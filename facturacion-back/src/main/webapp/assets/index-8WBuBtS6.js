const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/html2pdf-Dl1fu7qR.js","assets/jspdf.es.min-E-dsLDt-.js","assets/html2canvas.esm-DZlvpFNH.js"])))=>i.map(i=>d[i]);
(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var dL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function A2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function uL(e){if(e.__esModule)return e;var a=e.default;if(typeof a=="function"){var t=function r(){return this instanceof r?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};t.prototype=a.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),t}var R2={exports:{}},J0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uk=Symbol.for("react.transitional.element"),Lk=Symbol.for("react.fragment");function D2(e,a,t){var r=null;if(t!==void 0&&(r=""+t),a.key!==void 0&&(r=""+a.key),"key"in a){t={};for(var s in a)s!=="key"&&(t[s]=a[s])}else t=a;return a=t.ref,{$$typeof:Uk,type:e,key:r,ref:a!==void 0?a:null,props:t}}J0.Fragment=Lk;J0.jsx=D2;J0.jsxs=D2;R2.exports=J0;var n=R2.exports,P2={exports:{}},ia={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jx=Symbol.for("react.transitional.element"),Bk=Symbol.for("react.portal"),zk=Symbol.for("react.fragment"),$k=Symbol.for("react.strict_mode"),Vk=Symbol.for("react.profiler"),Hk=Symbol.for("react.consumer"),Gk=Symbol.for("react.context"),Xk=Symbol.for("react.forward_ref"),qk=Symbol.for("react.suspense"),Yk=Symbol.for("react.memo"),O2=Symbol.for("react.lazy"),kp=Symbol.iterator;function Wk(e){return e===null||typeof e!="object"?null:(e=kp&&e[kp]||e["@@iterator"],typeof e=="function"?e:null)}var I2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M2=Object.assign,U2={};function Go(e,a,t){this.props=e,this.context=a,this.refs=U2,this.updater=t||I2}Go.prototype.isReactComponent={};Go.prototype.setState=function(e,a){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,a,"setState")};Go.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function L2(){}L2.prototype=Go.prototype;function Sx(e,a,t){this.props=e,this.context=a,this.refs=U2,this.updater=t||I2}var Cx=Sx.prototype=new L2;Cx.constructor=Sx;M2(Cx,Go.prototype);Cx.isPureReactComponent=!0;var Np=Array.isArray,Ha={H:null,A:null,T:null,S:null,V:null},B2=Object.prototype.hasOwnProperty;function Tx(e,a,t,r,s,i){return t=i.ref,{$$typeof:jx,type:e,key:a,ref:t!==void 0?t:null,props:i}}function Kk(e,a){return Tx(e.type,a,void 0,void 0,void 0,e.props)}function Fx(e){return typeof e=="object"&&e!==null&&e.$$typeof===jx}function Jk(e){var a={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(t){return a[t]})}var jp=/\/+/g;function Mu(e,a){return typeof e=="object"&&e!==null&&e.key!=null?Jk(""+e.key):a.toString(36)}function Sp(){}function Zk(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(Sp,Sp):(e.status="pending",e.then(function(a){e.status==="pending"&&(e.status="fulfilled",e.value=a)},function(a){e.status==="pending"&&(e.status="rejected",e.reason=a)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function Gi(e,a,t,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"bigint":case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case jx:case Bk:o=!0;break;case O2:return o=e._init,Gi(o(e._payload),a,t,r,s)}}if(o)return s=s(e),o=r===""?"."+Mu(e,0):r,Np(s)?(t="",o!=null&&(t=o.replace(jp,"$&/")+"/"),Gi(s,a,t,"",function(u){return u})):s!=null&&(Fx(s)&&(s=Kk(s,t+(s.key==null||e&&e.key===s.key?"":(""+s.key).replace(jp,"$&/")+"/")+o)),a.push(s)),1;o=0;var l=r===""?".":r+":";if(Np(e))for(var c=0;c<e.length;c++)r=e[c],i=l+Mu(r,c),o+=Gi(r,a,t,i,s);else if(c=Wk(e),typeof c=="function")for(e=c.call(e),c=0;!(r=e.next()).done;)r=r.value,i=l+Mu(r,c++),o+=Gi(r,a,t,i,s);else if(i==="object"){if(typeof e.then=="function")return Gi(Zk(e),a,t,r,s);throw a=String(e),Error("Objects are not valid as a React child (found: "+(a==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":a)+"). If you meant to render a collection of children, use an array instead.")}return o}function Qc(e,a,t){if(e==null)return e;var r=[],s=0;return Gi(e,r,"","",function(i){return a.call(t,i,s++)}),r}function Qk(e){if(e._status===-1){var a=e._result;a=a(),a.then(function(t){(e._status===0||e._status===-1)&&(e._status=1,e._result=t)},function(t){(e._status===0||e._status===-1)&&(e._status=2,e._result=t)}),e._status===-1&&(e._status=0,e._result=a)}if(e._status===1)return e._result.default;throw e._result}var Cp=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function eN(){}ia.Children={map:Qc,forEach:function(e,a,t){Qc(e,function(){a.apply(this,arguments)},t)},count:function(e){var a=0;return Qc(e,function(){a++}),a},toArray:function(e){return Qc(e,function(a){return a})||[]},only:function(e){if(!Fx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ia.Component=Go;ia.Fragment=zk;ia.Profiler=Vk;ia.PureComponent=Sx;ia.StrictMode=$k;ia.Suspense=qk;ia.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ha;ia.__COMPILER_RUNTIME={__proto__:null,c:function(e){return Ha.H.useMemoCache(e)}};ia.cache=function(e){return function(){return e.apply(null,arguments)}};ia.cloneElement=function(e,a,t){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var r=M2({},e.props),s=e.key,i=void 0;if(a!=null)for(o in a.ref!==void 0&&(i=void 0),a.key!==void 0&&(s=""+a.key),a)!B2.call(a,o)||o==="key"||o==="__self"||o==="__source"||o==="ref"&&a.ref===void 0||(r[o]=a[o]);var o=arguments.length-2;if(o===1)r.children=t;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];r.children=l}return Tx(e.type,s,void 0,void 0,i,r)};ia.createContext=function(e){return e={$$typeof:Gk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:Hk,_context:e},e};ia.createElement=function(e,a,t){var r,s={},i=null;if(a!=null)for(r in a.key!==void 0&&(i=""+a.key),a)B2.call(a,r)&&r!=="key"&&r!=="__self"&&r!=="__source"&&(s[r]=a[r]);var o=arguments.length-2;if(o===1)s.children=t;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)s[r]===void 0&&(s[r]=o[r]);return Tx(e,i,void 0,void 0,null,s)};ia.createRef=function(){return{current:null}};ia.forwardRef=function(e){return{$$typeof:Xk,render:e}};ia.isValidElement=Fx;ia.lazy=function(e){return{$$typeof:O2,_payload:{_status:-1,_result:e},_init:Qk}};ia.memo=function(e,a){return{$$typeof:Yk,type:e,compare:a===void 0?null:a}};ia.startTransition=function(e){var a=Ha.T,t={};Ha.T=t;try{var r=e(),s=Ha.S;s!==null&&s(t,r),typeof r=="object"&&r!==null&&typeof r.then=="function"&&r.then(eN,Cp)}catch(i){Cp(i)}finally{Ha.T=a}};ia.unstable_useCacheRefresh=function(){return Ha.H.useCacheRefresh()};ia.use=function(e){return Ha.H.use(e)};ia.useActionState=function(e,a,t){return Ha.H.useActionState(e,a,t)};ia.useCallback=function(e,a){return Ha.H.useCallback(e,a)};ia.useContext=function(e){return Ha.H.useContext(e)};ia.useDebugValue=function(){};ia.useDeferredValue=function(e,a){return Ha.H.useDeferredValue(e,a)};ia.useEffect=function(e,a,t){var r=Ha.H;if(typeof t=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,a)};ia.useId=function(){return Ha.H.useId()};ia.useImperativeHandle=function(e,a,t){return Ha.H.useImperativeHandle(e,a,t)};ia.useInsertionEffect=function(e,a){return Ha.H.useInsertionEffect(e,a)};ia.useLayoutEffect=function(e,a){return Ha.H.useLayoutEffect(e,a)};ia.useMemo=function(e,a){return Ha.H.useMemo(e,a)};ia.useOptimistic=function(e,a){return Ha.H.useOptimistic(e,a)};ia.useReducer=function(e,a,t){return Ha.H.useReducer(e,a,t)};ia.useRef=function(e){return Ha.H.useRef(e)};ia.useState=function(e){return Ha.H.useState(e)};ia.useSyncExternalStore=function(e,a,t){return Ha.H.useSyncExternalStore(e,a,t)};ia.useTransition=function(){return Ha.H.useTransition()};ia.version="19.1.1";P2.exports=ia;var N=P2.exports;const or=A2(N);var z2={exports:{}},Z0={},$2={exports:{}},V2={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function a(S,D){var H=S.length;S.push(D);e:for(;0<H;){var U=H-1>>>1,B=S[U];if(0<s(B,D))S[U]=D,S[H]=B,H=U;else break e}}function t(S){return S.length===0?null:S[0]}function r(S){if(S.length===0)return null;var D=S[0],H=S.pop();if(H!==D){S[0]=H;e:for(var U=0,B=S.length,X=B>>>1;U<X;){var T=2*(U+1)-1,L=S[T],V=T+1,O=S[V];if(0>s(L,H))V<B&&0>s(O,L)?(S[U]=O,S[V]=H,U=V):(S[U]=L,S[T]=H,U=T);else if(V<B&&0>s(O,H))S[U]=O,S[V]=H,U=V;else break e}}return D}function s(S,D){var H=S.sortIndex-D.sortIndex;return H!==0?H:S.id-D.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,m=3,x=!1,h=!1,g=!1,p=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function y(S){for(var D=t(u);D!==null;){if(D.callback===null)r(u);else if(D.startTime<=S)r(u),D.sortIndex=D.expirationTime,a(c,D);else break;D=t(u)}}function j(S){if(g=!1,y(S),!h)if(t(c)!==null)h=!0,A||(A=!0,_());else{var D=t(u);D!==null&&z(j,D.startTime-S)}}var A=!1,E=-1,F=5,k=-1;function P(){return p?!0:!(e.unstable_now()-k<F)}function R(){if(p=!1,A){var S=e.unstable_now();k=S;var D=!0;try{e:{h=!1,g&&(g=!1,w(E),E=-1),x=!0;var H=m;try{a:{for(y(S),f=t(c);f!==null&&!(f.expirationTime>S&&P());){var U=f.callback;if(typeof U=="function"){f.callback=null,m=f.priorityLevel;var B=U(f.expirationTime<=S);if(S=e.unstable_now(),typeof B=="function"){f.callback=B,y(S),D=!0;break a}f===t(c)&&r(c),y(S)}else r(c);f=t(c)}if(f!==null)D=!0;else{var X=t(u);X!==null&&z(j,X.startTime-S),D=!1}}break e}finally{f=null,m=H,x=!1}D=void 0}}finally{D?_():A=!1}}}var _;if(typeof b=="function")_=function(){b(R)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,C=Q.port2;Q.port1.onmessage=R,_=function(){C.postMessage(null)}}else _=function(){v(R,0)};function z(S,D){E=v(function(){S(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(S){S.callback=null},e.unstable_forceFrameRate=function(S){0>S||125<S?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<S?Math.floor(1e3/S):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(S){switch(m){case 1:case 2:case 3:var D=3;break;default:D=m}var H=m;m=D;try{return S()}finally{m=H}},e.unstable_requestPaint=function(){p=!0},e.unstable_runWithPriority=function(S,D){switch(S){case 1:case 2:case 3:case 4:case 5:break;default:S=3}var H=m;m=S;try{return D()}finally{m=H}},e.unstable_scheduleCallback=function(S,D,H){var U=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?U+H:U):H=U,S){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=H+B,S={id:d++,callback:D,priorityLevel:S,startTime:H,expirationTime:B,sortIndex:-1},H>U?(S.sortIndex=H,a(u,S),t(c)===null&&S===t(u)&&(g?(w(E),E=-1):g=!0,z(j,H-U))):(S.sortIndex=B,a(c,S),h||x||(h=!0,A||(A=!0,_()))),S},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(S){var D=m;return function(){var H=m;m=D;try{return S.apply(this,arguments)}finally{m=H}}}})(V2);$2.exports=V2;var aN=$2.exports,H2={exports:{}},tr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tN=N;function G2(e){var a="https://react.dev/errors/"+e;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var t=2;t<arguments.length;t++)a+="&args[]="+encodeURIComponent(arguments[t])}return"Minified React error #"+e+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Ks(){}var er={d:{f:Ks,r:function(){throw Error(G2(522))},D:Ks,C:Ks,L:Ks,m:Ks,X:Ks,S:Ks,M:Ks},p:0,findDOMNode:null},rN=Symbol.for("react.portal");function sN(e,a,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rN,key:r==null?null:""+r,children:e,containerInfo:a,implementation:t}}var Cl=tN.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Q0(e,a){if(e==="font")return"";if(typeof a=="string")return a==="use-credentials"?a:""}tr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=er;tr.createPortal=function(e,a){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)throw Error(G2(299));return sN(e,a,null,t)};tr.flushSync=function(e){var a=Cl.T,t=er.p;try{if(Cl.T=null,er.p=2,e)return e()}finally{Cl.T=a,er.p=t,er.d.f()}};tr.preconnect=function(e,a){typeof e=="string"&&(a?(a=a.crossOrigin,a=typeof a=="string"?a==="use-credentials"?a:"":void 0):a=null,er.d.C(e,a))};tr.prefetchDNS=function(e){typeof e=="string"&&er.d.D(e)};tr.preinit=function(e,a){if(typeof e=="string"&&a&&typeof a.as=="string"){var t=a.as,r=Q0(t,a.crossOrigin),s=typeof a.integrity=="string"?a.integrity:void 0,i=typeof a.fetchPriority=="string"?a.fetchPriority:void 0;t==="style"?er.d.S(e,typeof a.precedence=="string"?a.precedence:void 0,{crossOrigin:r,integrity:s,fetchPriority:i}):t==="script"&&er.d.X(e,{crossOrigin:r,integrity:s,fetchPriority:i,nonce:typeof a.nonce=="string"?a.nonce:void 0})}};tr.preinitModule=function(e,a){if(typeof e=="string")if(typeof a=="object"&&a!==null){if(a.as==null||a.as==="script"){var t=Q0(a.as,a.crossOrigin);er.d.M(e,{crossOrigin:t,integrity:typeof a.integrity=="string"?a.integrity:void 0,nonce:typeof a.nonce=="string"?a.nonce:void 0})}}else a==null&&er.d.M(e)};tr.preload=function(e,a){if(typeof e=="string"&&typeof a=="object"&&a!==null&&typeof a.as=="string"){var t=a.as,r=Q0(t,a.crossOrigin);er.d.L(e,t,{crossOrigin:r,integrity:typeof a.integrity=="string"?a.integrity:void 0,nonce:typeof a.nonce=="string"?a.nonce:void 0,type:typeof a.type=="string"?a.type:void 0,fetchPriority:typeof a.fetchPriority=="string"?a.fetchPriority:void 0,referrerPolicy:typeof a.referrerPolicy=="string"?a.referrerPolicy:void 0,imageSrcSet:typeof a.imageSrcSet=="string"?a.imageSrcSet:void 0,imageSizes:typeof a.imageSizes=="string"?a.imageSizes:void 0,media:typeof a.media=="string"?a.media:void 0})}};tr.preloadModule=function(e,a){if(typeof e=="string")if(a){var t=Q0(a.as,a.crossOrigin);er.d.m(e,{as:typeof a.as=="string"&&a.as!=="script"?a.as:void 0,crossOrigin:t,integrity:typeof a.integrity=="string"?a.integrity:void 0})}else er.d.m(e)};tr.requestFormReset=function(e){er.d.r(e)};tr.unstable_batchedUpdates=function(e,a){return e(a)};tr.useFormState=function(e,a,t){return Cl.H.useFormState(e,a,t)};tr.useFormStatus=function(){return Cl.H.useHostTransitionStatus()};tr.version="19.1.1";function X2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X2)}catch(e){console.error(e)}}X2(),H2.exports=tr;var nN=H2.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vt=aN,q2=N,iN=nN;function Ce(e){var a="https://react.dev/errors/"+e;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var t=2;t<arguments.length;t++)a+="&args[]="+encodeURIComponent(arguments[t])}return"Minified React error #"+e+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Y2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function kc(e){var a=e,t=e;if(e.alternate)for(;a.return;)a=a.return;else{e=a;do a=e,a.flags&4098&&(t=a.return),e=a.return;while(e)}return a.tag===3?t:null}function W2(e){if(e.tag===13){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function Tp(e){if(kc(e)!==e)throw Error(Ce(188))}function oN(e){var a=e.alternate;if(!a){if(a=kc(e),a===null)throw Error(Ce(188));return a!==e?null:e}for(var t=e,r=a;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return Tp(s),e;if(i===r)return Tp(s),a;i=i.sibling}throw Error(Ce(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===t){o=!0,t=s,r=i;break}if(l===r){o=!0,r=s,t=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===t){o=!0,t=i,r=s;break}if(l===r){o=!0,r=i,t=s;break}l=l.sibling}if(!o)throw Error(Ce(189))}}if(t.alternate!==r)throw Error(Ce(190))}if(t.tag!==3)throw Error(Ce(188));return t.stateNode.current===t?e:a}function K2(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e;for(e=e.child;e!==null;){if(a=K2(e),a!==null)return a;e=e.sibling}return null}var za=Object.assign,lN=Symbol.for("react.element"),ed=Symbol.for("react.transitional.element"),bl=Symbol.for("react.portal"),Zi=Symbol.for("react.fragment"),J2=Symbol.for("react.strict_mode"),Zf=Symbol.for("react.profiler"),cN=Symbol.for("react.provider"),Z2=Symbol.for("react.consumer"),Fs=Symbol.for("react.context"),_x=Symbol.for("react.forward_ref"),Qf=Symbol.for("react.suspense"),em=Symbol.for("react.suspense_list"),Ax=Symbol.for("react.memo"),en=Symbol.for("react.lazy"),am=Symbol.for("react.activity"),dN=Symbol.for("react.memo_cache_sentinel"),Fp=Symbol.iterator;function ll(e){return e===null||typeof e!="object"?null:(e=Fp&&e[Fp]||e["@@iterator"],typeof e=="function"?e:null)}var uN=Symbol.for("react.client.reference");function tm(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===uN?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Zi:return"Fragment";case Zf:return"Profiler";case J2:return"StrictMode";case Qf:return"Suspense";case em:return"SuspenseList";case am:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case bl:return"Portal";case Fs:return(e.displayName||"Context")+".Provider";case Z2:return(e._context.displayName||"Context")+".Consumer";case _x:var a=e.render;return e=e.displayName,e||(e=a.displayName||a.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ax:return a=e.displayName||null,a!==null?a:tm(e.type)||"Memo";case en:a=e._payload,e=e._init;try{return tm(e(a))}catch{}}return null}var wl=Array.isArray,Je=q2.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ea=iN.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Kn={pending:!1,data:null,method:null,action:null},rm=[],Qi=-1;function vs(e){return{current:e}}function Ct(e){0>Qi||(e.current=rm[Qi],rm[Qi]=null,Qi--)}function Ga(e,a){Qi++,rm[Qi]=e.current,e.current=a}var xs=vs(null),Kl=vs(null),xn=vs(null),Zd=vs(null);function Qd(e,a){switch(Ga(xn,a),Ga(Kl,e),Ga(xs,null),a.nodeType){case 9:case 11:e=(e=a.documentElement)&&(e=e.namespaceURI)?Pg(e):0;break;default:if(e=a.tagName,a=a.namespaceURI)a=Pg(a),e=hw(a,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Ct(xs),Ga(xs,e)}function Fo(){Ct(xs),Ct(Kl),Ct(xn)}function sm(e){e.memoizedState!==null&&Ga(Zd,e);var a=xs.current,t=hw(a,e.type);a!==t&&(Ga(Kl,e),Ga(xs,t))}function e0(e){Kl.current===e&&(Ct(xs),Ct(Kl)),Zd.current===e&&(Ct(Zd),ic._currentValue=Kn)}var nm=Object.prototype.hasOwnProperty,Rx=vt.unstable_scheduleCallback,Uu=vt.unstable_cancelCallback,fN=vt.unstable_shouldYield,mN=vt.unstable_requestPaint,hs=vt.unstable_now,xN=vt.unstable_getCurrentPriorityLevel,Q2=vt.unstable_ImmediatePriority,eb=vt.unstable_UserBlockingPriority,a0=vt.unstable_NormalPriority,hN=vt.unstable_LowPriority,ab=vt.unstable_IdlePriority,pN=vt.log,gN=vt.unstable_setDisableYieldValue,Nc=null,Nr=null;function ln(e){if(typeof pN=="function"&&gN(e),Nr&&typeof Nr.setStrictMode=="function")try{Nr.setStrictMode(Nc,e)}catch{}}var jr=Math.clz32?Math.clz32:bN,yN=Math.log,vN=Math.LN2;function bN(e){return e>>>=0,e===0?32:31-(yN(e)/vN|0)|0}var ad=256,td=4194304;function $n(e){var a=e&42;if(a!==0)return a;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function eu(e,a,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,i=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var l=r&134217727;return l!==0?(r=l&~i,r!==0?s=$n(r):(o&=l,o!==0?s=$n(o):t||(t=l&~e,t!==0&&(s=$n(t))))):(l=r&~i,l!==0?s=$n(l):o!==0?s=$n(o):t||(t=r&~e,t!==0&&(s=$n(t)))),s===0?0:a!==0&&a!==s&&!(a&i)&&(i=s&-s,t=a&-a,i>=t||i===32&&(t&4194048)!==0)?a:s}function jc(e,a){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&a)===0}function wN(e,a){switch(e){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tb(){var e=ad;return ad<<=1,!(ad&4194048)&&(ad=256),e}function rb(){var e=td;return td<<=1,!(td&62914560)&&(td=4194304),e}function Lu(e){for(var a=[],t=0;31>t;t++)a.push(e);return a}function Sc(e,a){e.pendingLanes|=a,a!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function EN(e,a,t,r,s,i){var o=e.pendingLanes;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=t,e.entangledLanes&=t,e.errorRecoveryDisabledLanes&=t,e.shellSuspendCounter=0;var l=e.entanglements,c=e.expirationTimes,u=e.hiddenUpdates;for(t=o&~t;0<t;){var d=31-jr(t),f=1<<d;l[d]=0,c[d]=-1;var m=u[d];if(m!==null)for(u[d]=null,d=0;d<m.length;d++){var x=m[d];x!==null&&(x.lane&=-536870913)}t&=~f}r!==0&&sb(e,r,0),i!==0&&s===0&&e.tag!==0&&(e.suspendedLanes|=i&~(o&~a))}function sb(e,a,t){e.pendingLanes|=a,e.suspendedLanes&=~a;var r=31-jr(a);e.entangledLanes|=a,e.entanglements[r]=e.entanglements[r]|1073741824|t&4194090}function nb(e,a){var t=e.entangledLanes|=a;for(e=e.entanglements;t;){var r=31-jr(t),s=1<<r;s&a|e[r]&a&&(e[r]|=a),t&=~s}}function Dx(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Px(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function ib(){var e=Ea.p;return e!==0?e:(e=window.event,e===void 0?32:jw(e.type))}function kN(e,a){var t=Ea.p;try{return Ea.p=e,a()}finally{Ea.p=t}}var Rn=Math.random().toString(36).slice(2),Gt="__reactFiber$"+Rn,ur="__reactProps$"+Rn,Xo="__reactContainer$"+Rn,im="__reactEvents$"+Rn,NN="__reactListeners$"+Rn,jN="__reactHandles$"+Rn,_p="__reactResources$"+Rn,Cc="__reactMarker$"+Rn;function Ox(e){delete e[Gt],delete e[ur],delete e[im],delete e[NN],delete e[jN]}function eo(e){var a=e[Gt];if(a)return a;for(var t=e.parentNode;t;){if(a=t[Xo]||t[Gt]){if(t=a.alternate,a.child!==null||t!==null&&t.child!==null)for(e=Mg(e);e!==null;){if(t=e[Gt])return t;e=Mg(e)}return a}e=t,t=e.parentNode}return null}function qo(e){if(e=e[Gt]||e[Xo]){var a=e.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return e}return null}function El(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e.stateNode;throw Error(Ce(33))}function ho(e){var a=e[_p];return a||(a=e[_p]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function kt(e){e[Cc]=!0}var ob=new Set,lb={};function ki(e,a){_o(e,a),_o(e+"Capture",a)}function _o(e,a){for(lb[e]=a,e=0;e<a.length;e++)ob.add(a[e])}var SN=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ap={},Rp={};function CN(e){return nm.call(Rp,e)?!0:nm.call(Ap,e)?!1:SN.test(e)?Rp[e]=!0:(Ap[e]=!0,!1)}function Id(e,a,t){if(CN(a))if(t===null)e.removeAttribute(a);else{switch(typeof t){case"undefined":case"function":case"symbol":e.removeAttribute(a);return;case"boolean":var r=a.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){e.removeAttribute(a);return}}e.setAttribute(a,""+t)}}function rd(e,a,t){if(t===null)e.removeAttribute(a);else{switch(typeof t){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttribute(a,""+t)}}function js(e,a,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttributeNS(a,t,""+r)}}var Bu,Dp;function Xi(e){if(Bu===void 0)try{throw Error()}catch(t){var a=t.stack.trim().match(/\n( *(at )?)/);Bu=a&&a[1]||"",Dp=-1<t.stack.indexOf(`
    at`)?" (<anonymous>)":-1<t.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Bu+e+Dp}var zu=!1;function $u(e,a){if(!e||zu)return"";zu=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(a){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(x){var m=x}Reflect.construct(e,[],f)}else{try{f.call()}catch(x){m=x}e.call(f.prototype)}}else{try{throw Error()}catch(x){m=x}(f=e())&&typeof f.catch=="function"&&f.catch(function(){})}}catch(x){if(x&&m&&typeof x.stack=="string")return[x.stack,m.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),o=i[0],l=i[1];if(o&&l){var c=o.split(`
`),u=l.split(`
`);for(s=r=0;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;for(;s<u.length&&!u[s].includes("DetermineComponentFrameRoot");)s++;if(r===c.length||s===u.length)for(r=c.length-1,s=u.length-1;1<=r&&0<=s&&c[r]!==u[s];)s--;for(;1<=r&&0<=s;r--,s--)if(c[r]!==u[s]){if(r!==1||s!==1)do if(r--,s--,0>s||c[r]!==u[s]){var d=`
`+c[r].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=r&&0<=s);break}}}finally{zu=!1,Error.prepareStackTrace=t}return(t=e?e.displayName||e.name:"")?Xi(t):""}function TN(e){switch(e.tag){case 26:case 27:case 5:return Xi(e.type);case 16:return Xi("Lazy");case 13:return Xi("Suspense");case 19:return Xi("SuspenseList");case 0:case 15:return $u(e.type,!1);case 11:return $u(e.type.render,!1);case 1:return $u(e.type,!0);case 31:return Xi("Activity");default:return""}}function Pp(e){try{var a="";do a+=TN(e),e=e.return;while(e);return a}catch(t){return`
Error generating stack: `+t.message+`
`+t.stack}}function Mr(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function cb(e){var a=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function FN(e){var a=cb(e)?"checked":"value",t=Object.getOwnPropertyDescriptor(e.constructor.prototype,a),r=""+e[a];if(!e.hasOwnProperty(a)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(e,a,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,a,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[a]}}}}function t0(e){e._valueTracker||(e._valueTracker=FN(e))}function db(e){if(!e)return!1;var a=e._valueTracker;if(!a)return!0;var t=a.getValue(),r="";return e&&(r=cb(e)?e.checked?"true":"false":e.value),e=r,e!==t?(a.setValue(e),!0):!1}function r0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var _N=/[\n"\\]/g;function Br(e){return e.replace(_N,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function om(e,a,t,r,s,i,o,l){e.name="",o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?e.type=o:e.removeAttribute("type"),a!=null?o==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+Mr(a)):e.value!==""+Mr(a)&&(e.value=""+Mr(a)):o!=="submit"&&o!=="reset"||e.removeAttribute("value"),a!=null?lm(e,o,Mr(a)):t!=null?lm(e,o,Mr(t)):r!=null&&e.removeAttribute("value"),s==null&&i!=null&&(e.defaultChecked=!!i),s!=null&&(e.checked=s&&typeof s!="function"&&typeof s!="symbol"),l!=null&&typeof l!="function"&&typeof l!="symbol"&&typeof l!="boolean"?e.name=""+Mr(l):e.removeAttribute("name")}function ub(e,a,t,r,s,i,o,l){if(i!=null&&typeof i!="function"&&typeof i!="symbol"&&typeof i!="boolean"&&(e.type=i),a!=null||t!=null){if(!(i!=="submit"&&i!=="reset"||a!=null))return;t=t!=null?""+Mr(t):"",a=a!=null?""+Mr(a):t,l||a===e.value||(e.value=a),e.defaultValue=a}r=r??s,r=typeof r!="function"&&typeof r!="symbol"&&!!r,e.checked=l?e.checked:!!r,e.defaultChecked=!!r,o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"&&(e.name=o)}function lm(e,a,t){a==="number"&&r0(e.ownerDocument)===e||e.defaultValue===""+t||(e.defaultValue=""+t)}function po(e,a,t,r){if(e=e.options,a){a={};for(var s=0;s<t.length;s++)a["$"+t[s]]=!0;for(t=0;t<e.length;t++)s=a.hasOwnProperty("$"+e[t].value),e[t].selected!==s&&(e[t].selected=s),s&&r&&(e[t].defaultSelected=!0)}else{for(t=""+Mr(t),a=null,s=0;s<e.length;s++){if(e[s].value===t){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}a!==null||e[s].disabled||(a=e[s])}a!==null&&(a.selected=!0)}}function fb(e,a,t){if(a!=null&&(a=""+Mr(a),a!==e.value&&(e.value=a),t==null)){e.defaultValue!==a&&(e.defaultValue=a);return}e.defaultValue=t!=null?""+Mr(t):""}function mb(e,a,t,r){if(a==null){if(r!=null){if(t!=null)throw Error(Ce(92));if(wl(r)){if(1<r.length)throw Error(Ce(93));r=r[0]}t=r}t==null&&(t=""),a=t}t=Mr(a),e.defaultValue=t,r=e.textContent,r===t&&r!==""&&r!==null&&(e.value=r)}function Ao(e,a){if(a){var t=e.firstChild;if(t&&t===e.lastChild&&t.nodeType===3){t.nodeValue=a;return}}e.textContent=a}var AN=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Op(e,a,t){var r=a.indexOf("--")===0;t==null||typeof t=="boolean"||t===""?r?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="":r?e.setProperty(a,t):typeof t!="number"||t===0||AN.has(a)?a==="float"?e.cssFloat=t:e[a]=(""+t).trim():e[a]=t+"px"}function xb(e,a,t){if(a!=null&&typeof a!="object")throw Error(Ce(62));if(e=e.style,t!=null){for(var r in t)!t.hasOwnProperty(r)||a!=null&&a.hasOwnProperty(r)||(r.indexOf("--")===0?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="");for(var s in a)r=a[s],a.hasOwnProperty(s)&&t[s]!==r&&Op(e,s,r)}else for(var i in a)a.hasOwnProperty(i)&&Op(e,i,a[i])}function Ix(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var RN=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),DN=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Md(e){return DN.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var cm=null;function Mx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ao=null,go=null;function Ip(e){var a=qo(e);if(a&&(e=a.stateNode)){var t=e[ur]||null;e:switch(e=a.stateNode,a.type){case"input":if(om(e,t.value,t.defaultValue,t.defaultValue,t.checked,t.defaultChecked,t.type,t.name),a=t.name,t.type==="radio"&&a!=null){for(t=e;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll('input[name="'+Br(""+a)+'"][type="radio"]'),a=0;a<t.length;a++){var r=t[a];if(r!==e&&r.form===e.form){var s=r[ur]||null;if(!s)throw Error(Ce(90));om(r,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name)}}for(a=0;a<t.length;a++)r=t[a],r.form===e.form&&db(r)}break e;case"textarea":fb(e,t.value,t.defaultValue);break e;case"select":a=t.value,a!=null&&po(e,!!t.multiple,a,!1)}}}var Vu=!1;function hb(e,a,t){if(Vu)return e(a,t);Vu=!0;try{var r=e(a);return r}finally{if(Vu=!1,(ao!==null||go!==null)&&(du(),ao&&(a=ao,e=go,go=ao=null,Ip(a),e)))for(a=0;a<e.length;a++)Ip(e[a])}}function Jl(e,a){var t=e.stateNode;if(t===null)return null;var r=t[ur]||null;if(r===null)return null;t=r[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(t&&typeof t!="function")throw Error(Ce(231,a,typeof t));return t}var Bs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dm=!1;if(Bs)try{var cl={};Object.defineProperty(cl,"passive",{get:function(){dm=!0}}),window.addEventListener("test",cl,cl),window.removeEventListener("test",cl,cl)}catch{dm=!1}var cn=null,Ux=null,Ud=null;function pb(){if(Ud)return Ud;var e,a=Ux,t=a.length,r,s="value"in cn?cn.value:cn.textContent,i=s.length;for(e=0;e<t&&a[e]===s[e];e++);var o=t-e;for(r=1;r<=o&&a[t-r]===s[i-r];r++);return Ud=s.slice(e,1<r?1-r:void 0)}function Ld(e){var a=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&a===13&&(e=13)):e=a,e===10&&(e=13),32<=e||e===13?e:0}function sd(){return!0}function Mp(){return!1}function mr(e){function a(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(t=e[l],this[l]=t?t(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?sd:Mp,this.isPropagationStopped=Mp,this}return za(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=sd)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=sd)},persist:function(){},isPersistent:sd}),a}var Ni={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},au=mr(Ni),Tc=za({},Ni,{view:0,detail:0}),PN=mr(Tc),Hu,Gu,dl,tu=za({},Tc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==dl&&(dl&&e.type==="mousemove"?(Hu=e.screenX-dl.screenX,Gu=e.screenY-dl.screenY):Gu=Hu=0,dl=e),Hu)},movementY:function(e){return"movementY"in e?e.movementY:Gu}}),Up=mr(tu),ON=za({},tu,{dataTransfer:0}),IN=mr(ON),MN=za({},Tc,{relatedTarget:0}),Xu=mr(MN),UN=za({},Ni,{animationName:0,elapsedTime:0,pseudoElement:0}),LN=mr(UN),BN=za({},Ni,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),zN=mr(BN),$N=za({},Ni,{data:0}),Lp=mr($N),VN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function XN(e){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(e):(e=GN[e])?!!a[e]:!1}function Lx(){return XN}var qN=za({},Tc,{key:function(e){if(e.key){var a=VN[e.key]||e.key;if(a!=="Unidentified")return a}return e.type==="keypress"?(e=Ld(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?HN[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lx,charCode:function(e){return e.type==="keypress"?Ld(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ld(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),YN=mr(qN),WN=za({},tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bp=mr(WN),KN=za({},Tc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lx}),JN=mr(KN),ZN=za({},Ni,{propertyName:0,elapsedTime:0,pseudoElement:0}),QN=mr(ZN),ej=za({},tu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),aj=mr(ej),tj=za({},Ni,{newState:0,oldState:0}),rj=mr(tj),sj=[9,13,27,32],Bx=Bs&&"CompositionEvent"in window,Tl=null;Bs&&"documentMode"in document&&(Tl=document.documentMode);var nj=Bs&&"TextEvent"in window&&!Tl,gb=Bs&&(!Bx||Tl&&8<Tl&&11>=Tl),zp=" ",$p=!1;function yb(e,a){switch(e){case"keyup":return sj.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vb(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var to=!1;function ij(e,a){switch(e){case"compositionend":return vb(a);case"keypress":return a.which!==32?null:($p=!0,zp);case"textInput":return e=a.data,e===zp&&$p?null:e;default:return null}}function oj(e,a){if(to)return e==="compositionend"||!Bx&&yb(e,a)?(e=pb(),Ud=Ux=cn=null,to=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return gb&&a.locale!=="ko"?null:a.data;default:return null}}var lj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vp(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a==="input"?!!lj[e.type]:a==="textarea"}function bb(e,a,t,r){ao?go?go.push(r):go=[r]:ao=r,a=w0(a,"onChange"),0<a.length&&(t=new au("onChange","change",null,t,r),e.push({event:t,listeners:a}))}var Fl=null,Zl=null;function cj(e){fw(e,0)}function ru(e){var a=El(e);if(db(a))return e}function Hp(e,a){if(e==="change")return a}var wb=!1;if(Bs){var qu;if(Bs){var Yu="oninput"in document;if(!Yu){var Gp=document.createElement("div");Gp.setAttribute("oninput","return;"),Yu=typeof Gp.oninput=="function"}qu=Yu}else qu=!1;wb=qu&&(!document.documentMode||9<document.documentMode)}function Xp(){Fl&&(Fl.detachEvent("onpropertychange",Eb),Zl=Fl=null)}function Eb(e){if(e.propertyName==="value"&&ru(Zl)){var a=[];bb(a,Zl,e,Mx(e)),hb(cj,a)}}function dj(e,a,t){e==="focusin"?(Xp(),Fl=a,Zl=t,Fl.attachEvent("onpropertychange",Eb)):e==="focusout"&&Xp()}function uj(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ru(Zl)}function fj(e,a){if(e==="click")return ru(a)}function mj(e,a){if(e==="input"||e==="change")return ru(a)}function xj(e,a){return e===a&&(e!==0||1/e===1/a)||e!==e&&a!==a}var Tr=typeof Object.is=="function"?Object.is:xj;function Ql(e,a){if(Tr(e,a))return!0;if(typeof e!="object"||e===null||typeof a!="object"||a===null)return!1;var t=Object.keys(e),r=Object.keys(a);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!nm.call(a,s)||!Tr(e[s],a[s]))return!1}return!0}function qp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Yp(e,a){var t=qp(e);e=0;for(var r;t;){if(t.nodeType===3){if(r=e+t.textContent.length,e<=a&&r>=a)return{node:t,offset:a-e};e=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=qp(t)}}function kb(e,a){return e&&a?e===a?!0:e&&e.nodeType===3?!1:a&&a.nodeType===3?kb(e,a.parentNode):"contains"in e?e.contains(a):e.compareDocumentPosition?!!(e.compareDocumentPosition(a)&16):!1:!1}function Nb(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var a=r0(e.document);a instanceof e.HTMLIFrameElement;){try{var t=typeof a.contentWindow.location.href=="string"}catch{t=!1}if(t)e=a.contentWindow;else break;a=r0(e.document)}return a}function zx(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a&&(a==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||a==="textarea"||e.contentEditable==="true")}var hj=Bs&&"documentMode"in document&&11>=document.documentMode,ro=null,um=null,_l=null,fm=!1;function Wp(e,a,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;fm||ro==null||ro!==r0(r)||(r=ro,"selectionStart"in r&&zx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),_l&&Ql(_l,r)||(_l=r,r=w0(um,"onSelect"),0<r.length&&(a=new au("onSelect","select",null,a,t),e.push({event:a,listeners:r}),a.target=ro)))}function Bn(e,a){var t={};return t[e.toLowerCase()]=a.toLowerCase(),t["Webkit"+e]="webkit"+a,t["Moz"+e]="moz"+a,t}var so={animationend:Bn("Animation","AnimationEnd"),animationiteration:Bn("Animation","AnimationIteration"),animationstart:Bn("Animation","AnimationStart"),transitionrun:Bn("Transition","TransitionRun"),transitionstart:Bn("Transition","TransitionStart"),transitioncancel:Bn("Transition","TransitionCancel"),transitionend:Bn("Transition","TransitionEnd")},Wu={},jb={};Bs&&(jb=document.createElement("div").style,"AnimationEvent"in window||(delete so.animationend.animation,delete so.animationiteration.animation,delete so.animationstart.animation),"TransitionEvent"in window||delete so.transitionend.transition);function ji(e){if(Wu[e])return Wu[e];if(!so[e])return e;var a=so[e],t;for(t in a)if(a.hasOwnProperty(t)&&t in jb)return Wu[e]=a[t];return e}var Sb=ji("animationend"),Cb=ji("animationiteration"),Tb=ji("animationstart"),pj=ji("transitionrun"),gj=ji("transitionstart"),yj=ji("transitioncancel"),Fb=ji("transitionend"),_b=new Map,mm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mm.push("scrollEnd");function rs(e,a){_b.set(e,a),ki(a,[e])}var Kp=new WeakMap;function zr(e,a){if(typeof e=="object"&&e!==null){var t=Kp.get(e);return t!==void 0?t:(a={value:e,source:a,stack:Pp(a)},Kp.set(e,a),a)}return{value:e,source:a,stack:Pp(a)}}var Or=[],no=0,$x=0;function su(){for(var e=no,a=$x=no=0;a<e;){var t=Or[a];Or[a++]=null;var r=Or[a];Or[a++]=null;var s=Or[a];Or[a++]=null;var i=Or[a];if(Or[a++]=null,r!==null&&s!==null){var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}i!==0&&Ab(t,s,i)}}function nu(e,a,t,r){Or[no++]=e,Or[no++]=a,Or[no++]=t,Or[no++]=r,$x|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function Vx(e,a,t,r){return nu(e,a,t,r),s0(e)}function Yo(e,a){return nu(e,null,null,a),s0(e)}function Ab(e,a,t){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t);for(var s=!1,i=e.return;i!==null;)i.childLanes|=t,r=i.alternate,r!==null&&(r.childLanes|=t),i.tag===22&&(e=i.stateNode,e===null||e._visibility&1||(s=!0)),e=i,i=i.return;return e.tag===3?(i=e.stateNode,s&&a!==null&&(s=31-jr(t),e=i.hiddenUpdates,r=e[s],r===null?e[s]=[a]:r.push(a),a.lane=t|536870912),i):null}function s0(e){if(50<Bl)throw Bl=0,Pm=null,Error(Ce(185));for(var a=e.return;a!==null;)e=a,a=e.return;return e.tag===3?e.stateNode:null}var io={};function vj(e,a,t,r){this.tag=e,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function br(e,a,t,r){return new vj(e,a,t,r)}function Hx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Os(e,a){var t=e.alternate;return t===null?(t=br(e.tag,a,e.key,e.mode),t.elementType=e.elementType,t.type=e.type,t.stateNode=e.stateNode,t.alternate=e,e.alternate=t):(t.pendingProps=a,t.type=e.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=e.flags&65011712,t.childLanes=e.childLanes,t.lanes=e.lanes,t.child=e.child,t.memoizedProps=e.memoizedProps,t.memoizedState=e.memoizedState,t.updateQueue=e.updateQueue,a=e.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},t.sibling=e.sibling,t.index=e.index,t.ref=e.ref,t.refCleanup=e.refCleanup,t}function Rb(e,a){e.flags&=65011714;var t=e.alternate;return t===null?(e.childLanes=0,e.lanes=a,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=t.childLanes,e.lanes=t.lanes,e.child=t.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=t.memoizedProps,e.memoizedState=t.memoizedState,e.updateQueue=t.updateQueue,e.type=t.type,a=t.dependencies,e.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),e}function Bd(e,a,t,r,s,i){var o=0;if(r=e,typeof e=="function")Hx(e)&&(o=1);else if(typeof e=="string")o=wS(e,t,xs.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case am:return e=br(31,t,a,s),e.elementType=am,e.lanes=i,e;case Zi:return Jn(t.children,s,i,a);case J2:o=8,s|=24;break;case Zf:return e=br(12,t,a,s|2),e.elementType=Zf,e.lanes=i,e;case Qf:return e=br(13,t,a,s),e.elementType=Qf,e.lanes=i,e;case em:return e=br(19,t,a,s),e.elementType=em,e.lanes=i,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case cN:case Fs:o=10;break e;case Z2:o=9;break e;case _x:o=11;break e;case Ax:o=14;break e;case en:o=16,r=null;break e}o=29,t=Error(Ce(130,e===null?"null":typeof e,"")),r=null}return a=br(o,t,a,s),a.elementType=e,a.type=r,a.lanes=i,a}function Jn(e,a,t,r){return e=br(7,e,r,a),e.lanes=t,e}function Ku(e,a,t){return e=br(6,e,null,a),e.lanes=t,e}function Ju(e,a,t){return a=br(4,e.children!==null?e.children:[],e.key,a),a.lanes=t,a.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},a}var oo=[],lo=0,n0=null,i0=0,Ur=[],Lr=0,Zn=null,_s=1,As="";function Vn(e,a){oo[lo++]=i0,oo[lo++]=n0,n0=e,i0=a}function Db(e,a,t){Ur[Lr++]=_s,Ur[Lr++]=As,Ur[Lr++]=Zn,Zn=e;var r=_s;e=As;var s=32-jr(r)-1;r&=~(1<<s),t+=1;var i=32-jr(a)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,_s=1<<32-jr(a)+s|t<<s|r,As=i+e}else _s=1<<i|t<<s|r,As=e}function Gx(e){e.return!==null&&(Vn(e,1),Db(e,1,0))}function Xx(e){for(;e===n0;)n0=oo[--lo],oo[lo]=null,i0=oo[--lo],oo[lo]=null;for(;e===Zn;)Zn=Ur[--Lr],Ur[Lr]=null,As=Ur[--Lr],Ur[Lr]=null,_s=Ur[--Lr],Ur[Lr]=null}var Qt=null,Ja=null,wa=!1,Qn=null,us=!1,xm=Error(Ce(519));function di(e){var a=Error(Ce(418,""));throw ec(zr(a,e)),xm}function Jp(e){var a=e.stateNode,t=e.type,r=e.memoizedProps;switch(a[Gt]=e,a[ur]=r,t){case"dialog":ua("cancel",a),ua("close",a);break;case"iframe":case"object":case"embed":ua("load",a);break;case"video":case"audio":for(t=0;t<rc.length;t++)ua(rc[t],a);break;case"source":ua("error",a);break;case"img":case"image":case"link":ua("error",a),ua("load",a);break;case"details":ua("toggle",a);break;case"input":ua("invalid",a),ub(a,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),t0(a);break;case"select":ua("invalid",a);break;case"textarea":ua("invalid",a),mb(a,r.value,r.defaultValue,r.children),t0(a)}t=r.children,typeof t!="string"&&typeof t!="number"&&typeof t!="bigint"||a.textContent===""+t||r.suppressHydrationWarning===!0||xw(a.textContent,t)?(r.popover!=null&&(ua("beforetoggle",a),ua("toggle",a)),r.onScroll!=null&&ua("scroll",a),r.onScrollEnd!=null&&ua("scrollend",a),r.onClick!=null&&(a.onclick=mu),a=!0):a=!1,a||di(e)}function Zp(e){for(Qt=e.return;Qt;)switch(Qt.tag){case 5:case 13:us=!1;return;case 27:case 3:us=!0;return;default:Qt=Qt.return}}function ul(e){if(e!==Qt)return!1;if(!wa)return Zp(e),wa=!0,!1;var a=e.tag,t;if((t=a!==3&&a!==27)&&((t=a===5)&&(t=e.type,t=!(t!=="form"&&t!=="button")||Bm(e.type,e.memoizedProps)),t=!t),t&&Ja&&di(e),Zp(e),a===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ce(317));e:{for(e=e.nextSibling,a=0;e;){if(e.nodeType===8)if(t=e.data,t==="/$"){if(a===0){Ja=es(e.nextSibling);break e}a--}else t!=="$"&&t!=="$!"&&t!=="$?"||a++;e=e.nextSibling}Ja=null}}else a===27?(a=Ja,Dn(e.type)?(e=Vm,Vm=null,Ja=e):Ja=a):Ja=Qt?es(e.stateNode.nextSibling):null;return!0}function Fc(){Ja=Qt=null,wa=!1}function Qp(){var e=Qn;return e!==null&&(nr===null?nr=e:nr.push.apply(nr,e),Qn=null),e}function ec(e){Qn===null?Qn=[e]:Qn.push(e)}var hm=vs(null),Si=null,Rs=null;function rn(e,a,t){Ga(hm,a._currentValue),a._currentValue=t}function Is(e){e._currentValue=hm.current,Ct(hm)}function pm(e,a,t){for(;e!==null;){var r=e.alternate;if((e.childLanes&a)!==a?(e.childLanes|=a,r!==null&&(r.childLanes|=a)):r!==null&&(r.childLanes&a)!==a&&(r.childLanes|=a),e===t)break;e=e.return}}function gm(e,a,t,r){var s=e.child;for(s!==null&&(s.return=e);s!==null;){var i=s.dependencies;if(i!==null){var o=s.child;i=i.firstContext;e:for(;i!==null;){var l=i;i=s;for(var c=0;c<a.length;c++)if(l.context===a[c]){i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),pm(i.return,t,e),r||(o=null);break e}i=l.next}}else if(s.tag===18){if(o=s.return,o===null)throw Error(Ce(341));o.lanes|=t,i=o.alternate,i!==null&&(i.lanes|=t),pm(o,t,e),o=null}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}}function _c(e,a,t,r){e=null;for(var s=a,i=!1;s!==null;){if(!i){if(s.flags&524288)i=!0;else if(s.flags&262144)break}if(s.tag===10){var o=s.alternate;if(o===null)throw Error(Ce(387));if(o=o.memoizedProps,o!==null){var l=s.type;Tr(s.pendingProps.value,o.value)||(e!==null?e.push(l):e=[l])}}else if(s===Zd.current){if(o=s.alternate,o===null)throw Error(Ce(387));o.memoizedState.memoizedState!==s.memoizedState.memoizedState&&(e!==null?e.push(ic):e=[ic])}s=s.return}e!==null&&gm(a,e,t,r),a.flags|=262144}function o0(e){for(e=e.firstContext;e!==null;){if(!Tr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ui(e){Si=e,Rs=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Xt(e){return Pb(Si,e)}function nd(e,a){return Si===null&&ui(e),Pb(e,a)}function Pb(e,a){var t=a._currentValue;if(a={context:a,memoizedValue:t,next:null},Rs===null){if(e===null)throw Error(Ce(308));Rs=a,e.dependencies={lanes:0,firstContext:a},e.flags|=524288}else Rs=Rs.next=a;return t}var bj=typeof AbortController<"u"?AbortController:function(){var e=[],a=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){a.aborted=!0,e.forEach(function(t){return t()})}},wj=vt.unstable_scheduleCallback,Ej=vt.unstable_NormalPriority,xt={$$typeof:Fs,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qx(){return{controller:new bj,data:new Map,refCount:0}}function Ac(e){e.refCount--,e.refCount===0&&wj(Ej,function(){e.controller.abort()})}var Al=null,ym=0,Ro=0,yo=null;function kj(e,a){if(Al===null){var t=Al=[];ym=0,Ro=ph(),yo={status:"pending",value:void 0,then:function(r){t.push(r)}}}return ym++,a.then(eg,eg),a}function eg(){if(--ym===0&&Al!==null){yo!==null&&(yo.status="fulfilled");var e=Al;Al=null,Ro=0,yo=null;for(var a=0;a<e.length;a++)(0,e[a])()}}function Nj(e,a){var t=[],r={status:"pending",value:null,reason:null,then:function(s){t.push(s)}};return e.then(function(){r.status="fulfilled",r.value=a;for(var s=0;s<t.length;s++)(0,t[s])(a)},function(s){for(r.status="rejected",r.reason=s,s=0;s<t.length;s++)(0,t[s])(void 0)}),r}var ag=Je.S;Je.S=function(e,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&kj(e,a),ag!==null&&ag(e,a)};var ei=vs(null);function Yx(){var e=ei.current;return e!==null?e:Oa.pooledCache}function zd(e,a){a===null?Ga(ei,ei.current):Ga(ei,a.pool)}function Ob(){var e=Yx();return e===null?null:{parent:xt._currentValue,pool:e}}var Rc=Error(Ce(460)),Ib=Error(Ce(474)),iu=Error(Ce(542)),vm={then:function(){}};function tg(e){return e=e.status,e==="fulfilled"||e==="rejected"}function id(){}function Mb(e,a,t){switch(t=e[t],t===void 0?e.push(a):t!==a&&(a.then(id,id),a=t),a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,sg(e),e;default:if(typeof a.status=="string")a.then(id,id);else{if(e=Oa,e!==null&&100<e.shellSuspendCounter)throw Error(Ce(482));e=a,e.status="pending",e.then(function(r){if(a.status==="pending"){var s=a;s.status="fulfilled",s.value=r}},function(r){if(a.status==="pending"){var s=a;s.status="rejected",s.reason=r}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,sg(e),e}throw Rl=a,Rc}}var Rl=null;function rg(){if(Rl===null)throw Error(Ce(459));var e=Rl;return Rl=null,e}function sg(e){if(e===Rc||e===iu)throw Error(Ce(483))}var an=!1;function Wx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bm(e,a){e=e.updateQueue,a.updateQueue===e&&(a.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function hn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function pn(e,a,t){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ta&2){var s=r.pending;return s===null?a.next=a:(a.next=s.next,s.next=a),r.pending=a,a=s0(e),Ab(e,null,t),a}return nu(e,r,a,t),s0(e)}function Dl(e,a,t){if(a=a.updateQueue,a!==null&&(a=a.shared,(t&4194048)!==0)){var r=a.lanes;r&=e.pendingLanes,t|=r,a.lanes=t,nb(e,t)}}function Zu(e,a){var t=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={lane:t.lane,tag:t.tag,payload:t.payload,callback:null,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=a:i=i.next=a}else s=i=a;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},e.updateQueue=t;return}e=t.lastBaseUpdate,e===null?t.firstBaseUpdate=a:e.next=a,t.lastBaseUpdate=a}var wm=!1;function Pl(){if(wm){var e=yo;if(e!==null)throw e}}function Ol(e,a,t,r){wm=!1;var s=e.updateQueue;an=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;o=0,d=u=c=null,l=i;do{var m=l.lane&-536870913,x=m!==l.lane;if(x?(xa&m)===m:(r&m)===m){m!==0&&m===Ro&&(wm=!0),d!==null&&(d=d.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});e:{var h=e,g=l;m=a;var p=t;switch(g.tag){case 1:if(h=g.payload,typeof h=="function"){f=h.call(p,f,m);break e}f=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=g.payload,m=typeof h=="function"?h.call(p,f,m):h,m==null)break e;f=za({},f,m);break e;case 2:an=!0}}m=l.callback,m!==null&&(e.flags|=64,x&&(e.flags|=8192),x=s.callbacks,x===null?s.callbacks=[m]:x.push(m))}else x={lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=x,c=f):d=d.next=x,o|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;x=l,l=x.next,x.next=null,s.lastBaseUpdate=x,s.shared.pending=null}}while(!0);d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,i===null&&(s.shared.lanes=0),Nn|=o,e.lanes=o,e.memoizedState=f}}function Ub(e,a){if(typeof e!="function")throw Error(Ce(191,e));e.call(a)}function Lb(e,a){var t=e.callbacks;if(t!==null)for(e.callbacks=null,e=0;e<t.length;e++)Ub(t[e],a)}var Do=vs(null),l0=vs(0);function ng(e,a){e=Vs,Ga(l0,e),Ga(Do,a),Vs=e|a.baseLanes}function Em(){Ga(l0,Vs),Ga(Do,Do.current)}function Kx(){Vs=l0.current,Ct(Do),Ct(l0)}var En=0,ca=null,Aa=null,ut=null,c0=!1,vo=!1,fi=!1,d0=0,ac=0,bo=null,jj=0;function tt(){throw Error(Ce(321))}function Jx(e,a){if(a===null)return!1;for(var t=0;t<a.length&&t<e.length;t++)if(!Tr(e[t],a[t]))return!1;return!0}function Zx(e,a,t,r,s,i){return En=i,ca=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Je.H=e===null||e.memoizedState===null?p4:g4,fi=!1,i=t(r,s),fi=!1,vo&&(i=zb(a,t,r,s)),Bb(e),i}function Bb(e){Je.H=u0;var a=Aa!==null&&Aa.next!==null;if(En=0,ut=Aa=ca=null,c0=!1,ac=0,bo=null,a)throw Error(Ce(300));e===null||jt||(e=e.dependencies,e!==null&&o0(e)&&(jt=!0))}function zb(e,a,t,r){ca=e;var s=0;do{if(vo&&(bo=null),ac=0,vo=!1,25<=s)throw Error(Ce(301));if(s+=1,ut=Aa=null,e.updateQueue!=null){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,i.memoCache!=null&&(i.memoCache.index=0)}Je.H=Rj,i=a(t,r)}while(vo);return i}function Sj(){var e=Je.H,a=e.useState()[0];return a=typeof a.then=="function"?Dc(a):a,e=e.useState()[0],(Aa!==null?Aa.memoizedState:null)!==e&&(ca.flags|=1024),a}function Qx(){var e=d0!==0;return d0=0,e}function eh(e,a,t){a.updateQueue=e.updateQueue,a.flags&=-2053,e.lanes&=~t}function ah(e){if(c0){for(e=e.memoizedState;e!==null;){var a=e.queue;a!==null&&(a.pending=null),e=e.next}c0=!1}En=0,ut=Aa=ca=null,vo=!1,ac=d0=0,bo=null}function rr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?ca.memoizedState=ut=e:ut=ut.next=e,ut}function mt(){if(Aa===null){var e=ca.alternate;e=e!==null?e.memoizedState:null}else e=Aa.next;var a=ut===null?ca.memoizedState:ut.next;if(a!==null)ut=a,Aa=e;else{if(e===null)throw ca.alternate===null?Error(Ce(467)):Error(Ce(310));Aa=e,e={memoizedState:Aa.memoizedState,baseState:Aa.baseState,baseQueue:Aa.baseQueue,queue:Aa.queue,next:null},ut===null?ca.memoizedState=ut=e:ut=ut.next=e}return ut}function th(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dc(e){var a=ac;return ac+=1,bo===null&&(bo=[]),e=Mb(bo,e,a),a=ca,(ut===null?a.memoizedState:ut.next)===null&&(a=a.alternate,Je.H=a===null||a.memoizedState===null?p4:g4),e}function ou(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Dc(e);if(e.$$typeof===Fs)return Xt(e)}throw Error(Ce(438,String(e)))}function rh(e){var a=null,t=ca.updateQueue;if(t!==null&&(a=t.memoCache),a==null){var r=ca.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(a={data:r.data.map(function(s){return s.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),t===null&&(t=th(),ca.updateQueue=t),t.memoCache=a,t=a.data[a.index],t===void 0)for(t=a.data[a.index]=Array(e),r=0;r<e;r++)t[r]=dN;return a.index++,t}function zs(e,a){return typeof a=="function"?a(e):a}function $d(e){var a=mt();return sh(a,Aa,e)}function sh(e,a,t){var r=e.queue;if(r===null)throw Error(Ce(311));r.lastRenderedReducer=t;var s=e.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}a.baseQueue=s=i,r.pending=null}if(i=e.baseState,s===null)e.memoizedState=i;else{a=s.next;var l=o=null,c=null,u=a,d=!1;do{var f=u.lane&-536870913;if(f!==u.lane?(xa&f)===f:(En&f)===f){var m=u.revertLane;if(m===0)c!==null&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===Ro&&(d=!0);else if((En&m)===m){u=u.next,m===Ro&&(d=!0);continue}else f={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(l=c=f,o=i):c=c.next=f,ca.lanes|=m,Nn|=m;f=u.action,fi&&t(i,f),i=u.hasEagerState?u.eagerState:t(i,f)}else m={lane:f,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(l=c=m,o=i):c=c.next=m,ca.lanes|=f,Nn|=f;u=u.next}while(u!==null&&u!==a);if(c===null?o=i:c.next=l,!Tr(i,e.memoizedState)&&(jt=!0,d&&(t=yo,t!==null)))throw t;e.memoizedState=i,e.baseState=o,e.baseQueue=c,r.lastRenderedState=i}return s===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Qu(e){var a=mt(),t=a.queue;if(t===null)throw Error(Ce(311));t.lastRenderedReducer=e;var r=t.dispatch,s=t.pending,i=a.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Tr(i,a.memoizedState)||(jt=!0),a.memoizedState=i,a.baseQueue===null&&(a.baseState=i),t.lastRenderedState=i}return[i,r]}function $b(e,a,t){var r=ca,s=mt(),i=wa;if(i){if(t===void 0)throw Error(Ce(407));t=t()}else t=a();var o=!Tr((Aa||s).memoizedState,t);o&&(s.memoizedState=t,jt=!0),s=s.queue;var l=Gb.bind(null,r,s,e);if(Pc(2048,8,l,[e]),s.getSnapshot!==a||o||ut!==null&&ut.memoizedState.tag&1){if(r.flags|=2048,Po(9,lu(),Hb.bind(null,r,s,t,a),null),Oa===null)throw Error(Ce(349));i||En&124||Vb(r,a,t)}return t}function Vb(e,a,t){e.flags|=16384,e={getSnapshot:a,value:t},a=ca.updateQueue,a===null?(a=th(),ca.updateQueue=a,a.stores=[e]):(t=a.stores,t===null?a.stores=[e]:t.push(e))}function Hb(e,a,t,r){a.value=t,a.getSnapshot=r,Xb(a)&&qb(e)}function Gb(e,a,t){return t(function(){Xb(a)&&qb(e)})}function Xb(e){var a=e.getSnapshot;e=e.value;try{var t=a();return!Tr(e,t)}catch{return!0}}function qb(e){var a=Yo(e,2);a!==null&&Cr(a,e,2)}function km(e){var a=rr();if(typeof e=="function"){var t=e;if(e=t(),fi){ln(!0);try{t()}finally{ln(!1)}}}return a.memoizedState=a.baseState=e,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zs,lastRenderedState:e},a}function Yb(e,a,t,r){return e.baseState=t,sh(e,Aa,typeof r=="function"?r:zs)}function Cj(e,a,t,r,s){if(cu(e))throw Error(Ce(485));if(e=a.action,e!==null){var i={payload:s,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(o){i.listeners.push(o)}};Je.T!==null?t(!0):i.isTransition=!1,r(i),t=a.pending,t===null?(i.next=a.pending=i,Wb(a,i)):(i.next=t.next,a.pending=t.next=i)}}function Wb(e,a){var t=a.action,r=a.payload,s=e.state;if(a.isTransition){var i=Je.T,o={};Je.T=o;try{var l=t(s,r),c=Je.S;c!==null&&c(o,l),ig(e,a,l)}catch(u){Nm(e,a,u)}finally{Je.T=i}}else try{i=t(s,r),ig(e,a,i)}catch(u){Nm(e,a,u)}}function ig(e,a,t){t!==null&&typeof t=="object"&&typeof t.then=="function"?t.then(function(r){og(e,a,r)},function(r){return Nm(e,a,r)}):og(e,a,t)}function og(e,a,t){a.status="fulfilled",a.value=t,Kb(a),e.state=t,a=e.pending,a!==null&&(t=a.next,t===a?e.pending=null:(t=t.next,a.next=t,Wb(e,t)))}function Nm(e,a,t){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do a.status="rejected",a.reason=t,Kb(a),a=a.next;while(a!==r)}e.action=null}function Kb(e){e=e.listeners;for(var a=0;a<e.length;a++)(0,e[a])()}function Jb(e,a){return a}function lg(e,a){if(wa){var t=Oa.formState;if(t!==null){e:{var r=ca;if(wa){if(Ja){a:{for(var s=Ja,i=us;s.nodeType!==8;){if(!i){s=null;break a}if(s=es(s.nextSibling),s===null){s=null;break a}}i=s.data,s=i==="F!"||i==="F"?s:null}if(s){Ja=es(s.nextSibling),r=s.data==="F!";break e}}di(r)}r=!1}r&&(a=t[0])}}return t=rr(),t.memoizedState=t.baseState=a,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jb,lastRenderedState:a},t.queue=r,t=m4.bind(null,ca,r),r.dispatch=t,r=km(!1),i=lh.bind(null,ca,!1,r.queue),r=rr(),s={state:a,dispatch:null,action:e,pending:null},r.queue=s,t=Cj.bind(null,ca,s,i,t),s.dispatch=t,r.memoizedState=e,[a,t,!1]}function cg(e){var a=mt();return Zb(a,Aa,e)}function Zb(e,a,t){if(a=sh(e,a,Jb)[0],e=$d(zs)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var r=Dc(a)}catch(o){throw o===Rc?iu:o}else r=a;a=mt();var s=a.queue,i=s.dispatch;return t!==a.memoizedState&&(ca.flags|=2048,Po(9,lu(),Tj.bind(null,s,t),null)),[r,i,e]}function Tj(e,a){e.action=a}function dg(e){var a=mt(),t=Aa;if(t!==null)return Zb(a,t,e);mt(),a=a.memoizedState,t=mt();var r=t.queue.dispatch;return t.memoizedState=e,[a,r,!1]}function Po(e,a,t,r){return e={tag:e,create:t,deps:r,inst:a,next:null},a=ca.updateQueue,a===null&&(a=th(),ca.updateQueue=a),t=a.lastEffect,t===null?a.lastEffect=e.next=e:(r=t.next,t.next=e,e.next=r,a.lastEffect=e),e}function lu(){return{destroy:void 0,resource:void 0}}function Qb(){return mt().memoizedState}function Vd(e,a,t,r){var s=rr();r=r===void 0?null:r,ca.flags|=e,s.memoizedState=Po(1|a,lu(),t,r)}function Pc(e,a,t,r){var s=mt();r=r===void 0?null:r;var i=s.memoizedState.inst;Aa!==null&&r!==null&&Jx(r,Aa.memoizedState.deps)?s.memoizedState=Po(a,i,t,r):(ca.flags|=e,s.memoizedState=Po(1|a,i,t,r))}function ug(e,a){Vd(8390656,8,e,a)}function e4(e,a){Pc(2048,8,e,a)}function a4(e,a){return Pc(4,2,e,a)}function t4(e,a){return Pc(4,4,e,a)}function r4(e,a){if(typeof a=="function"){e=e();var t=a(e);return function(){typeof t=="function"?t():a(null)}}if(a!=null)return e=e(),a.current=e,function(){a.current=null}}function s4(e,a,t){t=t!=null?t.concat([e]):null,Pc(4,4,r4.bind(null,a,e),t)}function nh(){}function n4(e,a){var t=mt();a=a===void 0?null:a;var r=t.memoizedState;return a!==null&&Jx(a,r[1])?r[0]:(t.memoizedState=[e,a],e)}function i4(e,a){var t=mt();a=a===void 0?null:a;var r=t.memoizedState;if(a!==null&&Jx(a,r[1]))return r[0];if(r=e(),fi){ln(!0);try{e()}finally{ln(!1)}}return t.memoizedState=[r,a],r}function ih(e,a,t){return t===void 0||En&1073741824?e.memoizedState=a:(e.memoizedState=t,e=K4(),ca.lanes|=e,Nn|=e,t)}function o4(e,a,t,r){return Tr(t,a)?t:Do.current!==null?(e=ih(e,t,r),Tr(e,a)||(jt=!0),e):En&42?(e=K4(),ca.lanes|=e,Nn|=e,a):(jt=!0,e.memoizedState=t)}function l4(e,a,t,r,s){var i=Ea.p;Ea.p=i!==0&&8>i?i:8;var o=Je.T,l={};Je.T=l,lh(e,!1,a,t);try{var c=s(),u=Je.S;if(u!==null&&u(l,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=Nj(c,r);Il(e,a,d,Sr(e))}else Il(e,a,r,Sr(e))}catch(f){Il(e,a,{then:function(){},status:"rejected",reason:f},Sr())}finally{Ea.p=i,Je.T=o}}function Fj(){}function jm(e,a,t,r){if(e.tag!==5)throw Error(Ce(476));var s=c4(e).queue;l4(e,s,a,Kn,t===null?Fj:function(){return d4(e),t(r)})}function c4(e){var a=e.memoizedState;if(a!==null)return a;a={memoizedState:Kn,baseState:Kn,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zs,lastRenderedState:Kn},next:null};var t={};return a.next={memoizedState:t,baseState:t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zs,lastRenderedState:t},next:null},e.memoizedState=a,e=e.alternate,e!==null&&(e.memoizedState=a),a}function d4(e){var a=c4(e).next.queue;Il(e,a,{},Sr())}function oh(){return Xt(ic)}function u4(){return mt().memoizedState}function f4(){return mt().memoizedState}function _j(e){for(var a=e.return;a!==null;){switch(a.tag){case 24:case 3:var t=Sr();e=hn(t);var r=pn(a,e,t);r!==null&&(Cr(r,a,t),Dl(r,a,t)),a={cache:qx()},e.payload=a;return}a=a.return}}function Aj(e,a,t){var r=Sr();t={lane:r,revertLane:0,action:t,hasEagerState:!1,eagerState:null,next:null},cu(e)?x4(a,t):(t=Vx(e,a,t,r),t!==null&&(Cr(t,e,r),h4(t,a,r)))}function m4(e,a,t){var r=Sr();Il(e,a,t,r)}function Il(e,a,t,r){var s={lane:r,revertLane:0,action:t,hasEagerState:!1,eagerState:null,next:null};if(cu(e))x4(a,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=a.lastRenderedReducer,i!==null))try{var o=a.lastRenderedState,l=i(o,t);if(s.hasEagerState=!0,s.eagerState=l,Tr(l,o))return nu(e,a,s,0),Oa===null&&su(),!1}catch{}finally{}if(t=Vx(e,a,s,r),t!==null)return Cr(t,e,r),h4(t,a,r),!0}return!1}function lh(e,a,t,r){if(r={lane:2,revertLane:ph(),action:r,hasEagerState:!1,eagerState:null,next:null},cu(e)){if(a)throw Error(Ce(479))}else a=Vx(e,t,r,2),a!==null&&Cr(a,e,2)}function cu(e){var a=e.alternate;return e===ca||a!==null&&a===ca}function x4(e,a){vo=c0=!0;var t=e.pending;t===null?a.next=a:(a.next=t.next,t.next=a),e.pending=a}function h4(e,a,t){if(t&4194048){var r=a.lanes;r&=e.pendingLanes,t|=r,a.lanes=t,nb(e,t)}}var u0={readContext:Xt,use:ou,useCallback:tt,useContext:tt,useEffect:tt,useImperativeHandle:tt,useLayoutEffect:tt,useInsertionEffect:tt,useMemo:tt,useReducer:tt,useRef:tt,useState:tt,useDebugValue:tt,useDeferredValue:tt,useTransition:tt,useSyncExternalStore:tt,useId:tt,useHostTransitionStatus:tt,useFormState:tt,useActionState:tt,useOptimistic:tt,useMemoCache:tt,useCacheRefresh:tt},p4={readContext:Xt,use:ou,useCallback:function(e,a){return rr().memoizedState=[e,a===void 0?null:a],e},useContext:Xt,useEffect:ug,useImperativeHandle:function(e,a,t){t=t!=null?t.concat([e]):null,Vd(4194308,4,r4.bind(null,a,e),t)},useLayoutEffect:function(e,a){return Vd(4194308,4,e,a)},useInsertionEffect:function(e,a){Vd(4,2,e,a)},useMemo:function(e,a){var t=rr();a=a===void 0?null:a;var r=e();if(fi){ln(!0);try{e()}finally{ln(!1)}}return t.memoizedState=[r,a],r},useReducer:function(e,a,t){var r=rr();if(t!==void 0){var s=t(a);if(fi){ln(!0);try{t(a)}finally{ln(!1)}}}else s=a;return r.memoizedState=r.baseState=s,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},r.queue=e,e=e.dispatch=Aj.bind(null,ca,e),[r.memoizedState,e]},useRef:function(e){var a=rr();return e={current:e},a.memoizedState=e},useState:function(e){e=km(e);var a=e.queue,t=m4.bind(null,ca,a);return a.dispatch=t,[e.memoizedState,t]},useDebugValue:nh,useDeferredValue:function(e,a){var t=rr();return ih(t,e,a)},useTransition:function(){var e=km(!1);return e=l4.bind(null,ca,e.queue,!0,!1),rr().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,a,t){var r=ca,s=rr();if(wa){if(t===void 0)throw Error(Ce(407));t=t()}else{if(t=a(),Oa===null)throw Error(Ce(349));xa&124||Vb(r,a,t)}s.memoizedState=t;var i={value:t,getSnapshot:a};return s.queue=i,ug(Gb.bind(null,r,i,e),[e]),r.flags|=2048,Po(9,lu(),Hb.bind(null,r,i,t,a),null),t},useId:function(){var e=rr(),a=Oa.identifierPrefix;if(wa){var t=As,r=_s;t=(r&~(1<<32-jr(r)-1)).toString(32)+t,a=""+a+"R"+t,t=d0++,0<t&&(a+="H"+t.toString(32)),a+=""}else t=jj++,a=""+a+"r"+t.toString(32)+"";return e.memoizedState=a},useHostTransitionStatus:oh,useFormState:lg,useActionState:lg,useOptimistic:function(e){var a=rr();a.memoizedState=a.baseState=e;var t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=t,a=lh.bind(null,ca,!0,t),t.dispatch=a,[e,a]},useMemoCache:rh,useCacheRefresh:function(){return rr().memoizedState=_j.bind(null,ca)}},g4={readContext:Xt,use:ou,useCallback:n4,useContext:Xt,useEffect:e4,useImperativeHandle:s4,useInsertionEffect:a4,useLayoutEffect:t4,useMemo:i4,useReducer:$d,useRef:Qb,useState:function(){return $d(zs)},useDebugValue:nh,useDeferredValue:function(e,a){var t=mt();return o4(t,Aa.memoizedState,e,a)},useTransition:function(){var e=$d(zs)[0],a=mt().memoizedState;return[typeof e=="boolean"?e:Dc(e),a]},useSyncExternalStore:$b,useId:u4,useHostTransitionStatus:oh,useFormState:cg,useActionState:cg,useOptimistic:function(e,a){var t=mt();return Yb(t,Aa,e,a)},useMemoCache:rh,useCacheRefresh:f4},Rj={readContext:Xt,use:ou,useCallback:n4,useContext:Xt,useEffect:e4,useImperativeHandle:s4,useInsertionEffect:a4,useLayoutEffect:t4,useMemo:i4,useReducer:Qu,useRef:Qb,useState:function(){return Qu(zs)},useDebugValue:nh,useDeferredValue:function(e,a){var t=mt();return Aa===null?ih(t,e,a):o4(t,Aa.memoizedState,e,a)},useTransition:function(){var e=Qu(zs)[0],a=mt().memoizedState;return[typeof e=="boolean"?e:Dc(e),a]},useSyncExternalStore:$b,useId:u4,useHostTransitionStatus:oh,useFormState:dg,useActionState:dg,useOptimistic:function(e,a){var t=mt();return Aa!==null?Yb(t,Aa,e,a):(t.baseState=e,[e,t.queue.dispatch])},useMemoCache:rh,useCacheRefresh:f4},wo=null,tc=0;function od(e){var a=tc;return tc+=1,wo===null&&(wo=[]),Mb(wo,e,a)}function fl(e,a){a=a.props.ref,e.ref=a!==void 0?a:null}function ld(e,a){throw a.$$typeof===lN?Error(Ce(525)):(e=Object.prototype.toString.call(a),Error(Ce(31,e==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":e)))}function fg(e){var a=e._init;return a(e._payload)}function y4(e){function a(v,w){if(e){var b=v.deletions;b===null?(v.deletions=[w],v.flags|=16):b.push(w)}}function t(v,w){if(!e)return null;for(;w!==null;)a(v,w),w=w.sibling;return null}function r(v){for(var w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function s(v,w){return v=Os(v,w),v.index=0,v.sibling=null,v}function i(v,w,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<w?(v.flags|=67108866,w):b):(v.flags|=67108866,w)):(v.flags|=1048576,w)}function o(v){return e&&v.alternate===null&&(v.flags|=67108866),v}function l(v,w,b,y){return w===null||w.tag!==6?(w=Ku(b,v.mode,y),w.return=v,w):(w=s(w,b),w.return=v,w)}function c(v,w,b,y){var j=b.type;return j===Zi?d(v,w,b.props.children,y,b.key):w!==null&&(w.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===en&&fg(j)===w.type)?(w=s(w,b.props),fl(w,b),w.return=v,w):(w=Bd(b.type,b.key,b.props,null,v.mode,y),fl(w,b),w.return=v,w)}function u(v,w,b,y){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=Ju(b,v.mode,y),w.return=v,w):(w=s(w,b.children||[]),w.return=v,w)}function d(v,w,b,y,j){return w===null||w.tag!==7?(w=Jn(b,v.mode,y,j),w.return=v,w):(w=s(w,b),w.return=v,w)}function f(v,w,b){if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return w=Ku(""+w,v.mode,b),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ed:return b=Bd(w.type,w.key,w.props,null,v.mode,b),fl(b,w),b.return=v,b;case bl:return w=Ju(w,v.mode,b),w.return=v,w;case en:var y=w._init;return w=y(w._payload),f(v,w,b)}if(wl(w)||ll(w))return w=Jn(w,v.mode,b,null),w.return=v,w;if(typeof w.then=="function")return f(v,od(w),b);if(w.$$typeof===Fs)return f(v,nd(v,w),b);ld(v,w)}return null}function m(v,w,b,y){var j=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return j!==null?null:l(v,w,""+b,y);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ed:return b.key===j?c(v,w,b,y):null;case bl:return b.key===j?u(v,w,b,y):null;case en:return j=b._init,b=j(b._payload),m(v,w,b,y)}if(wl(b)||ll(b))return j!==null?null:d(v,w,b,y,null);if(typeof b.then=="function")return m(v,w,od(b),y);if(b.$$typeof===Fs)return m(v,w,nd(v,b),y);ld(v,b)}return null}function x(v,w,b,y,j){if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return v=v.get(b)||null,l(w,v,""+y,j);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ed:return v=v.get(y.key===null?b:y.key)||null,c(w,v,y,j);case bl:return v=v.get(y.key===null?b:y.key)||null,u(w,v,y,j);case en:var A=y._init;return y=A(y._payload),x(v,w,b,y,j)}if(wl(y)||ll(y))return v=v.get(b)||null,d(w,v,y,j,null);if(typeof y.then=="function")return x(v,w,b,od(y),j);if(y.$$typeof===Fs)return x(v,w,b,nd(w,y),j);ld(w,y)}return null}function h(v,w,b,y){for(var j=null,A=null,E=w,F=w=0,k=null;E!==null&&F<b.length;F++){E.index>F?(k=E,E=null):k=E.sibling;var P=m(v,E,b[F],y);if(P===null){E===null&&(E=k);break}e&&E&&P.alternate===null&&a(v,E),w=i(P,w,F),A===null?j=P:A.sibling=P,A=P,E=k}if(F===b.length)return t(v,E),wa&&Vn(v,F),j;if(E===null){for(;F<b.length;F++)E=f(v,b[F],y),E!==null&&(w=i(E,w,F),A===null?j=E:A.sibling=E,A=E);return wa&&Vn(v,F),j}for(E=r(E);F<b.length;F++)k=x(E,v,F,b[F],y),k!==null&&(e&&k.alternate!==null&&E.delete(k.key===null?F:k.key),w=i(k,w,F),A===null?j=k:A.sibling=k,A=k);return e&&E.forEach(function(R){return a(v,R)}),wa&&Vn(v,F),j}function g(v,w,b,y){if(b==null)throw Error(Ce(151));for(var j=null,A=null,E=w,F=w=0,k=null,P=b.next();E!==null&&!P.done;F++,P=b.next()){E.index>F?(k=E,E=null):k=E.sibling;var R=m(v,E,P.value,y);if(R===null){E===null&&(E=k);break}e&&E&&R.alternate===null&&a(v,E),w=i(R,w,F),A===null?j=R:A.sibling=R,A=R,E=k}if(P.done)return t(v,E),wa&&Vn(v,F),j;if(E===null){for(;!P.done;F++,P=b.next())P=f(v,P.value,y),P!==null&&(w=i(P,w,F),A===null?j=P:A.sibling=P,A=P);return wa&&Vn(v,F),j}for(E=r(E);!P.done;F++,P=b.next())P=x(E,v,F,P.value,y),P!==null&&(e&&P.alternate!==null&&E.delete(P.key===null?F:P.key),w=i(P,w,F),A===null?j=P:A.sibling=P,A=P);return e&&E.forEach(function(_){return a(v,_)}),wa&&Vn(v,F),j}function p(v,w,b,y){if(typeof b=="object"&&b!==null&&b.type===Zi&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case ed:e:{for(var j=b.key;w!==null;){if(w.key===j){if(j=b.type,j===Zi){if(w.tag===7){t(v,w.sibling),y=s(w,b.props.children),y.return=v,v=y;break e}}else if(w.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===en&&fg(j)===w.type){t(v,w.sibling),y=s(w,b.props),fl(y,b),y.return=v,v=y;break e}t(v,w);break}else a(v,w);w=w.sibling}b.type===Zi?(y=Jn(b.props.children,v.mode,y,b.key),y.return=v,v=y):(y=Bd(b.type,b.key,b.props,null,v.mode,y),fl(y,b),y.return=v,v=y)}return o(v);case bl:e:{for(j=b.key;w!==null;){if(w.key===j)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){t(v,w.sibling),y=s(w,b.children||[]),y.return=v,v=y;break e}else{t(v,w);break}else a(v,w);w=w.sibling}y=Ju(b,v.mode,y),y.return=v,v=y}return o(v);case en:return j=b._init,b=j(b._payload),p(v,w,b,y)}if(wl(b))return h(v,w,b,y);if(ll(b)){if(j=ll(b),typeof j!="function")throw Error(Ce(150));return b=j.call(b),g(v,w,b,y)}if(typeof b.then=="function")return p(v,w,od(b),y);if(b.$$typeof===Fs)return p(v,w,nd(v,b),y);ld(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint"?(b=""+b,w!==null&&w.tag===6?(t(v,w.sibling),y=s(w,b),y.return=v,v=y):(t(v,w),y=Ku(b,v.mode,y),y.return=v,v=y),o(v)):t(v,w)}return function(v,w,b,y){try{tc=0;var j=p(v,w,b,y);return wo=null,j}catch(E){if(E===Rc||E===iu)throw E;var A=br(29,E,null,v.mode);return A.lanes=y,A.return=v,A}finally{}}}var Oo=y4(!0),v4=y4(!1),Hr=vs(null),ps=null;function sn(e){var a=e.alternate;Ga(ht,ht.current&1),Ga(Hr,e),ps===null&&(a===null||Do.current!==null||a.memoizedState!==null)&&(ps=e)}function b4(e){if(e.tag===22){if(Ga(ht,ht.current),Ga(Hr,e),ps===null){var a=e.alternate;a!==null&&a.memoizedState!==null&&(ps=e)}}else nn()}function nn(){Ga(ht,ht.current),Ga(Hr,Hr.current)}function Ds(e){Ct(Hr),ps===e&&(ps=null),Ct(ht)}var ht=vs(0);function f0(e){for(var a=e;a!==null;){if(a.tag===13){var t=a.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||$m(t)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function ef(e,a,t,r){a=e.memoizedState,t=t(r,a),t=t==null?a:za({},a,t),e.memoizedState=t,e.lanes===0&&(e.updateQueue.baseState=t)}var Sm={enqueueSetState:function(e,a,t){e=e._reactInternals;var r=Sr(),s=hn(r);s.payload=a,t!=null&&(s.callback=t),a=pn(e,s,r),a!==null&&(Cr(a,e,r),Dl(a,e,r))},enqueueReplaceState:function(e,a,t){e=e._reactInternals;var r=Sr(),s=hn(r);s.tag=1,s.payload=a,t!=null&&(s.callback=t),a=pn(e,s,r),a!==null&&(Cr(a,e,r),Dl(a,e,r))},enqueueForceUpdate:function(e,a){e=e._reactInternals;var t=Sr(),r=hn(t);r.tag=2,a!=null&&(r.callback=a),a=pn(e,r,t),a!==null&&(Cr(a,e,t),Dl(a,e,t))}};function mg(e,a,t,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):a.prototype&&a.prototype.isPureReactComponent?!Ql(t,r)||!Ql(s,i):!0}function xg(e,a,t,r){e=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(t,r),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(t,r),a.state!==e&&Sm.enqueueReplaceState(a,a.state,null)}function mi(e,a){var t=a;if("ref"in a){t={};for(var r in a)r!=="ref"&&(t[r]=a[r])}if(e=e.defaultProps){t===a&&(t=za({},t));for(var s in e)t[s]===void 0&&(t[s]=e[s])}return t}var m0=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function w4(e){m0(e)}function E4(e){console.error(e)}function k4(e){m0(e)}function x0(e,a){try{var t=e.onUncaughtError;t(a.value,{componentStack:a.stack})}catch(r){setTimeout(function(){throw r})}}function hg(e,a,t){try{var r=e.onCaughtError;r(t.value,{componentStack:t.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(s){setTimeout(function(){throw s})}}function Cm(e,a,t){return t=hn(t),t.tag=3,t.payload={element:null},t.callback=function(){x0(e,a)},t}function N4(e){return e=hn(e),e.tag=3,e}function j4(e,a,t,r){var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var i=r.value;e.payload=function(){return s(i)},e.callback=function(){hg(a,t,r)}}var o=t.stateNode;o!==null&&typeof o.componentDidCatch=="function"&&(e.callback=function(){hg(a,t,r),typeof s!="function"&&(gn===null?gn=new Set([this]):gn.add(this));var l=r.stack;this.componentDidCatch(r.value,{componentStack:l!==null?l:""})})}function Dj(e,a,t,r,s){if(t.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(a=t.alternate,a!==null&&_c(a,t,s,!0),t=Hr.current,t!==null){switch(t.tag){case 13:return ps===null?Om():t.alternate===null&&Qa===0&&(Qa=3),t.flags&=-257,t.flags|=65536,t.lanes=s,r===vm?t.flags|=16384:(a=t.updateQueue,a===null?t.updateQueue=new Set([r]):a.add(r),ff(e,r,s)),!1;case 22:return t.flags|=65536,r===vm?t.flags|=16384:(a=t.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([r])},t.updateQueue=a):(t=a.retryQueue,t===null?a.retryQueue=new Set([r]):t.add(r)),ff(e,r,s)),!1}throw Error(Ce(435,t.tag))}return ff(e,r,s),Om(),!1}if(wa)return a=Hr.current,a!==null?(!(a.flags&65536)&&(a.flags|=256),a.flags|=65536,a.lanes=s,r!==xm&&(e=Error(Ce(422),{cause:r}),ec(zr(e,t)))):(r!==xm&&(a=Error(Ce(423),{cause:r}),ec(zr(a,t))),e=e.current.alternate,e.flags|=65536,s&=-s,e.lanes|=s,r=zr(r,t),s=Cm(e.stateNode,r,s),Zu(e,s),Qa!==4&&(Qa=2)),!1;var i=Error(Ce(520),{cause:r});if(i=zr(i,t),Ll===null?Ll=[i]:Ll.push(i),Qa!==4&&(Qa=2),a===null)return!0;r=zr(r,t),t=a;do{switch(t.tag){case 3:return t.flags|=65536,e=s&-s,t.lanes|=e,e=Cm(t.stateNode,r,e),Zu(t,e),!1;case 1:if(a=t.type,i=t.stateNode,(t.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||i!==null&&typeof i.componentDidCatch=="function"&&(gn===null||!gn.has(i))))return t.flags|=65536,s&=-s,t.lanes|=s,s=N4(s),j4(s,e,t,r),Zu(t,s),!1}t=t.return}while(t!==null);return!1}var S4=Error(Ce(461)),jt=!1;function _t(e,a,t,r){a.child=e===null?v4(a,null,t,r):Oo(a,e.child,t,r)}function pg(e,a,t,r,s){t=t.render;var i=a.ref;if("ref"in r){var o={};for(var l in r)l!=="ref"&&(o[l]=r[l])}else o=r;return ui(a),r=Zx(e,a,t,o,i,s),l=Qx(),e!==null&&!jt?(eh(e,a,s),$s(e,a,s)):(wa&&l&&Gx(a),a.flags|=1,_t(e,a,r,s),a.child)}function gg(e,a,t,r,s){if(e===null){var i=t.type;return typeof i=="function"&&!Hx(i)&&i.defaultProps===void 0&&t.compare===null?(a.tag=15,a.type=i,C4(e,a,i,r,s)):(e=Bd(t.type,null,r,a,a.mode,s),e.ref=a.ref,e.return=a,a.child=e)}if(i=e.child,!ch(e,s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:Ql,t(o,r)&&e.ref===a.ref)return $s(e,a,s)}return a.flags|=1,e=Os(i,r),e.ref=a.ref,e.return=a,a.child=e}function C4(e,a,t,r,s){if(e!==null){var i=e.memoizedProps;if(Ql(i,r)&&e.ref===a.ref)if(jt=!1,a.pendingProps=r=i,ch(e,s))e.flags&131072&&(jt=!0);else return a.lanes=e.lanes,$s(e,a,s)}return Tm(e,a,t,r,s)}function T4(e,a,t){var r=a.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden"){if(a.flags&128){if(r=i!==null?i.baseLanes|t:t,e!==null){for(s=a.child=e.child,i=0;s!==null;)i=i|s.lanes|s.childLanes,s=s.sibling;a.childLanes=i&~r}else a.childLanes=0,a.child=null;return yg(e,a,r,t)}if(t&536870912)a.memoizedState={baseLanes:0,cachePool:null},e!==null&&zd(a,i!==null?i.cachePool:null),i!==null?ng(a,i):Em(),b4(a);else return a.lanes=a.childLanes=536870912,yg(e,a,i!==null?i.baseLanes|t:t,t)}else i!==null?(zd(a,i.cachePool),ng(a,i),nn(),a.memoizedState=null):(e!==null&&zd(a,null),Em(),nn());return _t(e,a,s,t),a.child}function yg(e,a,t,r){var s=Yx();return s=s===null?null:{parent:xt._currentValue,pool:s},a.memoizedState={baseLanes:t,cachePool:s},e!==null&&zd(a,null),Em(),b4(a),e!==null&&_c(e,a,r,!0),null}function Hd(e,a){var t=a.ref;if(t===null)e!==null&&e.ref!==null&&(a.flags|=4194816);else{if(typeof t!="function"&&typeof t!="object")throw Error(Ce(284));(e===null||e.ref!==t)&&(a.flags|=4194816)}}function Tm(e,a,t,r,s){return ui(a),t=Zx(e,a,t,r,void 0,s),r=Qx(),e!==null&&!jt?(eh(e,a,s),$s(e,a,s)):(wa&&r&&Gx(a),a.flags|=1,_t(e,a,t,s),a.child)}function vg(e,a,t,r,s,i){return ui(a),a.updateQueue=null,t=zb(a,r,t,s),Bb(e),r=Qx(),e!==null&&!jt?(eh(e,a,i),$s(e,a,i)):(wa&&r&&Gx(a),a.flags|=1,_t(e,a,t,i),a.child)}function bg(e,a,t,r,s){if(ui(a),a.stateNode===null){var i=io,o=t.contextType;typeof o=="object"&&o!==null&&(i=Xt(o)),i=new t(r,i),a.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Sm,a.stateNode=i,i._reactInternals=a,i=a.stateNode,i.props=r,i.state=a.memoizedState,i.refs={},Wx(a),o=t.contextType,i.context=typeof o=="object"&&o!==null?Xt(o):io,i.state=a.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(ef(a,t,o,r),i.state=a.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(o=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),o!==i.state&&Sm.enqueueReplaceState(i,i.state,null),Ol(a,r,i,s),Pl(),i.state=a.memoizedState),typeof i.componentDidMount=="function"&&(a.flags|=4194308),r=!0}else if(e===null){i=a.stateNode;var l=a.memoizedProps,c=mi(t,l);i.props=c;var u=i.context,d=t.contextType;o=io,typeof d=="object"&&d!==null&&(o=Xt(d));var f=t.getDerivedStateFromProps;d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function",l=a.pendingProps!==l,d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l||u!==o)&&xg(a,i,r,o),an=!1;var m=a.memoizedState;i.state=m,Ol(a,r,i,s),Pl(),u=a.memoizedState,l||m!==u||an?(typeof f=="function"&&(ef(a,t,f,r),u=a.memoizedState),(c=an||mg(a,t,c,r,m,u,o))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(a.flags|=4194308)):(typeof i.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=r,a.memoizedState=u),i.props=r,i.state=u,i.context=o,r=c):(typeof i.componentDidMount=="function"&&(a.flags|=4194308),r=!1)}else{i=a.stateNode,bm(e,a),o=a.memoizedProps,d=mi(t,o),i.props=d,f=a.pendingProps,m=i.context,u=t.contextType,c=io,typeof u=="object"&&u!==null&&(c=Xt(u)),l=t.getDerivedStateFromProps,(u=typeof l=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||m!==c)&&xg(a,i,r,c),an=!1,m=a.memoizedState,i.state=m,Ol(a,r,i,s),Pl();var x=a.memoizedState;o!==f||m!==x||an||e!==null&&e.dependencies!==null&&o0(e.dependencies)?(typeof l=="function"&&(ef(a,t,l,r),x=a.memoizedState),(d=an||mg(a,t,d,r,m,x,c)||e!==null&&e.dependencies!==null&&o0(e.dependencies))?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,x,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,x,c)),typeof i.componentDidUpdate=="function"&&(a.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(a.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(a.flags|=1024),a.memoizedProps=r,a.memoizedState=x),i.props=r,i.state=x,i.context=c,r=d):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(a.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(a.flags|=1024),r=!1)}return i=r,Hd(e,a),r=(a.flags&128)!==0,i||r?(i=a.stateNode,t=r&&typeof t.getDerivedStateFromError!="function"?null:i.render(),a.flags|=1,e!==null&&r?(a.child=Oo(a,e.child,null,s),a.child=Oo(a,null,t,s)):_t(e,a,t,s),a.memoizedState=i.state,e=a.child):e=$s(e,a,s),e}function wg(e,a,t,r){return Fc(),a.flags|=256,_t(e,a,t,r),a.child}var af={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tf(e){return{baseLanes:e,cachePool:Ob()}}function rf(e,a,t){return e=e!==null?e.childLanes&~t:0,a&&(e|=$r),e}function F4(e,a,t){var r=a.pendingProps,s=!1,i=(a.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(ht.current&2)!==0),o&&(s=!0,a.flags&=-129),o=(a.flags&32)!==0,a.flags&=-33,e===null){if(wa){if(s?sn(a):nn(),wa){var l=Ja,c;if(c=l){e:{for(c=l,l=us;c.nodeType!==8;){if(!l){l=null;break e}if(c=es(c.nextSibling),c===null){l=null;break e}}l=c}l!==null?(a.memoizedState={dehydrated:l,treeContext:Zn!==null?{id:_s,overflow:As}:null,retryLane:536870912,hydrationErrors:null},c=br(18,null,null,0),c.stateNode=l,c.return=a,a.child=c,Qt=a,Ja=null,c=!0):c=!1}c||di(a)}if(l=a.memoizedState,l!==null&&(l=l.dehydrated,l!==null))return $m(l)?a.lanes=32:a.lanes=536870912,null;Ds(a)}return l=r.children,r=r.fallback,s?(nn(),s=a.mode,l=h0({mode:"hidden",children:l},s),r=Jn(r,s,t,null),l.return=a,r.return=a,l.sibling=r,a.child=l,s=a.child,s.memoizedState=tf(t),s.childLanes=rf(e,o,t),a.memoizedState=af,r):(sn(a),Fm(a,l))}if(c=e.memoizedState,c!==null&&(l=c.dehydrated,l!==null)){if(i)a.flags&256?(sn(a),a.flags&=-257,a=sf(e,a,t)):a.memoizedState!==null?(nn(),a.child=e.child,a.flags|=128,a=null):(nn(),s=r.fallback,l=a.mode,r=h0({mode:"visible",children:r.children},l),s=Jn(s,l,t,null),s.flags|=2,r.return=a,s.return=a,r.sibling=s,a.child=r,Oo(a,e.child,null,t),r=a.child,r.memoizedState=tf(t),r.childLanes=rf(e,o,t),a.memoizedState=af,a=s);else if(sn(a),$m(l)){if(o=l.nextSibling&&l.nextSibling.dataset,o)var u=o.dgst;o=u,r=Error(Ce(419)),r.stack="",r.digest=o,ec({value:r,source:null,stack:null}),a=sf(e,a,t)}else if(jt||_c(e,a,t,!1),o=(t&e.childLanes)!==0,jt||o){if(o=Oa,o!==null&&(r=t&-t,r=r&42?1:Dx(r),r=r&(o.suspendedLanes|t)?0:r,r!==0&&r!==c.retryLane))throw c.retryLane=r,Yo(e,r),Cr(o,e,r),S4;l.data==="$?"||Om(),a=sf(e,a,t)}else l.data==="$?"?(a.flags|=192,a.child=e.child,a=null):(e=c.treeContext,Ja=es(l.nextSibling),Qt=a,wa=!0,Qn=null,us=!1,e!==null&&(Ur[Lr++]=_s,Ur[Lr++]=As,Ur[Lr++]=Zn,_s=e.id,As=e.overflow,Zn=a),a=Fm(a,r.children),a.flags|=4096);return a}return s?(nn(),s=r.fallback,l=a.mode,c=e.child,u=c.sibling,r=Os(c,{mode:"hidden",children:r.children}),r.subtreeFlags=c.subtreeFlags&65011712,u!==null?s=Os(u,s):(s=Jn(s,l,t,null),s.flags|=2),s.return=a,r.return=a,r.sibling=s,a.child=r,r=s,s=a.child,l=e.child.memoizedState,l===null?l=tf(t):(c=l.cachePool,c!==null?(u=xt._currentValue,c=c.parent!==u?{parent:u,pool:u}:c):c=Ob(),l={baseLanes:l.baseLanes|t,cachePool:c}),s.memoizedState=l,s.childLanes=rf(e,o,t),a.memoizedState=af,r):(sn(a),t=e.child,e=t.sibling,t=Os(t,{mode:"visible",children:r.children}),t.return=a,t.sibling=null,e!==null&&(o=a.deletions,o===null?(a.deletions=[e],a.flags|=16):o.push(e)),a.child=t,a.memoizedState=null,t)}function Fm(e,a){return a=h0({mode:"visible",children:a},e.mode),a.return=e,e.child=a}function h0(e,a){return e=br(22,e,null,a),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function sf(e,a,t){return Oo(a,e.child,null,t),e=Fm(a,a.pendingProps.children),e.flags|=2,a.memoizedState=null,e}function Eg(e,a,t){e.lanes|=a;var r=e.alternate;r!==null&&(r.lanes|=a),pm(e.return,a,t)}function nf(e,a,t,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=a,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function _4(e,a,t){var r=a.pendingProps,s=r.revealOrder,i=r.tail;if(_t(e,a,r.children,t),r=ht.current,r&2)r=r&1|2,a.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=a.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Eg(e,t,a);else if(e.tag===19)Eg(e,t,a);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===a)break e;for(;e.sibling===null;){if(e.return===null||e.return===a)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(Ga(ht,r),s){case"forwards":for(t=a.child,s=null;t!==null;)e=t.alternate,e!==null&&f0(e)===null&&(s=t),t=t.sibling;t=s,t===null?(s=a.child,a.child=null):(s=t.sibling,t.sibling=null),nf(a,!1,s,t,i);break;case"backwards":for(t=null,s=a.child,a.child=null;s!==null;){if(e=s.alternate,e!==null&&f0(e)===null){a.child=s;break}e=s.sibling,s.sibling=t,t=s,s=e}nf(a,!0,t,null,i);break;case"together":nf(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function $s(e,a,t){if(e!==null&&(a.dependencies=e.dependencies),Nn|=a.lanes,!(t&a.childLanes))if(e!==null){if(_c(e,a,t,!1),(t&a.childLanes)===0)return null}else return null;if(e!==null&&a.child!==e.child)throw Error(Ce(153));if(a.child!==null){for(e=a.child,t=Os(e,e.pendingProps),a.child=t,t.return=a;e.sibling!==null;)e=e.sibling,t=t.sibling=Os(e,e.pendingProps),t.return=a;t.sibling=null}return a.child}function ch(e,a){return e.lanes&a?!0:(e=e.dependencies,!!(e!==null&&o0(e)))}function Pj(e,a,t){switch(a.tag){case 3:Qd(a,a.stateNode.containerInfo),rn(a,xt,e.memoizedState.cache),Fc();break;case 27:case 5:sm(a);break;case 4:Qd(a,a.stateNode.containerInfo);break;case 10:rn(a,a.type,a.memoizedProps.value);break;case 13:var r=a.memoizedState;if(r!==null)return r.dehydrated!==null?(sn(a),a.flags|=128,null):t&a.child.childLanes?F4(e,a,t):(sn(a),e=$s(e,a,t),e!==null?e.sibling:null);sn(a);break;case 19:var s=(e.flags&128)!==0;if(r=(t&a.childLanes)!==0,r||(_c(e,a,t,!1),r=(t&a.childLanes)!==0),s){if(r)return _4(e,a,t);a.flags|=128}if(s=a.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ga(ht,ht.current),r)break;return null;case 22:case 23:return a.lanes=0,T4(e,a,t);case 24:rn(a,xt,e.memoizedState.cache)}return $s(e,a,t)}function A4(e,a,t){if(e!==null)if(e.memoizedProps!==a.pendingProps)jt=!0;else{if(!ch(e,t)&&!(a.flags&128))return jt=!1,Pj(e,a,t);jt=!!(e.flags&131072)}else jt=!1,wa&&a.flags&1048576&&Db(a,i0,a.index);switch(a.lanes=0,a.tag){case 16:e:{e=a.pendingProps;var r=a.elementType,s=r._init;if(r=s(r._payload),a.type=r,typeof r=="function")Hx(r)?(e=mi(r,e),a.tag=1,a=bg(null,a,r,e,t)):(a.tag=0,a=Tm(null,a,r,e,t));else{if(r!=null){if(s=r.$$typeof,s===_x){a.tag=11,a=pg(null,a,r,e,t);break e}else if(s===Ax){a.tag=14,a=gg(null,a,r,e,t);break e}}throw a=tm(r)||r,Error(Ce(306,a,""))}}return a;case 0:return Tm(e,a,a.type,a.pendingProps,t);case 1:return r=a.type,s=mi(r,a.pendingProps),bg(e,a,r,s,t);case 3:e:{if(Qd(a,a.stateNode.containerInfo),e===null)throw Error(Ce(387));r=a.pendingProps;var i=a.memoizedState;s=i.element,bm(e,a),Ol(a,r,null,t);var o=a.memoizedState;if(r=o.cache,rn(a,xt,r),r!==i.cache&&gm(a,[xt],t,!0),Pl(),r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache},a.updateQueue.baseState=i,a.memoizedState=i,a.flags&256){a=wg(e,a,r,t);break e}else if(r!==s){s=zr(Error(Ce(424)),a),ec(s),a=wg(e,a,r,t);break e}else{switch(e=a.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Ja=es(e.firstChild),Qt=a,wa=!0,Qn=null,us=!0,t=v4(a,null,r,t),a.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling}else{if(Fc(),r===s){a=$s(e,a,t);break e}_t(e,a,r,t)}a=a.child}return a;case 26:return Hd(e,a),e===null?(t=Lg(a.type,null,a.pendingProps,null))?a.memoizedState=t:wa||(t=a.type,e=a.pendingProps,r=E0(xn.current).createElement(t),r[Gt]=a,r[ur]=e,Ot(r,t,e),kt(r),a.stateNode=r):a.memoizedState=Lg(a.type,e.memoizedProps,a.pendingProps,e.memoizedState),null;case 27:return sm(a),e===null&&wa&&(r=a.stateNode=gw(a.type,a.pendingProps,xn.current),Qt=a,us=!0,s=Ja,Dn(a.type)?(Vm=s,Ja=es(r.firstChild)):Ja=s),_t(e,a,a.pendingProps.children,t),Hd(e,a),e===null&&(a.flags|=4194304),a.child;case 5:return e===null&&wa&&((s=r=Ja)&&(r=lS(r,a.type,a.pendingProps,us),r!==null?(a.stateNode=r,Qt=a,Ja=es(r.firstChild),us=!1,s=!0):s=!1),s||di(a)),sm(a),s=a.type,i=a.pendingProps,o=e!==null?e.memoizedProps:null,r=i.children,Bm(s,i)?r=null:o!==null&&Bm(s,o)&&(a.flags|=32),a.memoizedState!==null&&(s=Zx(e,a,Sj,null,null,t),ic._currentValue=s),Hd(e,a),_t(e,a,r,t),a.child;case 6:return e===null&&wa&&((e=t=Ja)&&(t=cS(t,a.pendingProps,us),t!==null?(a.stateNode=t,Qt=a,Ja=null,e=!0):e=!1),e||di(a)),null;case 13:return F4(e,a,t);case 4:return Qd(a,a.stateNode.containerInfo),r=a.pendingProps,e===null?a.child=Oo(a,null,r,t):_t(e,a,r,t),a.child;case 11:return pg(e,a,a.type,a.pendingProps,t);case 7:return _t(e,a,a.pendingProps,t),a.child;case 8:return _t(e,a,a.pendingProps.children,t),a.child;case 12:return _t(e,a,a.pendingProps.children,t),a.child;case 10:return r=a.pendingProps,rn(a,a.type,r.value),_t(e,a,r.children,t),a.child;case 9:return s=a.type._context,r=a.pendingProps.children,ui(a),s=Xt(s),r=r(s),a.flags|=1,_t(e,a,r,t),a.child;case 14:return gg(e,a,a.type,a.pendingProps,t);case 15:return C4(e,a,a.type,a.pendingProps,t);case 19:return _4(e,a,t);case 31:return r=a.pendingProps,t=a.mode,r={mode:r.mode,children:r.children},e===null?(t=h0(r,t),t.ref=a.ref,a.child=t,t.return=a,a=t):(t=Os(e.child,r),t.ref=a.ref,a.child=t,t.return=a,a=t),a;case 22:return T4(e,a,t);case 24:return ui(a),r=Xt(xt),e===null?(s=Yx(),s===null&&(s=Oa,i=qx(),s.pooledCache=i,i.refCount++,i!==null&&(s.pooledCacheLanes|=t),s=i),a.memoizedState={parent:r,cache:s},Wx(a),rn(a,xt,s)):(e.lanes&t&&(bm(e,a),Ol(a,null,null,t),Pl()),s=e.memoizedState,i=a.memoizedState,s.parent!==r?(s={parent:r,cache:r},a.memoizedState=s,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=s),rn(a,xt,r)):(r=i.cache,rn(a,xt,r),r!==s.cache&&gm(a,[xt],t,!0))),_t(e,a,a.pendingProps.children,t),a.child;case 29:throw a.pendingProps}throw Error(Ce(156,a.tag))}function Ss(e){e.flags|=4}function kg(e,a){if(a.type!=="stylesheet"||a.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!bw(a)){if(a=Hr.current,a!==null&&((xa&4194048)===xa?ps!==null:(xa&62914560)!==xa&&!(xa&536870912)||a!==ps))throw Rl=vm,Ib;e.flags|=8192}}function cd(e,a){a!==null&&(e.flags|=4),e.flags&16384&&(a=e.tag!==22?rb():536870912,e.lanes|=a,Io|=a)}function ml(e,a){if(!wa)switch(e.tailMode){case"hidden":a=e.tail;for(var t=null;a!==null;)a.alternate!==null&&(t=a),a=a.sibling;t===null?e.tail=null:t.sibling=null;break;case"collapsed":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?a||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ya(e){var a=e.alternate!==null&&e.alternate.child===e.child,t=0,r=0;if(a)for(var s=e.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&65011712,r|=s.flags&65011712,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=t,a}function Oj(e,a,t){var r=a.pendingProps;switch(Xx(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ya(a),null;case 1:return Ya(a),null;case 3:return t=a.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),a.memoizedState.cache!==r&&(a.flags|=2048),Is(xt),Fo(),t.pendingContext&&(t.context=t.pendingContext,t.pendingContext=null),(e===null||e.child===null)&&(ul(a)?Ss(a):e===null||e.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,Qp())),Ya(a),null;case 26:return t=a.memoizedState,e===null?(Ss(a),t!==null?(Ya(a),kg(a,t)):(Ya(a),a.flags&=-16777217)):t?t!==e.memoizedState?(Ss(a),Ya(a),kg(a,t)):(Ya(a),a.flags&=-16777217):(e.memoizedProps!==r&&Ss(a),Ya(a),a.flags&=-16777217),null;case 27:e0(a),t=xn.current;var s=a.type;if(e!==null&&a.stateNode!=null)e.memoizedProps!==r&&Ss(a);else{if(!r){if(a.stateNode===null)throw Error(Ce(166));return Ya(a),null}e=xs.current,ul(a)?Jp(a):(e=gw(s,r,t),a.stateNode=e,Ss(a))}return Ya(a),null;case 5:if(e0(a),t=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==r&&Ss(a);else{if(!r){if(a.stateNode===null)throw Error(Ce(166));return Ya(a),null}if(e=xs.current,ul(a))Jp(a);else{switch(s=E0(xn.current),e){case 1:e=s.createElementNS("http://www.w3.org/2000/svg",t);break;case 2:e=s.createElementNS("http://www.w3.org/1998/Math/MathML",t);break;default:switch(t){case"svg":e=s.createElementNS("http://www.w3.org/2000/svg",t);break;case"math":e=s.createElementNS("http://www.w3.org/1998/Math/MathML",t);break;case"script":e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof r.is=="string"?s.createElement("select",{is:r.is}):s.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e=typeof r.is=="string"?s.createElement(t,{is:r.is}):s.createElement(t)}}e[Gt]=a,e[ur]=r;e:for(s=a.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.tag!==27&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}a.stateNode=e;e:switch(Ot(e,t,r),t){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Ss(a)}}return Ya(a),a.flags&=-16777217,null;case 6:if(e&&a.stateNode!=null)e.memoizedProps!==r&&Ss(a);else{if(typeof r!="string"&&a.stateNode===null)throw Error(Ce(166));if(e=xn.current,ul(a)){if(e=a.stateNode,t=a.memoizedProps,r=null,s=Qt,s!==null)switch(s.tag){case 27:case 5:r=s.memoizedProps}e[Gt]=a,e=!!(e.nodeValue===t||r!==null&&r.suppressHydrationWarning===!0||xw(e.nodeValue,t)),e||di(a)}else e=E0(e).createTextNode(r),e[Gt]=a,a.stateNode=e}return Ya(a),null;case 13:if(r=a.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(s=ul(a),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(Ce(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ce(317));s[Gt]=a}else Fc(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;Ya(a),s=!1}else s=Qp(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=s),s=!0;if(!s)return a.flags&256?(Ds(a),a):(Ds(a),null)}if(Ds(a),a.flags&128)return a.lanes=t,a;if(t=r!==null,e=e!==null&&e.memoizedState!==null,t){r=a.child,s=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(s=r.alternate.memoizedState.cachePool.pool);var i=null;r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(i=r.memoizedState.cachePool.pool),i!==s&&(r.flags|=2048)}return t!==e&&t&&(a.child.flags|=8192),cd(a,a.updateQueue),Ya(a),null;case 4:return Fo(),e===null&&gh(a.stateNode.containerInfo),Ya(a),null;case 10:return Is(a.type),Ya(a),null;case 19:if(Ct(ht),s=a.memoizedState,s===null)return Ya(a),null;if(r=(a.flags&128)!==0,i=s.rendering,i===null)if(r)ml(s,!1);else{if(Qa!==0||e!==null&&e.flags&128)for(e=a.child;e!==null;){if(i=f0(e),i!==null){for(a.flags|=128,ml(s,!1),e=i.updateQueue,a.updateQueue=e,cd(a,e),a.subtreeFlags=0,e=t,t=a.child;t!==null;)Rb(t,e),t=t.sibling;return Ga(ht,ht.current&1|2),a.child}e=e.sibling}s.tail!==null&&hs()>g0&&(a.flags|=128,r=!0,ml(s,!1),a.lanes=4194304)}else{if(!r)if(e=f0(i),e!==null){if(a.flags|=128,r=!0,e=e.updateQueue,a.updateQueue=e,cd(a,e),ml(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!wa)return Ya(a),null}else 2*hs()-s.renderingStartTime>g0&&t!==536870912&&(a.flags|=128,r=!0,ml(s,!1),a.lanes=4194304);s.isBackwards?(i.sibling=a.child,a.child=i):(e=s.last,e!==null?e.sibling=i:a.child=i,s.last=i)}return s.tail!==null?(a=s.tail,s.rendering=a,s.tail=a.sibling,s.renderingStartTime=hs(),a.sibling=null,e=ht.current,Ga(ht,r?e&1|2:e&1),a):(Ya(a),null);case 22:case 23:return Ds(a),Kx(),r=a.memoizedState!==null,e!==null?e.memoizedState!==null!==r&&(a.flags|=8192):r&&(a.flags|=8192),r?t&536870912&&!(a.flags&128)&&(Ya(a),a.subtreeFlags&6&&(a.flags|=8192)):Ya(a),t=a.updateQueue,t!==null&&cd(a,t.retryQueue),t=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==t&&(a.flags|=2048),e!==null&&Ct(ei),null;case 24:return t=null,e!==null&&(t=e.memoizedState.cache),a.memoizedState.cache!==t&&(a.flags|=2048),Is(xt),Ya(a),null;case 25:return null;case 30:return null}throw Error(Ce(156,a.tag))}function Ij(e,a){switch(Xx(a),a.tag){case 1:return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 3:return Is(xt),Fo(),e=a.flags,e&65536&&!(e&128)?(a.flags=e&-65537|128,a):null;case 26:case 27:case 5:return e0(a),null;case 13:if(Ds(a),e=a.memoizedState,e!==null&&e.dehydrated!==null){if(a.alternate===null)throw Error(Ce(340));Fc()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 19:return Ct(ht),null;case 4:return Fo(),null;case 10:return Is(a.type),null;case 22:case 23:return Ds(a),Kx(),e!==null&&Ct(ei),e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 24:return Is(xt),null;case 25:return null;default:return null}}function R4(e,a){switch(Xx(a),a.tag){case 3:Is(xt),Fo();break;case 26:case 27:case 5:e0(a);break;case 4:Fo();break;case 13:Ds(a);break;case 19:Ct(ht);break;case 10:Is(a.type);break;case 22:case 23:Ds(a),Kx(),e!==null&&Ct(ei);break;case 24:Is(xt)}}function Oc(e,a){try{var t=a.updateQueue,r=t!==null?t.lastEffect:null;if(r!==null){var s=r.next;t=s;do{if((t.tag&e)===e){r=void 0;var i=t.create,o=t.inst;r=i(),o.destroy=r}t=t.next}while(t!==s)}}catch(l){Da(a,a.return,l)}}function kn(e,a,t){try{var r=a.updateQueue,s=r!==null?r.lastEffect:null;if(s!==null){var i=s.next;r=i;do{if((r.tag&e)===e){var o=r.inst,l=o.destroy;if(l!==void 0){o.destroy=void 0,s=a;var c=t,u=l;try{u()}catch(d){Da(s,c,d)}}}r=r.next}while(r!==i)}}catch(d){Da(a,a.return,d)}}function D4(e){var a=e.updateQueue;if(a!==null){var t=e.stateNode;try{Lb(a,t)}catch(r){Da(e,e.return,r)}}}function P4(e,a,t){t.props=mi(e.type,e.memoizedProps),t.state=e.memoizedState;try{t.componentWillUnmount()}catch(r){Da(e,a,r)}}function Ml(e,a){try{var t=e.ref;if(t!==null){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;case 30:r=e.stateNode;break;default:r=e.stateNode}typeof t=="function"?e.refCleanup=t(r):t.current=r}}catch(s){Da(e,a,s)}}function fs(e,a){var t=e.ref,r=e.refCleanup;if(t!==null)if(typeof r=="function")try{r()}catch(s){Da(e,a,s)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof t=="function")try{t(null)}catch(s){Da(e,a,s)}else t.current=null}function O4(e){var a=e.type,t=e.memoizedProps,r=e.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":t.autoFocus&&r.focus();break e;case"img":t.src?r.src=t.src:t.srcSet&&(r.srcset=t.srcSet)}}catch(s){Da(e,e.return,s)}}function of(e,a,t){try{var r=e.stateNode;rS(r,e.type,t,a),r[ur]=a}catch(s){Da(e,e.return,s)}}function I4(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Dn(e.type)||e.tag===4}function lf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||I4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Dn(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function _m(e,a,t){var r=e.tag;if(r===5||r===6)e=e.stateNode,a?(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t).insertBefore(e,a):(a=t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,a.appendChild(e),t=t._reactRootContainer,t!=null||a.onclick!==null||(a.onclick=mu));else if(r!==4&&(r===27&&Dn(e.type)&&(t=e.stateNode,a=null),e=e.child,e!==null))for(_m(e,a,t),e=e.sibling;e!==null;)_m(e,a,t),e=e.sibling}function p0(e,a,t){var r=e.tag;if(r===5||r===6)e=e.stateNode,a?t.insertBefore(e,a):t.appendChild(e);else if(r!==4&&(r===27&&Dn(e.type)&&(t=e.stateNode),e=e.child,e!==null))for(p0(e,a,t),e=e.sibling;e!==null;)p0(e,a,t),e=e.sibling}function M4(e){var a=e.stateNode,t=e.memoizedProps;try{for(var r=e.type,s=a.attributes;s.length;)a.removeAttributeNode(s[0]);Ot(a,r,t),a[Gt]=e,a[ur]=t}catch(i){Da(e,e.return,i)}}var Ts=!1,st=!1,cf=!1,Ng=typeof WeakSet=="function"?WeakSet:Set,Et=null;function Mj(e,a){if(e=e.containerInfo,Um=S0,e=Nb(e),zx(e)){if("selectionStart"in e)var t={start:e.selectionStart,end:e.selectionEnd};else e:{t=(t=e.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,m=null;a:for(;;){for(var x;f!==t||s!==0&&f.nodeType!==3||(l=o+s),f!==i||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(x=f.firstChild)!==null;)m=f,f=x;for(;;){if(f===e)break a;if(m===t&&++u===s&&(l=o),m===i&&++d===r&&(c=o),(x=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=x}t=l===-1||c===-1?null:{start:l,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(Lm={focusedElem:e,selectionRange:t},S0=!1,Et=a;Et!==null;)if(a=Et,e=a.child,(a.subtreeFlags&1024)!==0&&e!==null)e.return=a,Et=e;else for(;Et!==null;){switch(a=Et,i=a.alternate,e=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&i!==null){e=void 0,t=a,s=i.memoizedProps,i=i.memoizedState,r=t.stateNode;try{var h=mi(t.type,s,t.elementType===t.type);e=r.getSnapshotBeforeUpdate(h,i),r.__reactInternalSnapshotBeforeUpdate=e}catch(g){Da(t,t.return,g)}}break;case 3:if(e&1024){if(e=a.stateNode.containerInfo,t=e.nodeType,t===9)zm(e);else if(t===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":zm(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(Ce(163))}if(e=a.sibling,e!==null){e.return=a.return,Et=e;break}Et=a.return}}function U4(e,a,t){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Js(e,t),r&4&&Oc(5,t);break;case 1:if(Js(e,t),r&4)if(e=t.stateNode,a===null)try{e.componentDidMount()}catch(o){Da(t,t.return,o)}else{var s=mi(t.type,a.memoizedProps);a=a.memoizedState;try{e.componentDidUpdate(s,a,e.__reactInternalSnapshotBeforeUpdate)}catch(o){Da(t,t.return,o)}}r&64&&D4(t),r&512&&Ml(t,t.return);break;case 3:if(Js(e,t),r&64&&(e=t.updateQueue,e!==null)){if(a=null,t.child!==null)switch(t.child.tag){case 27:case 5:a=t.child.stateNode;break;case 1:a=t.child.stateNode}try{Lb(e,a)}catch(o){Da(t,t.return,o)}}break;case 27:a===null&&r&4&&M4(t);case 26:case 5:Js(e,t),a===null&&r&4&&O4(t),r&512&&Ml(t,t.return);break;case 12:Js(e,t);break;case 13:Js(e,t),r&4&&z4(e,t),r&64&&(e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(t=Xj.bind(null,t),dS(e,t))));break;case 22:if(r=t.memoizedState!==null||Ts,!r){a=a!==null&&a.memoizedState!==null||st,s=Ts;var i=st;Ts=r,(st=a)&&!i?Qs(e,t,(t.subtreeFlags&8772)!==0):Js(e,t),Ts=s,st=i}break;case 30:break;default:Js(e,t)}}function L4(e){var a=e.alternate;a!==null&&(e.alternate=null,L4(a)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(a=e.stateNode,a!==null&&Ox(a)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Va=null,sr=!1;function Cs(e,a,t){for(t=t.child;t!==null;)B4(e,a,t),t=t.sibling}function B4(e,a,t){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Nc,t)}catch{}switch(t.tag){case 26:st||fs(t,a),Cs(e,a,t),t.memoizedState?t.memoizedState.count--:t.stateNode&&(t=t.stateNode,t.parentNode.removeChild(t));break;case 27:st||fs(t,a);var r=Va,s=sr;Dn(t.type)&&(Va=t.stateNode,sr=!1),Cs(e,a,t),zl(t.stateNode),Va=r,sr=s;break;case 5:st||fs(t,a);case 6:if(r=Va,s=sr,Va=null,Cs(e,a,t),Va=r,sr=s,Va!==null)if(sr)try{(Va.nodeType===9?Va.body:Va.nodeName==="HTML"?Va.ownerDocument.body:Va).removeChild(t.stateNode)}catch(i){Da(t,a,i)}else try{Va.removeChild(t.stateNode)}catch(i){Da(t,a,i)}break;case 18:Va!==null&&(sr?(e=Va,Ig(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,t.stateNode),cc(e)):Ig(Va,t.stateNode));break;case 4:r=Va,s=sr,Va=t.stateNode.containerInfo,sr=!0,Cs(e,a,t),Va=r,sr=s;break;case 0:case 11:case 14:case 15:st||kn(2,t,a),st||kn(4,t,a),Cs(e,a,t);break;case 1:st||(fs(t,a),r=t.stateNode,typeof r.componentWillUnmount=="function"&&P4(t,a,r)),Cs(e,a,t);break;case 21:Cs(e,a,t);break;case 22:st=(r=st)||t.memoizedState!==null,Cs(e,a,t),st=r;break;default:Cs(e,a,t)}}function z4(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{cc(e)}catch(t){Da(a,a.return,t)}}function Uj(e){switch(e.tag){case 13:case 19:var a=e.stateNode;return a===null&&(a=e.stateNode=new Ng),a;case 22:return e=e.stateNode,a=e._retryCache,a===null&&(a=e._retryCache=new Ng),a;default:throw Error(Ce(435,e.tag))}}function df(e,a){var t=Uj(e);a.forEach(function(r){var s=qj.bind(null,e,r);t.has(r)||(t.add(r),r.then(s,s))})}function xr(e,a){var t=a.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r],i=e,o=a,l=o;e:for(;l!==null;){switch(l.tag){case 27:if(Dn(l.type)){Va=l.stateNode,sr=!1;break e}break;case 5:Va=l.stateNode,sr=!1;break e;case 3:case 4:Va=l.stateNode.containerInfo,sr=!0;break e}l=l.return}if(Va===null)throw Error(Ce(160));B4(i,o,s),Va=null,sr=!1,i=s.alternate,i!==null&&(i.return=null),s.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)$4(a,e),a=a.sibling}var Kr=null;function $4(e,a){var t=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:xr(a,e),hr(e),r&4&&(kn(3,e,e.return),Oc(3,e),kn(5,e,e.return));break;case 1:xr(a,e),hr(e),r&512&&(st||t===null||fs(t,t.return)),r&64&&Ts&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(t=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=t===null?r:t.concat(r))));break;case 26:var s=Kr;if(xr(a,e),hr(e),r&512&&(st||t===null||fs(t,t.return)),r&4){var i=t!==null?t.memoizedState:null;if(r=e.memoizedState,t===null)if(r===null)if(e.stateNode===null){e:{r=e.type,t=e.memoizedProps,s=s.ownerDocument||s;a:switch(r){case"title":i=s.getElementsByTagName("title")[0],(!i||i[Cc]||i[Gt]||i.namespaceURI==="http://www.w3.org/2000/svg"||i.hasAttribute("itemprop"))&&(i=s.createElement(r),s.head.insertBefore(i,s.querySelector("head > title"))),Ot(i,r,t),i[Gt]=e,kt(i),r=i;break e;case"link":var o=zg("link","href",s).get(r+(t.href||""));if(o){for(var l=0;l<o.length;l++)if(i=o[l],i.getAttribute("href")===(t.href==null||t.href===""?null:t.href)&&i.getAttribute("rel")===(t.rel==null?null:t.rel)&&i.getAttribute("title")===(t.title==null?null:t.title)&&i.getAttribute("crossorigin")===(t.crossOrigin==null?null:t.crossOrigin)){o.splice(l,1);break a}}i=s.createElement(r),Ot(i,r,t),s.head.appendChild(i);break;case"meta":if(o=zg("meta","content",s).get(r+(t.content||""))){for(l=0;l<o.length;l++)if(i=o[l],i.getAttribute("content")===(t.content==null?null:""+t.content)&&i.getAttribute("name")===(t.name==null?null:t.name)&&i.getAttribute("property")===(t.property==null?null:t.property)&&i.getAttribute("http-equiv")===(t.httpEquiv==null?null:t.httpEquiv)&&i.getAttribute("charset")===(t.charSet==null?null:t.charSet)){o.splice(l,1);break a}}i=s.createElement(r),Ot(i,r,t),s.head.appendChild(i);break;default:throw Error(Ce(468,r))}i[Gt]=e,kt(i),r=i}e.stateNode=r}else $g(s,e.type,e.stateNode);else e.stateNode=Bg(s,r,e.memoizedProps);else i!==r?(i===null?t.stateNode!==null&&(t=t.stateNode,t.parentNode.removeChild(t)):i.count--,r===null?$g(s,e.type,e.stateNode):Bg(s,r,e.memoizedProps)):r===null&&e.stateNode!==null&&of(e,e.memoizedProps,t.memoizedProps)}break;case 27:xr(a,e),hr(e),r&512&&(st||t===null||fs(t,t.return)),t!==null&&r&4&&of(e,e.memoizedProps,t.memoizedProps);break;case 5:if(xr(a,e),hr(e),r&512&&(st||t===null||fs(t,t.return)),e.flags&32){s=e.stateNode;try{Ao(s,"")}catch(x){Da(e,e.return,x)}}r&4&&e.stateNode!=null&&(s=e.memoizedProps,of(e,s,t!==null?t.memoizedProps:s)),r&1024&&(cf=!0);break;case 6:if(xr(a,e),hr(e),r&4){if(e.stateNode===null)throw Error(Ce(162));r=e.memoizedProps,t=e.stateNode;try{t.nodeValue=r}catch(x){Da(e,e.return,x)}}break;case 3:if(qd=null,s=Kr,Kr=k0(a.containerInfo),xr(a,e),Kr=s,hr(e),r&4&&t!==null&&t.memoizedState.isDehydrated)try{cc(a.containerInfo)}catch(x){Da(e,e.return,x)}cf&&(cf=!1,V4(e));break;case 4:r=Kr,Kr=k0(e.stateNode.containerInfo),xr(a,e),hr(e),Kr=r;break;case 12:xr(a,e),hr(e);break;case 13:xr(a,e),hr(e),e.child.flags&8192&&e.memoizedState!==null!=(t!==null&&t.memoizedState!==null)&&(xh=hs()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,df(e,r)));break;case 22:s=e.memoizedState!==null;var c=t!==null&&t.memoizedState!==null,u=Ts,d=st;if(Ts=u||s,st=d||c,xr(a,e),st=d,Ts=u,hr(e),r&8192)e:for(a=e.stateNode,a._visibility=s?a._visibility&-2:a._visibility|1,s&&(t===null||c||Ts||st||Hn(e)),t=null,a=e;;){if(a.tag===5||a.tag===26){if(t===null){c=t=a;try{if(i=c.stateNode,s)o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var f=c.memoizedProps.style,m=f!=null&&f.hasOwnProperty("display")?f.display:null;l.style.display=m==null||typeof m=="boolean"?"":(""+m).trim()}}catch(x){Da(c,c.return,x)}}}else if(a.tag===6){if(t===null){c=a;try{c.stateNode.nodeValue=s?"":c.memoizedProps}catch(x){Da(c,c.return,x)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===e)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;t===a&&(t=null),a=a.return}t===a&&(t=null),a.sibling.return=a.return,a=a.sibling}r&4&&(r=e.updateQueue,r!==null&&(t=r.retryQueue,t!==null&&(r.retryQueue=null,df(e,t))));break;case 19:xr(a,e),hr(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,df(e,r)));break;case 30:break;case 21:break;default:xr(a,e),hr(e)}}function hr(e){var a=e.flags;if(a&2){try{for(var t,r=e.return;r!==null;){if(I4(r)){t=r;break}r=r.return}if(t==null)throw Error(Ce(160));switch(t.tag){case 27:var s=t.stateNode,i=lf(e);p0(e,i,s);break;case 5:var o=t.stateNode;t.flags&32&&(Ao(o,""),t.flags&=-33);var l=lf(e);p0(e,l,o);break;case 3:case 4:var c=t.stateNode.containerInfo,u=lf(e);_m(e,u,c);break;default:throw Error(Ce(161))}}catch(d){Da(e,e.return,d)}e.flags&=-3}a&4096&&(e.flags&=-4097)}function V4(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var a=e;V4(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),e=e.sibling}}function Js(e,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)U4(e,a.alternate,a),a=a.sibling}function Hn(e){for(e=e.child;e!==null;){var a=e;switch(a.tag){case 0:case 11:case 14:case 15:kn(4,a,a.return),Hn(a);break;case 1:fs(a,a.return);var t=a.stateNode;typeof t.componentWillUnmount=="function"&&P4(a,a.return,t),Hn(a);break;case 27:zl(a.stateNode);case 26:case 5:fs(a,a.return),Hn(a);break;case 22:a.memoizedState===null&&Hn(a);break;case 30:Hn(a);break;default:Hn(a)}e=e.sibling}}function Qs(e,a,t){for(t=t&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var r=a.alternate,s=e,i=a,o=i.flags;switch(i.tag){case 0:case 11:case 15:Qs(s,i,t),Oc(4,i);break;case 1:if(Qs(s,i,t),r=i,s=r.stateNode,typeof s.componentDidMount=="function")try{s.componentDidMount()}catch(u){Da(r,r.return,u)}if(r=i,s=r.updateQueue,s!==null){var l=r.stateNode;try{var c=s.shared.hiddenCallbacks;if(c!==null)for(s.shared.hiddenCallbacks=null,s=0;s<c.length;s++)Ub(c[s],l)}catch(u){Da(r,r.return,u)}}t&&o&64&&D4(i),Ml(i,i.return);break;case 27:M4(i);case 26:case 5:Qs(s,i,t),t&&r===null&&o&4&&O4(i),Ml(i,i.return);break;case 12:Qs(s,i,t);break;case 13:Qs(s,i,t),t&&o&4&&z4(s,i);break;case 22:i.memoizedState===null&&Qs(s,i,t),Ml(i,i.return);break;case 30:break;default:Qs(s,i,t)}a=a.sibling}}function dh(e,a){var t=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),e=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(e=a.memoizedState.cachePool.pool),e!==t&&(e!=null&&e.refCount++,t!=null&&Ac(t))}function uh(e,a){e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&Ac(e))}function is(e,a,t,r){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)H4(e,a,t,r),a=a.sibling}function H4(e,a,t,r){var s=a.flags;switch(a.tag){case 0:case 11:case 15:is(e,a,t,r),s&2048&&Oc(9,a);break;case 1:is(e,a,t,r);break;case 3:is(e,a,t,r),s&2048&&(e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&Ac(e)));break;case 12:if(s&2048){is(e,a,t,r),e=a.stateNode;try{var i=a.memoizedProps,o=i.id,l=i.onPostCommit;typeof l=="function"&&l(o,a.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(c){Da(a,a.return,c)}}else is(e,a,t,r);break;case 13:is(e,a,t,r);break;case 23:break;case 22:i=a.stateNode,o=a.alternate,a.memoizedState!==null?i._visibility&2?is(e,a,t,r):Ul(e,a):i._visibility&2?is(e,a,t,r):(i._visibility|=2,qi(e,a,t,r,(a.subtreeFlags&10256)!==0)),s&2048&&dh(o,a);break;case 24:is(e,a,t,r),s&2048&&uh(a.alternate,a);break;default:is(e,a,t,r)}}function qi(e,a,t,r,s){for(s=s&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var i=e,o=a,l=t,c=r,u=o.flags;switch(o.tag){case 0:case 11:case 15:qi(i,o,l,c,s),Oc(8,o);break;case 23:break;case 22:var d=o.stateNode;o.memoizedState!==null?d._visibility&2?qi(i,o,l,c,s):Ul(i,o):(d._visibility|=2,qi(i,o,l,c,s)),s&&u&2048&&dh(o.alternate,o);break;case 24:qi(i,o,l,c,s),s&&u&2048&&uh(o.alternate,o);break;default:qi(i,o,l,c,s)}a=a.sibling}}function Ul(e,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var t=e,r=a,s=r.flags;switch(r.tag){case 22:Ul(t,r),s&2048&&dh(r.alternate,r);break;case 24:Ul(t,r),s&2048&&uh(r.alternate,r);break;default:Ul(t,r)}a=a.sibling}}var kl=8192;function Oi(e){if(e.subtreeFlags&kl)for(e=e.child;e!==null;)G4(e),e=e.sibling}function G4(e){switch(e.tag){case 26:Oi(e),e.flags&kl&&e.memoizedState!==null&&kS(Kr,e.memoizedState,e.memoizedProps);break;case 5:Oi(e);break;case 3:case 4:var a=Kr;Kr=k0(e.stateNode.containerInfo),Oi(e),Kr=a;break;case 22:e.memoizedState===null&&(a=e.alternate,a!==null&&a.memoizedState!==null?(a=kl,kl=16777216,Oi(e),kl=a):Oi(e));break;default:Oi(e)}}function X4(e){var a=e.alternate;if(a!==null&&(e=a.child,e!==null)){a.child=null;do a=e.sibling,e.sibling=null,e=a;while(e!==null)}}function xl(e){var a=e.deletions;if(e.flags&16){if(a!==null)for(var t=0;t<a.length;t++){var r=a[t];Et=r,Y4(r,e)}X4(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)q4(e),e=e.sibling}function q4(e){switch(e.tag){case 0:case 11:case 15:xl(e),e.flags&2048&&kn(9,e,e.return);break;case 3:xl(e);break;case 12:xl(e);break;case 22:var a=e.stateNode;e.memoizedState!==null&&a._visibility&2&&(e.return===null||e.return.tag!==13)?(a._visibility&=-3,Gd(e)):xl(e);break;default:xl(e)}}function Gd(e){var a=e.deletions;if(e.flags&16){if(a!==null)for(var t=0;t<a.length;t++){var r=a[t];Et=r,Y4(r,e)}X4(e)}for(e=e.child;e!==null;){switch(a=e,a.tag){case 0:case 11:case 15:kn(8,a,a.return),Gd(a);break;case 22:t=a.stateNode,t._visibility&2&&(t._visibility&=-3,Gd(a));break;default:Gd(a)}e=e.sibling}}function Y4(e,a){for(;Et!==null;){var t=Et;switch(t.tag){case 0:case 11:case 15:kn(8,t,a);break;case 23:case 22:if(t.memoizedState!==null&&t.memoizedState.cachePool!==null){var r=t.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:Ac(t.memoizedState.cache)}if(r=t.child,r!==null)r.return=t,Et=r;else e:for(t=e;Et!==null;){r=Et;var s=r.sibling,i=r.return;if(L4(r),r===t){Et=null;break e}if(s!==null){s.return=i,Et=s;break e}Et=i}}}var Lj={getCacheForType:function(e){var a=Xt(xt),t=a.data.get(e);return t===void 0&&(t=e(),a.data.set(e,t)),t}},Bj=typeof WeakMap=="function"?WeakMap:Map,Ta=0,Oa=null,fa=null,xa=0,ja=0,gr=null,dn=!1,Wo=!1,fh=!1,Vs=0,Qa=0,Nn=0,ai=0,mh=0,$r=0,Io=0,Ll=null,nr=null,Am=!1,xh=0,g0=1/0,y0=null,gn=null,Rt=0,yn=null,Mo=null,Eo=0,Rm=0,Dm=null,W4=null,Bl=0,Pm=null;function Sr(){if(Ta&2&&xa!==0)return xa&-xa;if(Je.T!==null){var e=Ro;return e!==0?e:ph()}return ib()}function K4(){$r===0&&($r=!(xa&536870912)||wa?tb():536870912);var e=Hr.current;return e!==null&&(e.flags|=32),$r}function Cr(e,a,t){(e===Oa&&(ja===2||ja===9)||e.cancelPendingCommit!==null)&&(Uo(e,0),un(e,xa,$r,!1)),Sc(e,t),(!(Ta&2)||e!==Oa)&&(e===Oa&&(!(Ta&2)&&(ai|=t),Qa===4&&un(e,xa,$r,!1)),bs(e))}function J4(e,a,t){if(Ta&6)throw Error(Ce(327));var r=!t&&(a&124)===0&&(a&e.expiredLanes)===0||jc(e,a),s=r?Vj(e,a):uf(e,a,!0),i=r;do{if(s===0){Wo&&!r&&un(e,a,0,!1);break}else{if(t=e.current.alternate,i&&!zj(t)){s=uf(e,a,!1),i=!1;continue}if(s===2){if(i=a,e.errorRecoveryDisabledLanes&i)var o=0;else o=e.pendingLanes&-536870913,o=o!==0?o:o&536870912?536870912:0;if(o!==0){a=o;e:{var l=e;s=Ll;var c=l.current.memoizedState.isDehydrated;if(c&&(Uo(l,o).flags|=256),o=uf(l,o,!1),o!==2){if(fh&&!c){l.errorRecoveryDisabledLanes|=i,ai|=i,s=4;break e}i=nr,nr=s,i!==null&&(nr===null?nr=i:nr.push.apply(nr,i))}s=o}if(i=!1,s!==2)continue}}if(s===1){Uo(e,0),un(e,a,0,!0);break}e:{switch(r=e,i=s,i){case 0:case 1:throw Error(Ce(345));case 4:if((a&4194048)!==a)break;case 6:un(r,a,$r,!dn);break e;case 2:nr=null;break;case 3:case 5:break;default:throw Error(Ce(329))}if((a&62914560)===a&&(s=xh+300-hs(),10<s)){if(un(r,a,$r,!dn),eu(r,0,!0)!==0)break e;r.timeoutHandle=pw(jg.bind(null,r,t,nr,y0,Am,a,$r,ai,Io,dn,i,2,-0,0),s);break e}jg(r,t,nr,y0,Am,a,$r,ai,Io,dn,i,0,-0,0)}}break}while(!0);bs(e)}function jg(e,a,t,r,s,i,o,l,c,u,d,f,m,x){if(e.timeoutHandle=-1,f=a.subtreeFlags,(f&8192||(f&16785408)===16785408)&&(nc={stylesheets:null,count:0,unsuspend:ES},G4(a),f=NS(),f!==null)){e.cancelPendingCommit=f(Cg.bind(null,e,a,i,t,r,s,o,l,c,d,1,m,x)),un(e,i,o,!u);return}Cg(e,a,i,t,r,s,o,l,c)}function zj(e){for(var a=e;;){var t=a.tag;if((t===0||t===11||t===15)&&a.flags&16384&&(t=a.updateQueue,t!==null&&(t=t.stores,t!==null)))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!Tr(i(),s))return!1}catch{return!1}}if(t=a.child,a.subtreeFlags&16384&&t!==null)t.return=a,a=t;else{if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function un(e,a,t,r){a&=~mh,a&=~ai,e.suspendedLanes|=a,e.pingedLanes&=~a,r&&(e.warmLanes|=a),r=e.expirationTimes;for(var s=a;0<s;){var i=31-jr(s),o=1<<i;r[i]=-1,s&=~o}t!==0&&sb(e,t,a)}function du(){return Ta&6?!0:(Ic(0),!1)}function hh(){if(fa!==null){if(ja===0)var e=fa.return;else e=fa,Rs=Si=null,ah(e),wo=null,tc=0,e=fa;for(;e!==null;)R4(e.alternate,e),e=e.return;fa=null}}function Uo(e,a){var t=e.timeoutHandle;t!==-1&&(e.timeoutHandle=-1,nS(t)),t=e.cancelPendingCommit,t!==null&&(e.cancelPendingCommit=null,t()),hh(),Oa=e,fa=t=Os(e.current,null),xa=a,ja=0,gr=null,dn=!1,Wo=jc(e,a),fh=!1,Io=$r=mh=ai=Nn=Qa=0,nr=Ll=null,Am=!1,a&8&&(a|=a&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=a;0<r;){var s=31-jr(r),i=1<<s;a|=e[s],r&=~i}return Vs=a,su(),t}function Z4(e,a){ca=null,Je.H=u0,a===Rc||a===iu?(a=rg(),ja=3):a===Ib?(a=rg(),ja=4):ja=a===S4?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,gr=a,fa===null&&(Qa=1,x0(e,zr(a,e.current)))}function Q4(){var e=Je.H;return Je.H=u0,e===null?u0:e}function ew(){var e=Je.A;return Je.A=Lj,e}function Om(){Qa=4,dn||(xa&4194048)!==xa&&Hr.current!==null||(Wo=!0),!(Nn&134217727)&&!(ai&134217727)||Oa===null||un(Oa,xa,$r,!1)}function uf(e,a,t){var r=Ta;Ta|=2;var s=Q4(),i=ew();(Oa!==e||xa!==a)&&(y0=null,Uo(e,a)),a=!1;var o=Qa;e:do try{if(ja!==0&&fa!==null){var l=fa,c=gr;switch(ja){case 8:hh(),o=6;break e;case 3:case 2:case 9:case 6:Hr.current===null&&(a=!0);var u=ja;if(ja=0,gr=null,co(e,l,c,u),t&&Wo){o=0;break e}break;default:u=ja,ja=0,gr=null,co(e,l,c,u)}}$j(),o=Qa;break}catch(d){Z4(e,d)}while(!0);return a&&e.shellSuspendCounter++,Rs=Si=null,Ta=r,Je.H=s,Je.A=i,fa===null&&(Oa=null,xa=0,su()),o}function $j(){for(;fa!==null;)aw(fa)}function Vj(e,a){var t=Ta;Ta|=2;var r=Q4(),s=ew();Oa!==e||xa!==a?(y0=null,g0=hs()+500,Uo(e,a)):Wo=jc(e,a);e:do try{if(ja!==0&&fa!==null){a=fa;var i=gr;a:switch(ja){case 1:ja=0,gr=null,co(e,a,i,1);break;case 2:case 9:if(tg(i)){ja=0,gr=null,Sg(a);break}a=function(){ja!==2&&ja!==9||Oa!==e||(ja=7),bs(e)},i.then(a,a);break e;case 3:ja=7;break e;case 4:ja=5;break e;case 7:tg(i)?(ja=0,gr=null,Sg(a)):(ja=0,gr=null,co(e,a,i,7));break;case 5:var o=null;switch(fa.tag){case 26:o=fa.memoizedState;case 5:case 27:var l=fa;if(!o||bw(o)){ja=0,gr=null;var c=l.sibling;if(c!==null)fa=c;else{var u=l.return;u!==null?(fa=u,uu(u)):fa=null}break a}}ja=0,gr=null,co(e,a,i,5);break;case 6:ja=0,gr=null,co(e,a,i,6);break;case 8:hh(),Qa=6;break e;default:throw Error(Ce(462))}}Hj();break}catch(d){Z4(e,d)}while(!0);return Rs=Si=null,Je.H=r,Je.A=s,Ta=t,fa!==null?0:(Oa=null,xa=0,su(),Qa)}function Hj(){for(;fa!==null&&!fN();)aw(fa)}function aw(e){var a=A4(e.alternate,e,Vs);e.memoizedProps=e.pendingProps,a===null?uu(e):fa=a}function Sg(e){var a=e,t=a.alternate;switch(a.tag){case 15:case 0:a=vg(t,a,a.pendingProps,a.type,void 0,xa);break;case 11:a=vg(t,a,a.pendingProps,a.type.render,a.ref,xa);break;case 5:ah(a);default:R4(t,a),a=fa=Rb(a,Vs),a=A4(t,a,Vs)}e.memoizedProps=e.pendingProps,a===null?uu(e):fa=a}function co(e,a,t,r){Rs=Si=null,ah(a),wo=null,tc=0;var s=a.return;try{if(Dj(e,s,a,t,xa)){Qa=1,x0(e,zr(t,e.current)),fa=null;return}}catch(i){if(s!==null)throw fa=s,i;Qa=1,x0(e,zr(t,e.current)),fa=null;return}a.flags&32768?(wa||r===1?e=!0:Wo||xa&536870912?e=!1:(dn=e=!0,(r===2||r===9||r===3||r===6)&&(r=Hr.current,r!==null&&r.tag===13&&(r.flags|=16384))),tw(a,e)):uu(a)}function uu(e){var a=e;do{if(a.flags&32768){tw(a,dn);return}e=a.return;var t=Oj(a.alternate,a,Vs);if(t!==null){fa=t;return}if(a=a.sibling,a!==null){fa=a;return}fa=a=e}while(a!==null);Qa===0&&(Qa=5)}function tw(e,a){do{var t=Ij(e.alternate,e);if(t!==null){t.flags&=32767,fa=t;return}if(t=e.return,t!==null&&(t.flags|=32768,t.subtreeFlags=0,t.deletions=null),!a&&(e=e.sibling,e!==null)){fa=e;return}fa=e=t}while(e!==null);Qa=6,fa=null}function Cg(e,a,t,r,s,i,o,l,c){e.cancelPendingCommit=null;do fu();while(Rt!==0);if(Ta&6)throw Error(Ce(327));if(a!==null){if(a===e.current)throw Error(Ce(177));if(i=a.lanes|a.childLanes,i|=$x,EN(e,t,i,o,l,c),e===Oa&&(fa=Oa=null,xa=0),Mo=a,yn=e,Eo=t,Rm=i,Dm=s,W4=r,a.subtreeFlags&10256||a.flags&10256?(e.callbackNode=null,e.callbackPriority=0,Yj(a0,function(){return ow(),null})):(e.callbackNode=null,e.callbackPriority=0),r=(a.flags&13878)!==0,a.subtreeFlags&13878||r){r=Je.T,Je.T=null,s=Ea.p,Ea.p=2,o=Ta,Ta|=4;try{Mj(e,a,t)}finally{Ta=o,Ea.p=s,Je.T=r}}Rt=1,rw(),sw(),nw()}}function rw(){if(Rt===1){Rt=0;var e=yn,a=Mo,t=(a.flags&13878)!==0;if(a.subtreeFlags&13878||t){t=Je.T,Je.T=null;var r=Ea.p;Ea.p=2;var s=Ta;Ta|=4;try{$4(a,e);var i=Lm,o=Nb(e.containerInfo),l=i.focusedElem,c=i.selectionRange;if(o!==l&&l&&l.ownerDocument&&kb(l.ownerDocument.documentElement,l)){if(c!==null&&zx(l)){var u=c.start,d=c.end;if(d===void 0&&(d=u),"selectionStart"in l)l.selectionStart=u,l.selectionEnd=Math.min(d,l.value.length);else{var f=l.ownerDocument||document,m=f&&f.defaultView||window;if(m.getSelection){var x=m.getSelection(),h=l.textContent.length,g=Math.min(c.start,h),p=c.end===void 0?g:Math.min(c.end,h);!x.extend&&g>p&&(o=p,p=g,g=o);var v=Yp(l,g),w=Yp(l,p);if(v&&w&&(x.rangeCount!==1||x.anchorNode!==v.node||x.anchorOffset!==v.offset||x.focusNode!==w.node||x.focusOffset!==w.offset)){var b=f.createRange();b.setStart(v.node,v.offset),x.removeAllRanges(),g>p?(x.addRange(b),x.extend(w.node,w.offset)):(b.setEnd(w.node,w.offset),x.addRange(b))}}}}for(f=[],x=l;x=x.parentNode;)x.nodeType===1&&f.push({element:x,left:x.scrollLeft,top:x.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<f.length;l++){var y=f[l];y.element.scrollLeft=y.left,y.element.scrollTop=y.top}}S0=!!Um,Lm=Um=null}finally{Ta=s,Ea.p=r,Je.T=t}}e.current=a,Rt=2}}function sw(){if(Rt===2){Rt=0;var e=yn,a=Mo,t=(a.flags&8772)!==0;if(a.subtreeFlags&8772||t){t=Je.T,Je.T=null;var r=Ea.p;Ea.p=2;var s=Ta;Ta|=4;try{U4(e,a.alternate,a)}finally{Ta=s,Ea.p=r,Je.T=t}}Rt=3}}function nw(){if(Rt===4||Rt===3){Rt=0,mN();var e=yn,a=Mo,t=Eo,r=W4;a.subtreeFlags&10256||a.flags&10256?Rt=5:(Rt=0,Mo=yn=null,iw(e,e.pendingLanes));var s=e.pendingLanes;if(s===0&&(gn=null),Px(t),a=a.stateNode,Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Nc,a,void 0,(a.current.flags&128)===128)}catch{}if(r!==null){a=Je.T,s=Ea.p,Ea.p=2,Je.T=null;try{for(var i=e.onRecoverableError,o=0;o<r.length;o++){var l=r[o];i(l.value,{componentStack:l.stack})}}finally{Je.T=a,Ea.p=s}}Eo&3&&fu(),bs(e),s=e.pendingLanes,t&4194090&&s&42?e===Pm?Bl++:(Bl=0,Pm=e):Bl=0,Ic(0)}}function iw(e,a){(e.pooledCacheLanes&=a)===0&&(a=e.pooledCache,a!=null&&(e.pooledCache=null,Ac(a)))}function fu(e){return rw(),sw(),nw(),ow()}function ow(){if(Rt!==5)return!1;var e=yn,a=Rm;Rm=0;var t=Px(Eo),r=Je.T,s=Ea.p;try{Ea.p=32>t?32:t,Je.T=null,t=Dm,Dm=null;var i=yn,o=Eo;if(Rt=0,Mo=yn=null,Eo=0,Ta&6)throw Error(Ce(331));var l=Ta;if(Ta|=4,q4(i.current),H4(i,i.current,o,t),Ta=l,Ic(0,!1),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Nc,i)}catch{}return!0}finally{Ea.p=s,Je.T=r,iw(e,a)}}function Tg(e,a,t){a=zr(t,a),a=Cm(e.stateNode,a,2),e=pn(e,a,2),e!==null&&(Sc(e,2),bs(e))}function Da(e,a,t){if(e.tag===3)Tg(e,e,t);else for(;a!==null;){if(a.tag===3){Tg(a,e,t);break}else if(a.tag===1){var r=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(gn===null||!gn.has(r))){e=zr(t,e),t=N4(2),r=pn(a,t,2),r!==null&&(j4(t,r,a,e),Sc(r,2),bs(r));break}}a=a.return}}function ff(e,a,t){var r=e.pingCache;if(r===null){r=e.pingCache=new Bj;var s=new Set;r.set(a,s)}else s=r.get(a),s===void 0&&(s=new Set,r.set(a,s));s.has(t)||(fh=!0,s.add(t),e=Gj.bind(null,e,a,t),a.then(e,e))}function Gj(e,a,t){var r=e.pingCache;r!==null&&r.delete(a),e.pingedLanes|=e.suspendedLanes&t,e.warmLanes&=~t,Oa===e&&(xa&t)===t&&(Qa===4||Qa===3&&(xa&62914560)===xa&&300>hs()-xh?!(Ta&2)&&Uo(e,0):mh|=t,Io===xa&&(Io=0)),bs(e)}function lw(e,a){a===0&&(a=rb()),e=Yo(e,a),e!==null&&(Sc(e,a),bs(e))}function Xj(e){var a=e.memoizedState,t=0;a!==null&&(t=a.retryLane),lw(e,t)}function qj(e,a){var t=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(Ce(314))}r!==null&&r.delete(a),lw(e,t)}function Yj(e,a){return Rx(e,a)}var v0=null,Yi=null,Im=!1,b0=!1,mf=!1,ti=0;function bs(e){e!==Yi&&e.next===null&&(Yi===null?v0=Yi=e:Yi=Yi.next=e),b0=!0,Im||(Im=!0,Kj())}function Ic(e,a){if(!mf&&b0){mf=!0;do for(var t=!1,r=v0;r!==null;){if(e!==0){var s=r.pendingLanes;if(s===0)var i=0;else{var o=r.suspendedLanes,l=r.pingedLanes;i=(1<<31-jr(42|e)+1)-1,i&=s&~(o&~l),i=i&201326741?i&201326741|1:i?i|2:0}i!==0&&(t=!0,Fg(r,i))}else i=xa,i=eu(r,r===Oa?i:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),!(i&3)||jc(r,i)||(t=!0,Fg(r,i));r=r.next}while(t);mf=!1}}function Wj(){cw()}function cw(){b0=Im=!1;var e=0;ti!==0&&(sS()&&(e=ti),ti=0);for(var a=hs(),t=null,r=v0;r!==null;){var s=r.next,i=dw(r,a);i===0?(r.next=null,t===null?v0=s:t.next=s,s===null&&(Yi=t)):(t=r,(e!==0||i&3)&&(b0=!0)),r=s}Ic(e)}function dw(e,a){for(var t=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes&-62914561;0<i;){var o=31-jr(i),l=1<<o,c=s[o];c===-1?(!(l&t)||l&r)&&(s[o]=wN(l,a)):c<=a&&(e.expiredLanes|=l),i&=~l}if(a=Oa,t=xa,t=eu(e,e===a?t:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r=e.callbackNode,t===0||e===a&&(ja===2||ja===9)||e.cancelPendingCommit!==null)return r!==null&&r!==null&&Uu(r),e.callbackNode=null,e.callbackPriority=0;if(!(t&3)||jc(e,t)){if(a=t&-t,a===e.callbackPriority)return a;switch(r!==null&&Uu(r),Px(t)){case 2:case 8:t=eb;break;case 32:t=a0;break;case 268435456:t=ab;break;default:t=a0}return r=uw.bind(null,e),t=Rx(t,r),e.callbackPriority=a,e.callbackNode=t,a}return r!==null&&r!==null&&Uu(r),e.callbackPriority=2,e.callbackNode=null,2}function uw(e,a){if(Rt!==0&&Rt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var t=e.callbackNode;if(fu()&&e.callbackNode!==t)return null;var r=xa;return r=eu(e,e===Oa?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r===0?null:(J4(e,r,a),dw(e,hs()),e.callbackNode!=null&&e.callbackNode===t?uw.bind(null,e):null)}function Fg(e,a){if(fu())return null;J4(e,a,!0)}function Kj(){iS(function(){Ta&6?Rx(Q2,Wj):cw()})}function ph(){return ti===0&&(ti=tb()),ti}function _g(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Md(""+e)}function Ag(e,a){var t=a.ownerDocument.createElement("input");return t.name=a.name,t.value=a.value,e.id&&t.setAttribute("form",e.id),a.parentNode.insertBefore(t,a),e=new FormData(e),t.parentNode.removeChild(t),e}function Jj(e,a,t,r,s){if(a==="submit"&&t&&t.stateNode===s){var i=_g((s[ur]||null).action),o=r.submitter;o&&(a=(a=o[ur]||null)?_g(a.formAction):o.getAttribute("formAction"),a!==null&&(i=a,o=null));var l=new au("action","action",null,r,s);e.push({event:l,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(ti!==0){var c=o?Ag(s,o):new FormData(s);jm(t,{pending:!0,data:c,method:s.method,action:i},null,c)}}else typeof i=="function"&&(l.preventDefault(),c=o?Ag(s,o):new FormData(s),jm(t,{pending:!0,data:c,method:s.method,action:i},i,c))},currentTarget:s}]})}}for(var xf=0;xf<mm.length;xf++){var hf=mm[xf],Zj=hf.toLowerCase(),Qj=hf[0].toUpperCase()+hf.slice(1);rs(Zj,"on"+Qj)}rs(Sb,"onAnimationEnd");rs(Cb,"onAnimationIteration");rs(Tb,"onAnimationStart");rs("dblclick","onDoubleClick");rs("focusin","onFocus");rs("focusout","onBlur");rs(pj,"onTransitionRun");rs(gj,"onTransitionStart");rs(yj,"onTransitionCancel");rs(Fb,"onTransitionEnd");_o("onMouseEnter",["mouseout","mouseover"]);_o("onMouseLeave",["mouseout","mouseover"]);_o("onPointerEnter",["pointerout","pointerover"]);_o("onPointerLeave",["pointerout","pointerover"]);ki("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ki("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ki("onBeforeInput",["compositionend","keypress","textInput","paste"]);ki("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ki("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ki("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(rc));function fw(e,a){a=(a&4)!==0;for(var t=0;t<e.length;t++){var r=e[t],s=r.event;r=r.listeners;e:{var i=void 0;if(a)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;i=l,s.currentTarget=u;try{i(s)}catch(d){m0(d)}s.currentTarget=null,i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;i=l,s.currentTarget=u;try{i(s)}catch(d){m0(d)}s.currentTarget=null,i=c}}}}function ua(e,a){var t=a[im];t===void 0&&(t=a[im]=new Set);var r=e+"__bubble";t.has(r)||(mw(a,e,2,!1),t.add(r))}function pf(e,a,t){var r=0;a&&(r|=4),mw(t,e,r,a)}var dd="_reactListening"+Math.random().toString(36).slice(2);function gh(e){if(!e[dd]){e[dd]=!0,ob.forEach(function(t){t!=="selectionchange"&&(eS.has(t)||pf(t,!1,e),pf(t,!0,e))});var a=e.nodeType===9?e:e.ownerDocument;a===null||a[dd]||(a[dd]=!0,pf("selectionchange",!1,a))}}function mw(e,a,t,r){switch(jw(a)){case 2:var s=CS;break;case 8:s=TS;break;default:s=wh}t=s.bind(null,a,t,e),s=void 0,!dm||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(a,t,{capture:!0,passive:s}):e.addEventListener(a,t,!0):s!==void 0?e.addEventListener(a,t,{passive:s}):e.addEventListener(a,t,!1)}function gf(e,a,t,r,s){var i=r;if(!(a&1)&&!(a&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&o.stateNode.containerInfo===s)return;o=o.return}for(;l!==null;){if(o=eo(l),o===null)return;if(c=o.tag,c===5||c===6||c===26||c===27){r=i=o;continue e}l=l.parentNode}}r=r.return}hb(function(){var u=i,d=Mx(t),f=[];e:{var m=_b.get(e);if(m!==void 0){var x=au,h=e;switch(e){case"keypress":if(Ld(t)===0)break e;case"keydown":case"keyup":x=YN;break;case"focusin":h="focus",x=Xu;break;case"focusout":h="blur",x=Xu;break;case"beforeblur":case"afterblur":x=Xu;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Up;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=IN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=JN;break;case Sb:case Cb:case Tb:x=LN;break;case Fb:x=QN;break;case"scroll":case"scrollend":x=PN;break;case"wheel":x=aj;break;case"copy":case"cut":case"paste":x=zN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Bp;break;case"toggle":case"beforetoggle":x=rj}var g=(a&4)!==0,p=!g&&(e==="scroll"||e==="scrollend"),v=g?m!==null?m+"Capture":null:m;g=[];for(var w=u,b;w!==null;){var y=w;if(b=y.stateNode,y=y.tag,y!==5&&y!==26&&y!==27||b===null||v===null||(y=Jl(w,v),y!=null&&g.push(sc(w,y,b))),p)break;w=w.return}0<g.length&&(m=new x(m,h,null,t,d),f.push({event:m,listeners:g}))}}if(!(a&7)){e:{if(m=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",m&&t!==cm&&(h=t.relatedTarget||t.fromElement)&&(eo(h)||h[Xo]))break e;if((x||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,x?(h=t.relatedTarget||t.toElement,x=u,h=h?eo(h):null,h!==null&&(p=kc(h),g=h.tag,h!==p||g!==5&&g!==27&&g!==6)&&(h=null)):(x=null,h=u),x!==h)){if(g=Up,y="onMouseLeave",v="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(g=Bp,y="onPointerLeave",v="onPointerEnter",w="pointer"),p=x==null?m:El(x),b=h==null?m:El(h),m=new g(y,w+"leave",x,t,d),m.target=p,m.relatedTarget=b,y=null,eo(d)===u&&(g=new g(v,w+"enter",h,t,d),g.target=b,g.relatedTarget=p,y=g),p=y,x&&h)a:{for(g=x,v=h,w=0,b=g;b;b=Ii(b))w++;for(b=0,y=v;y;y=Ii(y))b++;for(;0<w-b;)g=Ii(g),w--;for(;0<b-w;)v=Ii(v),b--;for(;w--;){if(g===v||v!==null&&g===v.alternate)break a;g=Ii(g),v=Ii(v)}g=null}else g=null;x!==null&&Rg(f,m,x,g,!1),h!==null&&p!==null&&Rg(f,p,h,g,!0)}}e:{if(m=u?El(u):window,x=m.nodeName&&m.nodeName.toLowerCase(),x==="select"||x==="input"&&m.type==="file")var j=Hp;else if(Vp(m))if(wb)j=mj;else{j=uj;var A=dj}else x=m.nodeName,!x||x.toLowerCase()!=="input"||m.type!=="checkbox"&&m.type!=="radio"?u&&Ix(u.elementType)&&(j=Hp):j=fj;if(j&&(j=j(e,u))){bb(f,j,t,d);break e}A&&A(e,m,u),e==="focusout"&&u&&m.type==="number"&&u.memoizedProps.value!=null&&lm(m,"number",m.value)}switch(A=u?El(u):window,e){case"focusin":(Vp(A)||A.contentEditable==="true")&&(ro=A,um=u,_l=null);break;case"focusout":_l=um=ro=null;break;case"mousedown":fm=!0;break;case"contextmenu":case"mouseup":case"dragend":fm=!1,Wp(f,t,d);break;case"selectionchange":if(hj)break;case"keydown":case"keyup":Wp(f,t,d)}var E;if(Bx)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else to?yb(e,t)&&(F="onCompositionEnd"):e==="keydown"&&t.keyCode===229&&(F="onCompositionStart");F&&(gb&&t.locale!=="ko"&&(to||F!=="onCompositionStart"?F==="onCompositionEnd"&&to&&(E=pb()):(cn=d,Ux="value"in cn?cn.value:cn.textContent,to=!0)),A=w0(u,F),0<A.length&&(F=new Lp(F,e,null,t,d),f.push({event:F,listeners:A}),E?F.data=E:(E=vb(t),E!==null&&(F.data=E)))),(E=nj?ij(e,t):oj(e,t))&&(F=w0(u,"onBeforeInput"),0<F.length&&(A=new Lp("onBeforeInput","beforeinput",null,t,d),f.push({event:A,listeners:F}),A.data=E)),Jj(f,e,u,t,d)}fw(f,a)})}function sc(e,a,t){return{instance:e,listener:a,currentTarget:t}}function w0(e,a){for(var t=a+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;if(s=s.tag,s!==5&&s!==26&&s!==27||i===null||(s=Jl(e,t),s!=null&&r.unshift(sc(e,s,i)),s=Jl(e,a),s!=null&&r.push(sc(e,s,i))),e.tag===3)return r;e=e.return}return[]}function Ii(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Rg(e,a,t,r,s){for(var i=a._reactName,o=[];t!==null&&t!==r;){var l=t,c=l.alternate,u=l.stateNode;if(l=l.tag,c!==null&&c===r)break;l!==5&&l!==26&&l!==27||u===null||(c=u,s?(u=Jl(t,i),u!=null&&o.unshift(sc(t,u,c))):s||(u=Jl(t,i),u!=null&&o.push(sc(t,u,c)))),t=t.return}o.length!==0&&e.push({event:a,listeners:o})}var aS=/\r\n?/g,tS=/\u0000|\uFFFD/g;function Dg(e){return(typeof e=="string"?e:""+e).replace(aS,`
`).replace(tS,"")}function xw(e,a){return a=Dg(a),Dg(e)===a}function mu(){}function _a(e,a,t,r,s,i){switch(t){case"children":typeof r=="string"?a==="body"||a==="textarea"&&r===""||Ao(e,r):(typeof r=="number"||typeof r=="bigint")&&a!=="body"&&Ao(e,""+r);break;case"className":rd(e,"class",r);break;case"tabIndex":rd(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":rd(e,t,r);break;case"style":xb(e,r,i);break;case"data":if(a!=="object"){rd(e,"data",r);break}case"src":case"href":if(r===""&&(a!=="a"||t!=="href")){e.removeAttribute(t);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(t);break}r=Md(""+r),e.setAttribute(t,r);break;case"action":case"formAction":if(typeof r=="function"){e.setAttribute(t,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof i=="function"&&(t==="formAction"?(a!=="input"&&_a(e,a,"name",s.name,s,null),_a(e,a,"formEncType",s.formEncType,s,null),_a(e,a,"formMethod",s.formMethod,s,null),_a(e,a,"formTarget",s.formTarget,s,null)):(_a(e,a,"encType",s.encType,s,null),_a(e,a,"method",s.method,s,null),_a(e,a,"target",s.target,s,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(t);break}r=Md(""+r),e.setAttribute(t,r);break;case"onClick":r!=null&&(e.onclick=mu);break;case"onScroll":r!=null&&ua("scroll",e);break;case"onScrollEnd":r!=null&&ua("scrollend",e);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(Ce(61));if(t=r.__html,t!=null){if(s.children!=null)throw Error(Ce(60));e.innerHTML=t}}break;case"multiple":e.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":e.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){e.removeAttribute("xlink:href");break}t=Md(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(t,""+r):e.removeAttribute(t);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(t,""):e.removeAttribute(t);break;case"capture":case"download":r===!0?e.setAttribute(t,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(t,r):e.removeAttribute(t);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?e.setAttribute(t,r):e.removeAttribute(t);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?e.removeAttribute(t):e.setAttribute(t,r);break;case"popover":ua("beforetoggle",e),ua("toggle",e),Id(e,"popover",r);break;case"xlinkActuate":js(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":js(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":js(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":js(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":js(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":js(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":js(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":js(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":js(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":Id(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(t=RN.get(t)||t,Id(e,t,r))}}function Mm(e,a,t,r,s,i){switch(t){case"style":xb(e,r,i);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(Ce(61));if(t=r.__html,t!=null){if(s.children!=null)throw Error(Ce(60));e.innerHTML=t}}break;case"children":typeof r=="string"?Ao(e,r):(typeof r=="number"||typeof r=="bigint")&&Ao(e,""+r);break;case"onScroll":r!=null&&ua("scroll",e);break;case"onScrollEnd":r!=null&&ua("scrollend",e);break;case"onClick":r!=null&&(e.onclick=mu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!lb.hasOwnProperty(t))e:{if(t[0]==="o"&&t[1]==="n"&&(s=t.endsWith("Capture"),a=t.slice(2,s?t.length-7:void 0),i=e[ur]||null,i=i!=null?i[t]:null,typeof i=="function"&&e.removeEventListener(a,i,s),typeof r=="function")){typeof i!="function"&&i!==null&&(t in e?e[t]=null:e.hasAttribute(t)&&e.removeAttribute(t)),e.addEventListener(a,r,s);break e}t in e?e[t]=r:r===!0?e.setAttribute(t,""):Id(e,t,r)}}}function Ot(e,a,t){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ua("error",e),ua("load",e);var r=!1,s=!1,i;for(i in t)if(t.hasOwnProperty(i)){var o=t[i];if(o!=null)switch(i){case"src":r=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Ce(137,a));default:_a(e,a,i,o,t,null)}}s&&_a(e,a,"srcSet",t.srcSet,t,null),r&&_a(e,a,"src",t.src,t,null);return;case"input":ua("invalid",e);var l=i=o=s=null,c=null,u=null;for(r in t)if(t.hasOwnProperty(r)){var d=t[r];if(d!=null)switch(r){case"name":s=d;break;case"type":o=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":i=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(Ce(137,a));break;default:_a(e,a,r,d,t,null)}}ub(e,i,l,c,u,o,s,!1),t0(e);return;case"select":ua("invalid",e),r=o=i=null;for(s in t)if(t.hasOwnProperty(s)&&(l=t[s],l!=null))switch(s){case"value":i=l;break;case"defaultValue":o=l;break;case"multiple":r=l;default:_a(e,a,s,l,t,null)}a=i,t=o,e.multiple=!!r,a!=null?po(e,!!r,a,!1):t!=null&&po(e,!!r,t,!0);return;case"textarea":ua("invalid",e),i=s=r=null;for(o in t)if(t.hasOwnProperty(o)&&(l=t[o],l!=null))switch(o){case"value":r=l;break;case"defaultValue":s=l;break;case"children":i=l;break;case"dangerouslySetInnerHTML":if(l!=null)throw Error(Ce(91));break;default:_a(e,a,o,l,t,null)}mb(e,r,s,i),t0(e);return;case"option":for(c in t)if(t.hasOwnProperty(c)&&(r=t[c],r!=null))switch(c){case"selected":e.selected=r&&typeof r!="function"&&typeof r!="symbol";break;default:_a(e,a,c,r,t,null)}return;case"dialog":ua("beforetoggle",e),ua("toggle",e),ua("cancel",e),ua("close",e);break;case"iframe":case"object":ua("load",e);break;case"video":case"audio":for(r=0;r<rc.length;r++)ua(rc[r],e);break;case"image":ua("error",e),ua("load",e);break;case"details":ua("toggle",e);break;case"embed":case"source":case"link":ua("error",e),ua("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in t)if(t.hasOwnProperty(u)&&(r=t[u],r!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(Ce(137,a));default:_a(e,a,u,r,t,null)}return;default:if(Ix(a)){for(d in t)t.hasOwnProperty(d)&&(r=t[d],r!==void 0&&Mm(e,a,d,r,t,void 0));return}}for(l in t)t.hasOwnProperty(l)&&(r=t[l],r!=null&&_a(e,a,l,r,t,null))}function rS(e,a,t,r){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var s=null,i=null,o=null,l=null,c=null,u=null,d=null;for(x in t){var f=t[x];if(t.hasOwnProperty(x)&&f!=null)switch(x){case"checked":break;case"value":break;case"defaultValue":c=f;default:r.hasOwnProperty(x)||_a(e,a,x,null,r,f)}}for(var m in r){var x=r[m];if(f=t[m],r.hasOwnProperty(m)&&(x!=null||f!=null))switch(m){case"type":i=x;break;case"name":s=x;break;case"checked":u=x;break;case"defaultChecked":d=x;break;case"value":o=x;break;case"defaultValue":l=x;break;case"children":case"dangerouslySetInnerHTML":if(x!=null)throw Error(Ce(137,a));break;default:x!==f&&_a(e,a,m,x,r,f)}}om(e,o,l,c,u,d,i,s);return;case"select":x=o=l=m=null;for(i in t)if(c=t[i],t.hasOwnProperty(i)&&c!=null)switch(i){case"value":break;case"multiple":x=c;default:r.hasOwnProperty(i)||_a(e,a,i,null,r,c)}for(s in r)if(i=r[s],c=t[s],r.hasOwnProperty(s)&&(i!=null||c!=null))switch(s){case"value":m=i;break;case"defaultValue":l=i;break;case"multiple":o=i;default:i!==c&&_a(e,a,s,i,r,c)}a=l,t=o,r=x,m!=null?po(e,!!t,m,!1):!!r!=!!t&&(a!=null?po(e,!!t,a,!0):po(e,!!t,t?[]:"",!1));return;case"textarea":x=m=null;for(l in t)if(s=t[l],t.hasOwnProperty(l)&&s!=null&&!r.hasOwnProperty(l))switch(l){case"value":break;case"children":break;default:_a(e,a,l,null,r,s)}for(o in r)if(s=r[o],i=t[o],r.hasOwnProperty(o)&&(s!=null||i!=null))switch(o){case"value":m=s;break;case"defaultValue":x=s;break;case"children":break;case"dangerouslySetInnerHTML":if(s!=null)throw Error(Ce(91));break;default:s!==i&&_a(e,a,o,s,r,i)}fb(e,m,x);return;case"option":for(var h in t)if(m=t[h],t.hasOwnProperty(h)&&m!=null&&!r.hasOwnProperty(h))switch(h){case"selected":e.selected=!1;break;default:_a(e,a,h,null,r,m)}for(c in r)if(m=r[c],x=t[c],r.hasOwnProperty(c)&&m!==x&&(m!=null||x!=null))switch(c){case"selected":e.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:_a(e,a,c,m,r,x)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in t)m=t[g],t.hasOwnProperty(g)&&m!=null&&!r.hasOwnProperty(g)&&_a(e,a,g,null,r,m);for(u in r)if(m=r[u],x=t[u],r.hasOwnProperty(u)&&m!==x&&(m!=null||x!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(Ce(137,a));break;default:_a(e,a,u,m,r,x)}return;default:if(Ix(a)){for(var p in t)m=t[p],t.hasOwnProperty(p)&&m!==void 0&&!r.hasOwnProperty(p)&&Mm(e,a,p,void 0,r,m);for(d in r)m=r[d],x=t[d],!r.hasOwnProperty(d)||m===x||m===void 0&&x===void 0||Mm(e,a,d,m,r,x);return}}for(var v in t)m=t[v],t.hasOwnProperty(v)&&m!=null&&!r.hasOwnProperty(v)&&_a(e,a,v,null,r,m);for(f in r)m=r[f],x=t[f],!r.hasOwnProperty(f)||m===x||m==null&&x==null||_a(e,a,f,m,r,x)}var Um=null,Lm=null;function E0(e){return e.nodeType===9?e:e.ownerDocument}function Pg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hw(e,a){if(e===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&a==="foreignObject"?0:e}function Bm(e,a){return e==="textarea"||e==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var yf=null;function sS(){var e=window.event;return e&&e.type==="popstate"?e===yf?!1:(yf=e,!0):(yf=null,!1)}var pw=typeof setTimeout=="function"?setTimeout:void 0,nS=typeof clearTimeout=="function"?clearTimeout:void 0,Og=typeof Promise=="function"?Promise:void 0,iS=typeof queueMicrotask=="function"?queueMicrotask:typeof Og<"u"?function(e){return Og.resolve(null).then(e).catch(oS)}:pw;function oS(e){setTimeout(function(){throw e})}function Dn(e){return e==="head"}function Ig(e,a){var t=a,r=0,s=0;do{var i=t.nextSibling;if(e.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(0<r&&8>r){t=r;var o=e.ownerDocument;if(t&1&&zl(o.documentElement),t&2&&zl(o.body),t&4)for(t=o.head,zl(t),o=t.firstChild;o;){var l=o.nextSibling,c=o.nodeName;o[Cc]||c==="SCRIPT"||c==="STYLE"||c==="LINK"&&o.rel.toLowerCase()==="stylesheet"||t.removeChild(o),o=l}}if(s===0){e.removeChild(i),cc(a);return}s--}else t==="$"||t==="$?"||t==="$!"?s++:r=t.charCodeAt(0)-48;else r=0;t=i}while(t);cc(a)}function zm(e){var a=e.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var t=a;switch(a=a.nextSibling,t.nodeName){case"HTML":case"HEAD":case"BODY":zm(t),Ox(t);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(t.rel.toLowerCase()==="stylesheet")continue}e.removeChild(t)}}function lS(e,a,t,r){for(;e.nodeType===1;){var s=t;if(e.nodeName.toLowerCase()!==a.toLowerCase()){if(!r&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(r){if(!e[Cc])switch(a){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(i=e.getAttribute("rel"),i==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(i!==s.rel||e.getAttribute("href")!==(s.href==null||s.href===""?null:s.href)||e.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin)||e.getAttribute("title")!==(s.title==null?null:s.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(i=e.getAttribute("src"),(i!==(s.src==null?null:s.src)||e.getAttribute("type")!==(s.type==null?null:s.type)||e.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(a==="input"&&e.type==="hidden"){var i=s.name==null?null:""+s.name;if(s.type==="hidden"&&e.getAttribute("name")===i)return e}else return e;if(e=es(e.nextSibling),e===null)break}return null}function cS(e,a,t){if(a==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=es(e.nextSibling),e===null))return null;return e}function $m(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function dS(e,a){var t=e.ownerDocument;if(e.data!=="$?"||t.readyState==="complete")a();else{var r=function(){a(),t.removeEventListener("DOMContentLoaded",r)};t.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}function es(e){for(;e!=null;e=e.nextSibling){var a=e.nodeType;if(a===1||a===3)break;if(a===8){if(a=e.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return e}var Vm=null;function Mg(e){e=e.previousSibling;for(var a=0;e;){if(e.nodeType===8){var t=e.data;if(t==="$"||t==="$!"||t==="$?"){if(a===0)return e;a--}else t==="/$"&&a++}e=e.previousSibling}return null}function gw(e,a,t){switch(a=E0(t),e){case"html":if(e=a.documentElement,!e)throw Error(Ce(452));return e;case"head":if(e=a.head,!e)throw Error(Ce(453));return e;case"body":if(e=a.body,!e)throw Error(Ce(454));return e;default:throw Error(Ce(451))}}function zl(e){for(var a=e.attributes;a.length;)e.removeAttributeNode(a[0]);Ox(e)}var Gr=new Map,Ug=new Set;function k0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Gs=Ea.d;Ea.d={f:uS,r:fS,D:mS,C:xS,L:hS,m:pS,X:yS,S:gS,M:vS};function uS(){var e=Gs.f(),a=du();return e||a}function fS(e){var a=qo(e);a!==null&&a.tag===5&&a.type==="form"?d4(a):Gs.r(e)}var Ko=typeof document>"u"?null:document;function yw(e,a,t){var r=Ko;if(r&&typeof a=="string"&&a){var s=Br(a);s='link[rel="'+e+'"][href="'+s+'"]',typeof t=="string"&&(s+='[crossorigin="'+t+'"]'),Ug.has(s)||(Ug.add(s),e={rel:e,crossOrigin:t,href:a},r.querySelector(s)===null&&(a=r.createElement("link"),Ot(a,"link",e),kt(a),r.head.appendChild(a)))}}function mS(e){Gs.D(e),yw("dns-prefetch",e,null)}function xS(e,a){Gs.C(e,a),yw("preconnect",e,a)}function hS(e,a,t){Gs.L(e,a,t);var r=Ko;if(r&&e&&a){var s='link[rel="preload"][as="'+Br(a)+'"]';a==="image"&&t&&t.imageSrcSet?(s+='[imagesrcset="'+Br(t.imageSrcSet)+'"]',typeof t.imageSizes=="string"&&(s+='[imagesizes="'+Br(t.imageSizes)+'"]')):s+='[href="'+Br(e)+'"]';var i=s;switch(a){case"style":i=Lo(e);break;case"script":i=Jo(e)}Gr.has(i)||(e=za({rel:"preload",href:a==="image"&&t&&t.imageSrcSet?void 0:e,as:a},t),Gr.set(i,e),r.querySelector(s)!==null||a==="style"&&r.querySelector(Mc(i))||a==="script"&&r.querySelector(Uc(i))||(a=r.createElement("link"),Ot(a,"link",e),kt(a),r.head.appendChild(a)))}}function pS(e,a){Gs.m(e,a);var t=Ko;if(t&&e){var r=a&&typeof a.as=="string"?a.as:"script",s='link[rel="modulepreload"][as="'+Br(r)+'"][href="'+Br(e)+'"]',i=s;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Jo(e)}if(!Gr.has(i)&&(e=za({rel:"modulepreload",href:e},a),Gr.set(i,e),t.querySelector(s)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(t.querySelector(Uc(i)))return}r=t.createElement("link"),Ot(r,"link",e),kt(r),t.head.appendChild(r)}}}function gS(e,a,t){Gs.S(e,a,t);var r=Ko;if(r&&e){var s=ho(r).hoistableStyles,i=Lo(e);a=a||"default";var o=s.get(i);if(!o){var l={loading:0,preload:null};if(o=r.querySelector(Mc(i)))l.loading=5;else{e=za({rel:"stylesheet",href:e,"data-precedence":a},t),(t=Gr.get(i))&&yh(e,t);var c=o=r.createElement("link");kt(c),Ot(c,"link",e),c._p=new Promise(function(u,d){c.onload=u,c.onerror=d}),c.addEventListener("load",function(){l.loading|=1}),c.addEventListener("error",function(){l.loading|=2}),l.loading|=4,Xd(o,a,r)}o={type:"stylesheet",instance:o,count:1,state:l},s.set(i,o)}}}function yS(e,a){Gs.X(e,a);var t=Ko;if(t&&e){var r=ho(t).hoistableScripts,s=Jo(e),i=r.get(s);i||(i=t.querySelector(Uc(s)),i||(e=za({src:e,async:!0},a),(a=Gr.get(s))&&vh(e,a),i=t.createElement("script"),kt(i),Ot(i,"link",e),t.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(s,i))}}function vS(e,a){Gs.M(e,a);var t=Ko;if(t&&e){var r=ho(t).hoistableScripts,s=Jo(e),i=r.get(s);i||(i=t.querySelector(Uc(s)),i||(e=za({src:e,async:!0,type:"module"},a),(a=Gr.get(s))&&vh(e,a),i=t.createElement("script"),kt(i),Ot(i,"link",e),t.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(s,i))}}function Lg(e,a,t,r){var s=(s=xn.current)?k0(s):null;if(!s)throw Error(Ce(446));switch(e){case"meta":case"title":return null;case"style":return typeof t.precedence=="string"&&typeof t.href=="string"?(a=Lo(t.href),t=ho(s).hoistableStyles,r=t.get(a),r||(r={type:"style",instance:null,count:0,state:null},t.set(a,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(t.rel==="stylesheet"&&typeof t.href=="string"&&typeof t.precedence=="string"){e=Lo(t.href);var i=ho(s).hoistableStyles,o=i.get(e);if(o||(s=s.ownerDocument||s,o={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},i.set(e,o),(i=s.querySelector(Mc(e)))&&!i._p&&(o.instance=i,o.state.loading=5),Gr.has(e)||(t={rel:"preload",as:"style",href:t.href,crossOrigin:t.crossOrigin,integrity:t.integrity,media:t.media,hrefLang:t.hrefLang,referrerPolicy:t.referrerPolicy},Gr.set(e,t),i||bS(s,e,t,o.state))),a&&r===null)throw Error(Ce(528,""));return o}if(a&&r!==null)throw Error(Ce(529,""));return null;case"script":return a=t.async,t=t.src,typeof t=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Jo(t),t=ho(s).hoistableScripts,r=t.get(a),r||(r={type:"script",instance:null,count:0,state:null},t.set(a,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(Ce(444,e))}}function Lo(e){return'href="'+Br(e)+'"'}function Mc(e){return'link[rel="stylesheet"]['+e+"]"}function vw(e){return za({},e,{"data-precedence":e.precedence,precedence:null})}function bS(e,a,t,r){e.querySelector('link[rel="preload"][as="style"]['+a+"]")?r.loading=1:(a=e.createElement("link"),r.preload=a,a.addEventListener("load",function(){return r.loading|=1}),a.addEventListener("error",function(){return r.loading|=2}),Ot(a,"link",t),kt(a),e.head.appendChild(a))}function Jo(e){return'[src="'+Br(e)+'"]'}function Uc(e){return"script[async]"+e}function Bg(e,a,t){if(a.count++,a.instance===null)switch(a.type){case"style":var r=e.querySelector('style[data-href~="'+Br(t.href)+'"]');if(r)return a.instance=r,kt(r),r;var s=za({},t,{"data-href":t.href,"data-precedence":t.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement("style"),kt(r),Ot(r,"style",s),Xd(r,t.precedence,e),a.instance=r;case"stylesheet":s=Lo(t.href);var i=e.querySelector(Mc(s));if(i)return a.state.loading|=4,a.instance=i,kt(i),i;r=vw(t),(s=Gr.get(s))&&yh(r,s),i=(e.ownerDocument||e).createElement("link"),kt(i);var o=i;return o._p=new Promise(function(l,c){o.onload=l,o.onerror=c}),Ot(i,"link",r),a.state.loading|=4,Xd(i,t.precedence,e),a.instance=i;case"script":return i=Jo(t.src),(s=e.querySelector(Uc(i)))?(a.instance=s,kt(s),s):(r=t,(s=Gr.get(i))&&(r=za({},t),vh(r,s)),e=e.ownerDocument||e,s=e.createElement("script"),kt(s),Ot(s,"link",r),e.head.appendChild(s),a.instance=s);case"void":return null;default:throw Error(Ce(443,a.type))}else a.type==="stylesheet"&&!(a.state.loading&4)&&(r=a.instance,a.state.loading|=4,Xd(r,t.precedence,e));return a.instance}function Xd(e,a,t){for(var r=t.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=r.length?r[r.length-1]:null,i=s,o=0;o<r.length;o++){var l=r[o];if(l.dataset.precedence===a)i=l;else if(i!==s)break}i?i.parentNode.insertBefore(e,i.nextSibling):(a=t.nodeType===9?t.head:t,a.insertBefore(e,a.firstChild))}function yh(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.title==null&&(e.title=a.title)}function vh(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.integrity==null&&(e.integrity=a.integrity)}var qd=null;function zg(e,a,t){if(qd===null){var r=new Map,s=qd=new Map;s.set(t,r)}else s=qd,r=s.get(t),r||(r=new Map,s.set(t,r));if(r.has(e))return r;for(r.set(e,null),t=t.getElementsByTagName(e),s=0;s<t.length;s++){var i=t[s];if(!(i[Cc]||i[Gt]||e==="link"&&i.getAttribute("rel")==="stylesheet")&&i.namespaceURI!=="http://www.w3.org/2000/svg"){var o=i.getAttribute(a)||"";o=e+o;var l=r.get(o);l?l.push(i):r.set(o,[i])}}return r}function $g(e,a,t){e=e.ownerDocument||e,e.head.insertBefore(t,a==="title"?e.querySelector("head > title"):null)}function wS(e,a,t){if(t===1||a.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return e=a.disabled,typeof a.precedence=="string"&&e==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function bw(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var nc=null;function ES(){}function kS(e,a,t){if(nc===null)throw Error(Ce(475));var r=nc;if(a.type==="stylesheet"&&(typeof t.media!="string"||matchMedia(t.media).matches!==!1)&&!(a.state.loading&4)){if(a.instance===null){var s=Lo(t.href),i=e.querySelector(Mc(s));if(i){e=i._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(r.count++,r=N0.bind(r),e.then(r,r)),a.state.loading|=4,a.instance=i,kt(i);return}i=e.ownerDocument||e,t=vw(t),(s=Gr.get(s))&&yh(t,s),i=i.createElement("link"),kt(i);var o=i;o._p=new Promise(function(l,c){o.onload=l,o.onerror=c}),Ot(i,"link",t),a.instance=i}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(a,e),(e=a.state.preload)&&!(a.state.loading&3)&&(r.count++,a=N0.bind(r),e.addEventListener("load",a),e.addEventListener("error",a))}}function NS(){if(nc===null)throw Error(Ce(475));var e=nc;return e.stylesheets&&e.count===0&&Hm(e,e.stylesheets),0<e.count?function(a){var t=setTimeout(function(){if(e.stylesheets&&Hm(e,e.stylesheets),e.unsuspend){var r=e.unsuspend;e.unsuspend=null,r()}},6e4);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(t)}}:null}function N0(){if(this.count--,this.count===0){if(this.stylesheets)Hm(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var j0=null;function Hm(e,a){e.stylesheets=null,e.unsuspend!==null&&(e.count++,j0=new Map,a.forEach(jS,e),j0=null,N0.call(e))}function jS(e,a){if(!(a.state.loading&4)){var t=j0.get(e);if(t)var r=t.get(null);else{t=new Map,j0.set(e,t);for(var s=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<s.length;i++){var o=s[i];(o.nodeName==="LINK"||o.getAttribute("media")!=="not all")&&(t.set(o.dataset.precedence,o),r=o)}r&&t.set(null,r)}s=a.instance,o=s.getAttribute("data-precedence"),i=t.get(o)||r,i===r&&t.set(null,s),t.set(o,s),this.count++,r=N0.bind(this),s.addEventListener("load",r),s.addEventListener("error",r),i?i.parentNode.insertBefore(s,i.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(s,e.firstChild)),a.state.loading|=4}}var ic={$$typeof:Fs,Provider:null,Consumer:null,_currentValue:Kn,_currentValue2:Kn,_threadCount:0};function SS(e,a,t,r,s,i,o,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Lu(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lu(0),this.hiddenUpdates=Lu(null),this.identifierPrefix=r,this.onUncaughtError=s,this.onCaughtError=i,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function ww(e,a,t,r,s,i,o,l,c,u,d,f){return e=new SS(e,a,t,o,l,c,u,f),a=1,i===!0&&(a|=24),i=br(3,null,null,a),e.current=i,i.stateNode=e,a=qx(),a.refCount++,e.pooledCache=a,a.refCount++,i.memoizedState={element:r,isDehydrated:t,cache:a},Wx(i),e}function Ew(e){return e?(e=io,e):io}function kw(e,a,t,r,s,i){s=Ew(s),r.context===null?r.context=s:r.pendingContext=s,r=hn(a),r.payload={element:t},i=i===void 0?null:i,i!==null&&(r.callback=i),t=pn(e,r,a),t!==null&&(Cr(t,e,a),Dl(t,e,a))}function Vg(e,a){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var t=e.retryLane;e.retryLane=t!==0&&t<a?t:a}}function bh(e,a){Vg(e,a),(e=e.alternate)&&Vg(e,a)}function Nw(e){if(e.tag===13){var a=Yo(e,67108864);a!==null&&Cr(a,e,67108864),bh(e,67108864)}}var S0=!0;function CS(e,a,t,r){var s=Je.T;Je.T=null;var i=Ea.p;try{Ea.p=2,wh(e,a,t,r)}finally{Ea.p=i,Je.T=s}}function TS(e,a,t,r){var s=Je.T;Je.T=null;var i=Ea.p;try{Ea.p=8,wh(e,a,t,r)}finally{Ea.p=i,Je.T=s}}function wh(e,a,t,r){if(S0){var s=Gm(r);if(s===null)gf(e,a,r,C0,t),Hg(e,r);else if(_S(s,e,a,t,r))r.stopPropagation();else if(Hg(e,r),a&4&&-1<FS.indexOf(e)){for(;s!==null;){var i=qo(s);if(i!==null)switch(i.tag){case 3:if(i=i.stateNode,i.current.memoizedState.isDehydrated){var o=$n(i.pendingLanes);if(o!==0){var l=i;for(l.pendingLanes|=2,l.entangledLanes|=2;o;){var c=1<<31-jr(o);l.entanglements[1]|=c,o&=~c}bs(i),!(Ta&6)&&(g0=hs()+500,Ic(0))}}break;case 13:l=Yo(i,2),l!==null&&Cr(l,i,2),du(),bh(i,2)}if(i=Gm(r),i===null&&gf(e,a,r,C0,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else gf(e,a,r,null,t)}}function Gm(e){return e=Mx(e),Eh(e)}var C0=null;function Eh(e){if(C0=null,e=eo(e),e!==null){var a=kc(e);if(a===null)e=null;else{var t=a.tag;if(t===13){if(e=W2(a),e!==null)return e;e=null}else if(t===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;e=null}else a!==e&&(e=null)}}return C0=e,null}function jw(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xN()){case Q2:return 2;case eb:return 8;case a0:case hN:return 32;case ab:return 268435456;default:return 32}default:return 32}}var Xm=!1,vn=null,bn=null,wn=null,oc=new Map,lc=new Map,on=[],FS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Hg(e,a){switch(e){case"focusin":case"focusout":vn=null;break;case"dragenter":case"dragleave":bn=null;break;case"mouseover":case"mouseout":wn=null;break;case"pointerover":case"pointerout":oc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":lc.delete(a.pointerId)}}function hl(e,a,t,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:a,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},a!==null&&(a=qo(a),a!==null&&Nw(a)),e):(e.eventSystemFlags|=r,a=e.targetContainers,s!==null&&a.indexOf(s)===-1&&a.push(s),e)}function _S(e,a,t,r,s){switch(a){case"focusin":return vn=hl(vn,e,a,t,r,s),!0;case"dragenter":return bn=hl(bn,e,a,t,r,s),!0;case"mouseover":return wn=hl(wn,e,a,t,r,s),!0;case"pointerover":var i=s.pointerId;return oc.set(i,hl(oc.get(i)||null,e,a,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,lc.set(i,hl(lc.get(i)||null,e,a,t,r,s)),!0}return!1}function Sw(e){var a=eo(e.target);if(a!==null){var t=kc(a);if(t!==null){if(a=t.tag,a===13){if(a=W2(t),a!==null){e.blockedOn=a,kN(e.priority,function(){if(t.tag===13){var r=Sr();r=Dx(r);var s=Yo(t,r);s!==null&&Cr(s,t,r),bh(t,r)}});return}}else if(a===3&&t.stateNode.current.memoizedState.isDehydrated){e.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yd(e){if(e.blockedOn!==null)return!1;for(var a=e.targetContainers;0<a.length;){var t=Gm(e.nativeEvent);if(t===null){t=e.nativeEvent;var r=new t.constructor(t.type,t);cm=r,t.target.dispatchEvent(r),cm=null}else return a=qo(t),a!==null&&Nw(a),e.blockedOn=t,!1;a.shift()}return!0}function Gg(e,a,t){Yd(e)&&t.delete(a)}function AS(){Xm=!1,vn!==null&&Yd(vn)&&(vn=null),bn!==null&&Yd(bn)&&(bn=null),wn!==null&&Yd(wn)&&(wn=null),oc.forEach(Gg),lc.forEach(Gg)}function ud(e,a){e.blockedOn===a&&(e.blockedOn=null,Xm||(Xm=!0,vt.unstable_scheduleCallback(vt.unstable_NormalPriority,AS)))}var fd=null;function Xg(e){fd!==e&&(fd=e,vt.unstable_scheduleCallback(vt.unstable_NormalPriority,function(){fd===e&&(fd=null);for(var a=0;a<e.length;a+=3){var t=e[a],r=e[a+1],s=e[a+2];if(typeof r!="function"){if(Eh(r||t)===null)continue;break}var i=qo(t);i!==null&&(e.splice(a,3),a-=3,jm(i,{pending:!0,data:s,method:t.method,action:r},r,s))}}))}function cc(e){function a(c){return ud(c,e)}vn!==null&&ud(vn,e),bn!==null&&ud(bn,e),wn!==null&&ud(wn,e),oc.forEach(a),lc.forEach(a);for(var t=0;t<on.length;t++){var r=on[t];r.blockedOn===e&&(r.blockedOn=null)}for(;0<on.length&&(t=on[0],t.blockedOn===null);)Sw(t),t.blockedOn===null&&on.shift();if(t=(e.ownerDocument||e).$$reactFormReplay,t!=null)for(r=0;r<t.length;r+=3){var s=t[r],i=t[r+1],o=s[ur]||null;if(typeof i=="function")o||Xg(t);else if(o){var l=null;if(i&&i.hasAttribute("formAction")){if(s=i,o=i[ur]||null)l=o.formAction;else if(Eh(s)!==null)continue}else l=o.action;typeof l=="function"?t[r+1]=l:(t.splice(r,3),r-=3),Xg(t)}}}function kh(e){this._internalRoot=e}xu.prototype.render=kh.prototype.render=function(e){var a=this._internalRoot;if(a===null)throw Error(Ce(409));var t=a.current,r=Sr();kw(t,r,e,a,null,null)};xu.prototype.unmount=kh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var a=e.containerInfo;kw(e.current,2,null,e,null,null),du(),a[Xo]=null}};function xu(e){this._internalRoot=e}xu.prototype.unstable_scheduleHydration=function(e){if(e){var a=ib();e={blockedOn:null,target:e,priority:a};for(var t=0;t<on.length&&a!==0&&a<on[t].priority;t++);on.splice(t,0,e),t===0&&Sw(e)}};var qg=q2.version;if(qg!=="19.1.1")throw Error(Ce(527,qg,"19.1.1"));Ea.findDOMNode=function(e){var a=e._reactInternals;if(a===void 0)throw typeof e.render=="function"?Error(Ce(188)):(e=Object.keys(e).join(","),Error(Ce(268,e)));return e=oN(a),e=e!==null?K2(e):null,e=e===null?null:e.stateNode,e};var RS={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Je,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var md=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!md.isDisabled&&md.supportsFiber)try{Nc=md.inject(RS),Nr=md}catch{}}Z0.createRoot=function(e,a){if(!Y2(e))throw Error(Ce(299));var t=!1,r="",s=w4,i=E4,o=k4,l=null;return a!=null&&(a.unstable_strictMode===!0&&(t=!0),a.identifierPrefix!==void 0&&(r=a.identifierPrefix),a.onUncaughtError!==void 0&&(s=a.onUncaughtError),a.onCaughtError!==void 0&&(i=a.onCaughtError),a.onRecoverableError!==void 0&&(o=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(l=a.unstable_transitionCallbacks)),a=ww(e,1,!1,null,null,t,r,s,i,o,l,null),e[Xo]=a.current,gh(e),new kh(a)};Z0.hydrateRoot=function(e,a,t){if(!Y2(e))throw Error(Ce(299));var r=!1,s="",i=w4,o=E4,l=k4,c=null,u=null;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(i=t.onUncaughtError),t.onCaughtError!==void 0&&(o=t.onCaughtError),t.onRecoverableError!==void 0&&(l=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(c=t.unstable_transitionCallbacks),t.formState!==void 0&&(u=t.formState)),a=ww(e,1,!0,a,t??null,r,s,i,o,l,c,u),a.context=Ew(null),t=a.current,r=Sr(),r=Dx(r),s=hn(r),s.callback=null,pn(t,s,r),t=r,a.current.lanes=t,Sc(a,t),bs(a),e[Xo]=a.current,gh(e),new xu(a)};Z0.version="19.1.1";function Cw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Cw)}catch(e){console.error(e)}}Cw(),z2.exports=Z0;var DS=z2.exports;const PS=A2(DS),OS=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})}),Nh=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),IS=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955a.75.75 0 011.06 0l8.955 8.955M3.75 10.5V21a1.5 1.5 0 001.5 1.5h3.75V15a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v7.5h3.75a1.5 1.5 0 001.5-1.5V10.5M20.25 12H3.75"})}),vf=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",width:24,height:24,...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"})}),pr=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})}),Pn=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),bf=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.83-5.83M11.42 15.17A3 3 0 016.343 12.34l-1.263-1.263A2.25 2.25 0 013.838 8.86L2.25 10.5M11.42 15.17L14.835 18.59M12.75 3.825V10.5M12.75 3.825A3 3 0 0115.17 2.25l1.264 1.263A2.25 2.25 0 0118.86 5.662l-1.028 1.028M12.75 3.825L9.335 7.24M7.5 12A2.25 2.25 0 009.75 14.25M7.5 12A2.25 2.25 0 015.25 9.75M7.5 12l-.75-.75M9.75 14.25L12 16.5m0 0l2.25-2.25M12 16.5l-2.25 2.25m2.25-2.25V10.5m2.25-4.5l-2.25 2.25m2.25-2.25A2.25 2.25 0 0012.75 3.75m0 0V2.25m0 1.5A2.25 2.25 0 0110.5 3.75m0 0V2.25"})}),qm=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"})}),wf=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 11.219 12.768 11 12 11c-.768 0-1.536.219-2.121.659L9 12.25M12 6v12m-3-2.818L8.12 14.09c-1.171.879-1.171 2.303 0 3.182s3.07.879 4.242 0L15 16.182m-3-10.182L15 5.818m-3 0L9 5.818m0 0L8.12 7.09c-1.171.879-1.171 2.303 0 3.182s3.07.879 4.242 0L15 9.09m-3-3.273v12"})}),Yg=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 3.375A1.5 1.5 0 0011.25 4.5v3.682c0 .325.072.641.21 1.068a10.51 10.51 0 003.079 3.08c.427.138.743.21 1.068.21h3.682a1.5 1.5 0 001.125-2.625l-3.018-3.018A1.5 1.5 0 0015.932 6H4.5A1.5 1.5 0 003 7.5v10.5A1.5 1.5 0 004.5 19.5h15a1.5 1.5 0 001.5-1.5V11.25c0-.325-.072-.641-.21-1.068a10.51 10.51 0 00-3.079-3.08c-.427-.138-.743-.21-1.068-.21H9.318a1.5 1.5 0 00-1.125 2.625L11.25 12.75M12.75 3.375L15 5.625m-2.25-2.25L10.5 5.625m2.25-2.25V15m0 0l2.25-2.25M12.75 15l-2.25-2.25m0 0l-2.25 2.25m2.25-2.25V3.375M3 14.25h18M3 11.25h18"})}),Wg=e=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.254 9.254 9 9.563 9h4.874c.309 0 .563.254.563.563v4.874c0 .309-.254.563-.563.563H9.563A.562.562 0 019 14.437V9.564z"})]}),MS=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 4.5l7.5 7.5-7.5 7.5m-6-15l7.5 7.5-7.5 7.5"})}),Ym=e=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.096.573.393 1.099.82 1.468l.893.725c.495.402.768 1.007.768 1.633v1.971c0 .626-.273 1.231-.768 1.633l-.893.725c-.427.369-.724.895-.82 1.468l-.213 1.281c-.09.542-.56.94-1.11.94h-2.593c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.096-.573-.393-1.099-.82-1.468l-.893-.725c-.495-.402-.768-1.007-.768-1.633v-1.971c0-.626.273 1.231-.768 1.633l-.893-.725c-.427-.369-.724-.895-.82-1.468l-.213-1.281z"}),n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),US=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-3.024.013L3.558 17.99a.75.75 0 00.013 1.06l1.685 1.686a.75.75 0 001.06.013l1.856-1.855a3 3 0 00.013-3.024m2.041-2.041L14.25 8.169M9.53 16.122L6.25 12.845m3.281 3.277a3.005 3.005 0 013.578 0l2.878 2.878a3.005 3.005 0 010 4.249l-.856.856a3.005 3.005 0 01-4.249 0l-2.878-2.878a3.005 3.005 0 010-3.578m2.041-2.041L14.25 8.169m0 0L12.845 6.25m1.405 1.919L12.16 5.58a3 3 0 00-4.242 0L6.25 7.247m5.91 1.919a3 3 0 00-4.242 0L6.25 10.831m0 0L4.583 9.164a3 3 0 00-4.243 0L.34 10.83a3 3 0 000 4.243l1.686 1.686a3 3 0 004.242 0l1.169-1.168m13.5-1.355L16.122 9.53M17.75 8.169L15.831 6.25m1.919 1.919a3 3 0 010 4.242L16.084 12.5m1.667-4.331L15.58 6.667m1.667 1.502a3 3 0 000-4.243L15.582.34a3 3 0 00-4.243 0L9.667 1.919m1.667 4.748L9.53 8.431m0 0L7.863 6.764m1.667 1.667L6.25 9.53m0 0L4.583 7.863m1.667 1.667L4.917 8.169"})});var Tw={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Kg=or.createContext&&or.createContext(Tw),LS=["attr","size","title"];function BS(e,a){if(e==null)return{};var t=zS(e,a),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(a.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function zS(e,a){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(a.indexOf(r)>=0)continue;t[r]=e[r]}return t}function T0(){return T0=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},T0.apply(this,arguments)}function Jg(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,r)}return t}function F0(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?Jg(Object(t),!0).forEach(function(r){$S(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Jg(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function $S(e,a,t){return a=VS(a),a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function VS(e){var a=HS(e,"string");return typeof a=="symbol"?a:a+""}function HS(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function Fw(e){return e&&e.map((a,t)=>or.createElement(a.tag,F0({key:t},a.attr),Fw(a.child)))}function ya(e){return a=>or.createElement(GS,T0({attr:F0({},e.attr)},a),Fw(e.child))}function GS(e){var a=t=>{var{attr:r,size:s,title:i}=e,o=BS(e,LS),l=s||t.size||"1em",c;return t.className&&(c=t.className),e.className&&(c=(c?c+" ":"")+e.className),or.createElement("svg",T0({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:c,style:F0(F0({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&or.createElement("title",null,i),e.children)};return Kg!==void 0?or.createElement(Kg.Consumer,null,t=>a(t)):a(Tw)}function jn(e){return ya({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function Wi(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(e)}function Zg(e){return ya({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM192 40c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm121.2 231.8l-143 141.8c-4.7 4.7-12.3 4.6-17-.1l-82.6-83.3c-4.7-4.7-4.6-12.3.1-17L99.1 285c4.7-4.7 12.3-4.6 17 .1l46 46.4 106-105.2c4.7-4.7 12.3-4.6 17 .1l28.2 28.4c4.7 4.8 4.6 12.3-.1 17z"},child:[]}]})(e)}function Qg(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function jh(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function XS(e){return ya({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function e1(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function Ef(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 168v-16c0-13.255 10.745-24 24-24h360V80c0-21.367 25.899-32.042 40.971-16.971l80 80c9.372 9.373 9.372 24.569 0 33.941l-80 80C409.956 271.982 384 261.456 384 240v-48H24c-13.255 0-24-10.745-24-24zm488 152H128v-48c0-21.314-25.862-32.08-40.971-16.971l-80 80c-9.372 9.373-9.372 24.569 0 33.941l80 80C102.057 463.997 128 453.437 128 432v-48h360c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24z"},child:[]}]})(e)}function Wm(e){return ya({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function qS(e){return ya({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(e)}function _w(e){return ya({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(e)}function hu(e){return ya({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function YS(e){return ya({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"},child:[]}]})(e)}function WS(e){return ya({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M218.17 424.14c-2.95-5.92-8.09-6.52-10.17-6.52s-7.22.59-10.02 6.19l-7.67 15.34c-6.37 12.78-25.03 11.37-29.48-2.09L144 386.59l-10.61 31.88c-5.89 17.66-22.38 29.53-41 29.53H80c-8.84 0-16-7.16-16-16s7.16-16 16-16h12.39c4.83 0 9.11-3.08 10.64-7.66l18.19-54.64c3.3-9.81 12.44-16.41 22.78-16.41s19.48 6.59 22.77 16.41l13.88 41.64c19.75-16.19 54.06-9.7 66 14.16 1.89 3.78 5.49 5.95 9.36 6.26v-82.12l128-127.09V160H248c-13.2 0-24-10.8-24-24V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24v-40l-128-.11c-16.12-.31-30.58-9.28-37.83-23.75zM384 121.9c0-6.3-2.5-12.4-7-16.9L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1zm-96 225.06V416h68.99l161.68-162.78-67.88-67.88L288 346.96zm280.54-179.63l-31.87-31.87c-9.94-9.94-26.07-9.94-36.01 0l-27.25 27.25 67.88 67.88 27.25-27.25c9.95-9.94 9.95-26.07 0-36.01z"},child:[]}]})(e)}function Sh(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(e)}function a1(e){return ya({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M96 32H32C14.33 32 0 46.33 0 64v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zm0 160H32c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32v-64c0-17.67-14.33-32-32-32zm0 160H32c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32v-64c0-17.67-14.33-32-32-32zM288 32h-64c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zm0 160h-64c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32v-64c0-17.67-14.33-32-32-32zm0 160h-64c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32v-64c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function t1(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"},child:[]}]})(e)}function KS(e){return ya({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 416H381.54c-.74 19.81-14.71 32-32.74 32H288c-18.69 0-33.02-17.47-32.77-32H16c-8.8 0-16 7.2-16 16v16c0 35.2 28.8 64 64 64h512c35.2 0 64-28.8 64-64v-16c0-8.8-7.2-16-16-16zM576 48c0-26.4-21.6-48-48-48H112C85.6 0 64 21.6 64 48v336h512V48zm-64 272H128V64h384v256z"},child:[]}]})(e)}function JS(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M12.41 148.02l232.94 105.67c6.8 3.09 14.49 3.09 21.29 0l232.94-105.67c16.55-7.51 16.55-32.52 0-40.03L266.65 2.31a25.607 25.607 0 0 0-21.29 0L12.41 107.98c-16.55 7.51-16.55 32.53 0 40.04zm487.18 88.28l-58.09-26.33-161.64 73.27c-7.56 3.43-15.59 5.17-23.86 5.17s-16.29-1.74-23.86-5.17L70.51 209.97l-58.1 26.33c-16.55 7.5-16.55 32.5 0 40l232.94 105.59c6.8 3.08 14.49 3.08 21.29 0L499.59 276.3c16.55-7.5 16.55-32.5 0-40zm0 127.8l-57.87-26.23-161.86 73.37c-7.56 3.43-15.59 5.17-23.86 5.17s-16.29-1.74-23.86-5.17L70.29 337.87 12.41 364.1c-16.55 7.5-16.55 32.5 0 40l232.94 105.59c6.8 3.08 14.49 3.08 21.29 0L499.59 404.1c16.55-7.5 16.55-32.5 0-40z"},child:[]}]})(e)}function ZS(e){return ya({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(e)}function Ch(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function Km(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(e)}function ko(e){return ya({attr:{viewBox:"0 0 616 512"},child:[{tag:"path",attr:{d:"M602 118.6L537.1 15C531.3 5.7 521 0 510 0H106C95 0 84.7 5.7 78.9 15L14 118.6c-33.5 53.5-3.8 127.9 58.8 136.4 4.5.6 9.1.9 13.7.9 29.6 0 55.8-13 73.8-33.1 18 20.1 44.3 33.1 73.8 33.1 29.6 0 55.8-13 73.8-33.1 18 20.1 44.3 33.1 73.8 33.1 29.6 0 55.8-13 73.8-33.1 18.1 20.1 44.3 33.1 73.8 33.1 4.7 0 9.2-.3 13.7-.9 62.8-8.4 92.6-82.8 59-136.4zM529.5 288c-10 0-19.9-1.5-29.5-3.8V384H116v-99.8c-9.6 2.2-19.5 3.8-29.5 3.8-6 0-12.1-.4-18-1.2-5.6-.8-11.1-2.1-16.4-3.6V480c0 17.7 14.3 32 32 32h448c17.7 0 32-14.3 32-32V283.2c-5.4 1.6-10.8 2.9-16.4 3.6-6.1.8-12.1 1.2-18.2 1.2z"},child:[]}]})(e)}function pl(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"},child:[]}]})(e)}function QS(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M149.333 56v80c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V56c0-13.255 10.745-24 24-24h101.333c13.255 0 24 10.745 24 24zm181.334 240v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm32-240v80c0 13.255 10.745 24 24 24H488c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24zm-32 80V56c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm-205.334 56H24c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24zM0 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zm386.667-56H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zm0 160H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zM181.333 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24z"},child:[]}]})(e)}function Aw(e){return ya({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function eC(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function xi(e){return ya({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function kf(e){return ya({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}function aC(e){return ya({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(e)}function tC(e){return ya({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(e)}function rC(e){return ya({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}const sC=e=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6a7.5 7.5 0 107.5 7.5h-7.5V6z"}),n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 10.5H21A7.5 7.5 0 0013.5 3v7.5z"})]}),r1=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.348 14.651a3.75 3.75 0 010-5.303m5.304 0a3.75 3.75 0 010 5.303m-7.425 2.122a6.75 6.75 0 010-9.546m9.546 0a6.75 6.75 0 010 9.546M5.106 18.894c-3.808-3.808-3.808-9.98 0-13.789m13.788 0c3.808 3.808 3.808 9.981 0 13.79M12 12h.008v.007H12V12z"})}),nC=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v16.5c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9zm3.75 11.625a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})}),iC=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V19.5a2.25 2.25 0 002.25 2.25h5.25a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V19.5a2.25 2.25 0 002.25 2.25h5.25a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V19.5a2.25 2.25 0 002.25 2.25h5.25a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08"})}),xd={name:"RODRIGUEZ MARTINEZ CHRISTIAN JESUS",storeId:"798"},Jm={username:"cibercom",password:"password123"},Xn=[{label:"Dashboard",path:"dashboard",icon:IS},{label:"Emisin",icon:pr,children:[{label:"Facturar",path:"facturacion-articulos",icon:vf},{label:"Notas de crdito",path:"notas-credito",icon:wf},{label:"Complemento de pagos",path:"facturacion-complemento-pagos",icon:Ef},{label:"Retencin de pagos",path:"facturacion-retencion-pagos",icon:Zg},{label:"Carta Porte",path:"facturacion-carta-porte",icon:pr},{label:"Nminas",path:"facturacion-nominas",icon:kf},{label:"Factura Global",path:"facturacion-global",icon:pr}]},{label:"Cancelacin",icon:e1,children:[{label:"Cancelacin Masiva",path:"facturacion-cancelacion",icon:Wg}]},{label:"Consultas",icon:Pn,children:[{label:"Facturas",path:"consultas-facturas",icon:pr},{label:"SKU",path:"consultas-sku",icon:vf},{label:"Tickets",path:"consultas-tickets",icon:pr},{label:"Reportes",path:"consultas-reportes",icon:qm},{label:"REPs Sustituidos",path:"consultas-reps-sustituidos",icon:pr},{label:"Refactura",path:"refactura",icon:pr}]},{label:"Catlogos",icon:QS,children:[{label:"Productos o Servicios",path:"catalogos-productos-servicios",icon:vf},{label:"Clientes",path:"catalogos-clientes",icon:kf},{label:"Registro de Constancias",path:"registro-cfdi",icon:pr}]},{label:"Administracin",icon:bf,children:[{label:"Empleados",path:"admin-empleados",icon:xi},{label:"Tiendas",path:"admin-tiendas",icon:ko},{label:"Periodos por Perfil",path:"admin-periodos-perfil",icon:jn},{label:"Periodos Plataforma",path:"admin-periodos-plataforma",icon:jn},{label:"Kioscos",path:"admin-kioscos",icon:KS},{label:"Excepciones",path:"admin-excepciones",icon:Wm},{label:"Secciones",path:"admin-secciones",icon:JS}]},{label:"Reportes",icon:Wi,children:[{label:"Boletas No Auditadas",path:"reportes-boletas-no-auditadas",icon:hu},{label:"Reporte Ingreso-Facturacin",path:"reportes-ingreso-facturacion",icon:aC},{label:"Integracin Factura Global",path:"reportes-integracion-factura-global",icon:WS},{label:"Integracin Clientes",path:"reportes-integracion-clientes",icon:rC},{label:"Facturacin clientes posterior a Global",path:"reportes-facturacion-clientes-global",icon:Zg},{label:"Integracin Sustitucin CFDI",path:"reportes-integracion-sustitucion-cfdi",icon:pl},{label:"Control de emisin de REP",path:"reportes-control-emision-rep",icon:Ef},{label:"Reportes REPgcp",path:"reportes-repgcp",icon:Wi},{label:"Control de cambios",path:"reportes-control-cambios",icon:t1},{label:"Conciliacin",path:"reportes-conciliacion",icon:Wi},{label:"REPs Sustituidos (Fiscal)",path:"reportes-fiscales-reps-sustituidos",icon:pr},{label:"Reporte de Consulta Monederos",path:"reportes-consulta-monederos",icon:Yg},{label:"Reporte de Ventas Mquina Corporativas Serely Polu",path:"reportes-ventas-maquina-corporativas",icon:Wi},{label:"Rgimen de Facturacin No Misma Boleta",path:"reportes-regimen-facturacion-no-misma-boleta",icon:pr},{label:"Doble Facturacin Pendiente por Defencia",path:"reportes-doble-facturacion-pendiente",icon:Wm},{label:"Sustitucin en Proceso",path:"reportes-sustitucion-en-proceso",icon:pl},{label:"Cancelacin Sustitucin de Facturacin",path:"reportes-cancelacion-sustitucion-facturacion",icon:Wg},{label:"Saldo a Favor de Clientes",path:"reportes-saldo-favor-clientes",icon:wf},{label:"Orden de Mdulos y Facturacin",path:"reportes-orden-modulos-facturacion",icon:bf},{label:"Consulta de Usuarios",path:"reportes-consulta-usuarios",icon:kf},{label:"Consulta Tiendas de Total de Facturas Diarias",path:"reportes-consulta-tiendas-facturas-diarias",icon:ko},{label:"Validacin por Importe Intereses",path:"reportes-validacion-importe-intereses",icon:wf},{label:"Conciliacin Cambio de Sistema de Facturacin",path:"reportes-conciliacion-cambio-sistema",icon:pl},{label:"Control de Complementos de Pago (REP) Generados por Ventas Corporativas",path:"reportes-control-complementos-pago-rep",icon:Ef},{label:"Reporte por Factura de Mercanca de Monederos",path:"reportes-factura-mercancia-monederos",icon:Yg},{label:"Ventas Corporativas vs SAT",path:"reportes-ventas-corporativas-vs-sat",icon:Wi},{label:"Captura Libre Complemento de Pago (REP)",path:"reportes-captura-libre-complemento-pago",icon:MS},{label:"Conciliacin Sistema de Facturacin de Boletas vs SAT",path:"reportes-conciliacion-boletas-vs-sat",icon:pl},{label:"Reporte de Trazabilidad de Boletas Canceladas",path:"reportes-trazabilidad-boletas-canceladas",icon:t1},{label:"Estatus Actualizar SAT de CFDI por Peticin",path:"reportes-estatus-actualizar-sat-cfdi",icon:pl}]},{label:"Monitor",icon:sC,children:[{label:"Grficas",path:"monitor-graficas",icon:qm},{label:"Bitcora",path:"monitor-bitacora",icon:iC},{label:"Disponibilidad",path:"monitor-disponibilidad",icon:r1},{label:"Logs",path:"monitor-logs",icon:nC},{label:"Decodificador",path:"monitor-decodificador",icon:bf},{label:"Permisos",path:"monitor-permisos",icon:tC},{label:"Conexiones",path:"monitor-conexiones",icon:r1}]},{label:"Configuracin",icon:Ym,children:[{label:"Temas",path:"configuracion-temas",icon:US},{label:"Empresa",path:"configuracion-empresa",icon:ko},{label:"Mensajes de Correo",path:"configuracion-correo",icon:e1},{label:"Configuracin de Mens",path:"configuracion-menus",icon:Ym}]}];function Th(){const e=typeof import.meta<"u"?"/facturacion-backend/":"/";return(e.endsWith("/")?e:e+"/")+"images/cibercom-logo.svg"}const _0={primary:"#2E86AB",primaryDark:"#1E4A5F",secondary:"#1E4A5F",secondaryDark:"#0F2A3A",accent:"#0F2A3A",accentDark:"#2C5F7C"},qr=[{value:"MEX",label:"Mxico"},{value:"USA",label:"Estados Unidos"},{value:"CAN",label:"Canad"},{value:"otro",label:"Otro"}],gt=[{value:"601",label:"General de Ley Personas Morales"},{value:"605",label:"Sueldos y Salarios e Ingresos Asimilados a Salarios"},{value:"606",label:"Arrendamiento"},{value:"612",label:"Personas Fsicas con Actividades Empresariales y Profesionales"},{value:"616",label:"Sin obligaciones fiscales"},{value:"626",label:"Rgimen Simplificado de Confianza"}],yt=[{value:"G01",label:"Adquisicin de mercancas"},{value:"G03",label:"Gastos en general"},{value:"I08",label:"Otra maquinaria y equipo"},{value:"S01",label:"Sin efectos fiscales"},{value:"CP01",label:"Pagos"}],Ia=[{value:"S001",label:"Sucursal 1 (S001)"},{value:"S002",label:"Sucursal 2 (S002)"},{value:"S003",label:"Sucursal 3 (S003)"},{value:"S004",label:"Sucursal 4 (S004)"},{value:"S005",label:"Sucursal 5 (S005)"},{value:"Todas",label:"Todas las Sucursales"}],Sn=[{value:"S001",label:"Sucursal 1 (S001)"},{value:"S002",label:"Sucursal 2 (S002)"},{value:"S003",label:"Sucursal 3 (S003)"},{value:"S004",label:"Sucursal 4 (S004)"},{value:"S005",label:"Sucursal 5 (S005)"}],ss=[{value:"01",label:"Efectivo"},{value:"02",label:"Cheque nominativo"},{value:"03",label:"Transferencia electrnica de fondos"},{value:"04",label:"Tarjeta de crdito"},{value:"28",label:"Tarjeta de dbito"},{value:"99",label:"Por definir"}],ws=[{value:"PUE",label:"Pago en una sola exhibicin"},{value:"PPD",label:"Pago en parcialidades o diferido"}],oC=[{value:"Todas",label:"--Todas--"},{value:"I",label:"Ingreso"},{value:"E",label:"Egreso"},{value:"P",label:"Pago"}],lC=[{value:"Todas",label:"--Todas--"},{value:"Timbrada",label:"Timbrada"},{value:"Cancelada",label:"Cancelada"},{value:"Pendiente",label:"Pendiente"}],Rw=[{value:"opc1",label:"Opcin de justificacin 1"},{value:"opc2",label:"Opcin de justificacin 2"},{value:"opc3",label:"Otra justificacin"}],Dw=[{value:"I",label:"Factura (Ingreso)"},{value:"E",label:"Nota de crdito (Egreso)"},{value:"P",label:"Complemento de pago"}],pu=[{value:"H87",label:"Pieza (H87)"},{value:"KGM",label:"Kilogramo (KGM)"},{value:"EA",label:"Cada uno (EA)"},{value:"ACT",label:"Actividad (ACT)"},{value:"E48",label:"Unidad de servicio (E48)"}],gu=[{value:"0.16",label:"16%"},{value:"0.08",label:"8%"},{value:"0.00",label:"0%"},{value:"EXENTO",label:"Exento"}],Pw=[{value:"0.265",label:"26.5% (Gasolinas)"},{value:"0.53",label:"53% (Tabacos Labrados)"},{value:"0.08",label:"8% (Alimentos no bsicos alta densidad calrica)"},{value:"0.00",label:"0%"},{value:"EXENTO",label:"Exento"}],Zm=[{value:"A01",label:"Almacn Principal"},{value:"A02",label:"Almacn Secundario"},{value:"TODOS",label:"--SELECCIONAR--"}],Fh=[{value:"01",label:"Comprobante emitido con errores con relacin"},{value:"02",label:"Comprobante emitido con errores sin relacin"},{value:"03",label:"No se llev a cabo la operacin"},{value:"04",label:"Operacin nominativa relacionada en una factura global"},{value:"menu",label:"Sustitucin por men de artculos"}],cC=[{value:"01",label:"01 - Comprobante emitido con errores con relacin"},{value:"02",label:"02 - Comprobante emitido con errores sin relacin"},{value:"03",label:"03 - No se llev a cabo la operacin"},{value:"04",label:"04 - Operacin nominativa relacionada en una factura global"}],it=[{value:"01",label:"Enero"},{value:"02",label:"Febrero"},{value:"03",label:"Marzo"},{value:"04",label:"Abril"},{value:"05",label:"Mayo"},{value:"06",label:"Junio"},{value:"07",label:"Julio"},{value:"08",label:"Agosto"},{value:"09",label:"Septiembre"},{value:"10",label:"Octubre"},{value:"11",label:"Noviembre"},{value:"12",label:"Diciembre"},{value:"todos",label:"--SELECCIONA MES--"}],Ma=[{value:"E001",label:"Empresa Principal SA de CV"},{value:"E002",label:"Filial Servicios SC"},{value:"todas",label:"--SELECCIONA--"}],s1=["REPORTE DE CONSULTA MONEDEROS","REPORTE DE VENTAS MQUINA CORPORATIVAS SERELY POLU","RGIMEN DE FACTURACIN NO MISMA BOLETA","DOBLE FACTURACIN PENDIENTE POR DEFENCIA","SUSTITUCIN EN PROCESO","CANCELACIN SUSTITUCIN DE FACTURACIN","SALDO A FAVOR DE CLIENTES","ORDEN DE MODULOS Y FACTURACIN","CONSULTA DE USUARIOS","CONSULTA TIENDAS DE TOTAL DE FACTURAS DIARIAS Y VALIDACIN DEL IMPORTE TOTAL DE FACTURAS DIARIAS","VALIDACIN POR IMPORTE INTERESES","FACTURA POR SISTEMA DE FACTURACIN VS SAT","CONCILIACIN CAMBIO DE SISTEMA DE FACTURACIN","CONTROL DE COMPLEMENTOS DE PAGO (REP) GENERADOS POR VENTAS CORPORATIVAS","REPORTE POR FACTURA DE MERCANCA DE MONEDEROS","VENTAS CORPORATIVAS VS SAT","CAPTURA LIBRE COMPLEMENTO DE PAGO (REP)","CONCILIACIN SISTEMA DE FACTURACIN DE BOLETAS VS SAT","REPORTE DE TRAZABILIDAD DE BOLETAS CANCELADAS","ESTATUS ACTUALIZAR SAT DE CFDI POR PETICIN"],Qm=[{value:"jefe_credito",label:"Jefe de Crdito"},{value:"operador_credito",label:"Operador de Crdito"},{value:"admin_sis",label:"Administrador del Sistema"},{value:"cajero",label:"Cajero"}],A0=[{value:"facturacion",label:"Facturacin"},{value:"consultas",label:"Consultas"},{value:"admin",label:"Administracin"},{value:"reportes_fiscal",label:"Reportes Fiscales"},{value:"todos",label:"--SELECCIONA--"}],R0=[{value:"pos",label:"POS"},{value:"kiosko",label:"KIOSKO"},{value:"internet",label:"INTERNET"},{value:"todas",label:"--SELECCIONA--"}],ri=[{value:"web",label:"WEB"},{value:"pos",label:"POS"},{value:"internet",label:"Internet"},{value:"kiosco",label:"Kiosco"}],Bo=[{value:"101",label:"101 - MUEBLES"},{value:"102",label:"102 - ELECTRICOS"},{value:"103",label:"103 - EXT. GTIAS"},{value:"107",label:"107 - muebles"},{value:"116",label:"116 - MUEBLES DE JARDIN"},{value:"121",label:"121 - TAPETES Y ALFOMBRAS"},{value:"122",label:"122 - ALFOMBRAS Y PISOS"},{value:"123",label:"123 - FERRETERIA"},{value:"restaurante",label:"RESTAURANTE"},{value:"snack_bar",label:"SNACK BAR"}],ex=[{value:"-1",label:"-1 (CUALQUIERA)"},{value:"0",label:"0 - Cheque"},{value:"1",label:"1 - Cupn"},{value:"2",label:"2 - ValeMonedero Electrnico"},{value:"8",label:"8 - DILISA"},{value:"9",label:"9 - LPC"},{value:"10",label:"10 - Tarjetas externas"},{value:"11",label:"11 - LPC"}],D0=[{value:"pag_exhib",label:"Pagado en una sola exhibicin"},{value:"cred_dllo",label:"Credito Desarrollo"},{value:"nota_cred",label:"Nota de Credito"},{value:"seleccionar",label:"[Seleccionar]"}],Cn=[{value:"CON",label:"CON"},{value:"DEV",label:"DEV"},{value:"CRE",label:"CRE"},{value:"EMON",label:"EMON"}],P0=[{value:"PAGO",label:"PAGO"},{value:"INGRESO",label:"INGRESO"},{value:"EGRESO",label:"EGRESO"}],ax=[{value:"factura",label:"Factura"},{value:"nota_credito",label:"Nota de Crdito"},{value:"rep",label:"REP"},{value:"otro",label:"Otro"}],dC=[{id:"5",versionSistema:"v6",versionBroker:"v6",descripcion:"Hola mundo este es una prueba de creacin de versin con una breve descripcin para modelar en la notificacin que es un mensaje que se le muestra al administrador",fechaVersion:"2021-07-07 00:00:00.0"},{id:"4",versionSistema:"v5",versionBroker:"v5",descripcion:"test",fechaVersion:"2021-07-06 00:00:00.0"},{id:"1",versionSistema:"v3",versionBroker:"v3",descripcion:"TEST asdfsadfsdafdsafdsafjklasdjflkasjdflkjasdlfkjalskdfjlaksjdflkajsdlkfjalksdjflkajsdflkasjfdlkjasflkdj",fechaVersion:"2021-06-30 00:00:00.0"},{id:"2",versionSistema:"v3",versionBroker:"v3",descripcion:"Descripcion",fechaVersion:"2021-06-28 00:00:00.0"},{id:"0",versionSistema:"v4",versionBroker:"v4",descripcion:"Test",fechaVersion:"2021-06-26 00:00:00.0"},{id:"3",versionSistema:"v1",versionBroker:"v1",descripcion:"Alkjdflakjd",fechaVersion:"2021-06-25 00:00:00.0"}],uC=[{id:"doc1",identificador:"F001",tipo:"Factura",nombre:"cliente_a.xml",fechaArchivo:"2023-10-01",usuario:"admin",estatus:"Conciliado",fechaCarga:"2023-10-01",fechaValidacion:"2023-10-02"},{id:"doc2",identificador:"NC001",tipo:"Nota de Crdito",nombre:"devolucion_b.xml",fechaArchivo:"2023-10-03",usuario:"user1",estatus:"Pendiente",fechaCarga:"2023-10-03",fechaValidacion:""}],fC=({item:e,onNavItemClick:a,activePath:t})=>{var v,w;const[r,s]=N.useState(!1),{theme:i}=N.useContext(Kt),o=e.children&&e.children.length>0,l=()=>{o?s(!r):a(e.label,e.icon,e.path)};or.useEffect(()=>{var b,y,j,A;o&&((b=e.children)!=null&&b.some(E=>E.path===t))?s(!0):o&&!((y=e.children)!=null&&y.some(E=>E.path===t))&&e.path!==t&&((A=(j=Xn.find(F=>F.label===e.label))==null?void 0:j.children)!=null&&A.some(F=>F.path===t)||s(!1))},[t,o,e,e.children,e.path]);const c="flex items-center w-full p-2 sm:p-3 rounded-lg transition-colors duration-200 ease-in-out text-sm sm:text-base",u=i==="dark"?"text-gray-200 hover:text-white":"text-gray-700 hover:text-gray-900",d=i==="dark"?"hover:bg-gray-700":"hover:bg-gray-200";let f=!1;o&&t&&(f=((v=e.children)==null?void 0:v.some(b=>b.path===t))||!1);const m=e.path===t,x=m||f,h=i==="dark"?"bg-primary-dark":"bg-primary",g="text-white",p=e.icon;return n.jsxs("li",{className:"mb-1",children:[n.jsxs("button",{onClick:e.path&&!o?()=>a(e.label,e.icon,e.path):l,className:`${c} ${u} ${d} ${x?`${h} ${g}`:""}`,"aria-expanded":o?r:void 0,"aria-current":m?"page":void 0,children:[p&&n.jsx(p,{className:`w-4 h-4 sm:w-5 sm:h-5 mr-2 sm:mr-3 flex-shrink-0 ${x?g:i==="dark"?"text-gray-400":"text-gray-500"}`}),n.jsx("span",{className:"flex-1 text-left truncate",children:e.label}),o&&n.jsx(OS,{className:`w-4 h-4 transition-transform duration-200 ${r?"rotate-180":""} ${x?g:""}`})]}),o&&r&&n.jsx("ul",{className:"pl-4 sm:pl-6 mt-1 space-y-1",children:(w=e.children)==null?void 0:w.map(b=>n.jsx(mC,{item:b,onNavItemClick:a,activePath:t},b.path||b.label))})]})},mC=({item:e,onNavItemClick:a,activePath:t})=>{const{theme:r}=N.useContext(Kt),s=e.path===t,i="flex items-center w-full p-1.5 sm:p-2 pl-3 sm:pl-5 rounded-md transition-colors duration-200 ease-in-out text-xs sm:text-sm",o=r==="dark"?"text-gray-300 hover:text-white":"text-gray-600 hover:text-gray-900",l=r==="dark"?"hover:bg-gray-600":"hover:bg-gray-100",c=r==="dark"?"bg-secondary-dark":"bg-secondary",u="text-white",d=e.icon;return n.jsx("li",{children:n.jsxs("button",{onClick:()=>a(e.label,e.icon,e.path),className:`${i} ${o} ${l} ${s?`${c} ${u}`:""}`,"aria-current":s?"page":void 0,children:[d&&n.jsx(d,{className:`w-3 h-3 sm:w-4 sm:h-4 mr-1.5 sm:mr-2 flex-shrink-0 ${s?u:r==="dark"?"text-gray-400":"text-gray-500"}`}),n.jsx("span",{className:"truncate",children:e.label})]})})},xC=({navItems:e,isOpen:a,toggleSidebar:t,onNavItemClick:r,logoUrl:s,appName:i})=>{const[o,l]=N.useState("dashboard");console.log("=== SIDEBAR RECIBE ==="),console.log("Total navItems:",e.length),e.forEach(u=>{u.children&&console.log(`${u.label}: ${u.children.length} children`,u.children.map(d=>d.label))});const c=(u,d,f)=>{r(u,d,f),f&&l(f)};return n.jsxs(n.Fragment,{children:[a&&n.jsx("div",{className:"fixed inset-0 z-30 bg-black opacity-50 md:hidden",onClick:t,"aria-hidden":"true"}),n.jsxs("aside",{className:`fixed inset-y-0 left-0 z-40 flex flex-col bg-white dark:bg-gray-800 shadow-lg transform ${a?"translate-x-0":"-translate-x-full"} md:relative md:translate-x-0 transition-transform duration-300 ease-in-out w-56 sm:w-64 md:w-72 border-r border-gray-200 dark:border-gray-700 flex-shrink-0`,"aria-label":"Main navigation",children:[n.jsxs("div",{className:"flex items-center justify-between p-2 sm:p-4 border-b border-gray-200 dark:border-gray-700 h-14 sm:h-16 flex-shrink-0",children:[n.jsx("div",{className:"flex items-center min-w-0",children:s?n.jsx("img",{src:s,alt:`${i} Logo`,className:"h-8 sm:h-12 mr-2 sm:mr-3 object-contain flex-shrink-0"}):n.jsx("span",{className:"text-sm sm:text-xl font-semibold text-primary dark:text-primary-dark truncate",children:i})}),n.jsx("button",{onClick:t,className:"md:hidden p-1 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary-dark flex-shrink-0","aria-label":"Close sidebar",children:n.jsx(Nh,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),n.jsx("nav",{className:"flex-1 p-2 sm:p-4 space-y-2 overflow-y-auto overflow-x-hidden",children:n.jsx("ul",{children:e.map(u=>n.jsx(fC,{item:u,onNavItemClick:c,activePath:o},u.path||u.label))})}),n.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:n.jsxs("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400",children:[" ",new Date().getFullYear()," ",i]})})]})]})},hC=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),pC=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})}),gC=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),Ow={nombre:"Empresa Ejemplo S.A. de C.V.",rfc:"EEJ920629TE3"},Iw=N.createContext({empresaInfo:Ow,setEmpresaInfo:()=>{}}),yC=({children:e})=>{const[a,t]=N.useState(()=>{const r=localStorage.getItem("empresaInfo");return r?JSON.parse(r):Ow});return n.jsx(Iw.Provider,{value:{empresaInfo:a,setEmpresaInfo:t},children:e})},On=()=>N.useContext(Iw),vC=({user:e,toggleSidebar:a,onLogout:t,isSidebarOpen:r,isAuthenticated:s,ThemeToggleButton:i})=>{const{empresaInfo:o}=On(),[l,c]=N.useState(null),[u,d]=N.useState(!1),f=or.useRef(null);return N.useEffect(()=>{const m=()=>{if(s){const p=localStorage.getItem("nombreEmpleado"),v=localStorage.getItem("perfil");if(p){let w="Sin perfil";if(v)try{if(v.trim().startsWith("{")){const b=JSON.parse(v);w=(b==null?void 0:b.nombrePerfil)||(b==null?void 0:b.nombre)||"Sin perfil"}else w=v}catch(b){console.warn("Error al parsear perfil:",b),w=v!=="null"&&v!=="undefined"?v:"Sin perfil"}c({name:p,perfil:w})}}else c(null)};m();const x=p=>{(p.key==="perfil"||p.key==="nombreEmpleado")&&m()},h=()=>{m()};window.addEventListener("storage",x),window.addEventListener("localStorageChange",h);const g=setInterval(m,2e3);return()=>{window.removeEventListener("storage",x),window.removeEventListener("localStorageChange",h),clearInterval(g)}},[s]),N.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]),n.jsxs("header",{className:"bg-white dark:bg-gray-800 shadow-md min-h-16 flex items-center justify-between px-2 sm:px-4 md:px-6 sticky top-0 z-20 border-b border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[s&&!r&&n.jsx("button",{onClick:a,className:"md:hidden p-2 mr-1 sm:mr-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex-shrink-0","aria-label":"Open sidebar",children:n.jsx(hC,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 md:gap-6 min-w-0 flex-1",children:[n.jsx("h1",{className:"text-xs sm:text-sm md:text-lg font-semibold text-gray-700 dark:text-gray-200 truncate",children:"Sistema de Facturacin Cibercom"}),n.jsx("div",{className:"hidden sm:flex items-center gap-2 md:gap-3 text-gray-600 dark:text-gray-400 border-l border-gray-200 dark:border-gray-700 pl-3 md:pl-6 flex-shrink-0",children:n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-xs md:text-sm font-medium truncate max-w-[120px] md:max-w-none",children:o.nombre}),n.jsxs("p",{className:"text-[10px] md:text-xs truncate",children:["RFC: ",o.rfc]})]})}),n.jsxs("div",{className:"sm:hidden text-gray-600 dark:text-gray-400 text-xs",children:[n.jsx("p",{className:"truncate max-w-[120px]",children:o.nombre}),n.jsxs("p",{className:"truncate",children:["RFC: ",o.rfc]})]})]})]}),n.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2 md:space-x-4 flex-shrink-0",children:[i,s&&n.jsxs("div",{className:"relative z-50",onMouseEnter:()=>{f.current&&(clearTimeout(f.current),f.current=null),d(!0)},onMouseLeave:()=>{f.current=setTimeout(()=>{d(!1)},300)},children:[n.jsxs("button",{onClick:()=>d(!u),className:"flex items-center p-1.5 sm:p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors flex-shrink-0","aria-haspopup":"true","aria-expanded":u,"aria-label":`User menu for ${(l==null?void 0:l.name)||e.name}`,children:[n.jsx(pC,{className:"w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7"}),n.jsx("span",{className:"hidden lg:inline ml-2 text-sm",children:(l==null?void 0:l.name.split(" ")[0])||e.name.split(" ")[0]})]}),u&&n.jsxs("div",{className:"absolute right-0 mt-2 w-56 sm:w-64 bg-white dark:bg-gray-800 rounded-md shadow-lg py-2 z-[9999] ring-1 ring-black ring-opacity-5 dark:ring-gray-700 transition-opacity duration-200 ease-in-out",role:"menu","aria-orientation":"vertical","aria-labelledby":"user-menu-button",onMouseEnter:()=>{f.current&&(clearTimeout(f.current),f.current=null)},children:[n.jsxs("div",{className:"px-3 sm:px-4 py-2 border-b border-gray-200 dark:border-gray-700",children:[n.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 dark:text-white truncate",id:"user-name-full",children:(l==null?void 0:l.name)||e.name}),n.jsxs("p",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400 truncate",children:["Perfil: ",(l==null?void 0:l.perfil)||"Sin perfil"]})]}),n.jsxs("button",{onClick:()=>{d(!1),t()},className:"w-full text-left flex items-center px-3 sm:px-4 py-2 text-xs sm:text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-primary dark:hover:text-primary-dark transition-colors",role:"menuitem",children:[n.jsx(gC,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 flex-shrink-0","aria-hidden":"true"}),"Salir"]})]})]})]})]})},bC=({pageTitle:e,children:a})=>n.jsxs("main",{className:"flex-1 overflow-x-auto overflow-y-auto bg-gray-100 dark:bg-gray-900 p-2 sm:p-4 md:p-6 min-w-0",children:[n.jsx("div",{className:"mb-4 sm:mb-6",children:n.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 dark:text-gray-100",children:e})}),n.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-lg p-3 sm:p-4 md:p-6 min-w-0",children:a})]}),fe=({children:e,variant:a="primary",size:t="md",className:r="",...s})=>{let i="rounded-md font-medium shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed";switch(t){case"sm":i+=" px-2 py-1 text-xs";break;case"md":i+=" px-4 py-2 text-sm";break;case"lg":i+=" px-6 py-3 text-base";break}const o="bg-primary text-white hover:bg-primary-dark focus:ring-primary",l="dark:bg-primary dark:text-white dark:hover:bg-primary-dark dark:focus:ring-primary",c="bg-secondary text-white hover:bg-secondary-dark focus:ring-secondary",u="dark:bg-secondary dark:text-white dark:hover:bg-secondary-dark dark:focus:ring-secondary",d="bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",f="dark:bg-red-500 dark:text-white dark:hover:bg-red-600 dark:focus:ring-red-500",m="bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-400",x="dark:bg-gray-600 dark:text-gray-100 dark:hover:bg-gray-500 dark:focus:ring-gray-500",h="border-2 border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-gray-400 bg-transparent",g="dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700 dark:focus:ring-gray-500";switch(a){case"primary":i+=` ${o} ${l}`;break;case"secondary":i+=` ${c} ${u}`;break;case"danger":i+=` ${d} ${f}`;break;case"neutral":i+=` ${m} ${x}`;break;case"outline":i+=` ${h} ${g}`;break}return n.jsx("button",{className:`${i} ${r}`,...s,children:e})},J=N.forwardRef(({label:e,name:a,type:t="text",value:r,onChange:s,placeholder:i,required:o=!1,className:l="",disabled:c=!1,maxLength:u,error:d=!1,leftIcon:f,children:m,step:x,min:h,onFocus:g,onKeyPress:p},v)=>{const{theme:w}=N.useContext(Kt),b=a||`input-${e.toLowerCase().replace(/\s+/g,"-")}`,y="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 sm:text-sm transition-colors duration-200",j="border-gray-300 placeholder-gray-400 focus:ring-primary focus:border-primary bg-white text-gray-900",A="dark:border-gray-600 dark:placeholder-gray-500 dark:focus:ring-secondary dark:focus:border-secondary dark:bg-gray-700 dark:text-gray-100",E="disabled:bg-gray-100 disabled:dark:bg-gray-800 disabled:text-gray-500 disabled:dark:text-gray-400 disabled:cursor-not-allowed",F=d?"border-red-600 focus:ring-red-600 focus:border-red-600":"";return n.jsxs("div",{className:`mb-1 ${l}`,children:[n.jsxs("label",{htmlFor:b,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e,o&&n.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n.jsxs("div",{className:"relative",children:[f&&n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f}),n.jsx("input",{ref:v,type:t,name:b,id:b,value:r,onChange:s,onFocus:g,onKeyPress:p,placeholder:i||`Ingrese ${e.toLowerCase()}`,required:o,disabled:c,maxLength:u,step:x,min:h,className:`${y} ${f?"pl-10":""} ${w==="light"?j:A} ${E} ${F}`})]}),m]})}),wC=({onLogin:e,logoUrl:a,appName:t})=>{const[r,s]=N.useState(""),[i,o]=N.useState(""),[l,c]=N.useState(""),[u,d]=N.useState(!1),f=async m=>{m.preventDefault(),c(""),d(!0);try{await e(r,i)}catch(x){x instanceof Error&&x.message?c(x.message):c("Error de conexin con el servidor.")}finally{d(!1)}};return n.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-300 p-4",children:n.jsxs("div",{className:"w-full max-w-md",children:[n.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-lg p-8",children:[n.jsxs("div",{className:"flex flex-col items-center mb-6",children:[a?n.jsx("img",{src:a,alt:`${t} Logo`,className:"h-12 mb-4 object-contain"}):t&&n.jsx("h1",{className:"text-3xl font-bold text-primary dark:text-primary-dark mb-4",children:t}),n.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-gray-100",children:"Iniciar Sesin"})]}),n.jsxs("form",{onSubmit:f,className:"space-y-6",children:[n.jsx(J,{label:"Usuario",name:"username",value:r,onChange:m=>s(m.target.value),placeholder:"Ingrese su usuario",required:!0}),n.jsx(J,{label:"Contrasea",name:"password",type:"password",value:i,onChange:m=>o(m.target.value),placeholder:"Ingrese su contrasea",required:!0}),l&&n.jsx("p",{className:"text-sm text-red-500 dark:text-red-400 text-center",role:"alert",children:l}),n.jsx(fe,{type:"submit",variant:"primary",className:"w-full !py-3 text-base",disabled:u,children:u?"Ingresando...":"Ingresar"})]})]}),n.jsxs("p",{className:"mt-6 text-center text-sm text-gray-600 dark:text-gray-400",children:[" ",new Date().getFullYear()," ",t||"Cibercom",". Todos los derechos reservados."]})]})})},ve=({title:e,children:a,className:t=""})=>n.jsxs("div",{className:`bg-white dark:bg-gray-800 shadow-md rounded-lg p-1 ${t} border border-gray-200 dark:border-gray-700`,children:[e&&n.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700 sm:px-6",children:n.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-gray-100",children:e})}),n.jsx("div",{className:"p-4 sm:p-6",children:a})]}),EC=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),yu=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),Xs=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.56 0c1.153 0 2.242.078 3.324.225m8.916-3.128a48.108 48.108 0 01-3.478-.397m-12.56 0c-1.153 0-2.242.078-3.324.225m8.916 3.128L13.11 3.646A2.25 2.25 0 0115.356 2.25H8.644a2.25 2.25 0 01-2.246 1.396L4.05 5.79m1.405-3.128L5.44 3.246A2.25 2.25 0 017.684 1.875h8.632a2.25 2.25 0 012.244 1.371l.935 2.373M19.5 5.79V5.25A2.25 2.25 0 0017.25 3H6.75A2.25 2.25 0 004.5 5.25v.54"})}),hd=({className:e="h-5 w-5"})=>n.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})});function kC(){var i,o;const e=(o=(i=import.meta)==null?void 0:i.env)==null?void 0:o.VITE_API_BASE_URL;if(e)return e;if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname==="")return"http://localhost:8080/api";const t=window.location.pathname;let r="";return t.startsWith("/facturacion-backend"),r="/facturacion-backend",`${window.location.protocol}//${window.location.host}${r}/api`}const tn=kC().replace(/\/+$/,"");function NC(){var r,s;const e=(s=(r=import.meta)==null?void 0:r.env)==null?void 0:s.VITE_PAC_BASE_URL;return e||(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname===""?"http://localhost:8081/api":`${window.location.protocol}//${window.location.host}/cib-ms-cdp/api`)}const jC=NC().replace(/\/+$/,"");function Re(e){const a=e.startsWith("/")?e:`/${e}`;return`${tn}${a}`}function SC(){try{const e=window.localStorage.getItem("perfil");if(e)try{const t=JSON.parse(e);if((t==null?void 0:t.idUsuario)!=null&&t.idUsuario!==void 0&&/^\d+$/.test(String(t.idUsuario)))return String(t.idUsuario);if((t==null?void 0:t.idDfi)!=null&&t.idDfi!==void 0&&/^\d+$/.test(String(t.idDfi)))return String(t.idDfi);if((t==null?void 0:t.idPerfil)!=null&&t.idPerfil!==void 0&&/^\d+$/.test(String(t.idPerfil)))return String(t.idPerfil);console.warn("No se encontr ID numrico vlido en el perfil. Perfil:",t)}catch(t){console.error("Error al parsear perfil:",t)}else console.warn("No se encontr perfil en localStorage");const a=window.localStorage.getItem("session.idUsuario");if(a&&/^\d+$/.test(a)){const t=window.localStorage.getItem("perfil");if(t)try{const r=JSON.parse(t);if(r!=null&&r.noUsuario&&String(r.noUsuario)===a)return console.warn("session.idUsuario contiene noUsuario, no se usar. Buscando ID real..."),(r==null?void 0:r.idPerfil)!=null&&/^\d+$/.test(String(r.idPerfil))?String(r.idPerfil):"0"}catch{}return a}return console.error("No se encontr ID numrico vlido del usuario"),"0"}catch(e){return console.error("Error en getUsuarioId():",e),"0"}}function Ca(e={}){const a={"Content-Type":"application/json",...e},t=SC();return t&&t!=="0"&&(a["X-Usuario"]=t),a}function kr(e){const a=e.startsWith("/")?e:`/${e}`;return`${jC}${a}`}class uo{constructor(){this.baseUrl=Re("/dashboard")}static getInstance(){return uo.instance||(uo.instance=new uo),uo.instance}async obtenerEstadisticas(){try{const a=await fetch(`${this.baseUrl}/estadisticas`);if(!a.ok)throw new Error(`Error HTTP ${a.status}: ${a.statusText}`);return await a.json()}catch(a){return console.error("Error obteniendo estadsticas del dashboard:",a),{exitoso:!1,mensaje:a instanceof Error?a.message:"Error desconocido"}}}async consultarFacturasSustituidas(a,t){try{let r=`${this.baseUrl}/facturas-sustituidas`;const s=new URLSearchParams;a&&s.append("fechaInicio",a),t&&s.append("fechaFin",t),s.toString()&&(r+="?"+s.toString());const i=await fetch(r);if(!i.ok)throw new Error(`Error HTTP ${i.status}: ${i.statusText}`);return await i.json()}catch(r){return console.error("Error consultando facturas sustituidas:",r),{exitoso:!1,mensaje:r instanceof Error?r.message:"Error desconocido",facturas:[]}}}async consultarFacturasPorUsuario(a,t,r){try{let s=`${this.baseUrl}/facturas-por-usuario`;const i=new URLSearchParams;a&&i.append("usuario",a),t&&i.append("fechaInicio",t),r&&i.append("fechaFin",r),i.toString()&&(s+="?"+i.toString());const o=await fetch(s);if(!o.ok)throw new Error(`Error HTTP ${o.status}: ${o.statusText}`);return await o.json()}catch(s){return console.error("Error consultando facturas por usuario:",s),{exitoso:!1,mensaje:s instanceof Error?s.message:"Error desconocido",usuarios:[]}}}}const _h=uo.getInstance(),CC=({datos:e})=>{const a=["facturas","notas","tickets"],t=["#3B82F6","#F59E0B","#EF4444"];if(!e||e.length===0)return n.jsx("div",{className:"w-full text-center py-8 text-gray-500 dark:text-gray-400",children:"No hay datos disponibles para mostrar"});const r=Math.max(...e.flatMap(s=>[(s.facturas||0)+(s.notas||0)+(s.tickets||0)]));return n.jsxs("div",{className:"w-full",children:[n.jsx("div",{className:"flex items-center justify-center mb-4 space-x-6 flex-wrap",children:a.map((s,i)=>n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-4 h-4 mr-2 rounded-sm",style:{backgroundColor:t[i]}}),n.jsx("span",{className:"text-sm capitalize text-gray-700 dark:text-gray-300",children:s})]},i))}),n.jsx("div",{className:"flex items-end justify-between h-64 w-full",children:e.map((s,i)=>{const o=s.facturas||0,l=s.notas||0,c=s.tickets||0,u=o+l+c,d=r>0?u/r*100:0,f=u>0?o/u*d:0,m=u>0?l/u*d:0,x=u>0?c/u*d:0,h=0,g=f,p=f+m;return n.jsxs("div",{className:"flex flex-col items-center",style:{width:`${100/e.length}%`},children:[n.jsxs("div",{className:"relative w-full flex flex-col items-center justify-end h-56",children:[o>0&&n.jsx("div",{className:"w-5/6 absolute rounded-t-sm transition-all duration-300 hover:opacity-90",style:{height:`${f}%`,bottom:`${h}%`,backgroundColor:t[0],zIndex:3},title:`Facturas: ${o}`}),l>0&&n.jsx("div",{className:"w-5/6 absolute rounded-t-sm transition-all duration-300 hover:opacity-90",style:{height:`${m}%`,bottom:`${g}%`,backgroundColor:t[1],zIndex:2},title:`Notas de Crdito: ${l}`}),c>0&&n.jsx("div",{className:"w-5/6 absolute rounded-t-sm transition-all duration-300 hover:opacity-90",style:{height:`${x}%`,bottom:`${p}%`,backgroundColor:t[2],zIndex:1},title:`Tickets: ${c}`})]}),n.jsx("span",{className:"text-xs mt-2 text-gray-600 dark:text-gray-300 text-center",children:s.mes})]},i)})})]})},TC=({setActivePage:e})=>{const[a,t]=N.useState(null),[r,s]=N.useState([]),[i,o]=N.useState([]),[l,c]=N.useState(!0),[u,d]=N.useState(!1),[f,m]=N.useState(null),[x,h]=N.useState(!1);N.useEffect(()=>{(async()=>{c(!0);try{const j=await _h.obtenerEstadisticas();j.exitoso?(t(j.estadisticasRapidas||null),s(j.datosGrafico||[]),o(j.ultimasFacturas||[])):console.error("Error cargando estadsticas:",j.mensaje)}catch(j){console.error("Error obteniendo estadsticas:",j)}finally{c(!1)}})()},[]),N.useEffect(()=>{if(f)try{window.URL.revokeObjectURL(f)}catch{}},[f]);const g=()=>{e("facturacion-articulos")},p=async y=>{if(y){d(!0),h(!0),m(null);try{const j=await fetch(Re(`/factura/descargar-pdf/${y}`));if(!j.ok)throw new Error(`Error al obtener PDF (HTTP ${j.status})`);const A=await j.blob(),E=window.URL.createObjectURL(A);m(E)}catch(j){console.error("Error al cargar PDF:",j),alert(`Error al cargar la vista previa: ${j instanceof Error?j.message:"Error desconocido"}`),d(!1)}finally{h(!1)}}},v=()=>{d(!1),f&&(window.URL.revokeObjectURL(f),m(null))},w=y=>y==null?"$0.00":new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(y),b=y=>{if(!y)return"";try{return new Date(y).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric"})}catch{return y}};return n.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.jsx(ve,{title:"Resumen General",children:n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center mb-3",children:[n.jsx(qm,{className:"w-8 h-8 mr-3 text-primary dark:text-secondary"}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:"Estadsticas Rpidas"}),n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Visualiza el rendimiento clave."})]})]}),l?n.jsx("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"Cargando..."}):a?n.jsx("div",{className:"mt-4",children:n.jsxs("dl",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between py-1",children:[n.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Facturas Hoy:"}),n.jsx("dd",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:a.facturasHoy||0})]}),n.jsxs("div",{className:"flex justify-between py-1",children:[n.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Facturas del Mes:"}),n.jsx("dd",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:a.facturasMes||0})]}),n.jsxs("div",{className:"flex justify-between py-1",children:[n.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Facturas del Ao:"}),n.jsx("dd",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:a.facturasAnio||0})]}),n.jsxs("div",{className:"flex justify-between py-1 border-t border-gray-200 dark:border-gray-700 pt-2 mt-2",children:[n.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ingresos Hoy:"}),n.jsx("dd",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:w(a.ingresosHoy)})]}),n.jsxs("div",{className:"flex justify-between py-1",children:[n.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ingresos del Mes:"}),n.jsx("dd",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:w(a.ingresosMes)})]}),n.jsxs("div",{className:"flex justify-between py-1",children:[n.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ingresos del Ao:"}),n.jsx("dd",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:w(a.ingresosAnio)})]})]})}):n.jsx("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"No hay datos disponibles"})]})}),n.jsx(ve,{title:"Facturas Recientes",children:n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center mb-3",children:[n.jsx(pr,{className:"w-8 h-8 mr-3 text-primary dark:text-secondary"}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:"ltimas Facturas"}),n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Generadas recientemente."})]})]}),l?n.jsx("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"Cargando..."}):i.length>0?n.jsxs(n.Fragment,{children:[n.jsx("ul",{className:"space-y-2 mt-2",children:i.slice(0,3).map((y,j)=>n.jsx("li",{onClick:()=>y.uuid&&p(y.uuid),className:"text-sm text-gray-600 dark:text-gray-300 p-2 bg-gray-50 dark:bg-gray-700 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors cursor-pointer",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:y.serie&&y.folio?`Factura ${y.serie}-${y.folio}`:y.uuid?`Factura ${y.uuid.substring(0,8)}...`:`Factura #${j+1}`}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:y.receptorRazonSocial||"Sin receptor"}),y.fechaFactura&&n.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:b(y.fechaFactura)})]}),n.jsx("div",{className:"font-semibold text-gray-700 dark:text-gray-200 ml-2",children:w(y.total)})]})},y.uuid||j))}),i.length>3&&n.jsx("button",{onClick:()=>e("consultas-facturas"),className:"mt-4 text-sm text-primary dark:text-white hover:underline cursor-pointer",children:"Ver todas las facturas"})]}):n.jsx("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"No hay facturas recientes"})]})}),n.jsx(ve,{title:"Acciones Rpidas",children:n.jsxs("div",{className:"p-3",children:[n.jsxs("div",{className:"flex items-center mb-2",children:[n.jsx(Ym,{className:"w-6 h-6 mr-2 text-primary dark:text-secondary"}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-base font-semibold text-gray-800 dark:text-gray-100",children:"Accesos Directos"}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Tareas comunes."})]})]}),n.jsx("div",{className:"mt-2",children:n.jsx("button",{className:"w-full text-left p-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",onClick:g,children:"Nueva Factura de Artculos"})})]})})]}),n.jsx(ve,{title:"Estadsticas de Facturacin por Mes",children:n.jsx("div",{className:"p-6",children:l?n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Cargando datos del grfico..."}):n.jsxs(n.Fragment,{children:[n.jsx(CC,{datos:r}),n.jsx("div",{className:"mt-4 text-center",children:n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Comparativa mensual de documentos generados en el sistema (Facturas, Notas de Crdito y Tickets)"})})]})})}),u&&n.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/60",children:n.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg w-[95vw] max-w-5xl overflow-hidden",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 dark:border-gray-700",children:[n.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:"Vista previa PDF"}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{type:"button",className:"px-3 py-1 text-sm rounded bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700",onClick:v,children:"Cerrar"})})]}),n.jsx("div",{className:"p-0",children:x?n.jsx("div",{className:"p-6 text-center text-gray-700 dark:text-gray-200",children:"Cargando PDF"}):n.jsx("iframe",{src:f||"",title:"Visor PDF",className:"w-full h-[80vh]"})})]})}),n.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out forwards;
        }
      `})]})},FC="modulepreload",_C=function(e){return"/facturacion-backend/"+e},n1={},No=function(a,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(c=>{if(c=_C(c),c in n1)return;n1[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":FC,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((m,x)=>{f.addEventListener("load",m),f.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return a().catch(i)})};class fo{static getInstance(){return fo.instance||(fo.instance=new fo),fo.instance}getLogoSrc(a,t){if(t&&t.trim()){const r=t.trim();return/^data:image\//i.test(r)?r:`data:image/svg+xml;base64,${r}`}return a||(typeof import.meta<"u"?"/facturacion-backend/":"/")+"images/cibercom-logo.svg"}cargarScript(a){return new Promise((t,r)=>{if(Array.from(document.getElementsByTagName("script")).find(o=>o.src===a))return t();const i=document.createElement("script");i.src=a,i.async=!0,i.crossOrigin="anonymous",i.referrerPolicy="no-referrer",i.onload=()=>t(),i.onerror=()=>r(new Error(`No se pudo cargar script: ${a}`)),document.head.appendChild(i)})}async asegurarMotorPDF(){var t,r,s;const a=window;if(typeof a.html2pdf!="function"){try{const i=await No(()=>import("./html2pdf-Dl1fu7qR.js").then(o=>o.h),__vite__mapDeps([0,1,2]));a.html2pdf=i.default||i}catch{}if(typeof a.html2pdf!="function"){try{const i=await No(()=>import("./html2canvas.esm-DZlvpFNH.js").then(o=>o.h),[]);a.html2canvas=i.default||i}catch{}try{const i=await No(()=>import("./jspdf.es.min-E-dsLDt-.js").then(l=>l.j),[]),o=i.jsPDF||((t=i.default)==null?void 0:t.jsPDF)||i.default||i;o&&(a.jspdf={jsPDF:o},a.jsPDF=o)}catch{}}if(typeof a.html2pdf!="function"&&!(typeof a.html2canvas=="function"&&((r=a.jspdf)!=null&&r.jsPDF||a.jsPDF)))try{await this.cargarScript("https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js")}catch{try{await this.cargarScript("https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"),await this.cargarScript("https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js")}catch{}}if(typeof a.html2pdf!="function"&&!(typeof a.html2canvas=="function"&&((s=a.jspdf)!=null&&s.jsPDF||a.jsPDF)))throw new Error("Motor de PDF no disponible (html2pdf/jsPDF/html2canvas)")}}async generarPDFFactura(a,t){try{const r=this.generarHTMLFactura(a,t);return await this.convertirHTMLaPDF(r)}catch(r){throw console.error("Error generando PDF:",r),new Error("Error al generar el PDF de la factura")}}generarHTMLFactura(a,t){const{customColors:r,logoUrl:s,logoBase64:i}=t,o=this.getLogoSrc(s,i);return`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Factura ${a.serie}-${a.folio}</title>
        <style>
          * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
          }
          
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            line-height: 1.4;
            color: #333;
          }
          
          .factura-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: white;
          }
          
          .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 30px;
            border-bottom: 2px solid ${r.primary};
            padding-bottom: 20px;
          }
          
          .logo-section {
            flex: 1;
          }
          
          .logo {
            max-width: 200px;
            max-height: 80px;
            object-fit: contain;
          }
          
          .factura-info {
            flex: 1;
            text-align: right;
          }
          
          .factura-titulo {
            font-size: 24px;
            font-weight: bold;
            color: ${r.primary};
            margin-bottom: 10px;
          }
          
          .factura-numero {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
          }
          
          .emisor-receptor {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
          }
          
          .emisor, .receptor {
            flex: 1;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
          }
          
          .emisor {
            margin-right: 15px;
            background-color: ${r.secondary}20;
          }
          
          .receptor {
            margin-left: 15px;
            background-color: ${r.accent}20;
          }
          
          .seccion-titulo {
            font-weight: bold;
            font-size: 14px;
            color: ${r.primary};
            margin-bottom: 10px;
            border-bottom: 1px solid ${r.primary};
            padding-bottom: 5px;
          }
          
          .conceptos-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
          }
          
          .conceptos-table th {
            background-color: ${r.primary};
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: bold;
          }
          
          .conceptos-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #ddd;
          }
          
          .conceptos-table tr:nth-child(even) {
            background-color: #f9f9f9;
          }
          
          .totales {
            float: right;
            width: 300px;
            margin-bottom: 30px;
          }
          
          .totales-table {
            width: 100%;
            border-collapse: collapse;
          }
          
          .totales-table td {
            padding: 8px 12px;
            border: 1px solid #ddd;
          }
          
          .totales-table .label {
            background-color: ${r.secondary};
            color: white;
            font-weight: bold;
            text-align: right;
          }
          
          .totales-table .total-final {
            background-color: ${r.primary};
            color: white;
            font-weight: bold;
            font-size: 14px;
          }
          
          .sellos {
            clear: both;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
          }
          
          .sello {
            margin-bottom: 15px;
            word-break: break-all;
            font-size: 10px;
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 3px;
          }
          
          .text-right {
            text-align: right;
          }
          
          .text-center {
            text-align: center;
          }
          
          @media print {
            body {
              margin: 0;
            }
            
            .factura-container {
              max-width: none;
              margin: 0;
              padding: 15px;
            }
          }
        </style>
      </head>
      <body>
        <div class="factura-container">
          <!-- Header -->
          <div class="header">
            <div class="logo-section">
              <img src="${o}" alt="Logo" class="logo" />
            </div>
            <div class="factura-info">
              <div class="factura-titulo">FACTURA</div>
              <div class="factura-numero">${a.serie}-${a.folio}</div>
              <div><strong>UUID:</strong> ${a.uuid}</div>
              <div><strong>Fecha:</strong> ${new Date(a.fechaEmision).toLocaleDateString("es-MX")}</div>
            </div>
          </div>
          
          <!-- Emisor y Receptor -->
          <div class="emisor-receptor">
            <div class="emisor">
              <div class="seccion-titulo">EMISOR</div>
              <div><strong>Nombre:</strong> ${a.nombreEmisor}</div>
              <div><strong>RFC:</strong> ${a.rfcEmisor}</div>
            </div>
            <div class="receptor">
              <div class="seccion-titulo">RECEPTOR</div>
              <div><strong>Nombre:</strong> ${a.nombreReceptor}</div>
              <div><strong>RFC:</strong> ${a.rfcReceptor}</div>
            </div>
          </div>
          
          <!-- Conceptos -->
          <table class="conceptos-table">
            <thead>
              <tr>
                <th>Descripcin</th>
                <th class="text-center">Cantidad</th>
                <th class="text-center">Unidad</th>
                <th class="text-right">Precio Unitario</th>
                <th class="text-right">Importe</th>
              </tr>
            </thead>
            <tbody>
              ${a.conceptos.map(l=>`
                <tr>
                  <td>${l.descripcion}</td>
                  <td class="text-center">${l.cantidad}</td>
                  <td class="text-center">${l.unidad}</td>
                  <td class="text-right">$${l.precioUnitario.toFixed(2)}</td>
                  <td class="text-right">$${l.importe.toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          
          <!-- Totales -->
          <div class="totales">
            <table class="totales-table">
              <tr>
                <td class="label">Subtotal:</td>
                <td class="text-right">$${a.subtotal.toFixed(2)}</td>
              </tr>
              <tr>
                <td class="label">IVA:</td>
                <td class="text-right">$${a.iva.toFixed(2)}</td>
              </tr>
              ${a.ieps?`
                <tr>
                  <td class="label">IEPS:</td>
                  <td class="text-right">$${a.ieps.toFixed(2)}</td>
                </tr>
              `:""}
              <tr>
                <td class="label total-final">Total:</td>
                <td class="text-right total-final">$${a.importe.toFixed(2)}</td>
              </tr>
            </table>
          </div>
          
          <!-- Informacin de pago -->
          <div style="clear: both; margin-top: 20px;">
            <div><strong>Mtodo de Pago:</strong> ${a.metodoPago}</div>
            <div><strong>Forma de Pago:</strong> ${a.formaPago}</div>
            <div><strong>Uso CFDI:</strong> ${a.usoCFDI}</div>
          </div>
          
          <!-- Sellos digitales -->
          ${a.selloDigital||a.selloCFD?`
            <div class="sellos">
              <div class="seccion-titulo">SELLOS DIGITALES</div>
              ${a.selloCFD?`
                <div class="sello">
                  <strong>Sello CFD:</strong><br>
                  ${a.selloCFD}
                </div>
              `:""}
              ${a.selloDigital?`
                <div class="sello">
                  <strong>Sello SAT:</strong><br>
                  ${a.selloDigital}
                </div>
              `:""}
              ${a.noCertificado?`
                <div><strong>No. Certificado:</strong> ${a.noCertificado}</div>
              `:""}
            </div>
          `:""}
        </div>
      </body>
      </html>
    `}async convertirHTMLaPDF(a,t="factura.pdf"){return new Promise(async(r,s)=>{var o;try{await this.asegurarMotorPDF()}catch(l){return s(l)}const i=document.createElement("div");i.innerHTML=a,i.style.position="absolute",i.style.left="-9999px",document.body.appendChild(i);try{const l={margin:10,filename:t,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,logging:!1},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}},c=window.html2pdf;if(typeof c=="function"){c().from(i).set(l).toPdf().get("pdf").then(f=>{const m=f.output("blob");document.body.removeChild(i),r(m)}).catch(f=>{document.body.removeChild(i),s(f)});return}const u=window.html2canvas,d=((o=window.jspdf)==null?void 0:o.jsPDF)||window.jsPDF;if(typeof u=="function"&&typeof d=="function"){u(i,l.html2canvas).then(f=>{const m=f.toDataURL("image/jpeg",.98),x=new d(l.jsPDF),h=x.internal.pageSize.getWidth(),g=x.internal.pageSize.getHeight();x.addImage(m,"JPEG",0,0,h,g);const p=x.output("blob");document.body.removeChild(i),r(p)}).catch(f=>{document.body.removeChild(i),s(f)});return}document.body.removeChild(i),s(new Error("Motor de PDF no disponible (html2pdf/jsPDF/html2canvas)"))}catch(l){document.body.removeChild(i),s(l)}})}descargarPDF(a,t){const r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}async crearZipFactura(a,t,r){try{const s=await this.generarPDFFactura(a,r);if(typeof window.JSZip<"u"){const i=new window.JSZip;return i.file(`${a.serie}-${a.folio}.xml`,t),i.file(`${a.serie}-${a.folio}.pdf`,s),await i.generateAsync({type:"blob"})}else throw new Error("JSZip no est disponible")}catch(s){throw console.error("Error creando ZIP:",s),new Error("Error al crear el archivo ZIP")}}descargarZip(a,t){const r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}async generarPDFNotaCredito(a,t){try{const r=this.generarHTMLNotaCredito(a,t);return await this.convertirHTMLaPDF(r,"nota_credito.pdf")}catch(r){throw console.error("Error generando PDF de Nota de Crdito:",r),new Error("Error al generar el PDF de la nota de crdito")}}generarHTMLNotaCredito(a,t){const{customColors:r,logoUrl:s,logoBase64:i}=t,o=this.getLogoSrc(s,i);return`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Nota de Crdito ${a.serie}-${a.folio}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; color: #333; }
          .factura-container { max-width: 800px; margin: 0 auto; padding: 20px; background: white; }
          .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px; border-bottom: 2px solid ${r.primary}; padding-bottom: 20px; }
          .logo-section { flex: 1; }
          .logo { max-width: 200px; max-height: 80px; object-fit: contain; }
          .factura-info { flex: 1; text-align: right; }
          .factura-titulo { font-size: 24px; font-weight: bold; color: ${r.primary}; margin-bottom: 10px; }
          .factura-numero { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
          .emisor-receptor { display: flex; justify-content: space-between; margin-bottom: 20px; }
          .emisor, .receptor { flex: 1; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
          .emisor { margin-right: 15px; background-color: ${r.secondary}20; }
          .receptor { margin-left: 15px; background-color: ${r.accent}20; }
          .seccion-titulo { font-weight: bold; font-size: 14px; color: ${r.primary}; margin-bottom: 10px; border-bottom: 1px solid ${r.primary}; padding-bottom: 5px; }
          .referencias { margin-bottom: 20px; padding: 10px; border: 1px dashed ${r.primary}; border-radius: 5px; background-color: #f8fafc; }
          .conceptos-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
          .conceptos-table th { background-color: ${r.primary}; color: white; padding: 12px 8px; text-align: left; font-weight: bold; }
          .conceptos-table td { padding: 10px 8px; border-bottom: 1px solid #ddd; }
          .conceptos-table tr:nth-child(even) { background-color: #f9f9f9; }
          .totales { float: right; width: 300px; margin-bottom: 30px; }
          .totales-table { width: 100%; border-collapse: collapse; }
          .totales-table td { padding: 8px 12px; border: 1px solid #ddd; }
          .totales-table .label { background-color: ${r.secondary}; color: white; font-weight: bold; text-align: right; }
          .totales-table .total-final { background-color: ${r.primary}; color: white; font-weight: bold; font-size: 14px; }
          .text-right { text-align: right; }
          .text-center { text-align: center; }
        </style>
      </head>
      <body>
        <div class="factura-container">
          <div class="header">
            <div class="logo-section">
              <img src="${o}" alt="Logo" class="logo" />
            </div>
            <div class="factura-info">
              <div class="factura-titulo">NOTA DE CRDITO</div>
              <div class="factura-numero">${a.serie}-${a.folio}</div>
              <div><strong>UUID:</strong> ${a.uuid||""}</div>
              <div><strong>Fecha:</strong> ${new Date(a.fechaEmision).toLocaleDateString("es-MX")}</div>
              <div><strong>Tipo Comprobante:</strong> E</div>
            </div>
          </div>

          <div class="emisor-receptor">
            <div class="emisor">
              <div class="seccion-titulo">EMISOR</div>
              <div><strong>Nombre:</strong> ${a.nombreEmisor}</div>
              <div><strong>RFC:</strong> ${a.rfcEmisor}</div>
            </div>
            <div class="receptor">
              <div class="seccion-titulo">RECEPTOR</div>
              <div><strong>Nombre:</strong> ${a.nombreReceptor}</div>
              <div><strong>RFC:</strong> ${a.rfcReceptor}</div>
            </div>
          </div>

          <div class="referencias">
            ${a.referenciaFactura?`<div><strong>Factura original:</strong> ${a.referenciaFactura}</div>`:""}
            ${a.motivo?`<div><strong>Motivo:</strong> ${a.motivo}</div>`:""}
          </div>

          <table class="conceptos-table">
            <thead>
              <tr>
                <th>Descripcin</th>
                <th class="text-center">Cantidad</th>
                <th class="text-center">Unidad</th>
                <th class="text-right">Precio Unitario</th>
                <th class="text-right">Importe</th>
              </tr>
            </thead>
            <tbody>
              ${a.conceptos.map(l=>`
                <tr>
                  <td>${l.descripcion}</td>
                  <td class="text-center">${l.cantidad}</td>
                  <td class="text-center">${l.unidad}</td>
                  <td class="text-right">$${l.precioUnitario.toFixed(2)}</td>
                  <td class="text-right">$${l.importe.toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>

          <div class="totales">
            <table class="totales-table">
              <tr>
                <td class="label">Subtotal:</td>
                <td class="text-right">$${a.subtotal.toFixed(2)}</td>
              </tr>
              <tr>
                <td class="label">IVA:</td>
                <td class="text-right">$${a.iva.toFixed(2)}</td>
              </tr>
              ${a.ieps?`
                <tr>
                  <td class="label">IEPS:</td>
                  <td class="text-right">$${a.ieps.toFixed(2)}</td>
                </tr>
              `:""}
              <tr>
                <td class="label total-final">Total:</td>
                <td class="text-right total-final">$${a.importe.toFixed(2)}</td>
              </tr>
            </table>
          </div>

          <div style="clear: both; margin-top: 20px;">
            <div><strong>Mtodo de Pago:</strong> ${a.metodoPago}</div>
            <div><strong>Forma de Pago:</strong> ${a.formaPago}</div>
            <div><strong>Uso CFDI:</strong> ${a.usoCFDI}</div>
          </div>
        </div>
      </body>
      </html>
    `}async generarPDFResumenGlobal(a,t,r,s){try{const i=this.generarHTMLResumenGlobal(a,t,r,s),o=`Resumen_Global_${r.fecha}.pdf`;return await this.convertirHTMLaPDF(i,o)}catch(i){throw console.error("Error generando PDF de resumen global:",i),new Error("Error al generar el PDF de resumen global")}}generarHTMLResumenGlobal(a,t,r,s){const{customColors:i,logoUrl:o,logoBase64:l}=s,c=this.getLogoSrc(o,l),u=f=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(f??0)),d=a.map(f=>{const m=`
        <div class="agg-header">
          <div>
            <div class="agg-line"><b>Factura:</b> ${f.serie?`${f.serie}-${f.folio??""}`:f.folio??""}</div>
            <div class="agg-line"><b>UUID:</b> ${f.uuid}</div>
            <div class="agg-line"><b>Fecha:</b> ${f.fechaEmision??""}</div>
            <div class="agg-line"><b>Estatus:</b> ${f.estatusFacturacion??""}${f.estatusSat?` (${f.estatusSat})`:""}</div>
          </div>
          <div class="agg-right">
            <div class="agg-line"><b>Tienda:</b> ${f.tienda??""}</div>
            <div class="agg-total">${u(f.importe)}</div>
          </div>
        </div>
      `,x=Array.isArray(f.tickets)&&f.tickets.length>0?`
        <div class="table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th>Ticket</th>
                <th>Folio</th>
                <th>Fecha</th>
                <th>Forma Pago</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              ${f.tickets.map(y=>`
                <tr>
                  <td>${y.idTicket}</td>
                  <td>${y.folio??""}</td>
                  <td>${y.fecha??""}</td>
                  <td>${y.formaPago??""}</td>
                  <td class="text-right">${u(y.total)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
      `:'<div class="no-data">Sin tickets vinculados.</div>',h=Array.isArray(f.tickets)?f.tickets.map(y=>!Array.isArray(y.detalles)||y.detalles.length===0?"":`
          <div class="table-wrap">
            <table class="table">
              <thead>
                <tr>
                  <th>Descripcin</th>
                  <th class="text-center">Cantidad</th>
                  <th class="text-center">Unidad</th>
                  <th class="text-right">Precio</th>
                  <th class="text-right">Subtotal</th>
                  <th class="text-right">IVA</th>
                  <th class="text-right">Total</th>
                </tr>
              </thead>
              <tbody>
                ${y.detalles.map(j=>`
                  <tr>
                    <td>${j.descripcion??""}</td>
                    <td class="text-center">${j.cantidad??""}</td>
                    <td class="text-center">${j.unidad??""}</td>
                    <td class="text-right">${u(j.precioUnitario)}</td>
                    <td class="text-right">${u(j.subtotal)}</td>
                    <td class="text-right">${u(j.ivaImporte)}</td>
                    <td class="text-right">${u(j.total)}</td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          </div>
        `).join(""):"",g=Array.isArray(f.tickets)?f.tickets.flatMap(y=>Array.isArray(y.detalles)?y.detalles:[]):[],p=g.reduce((y,j)=>y+(Number(j==null?void 0:j.subtotal)||0),0),v=g.reduce((y,j)=>y+(Number(j==null?void 0:j.ivaImporte)||0),0),w=g.reduce((y,j)=>y+(Number(j==null?void 0:j.total)||0),0),b=g.length>0?`
        <div class="totales-box">
          <div>Subtotal: <span class="label">${u(p)}</span></div>
          <div>IVA: <span class="label">${u(v)}</span></div>
          <div class="total">TOTAL: ${u(w)}</div>
        </div>
      `:"";return`
        <div class="agg-card">
          ${m}
          ${x}
          ${h}
          ${b}
        </div>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Resumen Facturacin Global</title>
        <style>
          * { box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; color: #333; }
          .container { max-width: 900px; margin: 0 auto; padding: 20px; background: #fff; }

          /* Banner superior tipo factura */
          .banner { display: flex; justify-content: space-between; align-items: center; background-color: ${i.primary}; color: #fff; padding: 16px; border-radius: 6px; }
          .banner-title { font-size: 18px; font-weight: bold; }
          .banner-meta { font-size: 12px; opacity: 0.95; }
          .logo img { max-height: 64px; object-fit: contain; background: #fff0; }

          /* Lnea separadora */
          .separator { height: 3px; background-color: ${i.primary}; margin: 14px 0 10px; border-radius: 2px; }

          /* Stats alineadas como en la factura */
          .stats { display: flex; gap: 16px; margin-bottom: 12px; color: #111; }
          .stats b { color: #000; }

          /* Tarjeta por factura agregada */
          .agg-card { border: 1px solid #e5e7eb; border-radius: 8px; padding: 12px; margin-bottom: 12px; }
          .agg-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px; }
          .agg-right { text-align: right; }
          .agg-line { margin-bottom: 4px; }
          .agg-total { font-weight: bold; font-size: 14px; color: #000; }

          /* Tablas estilo "Conceptos" */
          .table-wrap { overflow-x: auto; margin-top: 8px; }
          table.table { width: 100%; border-collapse: collapse; }
          table.table thead tr { background-color: ${i.primary}; color: #fff; }
          table.table th { padding: 8px 6px; text-align: left; font-weight: bold; }
          table.table td { padding: 8px 6px; border-bottom: 1px solid #ddd; }
          table.table tr:nth-child(even) { background-color: #f9f9f9; }
          .text-center { text-align: center; }
          .text-right { text-align: right; }
          .no-data { margin-top: 8px; color: #777; }

          /* Caja de totales similar a factura */
          .totales-box { float: right; width: 280px; border: 2px solid ${i.primary}; border-radius: 6px; padding: 10px; margin-top: 6px; }
          .totales-box .label { font-weight: bold; }
          .totales-box .total { color: ${i.primary}; font-weight: bold; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="banner">
            <div>
              <div class="banner-title">Resumen Facturacin Global</div>
              <div class="banner-meta">${r.periodoLabel}  Fecha ${r.fecha}${r.tiendaLabel?`  Tienda ${r.tiendaLabel}`:""}</div>
            </div>
            <div class="logo"><img src="${c}" alt="Logo" /></div>
          </div>
          <div class="separator"></div>

          ${typeof t.totalFacturas=="number"||typeof t.totalTickets=="number"||typeof t.totalCartaPorte=="number"?`
            <div class="stats">
              <div>Facturas: <b>${t.totalFacturas??"-"}</b></div>
              <div>Tickets: <b>${t.totalTickets??"-"}</b></div>
              <div>Carta Porte: <b>${t.totalCartaPorte??"-"}</b></div>
            </div>
          `:""}

          ${d}
        </div>
      </body>
      </html>
    `}}const tx=fo.getInstance(),Lt={LOGO_STORAGE_KEY:"facturacion_cibercom_logo",guardarLogo:e=>{typeof window<"u"&&localStorage.setItem(Lt.LOGO_STORAGE_KEY,e)},obtenerLogo:()=>typeof window<"u"&&localStorage.getItem(Lt.LOGO_STORAGE_KEY)||"",eliminarLogo:()=>{typeof window<"u"&&localStorage.removeItem(Lt.LOGO_STORAGE_KEY)},guardarLogoBackend:async e=>{try{return(await fetch(Re("/logos/guardar"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({logoBase64:e})})).ok}catch(a){return console.error("Error guardando logo en backend:",a),!1}},obtenerLogoActivoBackend:async()=>{try{const e=await fetch(Re("/logos/activo"));if(!e.ok)return"";const a=await e.json().catch(()=>null);return(a&&(a.logoBase64||a.logo)||"").trim()}catch(e){return console.error("Error obteniendo logo activo del backend:",e),""}}};class mo{constructor(){this.baseUrl=tn}normalizarUuidParaPac(a){const t=String(a||"").trim();return t.length===32?`${t.substring(0,8)}-${t.substring(8,12)}-${t.substring(12,16)}-${t.substring(16,20)}-${t.substring(20)}`.toLowerCase():t.toLowerCase()}static getInstance(){return mo.instance||(mo.instance=new mo),mo.instance}async buscarReceptorPorRFC(a){var r,s,i,o,l,c,u,d,f;const t={rfc:(r=a.rfc)==null?void 0:r.toUpperCase(),idTienda:a.idTienda,correoElectronico:a.correoElectronico};try{const m=await fetch(`${this.baseUrl}/receptor/buscar`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),x=await m.json().catch(()=>null);if(!m.ok){if(m.status===404)return{encontrado:!1,completoCFDI40:!1,receptor:{rfc:t.rfc},faltantes:[]};throw new Error((x==null?void 0:x.mensaje)||`Error HTTP ${m.status}`)}return{encontrado:!!((x==null?void 0:x.encontrado)??!0),completoCFDI40:!!((x==null?void 0:x.completoCFDI40)??!0),idReceptor:(x==null?void 0:x.idReceptor)||`${t.rfc}-ID`,receptor:{rfc:t.rfc,razonSocial:(x==null?void 0:x.razonSocial)||((s=x==null?void 0:x.receptor)==null?void 0:s.razonSocial),nombre:(x==null?void 0:x.nombre)||((i=x==null?void 0:x.receptor)==null?void 0:i.nombre),paterno:(x==null?void 0:x.paterno)||((o=x==null?void 0:x.receptor)==null?void 0:o.paterno),materno:(x==null?void 0:x.materno)||((l=x==null?void 0:x.receptor)==null?void 0:l.materno),pais:(x==null?void 0:x.pais)||((c=x==null?void 0:x.receptor)==null?void 0:c.pais)||"MEX",domicilioFiscal:(x==null?void 0:x.domicilioFiscal)||((u=x==null?void 0:x.receptor)==null?void 0:u.domicilioFiscal),regimenFiscal:(x==null?void 0:x.regimenFiscal)||((d=x==null?void 0:x.receptor)==null?void 0:d.regimenFiscal),usoCfdi:(x==null?void 0:x.usoCfdi)||((f=x==null?void 0:x.receptor)==null?void 0:f.usoCfdi)||"G03"},faltantes:(x==null?void 0:x.faltantes)||[]}}catch{return/^[A-Z&]{3,4}[0-9]{6}[A-Z0-9]{3}$/.test(t.rfc||"")?(t.rfc||"").slice(-3).includes("0")?{encontrado:!0,completoCFDI40:!1,idReceptor:`${t.rfc}-SIM`,receptor:{rfc:t.rfc,razonSocial:"",nombre:"",paterno:"",materno:"",pais:"MEX",domicilioFiscal:"",regimenFiscal:"",usoCfdi:""},faltantes:["domicilioFiscal","razonSocial","regimenFiscal"]}:{encontrado:!0,completoCFDI40:!0,idReceptor:`${t.rfc}-SIM`,receptor:{rfc:t.rfc,razonSocial:`Cliente ${t.rfc}`,nombre:"Nombre",paterno:"Paterno",materno:"Materno",pais:"MEX",domicilioFiscal:"CP 12345, Calle Simulada 123",regimenFiscal:"612",usoCfdi:"G03"},faltantes:[]}:{encontrado:!1,completoCFDI40:!1,receptor:{rfc:t.rfc||""},faltantes:[]}}}async consultarIntereses(a){try{const t=await fetch(`${this.baseUrl}/intereses/consultar`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),r=await t.json().catch(()=>null);if(!t.ok||!r)throw new Error((r==null?void 0:r.mensaje)||`Error HTTP ${t.status}`);return{exitoso:!!(r.exitoso??!0),codigoRespuesta:String(r.codigoRespuesta??"SOF"),mensaje:String(r.mensaje??""),financiero:Number(r.financiero??0),financieroIva:Number(r.financieroIva??0),moratorio:Number(r.moratorio??0),moratorioIva:Number(r.moratorioIva??0)}}catch(t){return{exitoso:!1,codigoRespuesta:"ERR",mensaje:(t==null?void 0:t.message)||"Error consultando intereses",financiero:0,financieroIva:0,moratorio:0,moratorioIva:0}}}async obtenerFacturaPorUUID(a){try{let t=await fetch(Re(`/factura/timbrado/status/${a}`));if(!t.ok){const k=this.normalizarUuidParaPac(a),P=await fetch(kr(`/descargar-xml/${encodeURIComponent(k)}`));if(!P.ok)throw new Error(`Error HTTP ${t.status}: ${t.statusText}`);t=P}const r=(t.headers.get("content-type")||"").toLowerCase();if(r.includes("application/json")||r.includes("text/json")){const k=await t.json();if(!k.exitoso||!k.datosFactura)throw new Error(k.mensaje||"No se encontr la factura");const P=k.datosFactura;return{uuid:k.uuid||a,rfcEmisor:P.rfcEmisor||"EEM123456789",nombreEmisor:P.nombreEmisor||"Empresa Ejemplo",rfcReceptor:P.rfcReceptor||"XEXX010101000",nombreReceptor:P.nombreReceptor||"Cliente Ejemplo",serie:P.serie,folio:P.folio,fechaEmision:P.fechaTimbrado||P.fechaEmision,importe:P.total,subtotal:P.subtotal,iva:P.iva??0,ieps:P.ieps??0,conceptos:Array.isArray(P.conceptos)?P.conceptos.map(R=>({descripcion:R.descripcion,cantidad:R.cantidad??1,unidad:R.unidad||R.claveUnidad||"H87",precioUnitario:R.valorUnitario??R.precioUnitario??P.subtotal,importe:R.importe??P.subtotal})):[],metodoPago:P.metodoPago||"PUE",formaPago:P.formaPago||"01",usoCFDI:P.usoCFDI||P.usoCfdi||"G03",xmlContent:k.xmlTimbrado||P.xmlTimbrado,selloDigital:P.selloDigital,selloCFD:P.selloDigital,noCertificado:P.certificado,cadenaOriginal:P.cadenaOriginal,estatusFacturacion:P.estatusFacturacion||"Vigente",estatusSat:P.estatusSat||"Vigente"}}const s=await t.text();if(!s||!s.trim().startsWith("<"))throw new Error("Respuesta no JSON y no XML vlida");const o=new DOMParser().parseFromString(s,"application/xml"),l=o.getElementsByTagName("cfdi:Comprobante")[0]||o.getElementsByTagName("Comprobante")[0];if(!l)throw new Error("XML CFDI invlido: no se encontr Comprobante");const c=l.getAttribute("Serie")||"",u=l.getAttribute("Folio")||"",d=l.getAttribute("Fecha")||"",f=parseFloat(l.getAttribute("Total")||"0"),m=parseFloat(l.getAttribute("SubTotal")||"0");let x=0,h=0;(o.getElementsByTagName("cfdi:Traslado").length?Array.from(o.getElementsByTagName("cfdi:Traslado")):Array.from(o.getElementsByTagName("Traslado"))).forEach(k=>{const P=k.getAttribute("Impuesto"),R=parseFloat(k.getAttribute("Importe")||"0");P==="002"&&(x+=R),P==="003"&&(h+=R)});const p=o.getElementsByTagName("cfdi:Receptor")[0]||o.getElementsByTagName("Receptor")[0],v=o.getElementsByTagName("cfdi:Emisor")[0]||o.getElementsByTagName("Emisor")[0],w=(p==null?void 0:p.getAttribute("Rfc"))||"",b=(p==null?void 0:p.getAttribute("Nombre"))||"",y=(p==null?void 0:p.getAttribute("UsoCFDI"))||"",j=(v==null?void 0:v.getAttribute("Rfc"))||"",A=(v==null?void 0:v.getAttribute("Nombre"))||"",F=(o.getElementsByTagName("cfdi:Concepto").length?Array.from(o.getElementsByTagName("cfdi:Concepto")):Array.from(o.getElementsByTagName("Concepto"))).map(k=>{const P=k.getAttribute("Descripcion")||"",R=parseFloat(k.getAttribute("Cantidad")||"1"),_=k.getAttribute("Unidad")||k.getAttribute("ClaveUnidad")||"H87",Q=parseFloat(k.getAttribute("ValorUnitario")||"0"),C=parseFloat(k.getAttribute("Importe")||"0");return{descripcion:P,cantidad:R,unidad:_,precioUnitario:Q,importe:C}});return{uuid:a,rfcEmisor:j||"EEM123456789",nombreEmisor:A||"Empresa Ejemplo",rfcReceptor:w||"XEXX010101000",nombreReceptor:b||"Cliente Ejemplo",serie:c,folio:u,fechaEmision:d,importe:f,subtotal:m,iva:x,ieps:h,conceptos:F,metodoPago:l.getAttribute("MetodoPago")||"PUE",formaPago:l.getAttribute("FormaPago")||"01",usoCFDI:y||"G03",estatusFacturacion:"Vigente",estatusSat:"Vigente"}}catch(t){throw console.error("Error obteniendo factura:",t),new Error(`Error al obtener la factura: ${t instanceof Error?t.message:"Error desconocido"}`)}}async obtenerFacturasPorUUIDs(a){try{const t=a.map(s=>this.obtenerFacturaPorUUID(s));return await Promise.all(t)}catch(t){throw console.error("Error obteniendo facturas:",t),new Error(`Error al obtener las facturas: ${t instanceof Error?t.message:"Error desconocido"}`)}}async obtenerConfiguracionLogos(){try{const a=await fetch(`${this.baseUrl}/logos/configuracion`);if(!a.ok)throw new Error(`Error HTTP ${a.status}: ${a.statusText}`);const t=await a.json(),r=typeof window<"u"&&Lt.obtenerLogo()||"",s=r.trim()?r:t.logoBase64||void 0;return{exitoso:!0,logoUrl:t.logoUrl||(typeof import.meta<"u"?"/facturacion-backend/":"/")+"images/cibercom-logo.svg",logoBase64:s,customColors:t.customColors||{primary:"#2E86AB",secondary:"#1E4A5F",accent:"#0F2A3A"}}}catch(a){console.error("Error obteniendo configuracin de logos:",a);const t=typeof window<"u"&&Lt.obtenerLogo()||"";return{exitoso:!1,logoUrl:(typeof import.meta<"u"?"/facturacion-backend/":"/")+"images/cibercom-logo.svg",logoBase64:t.trim()?t:void 0,customColors:{primary:"#2E86AB",secondary:"#1E4A5F",accent:"#0F2A3A"},error:a instanceof Error?a.message:"Error desconocido"}}}convertirAFacturaData(a){return{uuid:a.uuid,serie:a.serie,folio:a.folio,fechaEmision:a.fechaEmision,rfcEmisor:a.rfcEmisor,nombreEmisor:a.nombreEmisor,rfcReceptor:a.rfcReceptor,nombreReceptor:a.nombreReceptor,subtotal:a.subtotal,iva:a.iva,total:a.importe,moneda:"MXN",metodoPago:a.metodoPago,formaPago:a.formaPago,usoCfdi:a.usoCFDI,tipoComprobante:"I",lugarExpedicion:"12345",xmlTimbrado:a.xmlContent||"<?xml version='1.0' encoding='UTF-8'?><cfdi:Comprobante></cfdi:Comprobante>",cadenaOriginal:a.cadenaOriginal||`||1.1|${a.uuid}|${a.fechaEmision}||`,selloDigital:a.selloDigital||"ABC123DEF456",certificado:a.noCertificado||"MIIE",folioFiscal:a.uuid,fechaTimbrado:a.fechaEmision,conceptos:a.conceptos.map(t=>({claveProdServ:"01010101",noIdentificacion:"PROD001",cantidad:t.cantidad,claveUnidad:"H87",unidad:t.unidad,descripcion:t.descripcion,valorUnitario:t.precioUnitario,importe:t.importe,descuento:0,impuestos:[{tipo:"Traslado",impuesto:"002",tipoFactor:"Tasa",tasaOCuota:.16,base:t.importe,importe:t.importe*.16}]}))}}async generarYDescargarPDF(a){try{let t=`Factura_${a}.pdf`;try{const d=await this.obtenerFacturaPorUUID(a),f=(d.serie||"").trim(),m=(d.folio||"").trim();(f||m)&&(t=`Factura_${f}-${m}.pdf`)}catch(d){console.warn("No se pudo obtener datos de la factura para el nombre del archivo. Usando nombre por defecto.",d)}const r=await fetch(Re(`/factura/descargar-pdf/${a}`));if(!r.ok){const d=await r.text().catch(()=>"");throw new Error(`Error al descargar PDF (HTTP ${r.status}) ${d}`)}const s=await r.blob(),i=window.URL.createObjectURL(s),o=document.createElement("a");o.href=i;const l=r.headers.get("content-disposition")||"";let c=t;const u=l.match(/filename="?([^";]+)"?/i);u&&u[1]&&(c=u[1]),o.download=c,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(i),document.body.removeChild(o)}catch(t){throw console.error("Error descargando PDF:",t),new Error(`Error al descargar el PDF: ${t instanceof Error?t.message:"Error desconocido"}`)}}async generarYDescargarZIP(a){try{const t=await this.obtenerFacturaPorUUID(a),r=await this.obtenerConfiguracionLogos();if(!r.exitoso)throw new Error("Error al obtener la configuracin de logos");const s=this.convertirAFacturaData(t),i=await fetch(kr("/generar-zip"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({facturas:[{facturaData:s}],logoConfig:r})});if(!i.ok)throw new Error("Error al generar ZIP en el servidor");const o=await i.blob(),l=window.URL.createObjectURL(o),c=document.createElement("a");c.href=l,c.download=`Factura_${t.serie}-${t.folio}.zip`,document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(l),document.body.removeChild(c)}catch(t){throw console.error("Error generando ZIP:",t),new Error(`Error al generar el ZIP: ${t instanceof Error?t.message:"Error desconocido"}`)}}async generarYDescargarXML(a){try{let t=await fetch(Re(`/factura/timbrado/status/${a}`));if(!t.ok){const o=this.normalizarUuidParaPac(a);t=await fetch(kr(`/descargar-xml/${encodeURIComponent(o)}`))}if(!t.ok)throw new Error(`XML no disponible (HTTP ${t.status})`);const r=await t.blob();if(r.size===0)throw new Error("El XML no est disponible para esta factura");const s=window.URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=`FACTURA_${a}.xml`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(s),document.body.removeChild(i)}catch(t){throw console.error("Error descargando XML:",t),new Error(`Error al descargar el XML: ${t instanceof Error?t.message:"Error desconocido"}`)}}async generarYDescargarZIPMultiple(a){try{if(a.length===0)throw new Error("No se han seleccionado facturas");const t=await this.obtenerFacturasPorUUIDs(a),r=await this.obtenerConfiguracionLogos();if(!r.exitoso)throw new Error("Error al obtener la configuracin de logos");const s=await fetch(kr("/generar-zip"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({facturas:t.map(c=>({facturaData:this.convertirAFacturaData(c)})),logoConfig:r})});if(!s.ok)throw new Error("Error al generar ZIP en el servidor");const i=await s.blob(),o=window.URL.createObjectURL(i),l=document.createElement("a");l.href=o,l.download=`Facturas_${new Date().toISOString().split("T")[0]}.zip`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(o),document.body.removeChild(l)}catch(t){throw console.error("Error generando ZIP mltiple:",t),new Error(`Error al generar el ZIP: ${t instanceof Error?t.message:"Error desconocido"}`)}}async emitirFacturaIntereses(a){var t,r,s,i,o,l,c;try{if(!((t=a==null?void 0:a.receptor)!=null&&t.rfc)||!((r=a==null?void 0:a.receptor)!=null&&r.usoCfdi)||!((s=a==null?void 0:a.receptor)!=null&&s.regimenFiscal)||!((i=a==null?void 0:a.receptor)!=null&&i.domicilioFiscal))return{exitoso:!1,mensaje:"Datos fiscales incompletos",error:"Datos fiscales incompletos",errorCode:"DATOS_FISCALES"};const u={rfc:a.receptor.rfc,correoElectronico:a.correoElectronico||"cliente@example.com",razonSocial:a.razonSocial||a.receptor.rfc,nombre:a.nombre||"",paterno:a.paterno||"",materno:a.materno||"",pais:a.pais||"MEX",noRegistroIdentidadTributaria:"",domicilioFiscal:a.receptor.domicilioFiscal,regimenFiscal:a.receptor.regimenFiscal,usoCfdi:a.receptor.usoCfdi,codigoFacturacion:`FAC-INTERESES-${(a.cuenta||"").replace(/\s+/g,"")}`,tienda:a.codigoTienda||a.idTienda,fecha:new Date().toISOString().slice(0,10),terminal:"TERM-INT",boleta:`INT-${(a.cuenta||"").replace(/\s+/g,"")}`,medioPago:a.medioPago||"PUE",formaPago:a.formaPago||"01",iepsDesglosado:!1,guardarEnMongo:!0},d=await fetch(`${this.baseUrl}/factura/generar/frontend`,{method:"POST",headers:Ca(),body:JSON.stringify(u)}),f=await d.json().catch(()=>null);if(!d.ok)return{exitoso:!1,mensaje:(f==null?void 0:f.mensaje)||"Fallo al emitir en backend",error:(f==null?void 0:f.mensaje)||"Error en emisin"};const m=((o=f==null?void 0:f.datosFactura)==null?void 0:o.serie)||"INT",x=(l=f==null?void 0:f.datosFactura)!=null&&l.folio?String(f.datosFactura.folio):void 0,h=(f==null?void 0:f.uuid)||((c=f==null?void 0:f.datosFactura)==null?void 0:c.uuid),g=new Date().toISOString();return{exitoso:!0,mensaje:(f==null?void 0:f.mensaje)||"Factura de intereses emitida",serie:m,folio:x,uuid:h,fechaEmision:g}}catch(u){return console.error("Error emitiendo intereses contra backend real:",u),{exitoso:!1,mensaje:"Error al emitir intereses",error:u.message}}}async consultarCfdiPorUUID(a){const{uuid:t,rfcReceptor:r,tipo:s}=a,i=Re(`/factura/consultar-uuid?uuid=${encodeURIComponent(t)}${r?`&rfcReceptor=${encodeURIComponent(r.toUpperCase())}`:""}&tipo=${encodeURIComponent(s)}`),o=await fetch(i),l=await o.json().catch(()=>null);if(!o.ok)throw new Error((l==null?void 0:l.mensaje)||`Error HTTP ${o.status}`);return l}}const ma=mo.getInstance();class AC{constructor(){this.baseUrl=Re("/correo")}async enviarCorreoPorUuid(a,t){try{const r=await fetch(`${this.baseUrl}/enviar-factura/${a}?correoReceptor=${encodeURIComponent(t)}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`Error HTTP: ${r.status} - ${r.statusText}`);return await r.json()}catch(r){throw console.error("Error al enviar correo por UUID:",r),r}}async enviarCorreoDirecto(a){try{const t=await fetch(`${this.baseUrl}/enviar-factura-directa`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error(`Error HTTP: ${t.status} - ${t.statusText}`);return await t.json()}catch(t){throw console.error("Error al enviar correo directo:",t),t}}async verificarConfiguracion(){try{const a=await fetch(`${this.baseUrl}/verificar-configuracion`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error(`Error HTTP: ${a.status} - ${a.statusText}`);return await a.json()}catch(a){throw console.error("Error al verificar configuracin de correo:",a),a}}validarEmail(a){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)}async enviarCorreoConPdfAdjunto(a){try{const t=Lt.obtenerLogo(),r=a.logoBase64&&a.logoBase64.trim().length>0?a.logoBase64:t||"",s={...a,cuerpo:a.mensaje,mensaje:a.mensaje,logoBase64:r};console.log("Enviando solicitud de correo con PDF:",JSON.stringify({...s,mensaje:"[omitted]",cuerpo:"[omitted]"},null,2));const i=await fetch(`${this.baseUrl}/enviar-con-pdf`,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json"},body:JSON.stringify(s)});if(!i.ok)throw new Error(`Error HTTP: ${i.status}`);return await i.json()}catch(t){throw console.error("Error al enviar correo con PDF adjunto:",t),t}}async enviarPdfDirecto(a){try{const t={...a,cuerpo:a.mensaje,templateVars:a.templateVars||{},xmlBase64:a.xmlBase64||void 0,nombreAdjuntoXml:a.nombreAdjuntoXml||void 0};console.log("Enviando solicitud de correo con PDF directo:",JSON.stringify({...t,mensaje:"[omitted]",cuerpo:"[omitted]"},null,2));const r=await fetch(`${this.baseUrl}/enviar-pdf-directo`,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error(`Error HTTP: ${r.status}`);return await r.json()}catch(t){throw console.error("Error al enviar PDF directo:",t),t}}}const Pt=new AC,Se=({label:e,name:a,value:t,onChange:r,options:s,required:i=!1,className:o="",disabled:l=!1,error:c=!1,placeholder:u})=>{const{theme:d}=N.useContext(Kt),f=a||(e?`select-${e.toLowerCase().replace(/\s+/g,"-")}`:"select-field"),m="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 sm:text-sm appearance-none transition-colors duration-200",x="border-gray-300 focus:ring-primary focus:border-primary bg-white text-gray-900",h="dark:border-gray-600 dark:focus:ring-secondary dark:focus:border-secondary dark:bg-gray-700 dark:text-gray-100",g="disabled:bg-gray-100 disabled:dark:bg-gray-800 disabled:text-gray-500 disabled:dark:text-gray-400 disabled:cursor-not-allowed",p=c?"border-red-600 focus:ring-red-600 focus:border-red-600":"",v=w=>{const b=w.target.value,y=!isNaN(Number(b))&&b!==""?Number(b):b;if(r.length===1)try{r(y);return}catch{try{r(w)}catch(E){console.error("Error calling onChange handler:",E)}}else r(w)};return n.jsxs("div",{className:`mb-1 ${o}`,children:[e&&n.jsxs("label",{htmlFor:f,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e,i&&n.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n.jsxs("div",{className:"relative",children:[n.jsxs("select",{name:f,id:f,value:t,onChange:v,required:i,disabled:l,className:`${m} ${d==="light"?x:h} ${g} ${p}`,children:[n.jsx("option",{value:"",disabled:!0,hidden:!0,className:"text-gray-500",children:u||"- Selecciona -"}),s.map(w=>n.jsx("option",{value:w.value,className:d==="dark"?"bg-gray-700 text-white":"bg-white text-black",children:w.label},w.value))]}),n.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700 dark:text-gray-300",children:n.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:n.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]})},RC=({message:e,type:a="success",onClose:t})=>n.jsx("div",{className:`fixed top-6 right-6 z-50 px-4 py-2 rounded shadow-lg text-white transition-all ${a==="success"?"bg-green-600":"bg-red-600"}`,role:"alert",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{children:e}),n.jsx("button",{onClick:t,className:"ml-2 text-white hover:text-gray-200 font-bold",children:""})]})}),Nf=({open:e,title:a,children:t,onClose:r,onConfirm:s,confirmText:i="Confirmar",loading:o})=>e?n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 min-w-[320px] max-w-[90vw]",children:[n.jsx("h2",{className:"text-lg font-bold mb-4 text-gray-900 dark:text-white",children:a}),n.jsx("div",{className:"mb-6 text-gray-700 dark:text-gray-200",children:t}),n.jsxs("div",{className:"flex justify-end space-x-3",children:[n.jsx(fe,{type:"button",variant:"neutral",onClick:r,disabled:o,children:"Cancelar"}),s&&n.jsx(fe,{type:"button",variant:"primary",onClick:s,disabled:o,children:o?"Procesando...":i})]})]})}):null,DC={fecha:"",periodo:"DIA",tienda:"Todas",tipoFactura:"",estatus:""},PC=({results:e,onPdf:a,onXml:t,onCancelar:r,onPreview:s,onEnviarCorreo:i})=>n.jsx(ve,{children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:n.jsx("tr",{children:["Tipo","Folio/Boleta","Fecha","Tienda","Acciones"].map(o=>n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:o},o))})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:e.map(o=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:o.tipo}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:o.folio}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:o.fecha}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:o.tienda}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[n.jsx("button",{className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200",onClick:()=>s(o),children:"Vista previa"}),n.jsx("button",{className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200",onClick:()=>a(o),children:"PDF"}),n.jsx("button",{className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200",onClick:()=>t(o),children:"XML"}),n.jsx("button",{className:"text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-200",onClick:()=>i(o),children:"Enviar Gmail"}),o.estatus==="Timbrada"&&n.jsx("button",{className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200",onClick:()=>r(o),children:"Cancelar"})]})]},o.id))})]})})}),OC=()=>{const[e,a]=N.useState(DC),[t,r]=N.useState([]),[s,i]=N.useState([]),[o,l]=N.useState({}),[c,u]=N.useState(!1),[d,f]=N.useState(!1),[m,x]=N.useState(null),[h,g]=N.useState(null),[p,v]=N.useState(null),[w,b]=N.useState(""),[y,j]=N.useState(!1),[A,E]=N.useState(new Set),[F,k]=N.useState(!1),[P,R]=N.useState(new Set),_=ae=>{const{name:ce,value:W}=ae.target;a(le=>({...le,[ce]:W}))},Q=async ae=>{ae.preventDefault();try{const ce={periodo:e.periodo,fecha:e.fecha,codigoTienda:e.tienda},W=await fetch(Re("/factura/global/consulta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)});if(!W.ok)throw new Error(`HTTP ${W.status}`);const le=await W.json(),I=Array.isArray(le==null?void 0:le.facturasAgregadas)?le.facturasAgregadas:[];i(I),l({totalFacturas:typeof(le==null?void 0:le.totalFacturas)=="number"?le.totalFacturas:void 0,totalTickets:typeof(le==null?void 0:le.totalTickets)=="number"?le.totalTickets:void 0,totalCartaPorte:typeof(le==null?void 0:le.totalCartaPorte)=="number"?le.totalCartaPorte:void 0});const q=I.reduce((ee,ie)=>ee+Number((ie==null?void 0:ie.importe)??0),0),G={id:0,tipo:"FACTURA",folio:`Facturacin de ${(()=>{const ee=e.fecha;if(e.periodo==="DIA")return`da ${ee}`;if(e.periodo==="SEMANA"){const je=new Date(ee+"T00:00:00");je.setHours(0,0,0,0),je.setDate(je.getDate()+3-(je.getDay()+6)%7);const Me=new Date(je.getFullYear(),0,4);return`semana ${1+Math.round(((je.getTime()-Me.getTime())/864e5-3+(Me.getDay()+6)%7)/7)}`}const ie=new Date(ee+"T00:00:00");return`mes ${["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][ie.getMonth()]} ${ie.getFullYear()}`})()}`,fecha:e.fecha,tienda:e.tienda,total:q,estatus:"Pendiente"};r([G]),x({message:"Consulta lista: 1 resultado de factura global",type:"success"})}catch(ce){console.error("Error en consulta factura global:",ce),x({message:"Error al ejecutar consulta global.",type:"error"}),r([]),i([]),l({})}},C=()=>{console.log("Exportar a Excel:",e),x({message:"Exportando a Excel (simulado).",type:"success"})},z=async()=>{try{f(!0);const ae={periodo:e.periodo,fecha:e.fecha,codigoTienda:e.tienda==="Todas"||!e.tienda?void 0:e.tienda},ce=await fetch(Re("/factura/global/consulta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!ce.ok)throw new Error(`HTTP ${ce.status}`);const W=await ce.json(),le=Array.isArray(W==null?void 0:W.facturasAgregadas)?W.facturasAgregadas:[];i(le),l({totalFacturas:typeof(W==null?void 0:W.totalFacturas)=="number"?W.totalFacturas:void 0,totalTickets:typeof(W==null?void 0:W.totalTickets)=="number"?W.totalTickets:void 0,totalCartaPorte:typeof(W==null?void 0:W.totalCartaPorte)=="number"?W.totalCartaPorte:void 0}),u(!0),x({message:`Vista previa lista: ${le.length} facturas agregadas`,type:"success"})}catch(ae){console.error("Error en vista previa de factura global:",ae),x({message:"Error al preparar vista previa.",type:"error"}),i([]),l({})}finally{f(!1)}},S=ae=>new Promise((ce,W)=>{const le=new FileReader;le.onloadend=()=>{const q=le.result.split(",")[1]||"";ce(q)},le.onerror=W,le.readAsDataURL(ae)}),D=ae=>{b(""),v({open:!0,factura:ae})},H=async()=>{let ae=s;if(!Array.isArray(ae)||ae.length===0){const G={periodo:e.periodo,fecha:e.fecha,codigoTienda:e.tienda==="Todas"||!e.tienda?void 0:e.tienda},ee=await fetch(Re("/factura/global/consulta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)});if(!ee.ok)throw new Error(`HTTP ${ee.status}`);const ie=await ee.json();ae=Array.isArray(ie==null?void 0:ie.facturasAgregadas)?ie.facturasAgregadas:[]}const ce=(ae||[]).map(G=>{const ee=Array.isArray(G==null?void 0:G.tickets)?G.tickets.reduce((je,Me)=>je+(Number(Me==null?void 0:Me.total)||0),0):Number(G==null?void 0:G.importe)||0;return{descripcion:`Factura ${G!=null&&G.serie?`${G.serie}-${(G==null?void 0:G.folio)??""}`:`${(G==null?void 0:G.folio)??""}`}${G!=null&&G.tienda?`  Tienda ${G.tienda}`:""}${G!=null&&G.fechaEmision?`  ${G.fechaEmision}`:""}`,importe:ee}}),W=ce.reduce((G,ee)=>G+(Number(ee==null?void 0:ee.importe)||0),0),I=W+0;let ne=`<?xml version="1.0" encoding="UTF-8"?>
<cfdi:Comprobante xmlns:cfdi="http://www.sat.gob.mx/cfd/4" Version="4.0" Fecha="${new Date().toISOString()}" Serie="RG" Folio="${e.periodo}_${e.fecha}" SubTotal="${W.toFixed(2)}" Total="${I.toFixed(2)}" TipoDeComprobante="I" Moneda="MXN" MetodoPago="PUE" FormaPago="99" LugarExpedicion="00000">
  <cfdi:Emisor Rfc="XAXX010101000" Nombre="Resumen Facturacin Global" RegimenFiscal="601"/>
  <cfdi:Receptor Rfc="XAXX010101000" Nombre="${e.tienda==="Todas"?"Todas las tiendas":`Tienda ${e.tienda}`}" DomicilioFiscalReceptor="00000" RegimenFiscalReceptor="601" UsoCFDI="G03"/>
  <cfdi:Conceptos>
`;for(const G of ce)ne+=`    <cfdi:Concepto ClaveProdServ="01010101" Cantidad="1" ClaveUnidad="ACT" Descripcion="${G.descripcion}" ValorUnitario="${Number(G.importe).toFixed(2)}" Importe="${Number(G.importe).toFixed(2)}"/>
`;return ne+=`  </cfdi:Conceptos>
</cfdi:Comprobante>`,ne},U=async()=>{if(p!=null&&p.open)try{if(!Pt.validarEmail(w)){x({message:"Correo invlido. Verifica el formato.",type:"error"});return}j(!0);let ae=s;if(!Array.isArray(ae)||ae.length===0){const Ie={periodo:e.periodo,fecha:e.fecha,codigoTienda:e.tienda==="Todas"||!e.tienda?void 0:e.tienda},We=await fetch(Re("/factura/global/consulta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ie)});if(!We.ok)throw new Error(`HTTP ${We.status}`);const Ve=await We.json();ae=Array.isArray(Ve==null?void 0:Ve.facturasAgregadas)?Ve.facturasAgregadas:[]}const ce=(ae||[]).map(Ie=>{const We=Array.isArray(Ie==null?void 0:Ie.tickets)?Ie.tickets.reduce((Fe,na)=>Fe+(Number(na==null?void 0:na.total)||0),0):Number(Ie==null?void 0:Ie.importe)||0;return{descripcion:`Factura ${Ie!=null&&Ie.serie?`${Ie.serie}-${(Ie==null?void 0:Ie.folio)??""}`:`${(Ie==null?void 0:Ie.folio)??""}`}${Ie!=null&&Ie.tienda?`  Tienda ${Ie.tienda}`:""}${Ie!=null&&Ie.fechaEmision?`  ${Ie.fechaEmision}`:""}`,cantidad:1,unidad:"Factura",precioUnitario:We,importe:We}}),W=ce.reduce((Ie,We)=>Ie+(Number(We==null?void 0:We.importe)||0),0),le=await ma.obtenerConfiguracionLogos(),I={uuid:`RESUMEN-GLOBAL-${e.periodo}-${e.fecha}`,rfcEmisor:"N/A",nombreEmisor:"Resumen Facturacin Global",rfcReceptor:"N/A",nombreReceptor:e.tienda==="Todas"?"Todas las tiendas":`Tienda ${e.tienda}`,serie:"RG",folio:`${e.periodo}_${e.fecha}`,fechaEmision:new Date().toISOString(),importe:W,subtotal:W,iva:0,conceptos:ce,metodoPago:"PUE",formaPago:"99",usoCFDI:"G03"},q=await fetch(Re("/factura/generar-pdf"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({facturaData:I,logoConfig:{logoUrl:le.logoUrl,logoBase64:le.logoBase64,customColors:le.customColors}})});if(!q.ok){const Ie=await q.text().catch(()=>"");throw new Error(`Error al generar PDF (HTTP ${q.status}) ${Ie}`)}const ne=await q.blob(),G=await S(ne),ee=await H(),ie=new Blob([ee],{type:"application/xml"}),we=await S(ie),je=`Resumen Global RG-${e.periodo}_${e.fecha}`,$e=await Pt.enviarPdfDirecto({pdfBase64:G,correoReceptor:w,asunto:je,mensaje:`Estimado(a),

Se adjunta su resumen de facturacin global.

Gracias.`,nombreAdjunto:`Resumen_Global_${e.periodo}_${e.fecha}.pdf`,xmlBase64:we,nombreAdjuntoXml:`Resumen_Global_${e.periodo}_${e.fecha}.xml`});$e!=null&&$e.success?(x({message:"Correo enviado exitosamente.",type:"success"}),v(null)):x({message:($e==null?void 0:$e.message)||"No se pudo enviar el correo.",type:"error"})}catch(ae){console.error("Error enviando correo:",ae),x({message:(ae==null?void 0:ae.message)||"Error al enviar correo con adjuntos.",type:"error"})}finally{j(!1)}},B=async ae=>{try{let ce=s;if(!Array.isArray(ce)||ce.length===0){const ie={periodo:e.periodo,fecha:e.fecha,codigoTienda:e.tienda==="Todas"||!e.tienda?void 0:e.tienda},we=await fetch(Re("/factura/global/consulta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ie)});if(!we.ok)throw new Error(`HTTP ${we.status}`);const je=await we.json();ce=Array.isArray(je==null?void 0:je.facturasAgregadas)?je.facturasAgregadas:[]}const W=await ma.obtenerConfiguracionLogos(),le=(ce||[]).map(ie=>{const we=Array.isArray(ie==null?void 0:ie.tickets)?ie.tickets.reduce(($e,Ie)=>$e+(Number(Ie==null?void 0:Ie.total)||0),0):Number(ie==null?void 0:ie.importe)||0;return{descripcion:`Factura ${ie!=null&&ie.serie?`${ie.serie}-${(ie==null?void 0:ie.folio)??""}`:`${(ie==null?void 0:ie.folio)??""}`}${ie!=null&&ie.tienda?`  Tienda ${ie.tienda}`:""}${ie!=null&&ie.fechaEmision?`  ${ie.fechaEmision}`:""}`,cantidad:1,unidad:"Factura",precioUnitario:we,importe:we}}),I=le.reduce((ie,we)=>ie+(Number(we==null?void 0:we.importe)||0),0),q={uuid:`RESUMEN-GLOBAL-${e.periodo}-${e.fecha}`,rfcEmisor:"N/A",nombreEmisor:"Resumen Facturacin Global",rfcReceptor:"N/A",nombreReceptor:e.tienda==="Todas"?"Todas las tiendas":`Tienda ${e.tienda}`,serie:"RG",folio:`${e.periodo}_${e.fecha}`,fechaEmision:new Date().toISOString(),importe:I,subtotal:I,iva:0,conceptos:le,metodoPago:"PUE",formaPago:"99",usoCFDI:"G03"},ne=await fetch(Re("/factura/generar-pdf"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({facturaData:q,logoConfig:{logoUrl:W.logoUrl,logoBase64:W.logoBase64,customColors:W.customColors}})});if(!ne.ok){const ie=await ne.text().catch(()=>"");throw new Error(`Error al generar PDF (HTTP ${ne.status}) ${ie}`)}const G=await ne.blob(),ee=`Resumen_Global_${e.periodo}_${e.fecha}.pdf`;tx.descargarPDF(G,ee),x({message:`PDF generado: ${ae.folio}`,type:"success"})}catch(ce){console.error("Error generando PDF de resumen global:",ce),x({message:(ce==null?void 0:ce.message)||"Error al generar PDF de resumen global.",type:"error"})}},X=async ae=>{try{const ce=await H(),W=new Blob([ce],{type:"application/xml"}),le=window.URL.createObjectURL(W),I=document.createElement("a"),q=`Resumen_Global_${e.periodo}_${e.fecha}.xml`;I.href=le,I.download=q,document.body.appendChild(I),I.click(),window.URL.revokeObjectURL(le),document.body.removeChild(I),x({message:`XML descargado: ${q}`,type:"success"})}catch(ce){console.error("Error generando/descargando XML de resumen global:",ce),x({message:(ce==null?void 0:ce.message)||"Error al generar XML de resumen global.",type:"error"})}},T=ae=>{g({open:!0,factura:ae})},L=ae=>{E(ce=>{const W=new Set(ce);return W.has(ae)?W.delete(ae):W.add(ae),W})},V=async(ae,ce)=>{try{await ma.generarYDescargarPDF(ae),x({message:`PDF descargado: ${ce}`,type:"success"})}catch(W){console.error("Error descargando PDF de factura:",W),x({message:(W==null?void 0:W.message)||"Error al descargar el PDF de la factura.",type:"error"})}},O=async ae=>{try{await ma.generarYDescargarXML(ae),x({message:"XML descargado exitosamente",type:"success"})}catch(ce){console.error("Error descargando XML de factura:",ce),x({message:(ce==null?void 0:ce.message)||"Error al descargar el XML de la factura.",type:"error"})}},de=async()=>{if(s.length===0){x({message:"No hay facturas para guardar como factura global.",type:"error"});return}try{k(!0);const ae=s.reduce((ne,G)=>ne+Number((G==null?void 0:G.importe)??0),0),ce=(()=>{const ne=e.fecha;if(e.periodo==="DIA")return`da ${ne}`;if(e.periodo==="SEMANA"){const ie=new Date(ne+"T00:00:00");ie.setHours(0,0,0,0),ie.setDate(ie.getDate()+3-(ie.getDay()+6)%7);const we=new Date(ie.getFullYear(),0,4);return`semana ${1+Math.round(((ie.getTime()-we.getTime())/864e5-3+(we.getDay()+6)%7)/7)}`}const G=new Date(ne+"T00:00:00");return`mes ${["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"][G.getMonth()]} ${G.getFullYear()}`})(),W=s.map(ne=>ne.uuid).filter(Boolean),le={periodo:e.periodo,fecha:e.fecha,codigoTienda:e.tienda==="Todas"||!e.tienda?null:e.tienda,serie:"RG",folio:`${e.periodo}_${e.fecha}`,importe:ae,subtotal:ae,facturasHijasUuid:W,totalFacturas:o.totalFacturas||0,totalTickets:o.totalTickets||0,totalCartaPorte:o.totalCartaPorte||0,descripcion:`Facturacin Global - ${ce}`},I=await fetch(Re("/factura/global/guardar"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(le)});if(!I.ok){const ne=await I.text().catch(()=>"Error desconocido");throw new Error(`Error al guardar factura global: ${ne}`)}const q=await I.json();if(q.success){const ne=q.idFacturaGlobal||q.uuid||"global-"+Date.now();R(G=>{const ee=new Set(G);return ee.add(ne),ee}),x({message:`Factura global guardada exitosamente. ID: ${q.idFacturaGlobal||ne}`,type:"success"})}else throw new Error(q.message||"Error al guardar factura global")}catch(ae){console.error("Error guardando factura global:",ae),x({message:(ae==null?void 0:ae.message)||"Error al guardar la factura global. Por favor intenta nuevamente.",type:"error"})}finally{k(!1)}},me=async()=>{h!=null&&h.factura&&(g({...h,loading:!0}),setTimeout(()=>{r(ae=>ae.map(ce=>ce.id===h.factura.id?{...ce,estatus:"Cancelada"}:ce)),g(null),x({message:`Factura ${h.factura.folio} cancelada exitosamente.`,type:"success"})},1200))};return n.jsxs("form",{onSubmit:Q,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"--Especificar bsqueda--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-4 items-end",children:[n.jsx(J,{label:"Fecha:",name:"fecha",type:"date",value:e.fecha,onChange:_}),n.jsx(Se,{label:"Periodo:",name:"periodo",value:e.periodo,onChange:_,options:[{value:"DIA",label:"Da"},{value:"SEMANA",label:"Semana"},{value:"MES",label:"Mes"}]}),n.jsx(Se,{label:"Tienda:",name:"tienda",value:e.tienda,onChange:_,options:Ia}),n.jsx(Se,{label:"Tipo de Factura:",name:"tipoFactura",value:e.tipoFactura,onChange:_,options:oC}),n.jsx(Se,{label:"Estatus:",name:"estatus",value:e.estatus,onChange:_,options:lC})]}),n.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[n.jsx(fe,{type:"submit",variant:"primary",children:"Consultar"}),n.jsx(fe,{type:"button",onClick:C,variant:"secondary",children:"Excel"})]})]}),t.length>0?n.jsx(PC,{results:t,onPdf:B,onXml:X,onCancelar:T,onPreview:z,onEnviarCorreo:D}):n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px] flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados de la bsqueda aparecern aqu."}),s.length>0&&n.jsxs(ve,{children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Facturas del Periodo Seleccionado"}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Total: ",s.length," factura(s)"]}),n.jsx(fe,{type:"button",variant:"primary",onClick:de,disabled:F||P.size>0,children:F?"Guardando...":P.size>0?" Factura Global Guardada":"Guardar Factura Global"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Accin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Serie-Folio"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"UUID"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Fecha Emisin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tienda"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Estatus"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Importe"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tickets"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Acciones"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:s.map((ae,ce)=>{const W=A.has(ae.uuid),le=Array.isArray(ae.tickets)?ae.tickets.length:0,I=ae.serie?`${ae.serie}-${ae.folio??""}`:`${ae.folio??""}`,q=ae.estatusFacturacion||"",ne=ae.estatusSat?` (${ae.estatusSat})`:"";return n.jsxs(or.Fragment,{children:[n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:n.jsx("button",{onClick:()=>L(ae.uuid),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200 font-medium text-sm",children:W?" Ocultar":" Ver Detalles"})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:I}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 dark:text-gray-300",children:n.jsx("span",{className:"truncate block max-w-xs",title:ae.uuid,children:ae.uuid})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:ae.fechaEmision?new Date(ae.fechaEmision).toLocaleDateString("es-MX"):"-"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:ae.tienda||"-"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsxs("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${q==="Timbrada"||q==="TIMBRADA"?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100":q==="Cancelada"||q==="CANCELADA"?"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100":"bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100"}`,children:[q,ne]})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-semibold text-gray-900 dark:text-white",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(ae.importe??0))}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:le}),n.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium space-x-2",children:[n.jsx("button",{onClick:()=>V(ae.uuid,I),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200",title:"Descargar PDF",children:"PDF"}),n.jsx("button",{onClick:()=>O(ae.uuid),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200",title:"Descargar XML",children:"XML"})]})]}),W&&n.jsx("tr",{children:n.jsx("td",{colSpan:9,className:"px-4 py-4 bg-gray-50 dark:bg-gray-800",children:n.jsx("div",{className:"space-y-4",children:Array.isArray(ae.tickets)&&ae.tickets.length>0?n.jsxs(n.Fragment,{children:[n.jsxs("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Tickets asociados (",ae.tickets.length,"):"]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 bg-white dark:bg-gray-900 rounded-md",children:[n.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"ID Ticket"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Folio"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Forma Pago"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Total"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Detalles"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:ae.tickets.map((G,ee)=>n.jsxs(or.Fragment,{children:[n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[n.jsx("td",{className:"px-3 py-2 text-sm text-gray-900 dark:text-white",children:G.idTicket}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-300",children:G.folio??"-"}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-300",children:G.fecha?new Date(G.fecha).toLocaleDateString("es-MX"):"-"}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-300",children:G.formaPago??"-"}),n.jsx("td",{className:"px-3 py-2 text-sm font-semibold text-gray-900 dark:text-white",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(G.total??0))}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-300",children:Array.isArray(G.detalles)?`${G.detalles.length} producto(s)`:"0 productos"})]}),Array.isArray(G.detalles)&&G.detalles.length>0&&n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-3 py-2 bg-gray-50 dark:bg-gray-700",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-600",children:[n.jsx("thead",{className:"bg-gray-200 dark:bg-gray-600",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-600 dark:text-gray-300",children:"Descripcin"}),n.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-600 dark:text-gray-300",children:"Cant."}),n.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-600 dark:text-gray-300",children:"Unidad"}),n.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-600 dark:text-gray-300",children:"Precio Unit."}),n.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-600 dark:text-gray-300",children:"Subtotal"}),n.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-600 dark:text-gray-300",children:"IVA"}),n.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-600 dark:text-gray-300",children:"Total"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600 bg-white dark:bg-gray-800",children:G.detalles.map((ie,we)=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[n.jsx("td",{className:"px-2 py-1 text-xs text-gray-700 dark:text-gray-300",children:ie.descripcion??"-"}),n.jsx("td",{className:"px-2 py-1 text-xs text-gray-500 dark:text-gray-400",children:ie.cantidad??"-"}),n.jsx("td",{className:"px-2 py-1 text-xs text-gray-500 dark:text-gray-400",children:ie.unidad??"-"}),n.jsx("td",{className:"px-2 py-1 text-xs text-gray-500 dark:text-gray-400",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(ie.precioUnitario??0))}),n.jsx("td",{className:"px-2 py-1 text-xs text-gray-500 dark:text-gray-400",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(ie.subtotal??0))}),n.jsx("td",{className:"px-2 py-1 text-xs text-gray-500 dark:text-gray-400",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(ie.ivaImporte??0))}),n.jsx("td",{className:"px-2 py-1 text-xs font-semibold text-gray-900 dark:text-white",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(ie.total??0))})]},`detalle-${ie.idDetalle}-${we}`))})]})})})})]},`ticket-${G.idTicket}-${ee}`))})]})})]}):n.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-2",children:"No hay tickets asociados a esta factura."})})})})]},`factura-${ae.uuid}-${ce}`)})})]})})]}),n.jsx(Nf,{open:!!(h!=null&&h.open),title:"Confirmar cancelacin",onClose:()=>g(null),onConfirm:me,confirmText:"Cancelar factura",loading:h==null?void 0:h.loading,children:(h==null?void 0:h.factura)&&n.jsxs(n.Fragment,{children:["Ests seguro que deseas cancelar la factura ",n.jsx("b",{children:h.factura.folio}),"? Esta accin no se puede deshacer."]})}),n.jsx(Nf,{open:!!(p!=null&&p.open),title:"Enviar resumen global por correo",onClose:()=>v(null),onConfirm:U,confirmText:"Enviar",loading:y,children:n.jsxs("div",{className:"space-y-3",children:[n.jsx(J,{label:"Correo electrnico del destinatario",name:"correoDestino",type:"email",value:w,onChange:ae=>b(ae.target.value)}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Se enviarn adjuntos: PDF y XML del resumen de facturacin global generado con los filtros actuales."})]})}),n.jsxs(Nf,{open:c,title:"Vista previa - Facturacin global",onClose:()=>u(!1),children:[typeof o.totalFacturas=="number"||typeof o.totalTickets=="number"||typeof o.totalCartaPorte=="number"?n.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:[n.jsxs("span",{className:"mr-4",children:["Facturas: ",n.jsx("b",{children:o.totalFacturas??"-"})]}),n.jsxs("span",{className:"mr-4",children:["Tickets: ",n.jsx("b",{children:o.totalTickets??"-"})]}),n.jsxs("span",{children:["Carta Porte: ",n.jsx("b",{children:o.totalCartaPorte??"-"})]})]}):null,s.length===0?n.jsx("div",{className:"p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md text-gray-400 dark:text-gray-500",children:"No hay facturas con estructura agregada para mostrar."}):n.jsx("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto pr-2",children:s.map((ae,ce)=>n.jsxs("div",{className:"border rounded-md p-4 bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:[n.jsx("b",{children:"Factura:"})," ",ae.serie?`${ae.serie}-${ae.folio??""}`:ae.folio??""]}),n.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:[n.jsx("b",{children:"UUID:"})," ",ae.uuid]}),n.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:[n.jsx("b",{children:"Fecha:"})," ",ae.fechaEmision??""]}),n.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:[n.jsx("b",{children:"Estatus:"})," ",ae.estatusFacturacion??""," ",ae.estatusSat?`(${ae.estatusSat})`:""]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:[n.jsx("b",{children:"Tienda:"})," ",ae.tienda??""]}),n.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(ae.importe??0))})]})]}),Array.isArray(ae.tickets)&&ae.tickets.length>0?n.jsx("div",{className:"mt-4 overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:n.jsx("tr",{children:["Ticket","Folio","Fecha","Forma Pago","Total"].map(W=>n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:W},W))})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:ae.tickets.map((W,le)=>n.jsxs("tr",{className:"align-top",children:[n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:W.idTicket}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:W.folio??""}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:W.fecha??""}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:W.formaPago??""}),n.jsx("td",{className:"px-4 py-2 text-sm font-semibold text-gray-900 dark:text-white",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(W.total??0))})]},`preview-${ae.uuid}-t-${le}`))})]})}):n.jsx("div",{className:"mt-3 text-sm text-gray-500 dark:text-gray-400",children:"Sin tickets vinculados."}),Array.isArray(ae.tickets)&&ae.tickets.map((W,le)=>n.jsx("div",{className:"mt-3",children:Array.isArray(W.detalles)&&W.detalles.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:n.jsx("tr",{children:["Descripcin","Cantidad","Unidad","Precio","Subtotal","IVA","Total"].map(I=>n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:I},I))})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:W.detalles.map((I,q)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:I.descripcion??""}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:I.cantidad??""}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:I.unidad??""}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(I.precioUnitario??0))}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(I.subtotal??0))}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(I.ivaImporte??0))}),n.jsx("td",{className:"px-4 py-2 text-sm font-semibold text-gray-900 dark:text-white",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(I.total??0))})]},`preview-${W.idTicket}-d-${q}`))})]})}):n.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Sin detalles para el ticket ",W.idTicket,"."]})},`preview-${ae.uuid}-td-${le}`))]},`preview-${ae.uuid}-${ce}`))})]}),m&&n.jsx(RC,{message:m.message,type:m.type,onClose:()=>x(null)})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var O0={};O0.version="0.18.5";var Mw=1252,IC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ah={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Rh=function(e){IC.indexOf(e)!=-1&&(Mw=Ah[0]=e)};function MC(){Rh(1252)}var Zr=function(e){Rh(e)};function Dh(){Zr(1200),MC()}function i1(e){for(var a=[],t=0,r=e.length;t<r;++t)a[t]=e.charCodeAt(t);return a}function UC(e){for(var a=[],t=0;t<e.length>>1;++t)a[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return a.join("")}function Uw(e){for(var a=[],t=0;t<e.length>>1;++t)a[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return a.join("")}var Nl=function(e){var a=e.charCodeAt(0),t=e.charCodeAt(1);return a==255&&t==254?UC(e.slice(2)):a==254&&t==255?Uw(e.slice(2)):a==65279?e.slice(1):e},pd=function(a){return String.fromCharCode(a)},o1=function(a){return String.fromCharCode(a)},rx,fn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function dc(e){for(var a="",t=0,r=0,s=0,i=0,o=0,l=0,c=0,u=0;u<e.length;)t=e.charCodeAt(u++),i=t>>2,r=e.charCodeAt(u++),o=(t&3)<<4|r>>4,s=e.charCodeAt(u++),l=(r&15)<<2|s>>6,c=s&63,isNaN(r)?l=c=64:isNaN(s)&&(c=64),a+=fn.charAt(i)+fn.charAt(o)+fn.charAt(l)+fn.charAt(c);return a}function Fr(e){var a="",t=0,r=0,s=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=fn.indexOf(e.charAt(u++)),o=fn.indexOf(e.charAt(u++)),t=i<<2|o>>4,a+=String.fromCharCode(t),l=fn.indexOf(e.charAt(u++)),r=(o&15)<<4|l>>2,l!==64&&(a+=String.fromCharCode(r)),c=fn.indexOf(e.charAt(u++)),s=(l&3)<<6|c,c!==64&&(a+=String.fromCharCode(s));return a}var la=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),qs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(a,t){return t?new Buffer(a,t):new Buffer(a)}:Buffer.from.bind(Buffer)}return function(){}}();function Tn(e){return la?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function l1(e){return la?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var wr=function(a){return la?qs(a,"binary"):a.split("").map(function(t){return t.charCodeAt(0)&255})};function vu(e){if(typeof ArrayBuffer>"u")return wr(e);for(var a=new ArrayBuffer(e.length),t=new Uint8Array(a),r=0;r!=e.length;++r)t[r]=e.charCodeAt(r)&255;return a}function In(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var a=[],t=0;t<e.length;++t)a[t]=String.fromCharCode(e[t]);return a.join("")}function LC(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Ph(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ph(new Uint8Array(e));for(var a=new Array(e.length),t=0;t<e.length;++t)a[t]=e[t];return a}var Nt=la?function(e){return Buffer.concat(e.map(function(a){return Buffer.isBuffer(a)?a:qs(a)}))}:function(e){if(typeof Uint8Array<"u"){var a=0,t=0;for(a=0;a<e.length;++a)t+=e[a].length;var r=new Uint8Array(t),s=0;for(a=0,t=0;a<e.length;t+=s,++a)if(s=e[a].length,e[a]instanceof Uint8Array)r.set(e[a],t);else{if(typeof e[a]=="string")throw"wtf";r.set(new Uint8Array(e[a]),t)}return r}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function BC(e){for(var a=[],t=0,r=e.length+250,s=Tn(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[t++]=o;else if(o<2048)s[t++]=192|o>>6&31,s[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;s[t++]=240|o>>8&7,s[t++]=128|o>>2&63,s[t++]=128|l>>6&15|(o&3)<<4,s[t++]=128|l&63}else s[t++]=224|o>>12&15,s[t++]=128|o>>6&63,s[t++]=128|o&63;t>r&&(a.push(s.slice(0,t)),t=0,s=Tn(65535),r=65530)}return a.push(s.slice(0,t)),Nt(a)}var ar=/\u0000/g,jl=/[\u0001-\u0006]/g;function jo(e){for(var a="",t=e.length-1;t>=0;)a+=e.charAt(t--);return a}function Qr(e,a){var t=""+e;return t.length>=a?t:Za("0",a-t.length)+t}function Oh(e,a){var t=""+e;return t.length>=a?t:Za(" ",a-t.length)+t}function I0(e,a){var t=""+e;return t.length>=a?t:t+Za(" ",a-t.length)}function zC(e,a){var t=""+Math.round(e);return t.length>=a?t:Za("0",a-t.length)+t}function $C(e,a){var t=""+e;return t.length>=a?t:Za("0",a-t.length)+t}var c1=Math.pow(2,32);function Mi(e,a){if(e>c1||e<-c1)return zC(e,a);var t=Math.round(e);return $C(t,a)}function M0(e,a){return a=a||0,e.length>=7+a&&(e.charCodeAt(a)|32)===103&&(e.charCodeAt(a+1)|32)===101&&(e.charCodeAt(a+2)|32)===110&&(e.charCodeAt(a+3)|32)===101&&(e.charCodeAt(a+4)|32)===114&&(e.charCodeAt(a+5)|32)===97&&(e.charCodeAt(a+6)|32)===108}var d1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],jf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function VC(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},u1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},HC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function U0(e,a,t){for(var r=e<0?-1:1,s=e*r,i=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(s);u<a&&(f=Math.floor(s),l=f*o+i,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),i=o,o=l,c=u,u=d;if(d>a&&(u>a?(d=c,l=i):(d=u,l=o)),!t)return[0,r*l,d];var m=Math.floor(r*l/d);return[m,r*l-m*d,d]}function Yn(e,a,t){if(e>2958465||e<0)return null;var r=e|0,s=Math.floor(86400*(e-r)),i=0,o=[],l={D:r,T:s,u:86400*(e-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),a&&a.date1904&&(r+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++r,++l.D)),r===60)o=t?[1317,10,29]:[1900,2,29],i=3;else if(r===0)o=t?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var c=new Date(1900,0,1);c.setDate(c.getDate()+r-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),r<60&&(i=(i+6)%7),t&&(i=KC(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var Lw=new Date(1899,11,31,0,0,0),GC=Lw.getTime(),XC=new Date(1900,2,1,0,0,0);function Bw(e,a){var t=e.getTime();return a?t-=1461*24*60*60*1e3:e>=XC&&(t+=24*60*60*1e3),(t-(GC+(e.getTimezoneOffset()-Lw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ih(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function qC(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function YC(e){var a=e<0?12:11,t=Ih(e.toFixed(12));return t.length<=a||(t=e.toPrecision(10),t.length<=a)?t:e.toExponential(5)}function WC(e){var a=Ih(e.toFixed(11));return a.length>(e<0?12:11)||a==="0"||a==="-0"?e.toPrecision(6):a}function uc(e){var a=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return a>=-4&&a<=-1?t=e.toPrecision(10+a):Math.abs(a)<=9?t=YC(e):a===10?t=e.toFixed(10).substr(0,12):t=WC(e),Ih(qC(t.toUpperCase()))}function hi(e,a){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):uc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Xr(14,Bw(e,a&&a.date1904),a)}throw new Error("unsupported value in General format: "+e)}function KC(e,a){a[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function JC(e,a,t,r){var s="",i=0,o=0,l=t.y,c,u=0;switch(e){case 98:l=t.y+543;case 121:switch(a.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(a.length){case 1:case 2:c=t.m,u=a.length;break;case 3:return jf[t.m-1][1];case 5:return jf[t.m-1][0];default:return jf[t.m-1][2]}break;case 100:switch(a.length){case 1:case 2:c=t.d,u=a.length;break;case 3:return d1[t.q][0];default:return d1[t.q][1]}break;case 104:switch(a.length){case 1:case 2:c=1+(t.H+11)%12,u=a.length;break;default:throw"bad hour format: "+a}break;case 72:switch(a.length){case 1:case 2:c=t.H,u=a.length;break;default:throw"bad hour format: "+a}break;case 77:switch(a.length){case 1:case 2:c=t.M,u=a.length;break;default:throw"bad minute format: "+a}break;case 115:if(a!="s"&&a!="ss"&&a!=".0"&&a!=".00"&&a!=".000")throw"bad second format: "+a;return t.u===0&&(a=="s"||a=="ss")?Qr(t.S,a.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,i=Math.round(o*(t.S+t.u)),i>=60*o&&(i=0),a==="s"?i===0?"0":""+i/o:(s=Qr(i,2+r),a==="ss"?s.substr(0,2):"."+s.substr(2,a.length-1)));case 90:switch(a){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+a}u=a.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Qr(c,u):"";return d}function mn(e){var a=3;if(e.length<=a)return e;for(var t=e.length%a,r=e.substr(0,t);t!=e.length;t+=a)r+=(r.length>0?",":"")+e.substr(t,a);return r}var zw=/%/g;function ZC(e,a,t){var r=a.replace(zw,""),s=a.length-r.length;return Ms(e,r,t*Math.pow(10,2*s))+Za("%",s)}function QC(e,a,t){for(var r=a.length-1;a.charCodeAt(r-1)===44;)--r;return Ms(e,a.substr(0,r),t/Math.pow(10,3*(a.length-r)))}function $w(e,a){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+$w(e,-a);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(a)*Math.LOG10E)%s;if(i<0&&(i+=s),t=(a/Math.pow(10,i)).toPrecision(r+1+(s+i)%s),t.indexOf("e")===-1){var o=Math.floor(Math.log(a)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+i):t+="E+"+(o-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else t=a.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Vw=/# (\?+)( ?)\/( ?)(\d+)/;function eT(e,a,t){var r=parseInt(e[4],10),s=Math.round(a*r),i=Math.floor(s/r),o=s-i*r,l=r;return t+(i===0?"":""+i)+" "+(o===0?Za(" ",e[1].length+1+e[4].length):Oh(o,e[1].length)+e[2]+"/"+e[3]+Qr(l,e[4].length))}function aT(e,a,t){return t+(a===0?"":""+a)+Za(" ",e[1].length+2+e[4].length)}var Hw=/^#*0*\.([0#]+)/,Gw=/\).*[0#]/,Xw=/\(###\) ###\\?-####/;function Jt(e){for(var a="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:a+=" ";break;case 48:a+="0";break;default:a+=String.fromCharCode(t)}return a}function f1(e,a){var t=Math.pow(10,a);return""+Math.round(e*t)/t}function m1(e,a){var t=e-Math.floor(e),r=Math.pow(10,a);return a<(""+Math.round(t*r)).length?0:Math.round(t*r)}function tT(e,a){return a<(""+Math.round((e-Math.floor(e))*Math.pow(10,a))).length?1:0}function rT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ar(e,a,t){if(e.charCodeAt(0)===40&&!a.match(Gw)){var r=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ar("n",r,t):"("+Ar("n",r,-t)+")"}if(a.charCodeAt(a.length-1)===44)return QC(e,a,t);if(a.indexOf("%")!==-1)return ZC(e,a,t);if(a.indexOf("E")!==-1)return $w(a,t);if(a.charCodeAt(0)===36)return"$"+Ar(e,a.substr(a.charAt(1)==" "?2:1),t);var s,i,o,l,c=Math.abs(t),u=t<0?"-":"";if(a.match(/^00+$/))return u+Mi(c,a.length);if(a.match(/^[#?]+$/))return s=Mi(t,0),s==="0"&&(s=""),s.length>a.length?s:Jt(a.substr(0,a.length-s.length))+s;if(i=a.match(Vw))return eT(i,c,u);if(a.match(/^#+0+$/))return u+Mi(c,a.length-a.indexOf("0"));if(i=a.match(Hw))return s=f1(t,i[1].length).replace(/^([^\.]+)$/,"$1."+Jt(i[1])).replace(/\.$/,"."+Jt(i[1])).replace(/\.(\d*)$/,function(h,g){return"."+g+Za("0",Jt(i[1]).length-g.length)}),a.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),i=a.match(/^(0*)\.(#*)$/))return u+f1(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=a.match(/^#{1,3},##0(\.?)$/))return u+mn(Mi(c,0));if(i=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ar(e,a,-t):mn(""+(Math.floor(t)+tT(t,i[1].length)))+"."+Qr(m1(t,i[1].length),i[1].length);if(i=a.match(/^#,#*,#0/))return Ar(e,a.replace(/^#,#*,/,""),t);if(i=a.match(/^([0#]+)(\\?-([0#]+))+$/))return s=jo(Ar(e,a.replace(/[\\-]/g,""),t)),o=0,jo(jo(a.replace(/\\/g,"")).replace(/[0#]/g,function(h){return o<s.length?s.charAt(o++):h==="0"?"0":""}));if(a.match(Xw))return s=Ar(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=U0(c,Math.pow(10,o)-1,!1),s=""+u,d=Ms("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=I0(l[2],o),d.length<i[4].length&&(d=Jt(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=U0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Oh(l[1],o)+i[2]+"/"+i[3]+I0(l[2],o):Za(" ",2*o+1+i[2].length+i[3].length));if(i=a.match(/^[#0?]+$/))return s=Mi(t,0),a.length<=s.length?s:Jt(a.substr(0,a.length-s.length))+s;if(i=a.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=a.indexOf(".")-o,m=a.length-s.length-f;return Jt(a.substr(0,f)+s+a.substr(a.length-m))}if(i=a.match(/^00,000\.([#0]*0)$/))return o=m1(t,i[1].length),t<0?"-"+Ar(e,a,-t):mn(rT(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(h){return"00,"+(h.length<3?Qr(0,3-h.length):"")+h})+"."+Qr(o,i[1].length);switch(a){case"###,##0.00":return Ar(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var x=mn(Mi(c,0));return x!=="0"?u+x:"";case"###,###.00":return Ar(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ar(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+a+"|")}function sT(e,a,t){for(var r=a.length-1;a.charCodeAt(r-1)===44;)--r;return Ms(e,a.substr(0,r),t/Math.pow(10,3*(a.length-r)))}function nT(e,a,t){var r=a.replace(zw,""),s=a.length-r.length;return Ms(e,r,t*Math.pow(10,2*s))+Za("%",s)}function qw(e,a){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+qw(e,-a);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(a)*Math.LOG10E)%s;if(i<0&&(i+=s),t=(a/Math.pow(10,i)).toPrecision(r+1+(s+i)%s),!t.match(/[Ee]/)){var o=Math.floor(Math.log(a)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+i):t+="E+"+(o-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else t=a.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function cs(e,a,t){if(e.charCodeAt(0)===40&&!a.match(Gw)){var r=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?cs("n",r,t):"("+cs("n",r,-t)+")"}if(a.charCodeAt(a.length-1)===44)return sT(e,a,t);if(a.indexOf("%")!==-1)return nT(e,a,t);if(a.indexOf("E")!==-1)return qw(a,t);if(a.charCodeAt(0)===36)return"$"+cs(e,a.substr(a.charAt(1)==" "?2:1),t);var s,i,o,l,c=Math.abs(t),u=t<0?"-":"";if(a.match(/^00+$/))return u+Qr(c,a.length);if(a.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>a.length?s:Jt(a.substr(0,a.length-s.length))+s;if(i=a.match(Vw))return aT(i,c,u);if(a.match(/^#+0+$/))return u+Qr(c,a.length-a.indexOf("0"));if(i=a.match(Hw))return s=(""+t).replace(/^([^\.]+)$/,"$1."+Jt(i[1])).replace(/\.$/,"."+Jt(i[1])),s=s.replace(/\.(\d*)$/,function(h,g){return"."+g+Za("0",Jt(i[1]).length-g.length)}),a.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),i=a.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=a.match(/^#{1,3},##0(\.?)$/))return u+mn(""+c);if(i=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+cs(e,a,-t):mn(""+t)+"."+Za("0",i[1].length);if(i=a.match(/^#,#*,#0/))return cs(e,a.replace(/^#,#*,/,""),t);if(i=a.match(/^([0#]+)(\\?-([0#]+))+$/))return s=jo(cs(e,a.replace(/[\\-]/g,""),t)),o=0,jo(jo(a.replace(/\\/g,"")).replace(/[0#]/g,function(h){return o<s.length?s.charAt(o++):h==="0"?"0":""}));if(a.match(Xw))return s=cs(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=U0(c,Math.pow(10,o)-1,!1),s=""+u,d=Ms("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=I0(l[2],o),d.length<i[4].length&&(d=Jt(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=U0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Oh(l[1],o)+i[2]+"/"+i[3]+I0(l[2],o):Za(" ",2*o+1+i[2].length+i[3].length));if(i=a.match(/^[#0?]+$/))return s=""+t,a.length<=s.length?s:Jt(a.substr(0,a.length-s.length))+s;if(i=a.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=a.indexOf(".")-o,m=a.length-s.length-f;return Jt(a.substr(0,f)+s+a.substr(a.length-m))}if(i=a.match(/^00,000\.([#0]*0)$/))return t<0?"-"+cs(e,a,-t):mn(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(h){return"00,"+(h.length<3?Qr(0,3-h.length):"")+h})+"."+Qr(0,i[1].length);switch(a){case"###,###":case"##,###":case"#,###":var x=mn(""+c);return x!=="0"?u+x:"";default:if(a.match(/\.[0#?]*$/))return cs(e,a.slice(0,a.lastIndexOf(".")),t)+Jt(a.slice(a.lastIndexOf(".")))}throw new Error("unsupported format |"+a+"|")}function Ms(e,a,t){return(t|0)===t?cs(e,a,t):Ar(e,a,t)}function iT(e){for(var a=[],t=!1,r=0,s=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:a[a.length]=e.substr(s,r-s),s=r+1}if(a[a.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return a}var Yw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Zo(e){for(var a=0,t="",r="";a<e.length;)switch(t=e.charAt(a)){case"G":M0(e,a)&&(a+=6),a++;break;case'"':for(;e.charCodeAt(++a)!==34&&a<e.length;);++a;break;case"\\":a+=2;break;case"_":a+=2;break;case"@":++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(a,3).toUpperCase()==="A/P"||e.substr(a,5).toUpperCase()==="AM/PM"||e.substr(a,5).toUpperCase()==="/")return!0;++a;break;case"[":for(r=t;e.charAt(a++)!=="]"&&a<e.length;)r+=e.charAt(a);if(r.match(Yw))return!0;break;case".":case"0":case"#":for(;a<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++a))>-1||t=="\\"&&e.charAt(a+1)=="-"&&"0#".indexOf(e.charAt(a+2))>-1););break;case"?":for(;e.charAt(++a)===t;);break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;);break;case" ":++a;break;default:++a;break}return!1}function oT(e,a,t,r){for(var s=[],i="",o=0,l="",c="t",u,d,f,m="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!M0(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++o;break;case"\\":var x=e.charAt(++o),h=x==="("||x===")"?x:"t";s[s.length]={t:h,v:x},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:a},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Yn(a,t,e.charAt(o+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(a<0||u==null&&(u=Yn(a,t),u==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var g={t:l,v:l};if(u==null&&(u=Yn(a,t)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",o+=5,m="h"):(g.t="t",++o),u==null&&g.t==="T")return"";s[s.length]=g,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Yw)){if(u==null&&(u=Yn(a,t),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Zo(e)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:r===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var p=0,v=0,w;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=m,c="h",p<1&&(p=1);break;case"s":(w=s[o].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&s[o].v.match(/[Hh]/)&&(p=1),p<2&&s[o].v.match(/[Mm]/)&&(p=2),p<3&&s[o].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",y;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=JC(s[o].t.charCodeAt(0),s[o].v,u,v),s[o].t="t";break;case"n":case"?":for(y=o+1;s[y]!=null&&((l=s[y].t)==="?"||l==="D"||(l===" "||l==="t")&&s[y+1]!=null&&(s[y+1].t==="?"||s[y+1].t==="t"&&s[y+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[y].v==="/"||s[y].v===" "&&s[y+1]!=null&&s[y+1].t=="?"));)s[o].v+=s[y].v,s[y]={v:"",t:";"},++y;b+=s[o].v,o=y-1;break;case"G":s[o].t="t",s[o].v=hi(a,t);break}var j="",A,E;if(b.length>0){b.charCodeAt(0)==40?(A=a<0&&b.charCodeAt(0)===45?-a:a,E=Ms("n",b,A)):(A=a<0&&r>1?-a:a,E=Ms("n",b,A),A<0&&s[0]&&s[0].t=="t"&&(E=E.substr(1),s[0].v="-"+s[0].v)),y=E.length-1;var F=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){F=o;break}var k=s.length;if(F===s.length&&E.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(y>=s[o].v.length-1?(y-=s[o].v.length,s[o].v=E.substr(y+1,s[o].v.length)):y<0?s[o].v="":(s[o].v=E.substr(0,y+1),y=-1),s[o].t="t",k=o);y>=0&&k<s.length&&(s[k].v=E.substr(0,y+1)+s[k].v)}else if(F!==s.length&&E.indexOf("E")===-1){for(y=E.indexOf(".")-1,o=F;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===F?s[o].v.indexOf(".")-1:s[o].v.length-1,j=s[o].v.substr(d+1);d>=0;--d)y>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(j=E.charAt(y--)+j);s[o].v=j,s[o].t="t",k=o}for(y>=0&&k<s.length&&(s[k].v=E.substr(0,y+1)+s[k].v),y=E.indexOf(".")+1,o=F;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==F)){for(d=s[o].v.indexOf(".")>-1&&o===F?s[o].v.indexOf(".")+1:0,j=s[o].v.substr(0,d);d<s[o].v.length;++d)y<E.length&&(j+=E.charAt(y++));s[o].v=j,s[o].t="t",k=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(A=r>1&&a<0&&o>0&&s[o-1].v==="-"?-a:a,s[o].v=Ms(s[o].t,s[o].v,A),s[o].t="t");var P="";for(o=0;o!==s.length;++o)s[o]!=null&&(P+=s[o].v);return P}var x1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function h1(e,a){if(a==null)return!1;var t=parseFloat(a[2]);switch(a[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function lT(e,a){var t=iT(e),r=t.length,s=t[r-1].indexOf("@");if(r<4&&s>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof a!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var i=a>0?t[0]:a<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(x1),l=t[1].match(x1);return h1(a,o)?[r,t[0]]:h1(a,l)?[r,t[1]]:[r,t[o!=null&&l!=null?2:1]]}return[r,i]}function Xr(e,a,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:qe)[e],r==null&&(r=t.table&&t.table[u1[e]]||qe[u1[e]]),r==null&&(r=HC[e]||"General");break}if(M0(r,0))return hi(a,t);a instanceof Date&&(a=Bw(a,t.date1904));var s=lT(r,a);if(M0(s[1]))return hi(a,t);if(a===!0)a="TRUE";else if(a===!1)a="FALSE";else if(a===""||a==null)return"";return oT(s[1],a,t,s[0])}function Us(e,a){if(typeof a!="number"){a=+a||-1;for(var t=0;t<392;++t){if(qe[t]==null){a<0&&(a=t);continue}if(qe[t]==e){a=t;break}}a<0&&(a=391)}return qe[a]=e,a}function bu(e){for(var a=0;a!=392;++a)e[a]!==void 0&&Us(e[a],a)}function Qo(){qe=VC()}var cT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ww=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dT(e){var a=typeof e=="number"?qe[e]:e;return a=a.replace(Ww,"(\\d+)"),new RegExp("^"+a+"$")}function uT(e,a,t){var r=-1,s=-1,i=-1,o=-1,l=-1,c=-1;(a.match(Ww)||[]).forEach(function(f,m){var x=parseInt(t[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=x;break;case"d":i=x;break;case"h":o=x;break;case"s":c=x;break;case"m":o>=0?l=x:s=x;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:r==-1&&s==-1&&i==-1?d:u+"T"+d}var fT=function(){var e={};e.version="1.2.0";function a(){for(var E=0,F=new Array(256),k=0;k!=256;++k)E=k,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,F[k]=E;return typeof Int32Array<"u"?new Int32Array(F):F}var t=a();function r(E){var F=0,k=0,P=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)R[P]=E[P];for(P=0;P!=256;++P)for(k=E[P],F=256+P;F<4096;F+=256)k=R[F]=k>>>8^E[k&255];var _=[];for(P=1;P!=16;++P)_[P-1]=typeof Int32Array<"u"?R.subarray(P*256,P*256+256):R.slice(P*256,P*256+256);return _}var s=r(t),i=s[0],o=s[1],l=s[2],c=s[3],u=s[4],d=s[5],f=s[6],m=s[7],x=s[8],h=s[9],g=s[10],p=s[11],v=s[12],w=s[13],b=s[14];function y(E,F){for(var k=F^-1,P=0,R=E.length;P<R;)k=k>>>8^t[(k^E.charCodeAt(P++))&255];return~k}function j(E,F){for(var k=F^-1,P=E.length-15,R=0;R<P;)k=b[E[R++]^k&255]^w[E[R++]^k>>8&255]^v[E[R++]^k>>16&255]^p[E[R++]^k>>>24]^g[E[R++]]^h[E[R++]]^x[E[R++]]^m[E[R++]]^f[E[R++]]^d[E[R++]]^u[E[R++]]^c[E[R++]]^l[E[R++]]^o[E[R++]]^i[E[R++]]^t[E[R++]];for(P+=15;R<P;)k=k>>>8^t[(k^E[R++])&255];return~k}function A(E,F){for(var k=F^-1,P=0,R=E.length,_=0,Q=0;P<R;)_=E.charCodeAt(P++),_<128?k=k>>>8^t[(k^_)&255]:_<2048?(k=k>>>8^t[(k^(192|_>>6&31))&255],k=k>>>8^t[(k^(128|_&63))&255]):_>=55296&&_<57344?(_=(_&1023)+64,Q=E.charCodeAt(P++)&1023,k=k>>>8^t[(k^(240|_>>8&7))&255],k=k>>>8^t[(k^(128|_>>2&63))&255],k=k>>>8^t[(k^(128|Q>>6&15|(_&3)<<4))&255],k=k>>>8^t[(k^(128|Q&63))&255]):(k=k>>>8^t[(k^(224|_>>12&15))&255],k=k>>>8^t[(k^(128|_>>6&63))&255],k=k>>>8^t[(k^(128|_&63))&255]);return~k}return e.table=t,e.bstr=y,e.buf=j,e.str=A,e}(),Ge=function(){var a={};a.version="1.2.1";function t(M,te){for(var K=M.split("/"),Z=te.split("/"),re=0,se=0,he=Math.min(K.length,Z.length);re<he;++re){if(se=K[re].length-Z[re].length)return se;if(K[re]!=Z[re])return K[re]<Z[re]?-1:1}return K.length-Z.length}function r(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:r(M.slice(0,-1));var te=M.lastIndexOf("/");return te===-1?M:M.slice(0,te+1)}function s(M){if(M.charAt(M.length-1)=="/")return s(M.slice(0,-1));var te=M.lastIndexOf("/");return te===-1?M:M.slice(te+1)}function i(M,te){typeof te=="string"&&(te=new Date(te));var K=te.getHours();K=K<<6|te.getMinutes(),K=K<<5|te.getSeconds()>>>1,M.write_shift(2,K);var Z=te.getFullYear()-1980;Z=Z<<4|te.getMonth()+1,Z=Z<<5|te.getDate(),M.write_shift(2,Z)}function o(M){var te=M.read_shift(2)&65535,K=M.read_shift(2)&65535,Z=new Date,re=K&31;K>>>=5;var se=K&15;K>>>=4,Z.setMilliseconds(0),Z.setFullYear(K+1980),Z.setMonth(se-1),Z.setDate(re);var he=te&31;te>>>=5;var Ne=te&63;return te>>>=6,Z.setHours(te),Z.setMinutes(Ne),Z.setSeconds(he<<1),Z}function l(M){At(M,0);for(var te={},K=0;M.l<=M.length-4;){var Z=M.read_shift(2),re=M.read_shift(2),se=M.l+re,he={};switch(Z){case 21589:K=M.read_shift(1),K&1&&(he.mtime=M.read_shift(4)),re>5&&(K&2&&(he.atime=M.read_shift(4)),K&4&&(he.ctime=M.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}M.l=se,te[Z]=he}return te}var c;function u(){return c||(c={})}function d(M,te){if(M[0]==80&&M[1]==75)return ka(M,te);if((M[0]|32)==109&&(M[1]|32)==105)return Rk(M,te);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var K=3,Z=512,re=0,se=0,he=0,Ne=0,xe=0,pe=[],ye=M.slice(0,512);At(ye,0);var Ae=f(ye);switch(K=Ae[0],K){case 3:Z=512;break;case 4:Z=4096;break;case 0:if(Ae[1]==0)return ka(M,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Z!==512&&(ye=M.slice(0,Z),At(ye,28));var Ue=M.slice(0,Z);m(ye,K);var ze=ye.read_shift(4,"i");if(K===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);ye.l+=4,he=ye.read_shift(4,"i"),ye.l+=4,ye.chk("00100000","Mini Stream Cutoff Size: "),Ne=ye.read_shift(4,"i"),re=ye.read_shift(4,"i"),xe=ye.read_shift(4,"i"),se=ye.read_shift(4,"i");for(var De=-1,Be=0;Be<109&&(De=ye.read_shift(4,"i"),!(De<0));++Be)pe[Be]=De;var ea=x(M,Z);p(xe,se,ea,Z,pe);var Xa=w(ea,he,pe,Z);Xa[he].name="!Directory",re>0&&Ne!==Q&&(Xa[Ne].name="!MiniFAT"),Xa[pe[0]].name="!FAT",Xa.fat_addrs=pe,Xa.ssz=Z;var qa={},It=[],nl=[],il=[];b(he,Xa,ea,It,re,qa,nl,Ne),h(nl,il,It),It.shift();var ol={FileIndex:nl,FullPaths:il};return te&&te.raw&&(ol.raw={header:Ue,sectors:ea}),ol}function f(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(C,"Header Signature: "),M.l+=16;var te=M.read_shift(2,"u");return[M.read_shift(2,"u"),te]}function m(M,te){var K=9;switch(M.l+=2,K=M.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function x(M,te){for(var K=Math.ceil(M.length/te)-1,Z=[],re=1;re<K;++re)Z[re-1]=M.slice(re*te,(re+1)*te);return Z[K-1]=M.slice(K*te),Z}function h(M,te,K){for(var Z=0,re=0,se=0,he=0,Ne=0,xe=K.length,pe=[],ye=[];Z<xe;++Z)pe[Z]=ye[Z]=Z,te[Z]=K[Z];for(;Ne<ye.length;++Ne)Z=ye[Ne],re=M[Z].L,se=M[Z].R,he=M[Z].C,pe[Z]===Z&&(re!==-1&&pe[re]!==re&&(pe[Z]=pe[re]),se!==-1&&pe[se]!==se&&(pe[Z]=pe[se])),he!==-1&&(pe[he]=Z),re!==-1&&Z!=pe[Z]&&(pe[re]=pe[Z],ye.lastIndexOf(re)<Ne&&ye.push(re)),se!==-1&&Z!=pe[Z]&&(pe[se]=pe[Z],ye.lastIndexOf(se)<Ne&&ye.push(se));for(Z=1;Z<xe;++Z)pe[Z]===Z&&(se!==-1&&pe[se]!==se?pe[Z]=pe[se]:re!==-1&&pe[re]!==re&&(pe[Z]=pe[re]));for(Z=1;Z<xe;++Z)if(M[Z].type!==0){if(Ne=Z,Ne!=pe[Ne])do Ne=pe[Ne],te[Z]=te[Ne]+"/"+te[Z];while(Ne!==0&&pe[Ne]!==-1&&Ne!=pe[Ne]);pe[Z]=-1}for(te[0]+="/",Z=1;Z<xe;++Z)M[Z].type!==2&&(te[Z]+="/")}function g(M,te,K){for(var Z=M.start,re=M.size,se=[],he=Z;K&&re>0&&he>=0;)se.push(te.slice(he*_,he*_+_)),re-=_,he=qn(K,he*4);return se.length===0?Ee(0):Nt(se).slice(0,M.size)}function p(M,te,K,Z,re){var se=Q;if(M===Q){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var he=K[M],Ne=(Z>>>2)-1;if(!he)return;for(var xe=0;xe<Ne&&(se=qn(he,xe*4))!==Q;++xe)re.push(se);p(qn(he,Z-4),te-1,K,Z,re)}}function v(M,te,K,Z,re){var se=[],he=[];re||(re=[]);var Ne=Z-1,xe=0,pe=0;for(xe=te;xe>=0;){re[xe]=!0,se[se.length]=xe,he.push(M[xe]);var ye=K[Math.floor(xe*4/Z)];if(pe=xe*4&Ne,Z<4+pe)throw new Error("FAT boundary crossed: "+xe+" 4 "+Z);if(!M[ye])break;xe=qn(M[ye],pe)}return{nodes:se,data:C1([he])}}function w(M,te,K,Z){var re=M.length,se=[],he=[],Ne=[],xe=[],pe=Z-1,ye=0,Ae=0,Ue=0,ze=0;for(ye=0;ye<re;++ye)if(Ne=[],Ue=ye+te,Ue>=re&&(Ue-=re),!he[Ue]){xe=[];var De=[];for(Ae=Ue;Ae>=0;){De[Ae]=!0,he[Ae]=!0,Ne[Ne.length]=Ae,xe.push(M[Ae]);var Be=K[Math.floor(Ae*4/Z)];if(ze=Ae*4&pe,Z<4+ze)throw new Error("FAT boundary crossed: "+Ae+" 4 "+Z);if(!M[Be]||(Ae=qn(M[Be],ze),De[Ae]))break}se[Ue]={nodes:Ne,data:C1([xe])}}return se}function b(M,te,K,Z,re,se,he,Ne){for(var xe=0,pe=Z.length?2:0,ye=te[M].data,Ae=0,Ue=0,ze;Ae<ye.length;Ae+=128){var De=ye.slice(Ae,Ae+128);At(De,64),Ue=De.read_shift(2),ze=Vh(De,0,Ue-pe),Z.push(ze);var Be={name:ze,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},ea=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);ea!==0&&(Be.ct=y(De,De.l-8));var Xa=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);Xa!==0&&(Be.mt=y(De,De.l-8)),Be.start=De.read_shift(4,"i"),Be.size=De.read_shift(4,"i"),Be.size<0&&Be.start<0&&(Be.size=Be.type=0,Be.start=Q,Be.name=""),Be.type===5?(xe=Be.start,re>0&&xe!==Q&&(te[xe].name="!StreamData")):Be.size>=4096?(Be.storage="fat",te[Be.start]===void 0&&(te[Be.start]=v(K,Be.start,te.fat_addrs,te.ssz)),te[Be.start].name=Be.name,Be.content=te[Be.start].data.slice(0,Be.size)):(Be.storage="minifat",Be.size<0?Be.size=0:xe!==Q&&Be.start!==Q&&te[xe]&&(Be.content=g(Be,te[xe].data,(te[Ne]||{}).data))),Be.content&&At(Be.content,0),se[ze]=Be,he.push(Be)}}function y(M,te){return new Date((vr(M,te+4)/1e7*Math.pow(2,32)+vr(M,te)/1e7-11644473600)*1e3)}function j(M,te){return u(),d(c.readFileSync(M),te)}function A(M,te){var K=te&&te.type;switch(K||la&&Buffer.isBuffer(M)&&(K="buffer"),K||"base64"){case"file":return j(M,te);case"base64":return d(wr(Fr(M)),te);case"binary":return d(wr(M),te)}return d(M,te)}function E(M,te){var K=te||{},Z=K.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=Z+"/",M.FileIndex[0]={name:Z,type:5}),K.CLSID&&(M.FileIndex[0].clsid=K.CLSID),F(M)}function F(M){var te="Sh33tJ5";if(!Ge.find(M,"/"+te)){var K=Ee(4);K[0]=55,K[1]=K[3]=50,K[2]=54,M.FileIndex.push({name:te,type:2,content:K,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+te),k(M)}}function k(M,te){E(M);for(var K=!1,Z=!1,re=M.FullPaths.length-1;re>=0;--re){var se=M.FileIndex[re];switch(se.type){case 0:Z?K=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(se.R*se.L*se.C)&&(K=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!te)){var he=new Date(1987,1,19),Ne=0,xe=Object.create?Object.create(null):{},pe=[];for(re=0;re<M.FullPaths.length;++re)xe[M.FullPaths[re]]=!0,M.FileIndex[re].type!==0&&pe.push([M.FullPaths[re],M.FileIndex[re]]);for(re=0;re<pe.length;++re){var ye=r(pe[re][0]);Z=xe[ye],Z||(pe.push([ye,{name:s(ye).replace("/",""),type:1,clsid:S,ct:he,mt:he,content:null}]),xe[ye]=!0)}for(pe.sort(function(ze,De){return t(ze[0],De[0])}),M.FullPaths=[],M.FileIndex=[],re=0;re<pe.length;++re)M.FullPaths[re]=pe[re][0],M.FileIndex[re]=pe[re][1];for(re=0;re<pe.length;++re){var Ae=M.FileIndex[re],Ue=M.FullPaths[re];if(Ae.name=s(Ue).replace("/",""),Ae.L=Ae.R=Ae.C=-(Ae.color=1),Ae.size=Ae.content?Ae.content.length:0,Ae.start=0,Ae.clsid=Ae.clsid||S,re===0)Ae.C=pe.length>1?1:-1,Ae.size=0,Ae.type=5;else if(Ue.slice(-1)=="/"){for(Ne=re+1;Ne<pe.length&&r(M.FullPaths[Ne])!=Ue;++Ne);for(Ae.C=Ne>=pe.length?-1:Ne,Ne=re+1;Ne<pe.length&&r(M.FullPaths[Ne])!=r(Ue);++Ne);Ae.R=Ne>=pe.length?-1:Ne,Ae.type=1}else r(M.FullPaths[re+1]||"")==r(Ue)&&(Ae.R=re+1),Ae.type=2}}}function P(M,te){var K=te||{};if(K.fileType=="mad")return Dk(M,K);switch(k(M),K.fileType){case"zip":return sl(M,K)}var Z=function(ze){for(var De=0,Be=0,ea=0;ea<ze.FileIndex.length;++ea){var Xa=ze.FileIndex[ea];if(Xa.content){var qa=Xa.content.length;qa>0&&(qa<4096?De+=qa+63>>6:Be+=qa+511>>9)}}for(var It=ze.FullPaths.length+3>>2,nl=De+7>>3,il=De+127>>7,ol=nl+Be+It+il,Ln=ol+127>>7,Iu=Ln<=109?0:Math.ceil((Ln-109)/127);ol+Ln+Iu+127>>7>Ln;)Iu=++Ln<=109?0:Math.ceil((Ln-109)/127);var Ns=[1,Iu,Ln,il,It,Be,De,0];return ze.FileIndex[0].size=De<<6,Ns[7]=(ze.FileIndex[0].start=Ns[0]+Ns[1]+Ns[2]+Ns[3]+Ns[4]+Ns[5])+(Ns[6]+7>>3),Ns}(M),re=Ee(Z[7]<<9),se=0,he=0;{for(se=0;se<8;++se)re.write_shift(1,z[se]);for(se=0;se<8;++se)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),se=0;se<3;++se)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,Z[2]),re.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:Q),re.write_shift(4,Z[3]),re.write_shift(-4,Z[1]?Z[0]-1:Q),re.write_shift(4,Z[1]),se=0;se<109;++se)re.write_shift(-4,se<Z[2]?Z[1]+se:-1)}if(Z[1])for(he=0;he<Z[1];++he){for(;se<236+he*127;++se)re.write_shift(-4,se<Z[2]?Z[1]+se:-1);re.write_shift(-4,he===Z[1]-1?Q:he+1)}var Ne=function(ze){for(he+=ze;se<he-1;++se)re.write_shift(-4,se+1);ze&&(++se,re.write_shift(-4,Q))};for(he=se=0,he+=Z[1];se<he;++se)re.write_shift(-4,D.DIFSECT);for(he+=Z[2];se<he;++se)re.write_shift(-4,D.FATSECT);Ne(Z[3]),Ne(Z[4]);for(var xe=0,pe=0,ye=M.FileIndex[0];xe<M.FileIndex.length;++xe)ye=M.FileIndex[xe],ye.content&&(pe=ye.content.length,!(pe<4096)&&(ye.start=he,Ne(pe+511>>9)));for(Ne(Z[6]+7>>3);re.l&511;)re.write_shift(-4,D.ENDOFCHAIN);for(he=se=0,xe=0;xe<M.FileIndex.length;++xe)ye=M.FileIndex[xe],ye.content&&(pe=ye.content.length,!(!pe||pe>=4096)&&(ye.start=he,Ne(pe+63>>6)));for(;re.l&511;)re.write_shift(-4,D.ENDOFCHAIN);for(se=0;se<Z[4]<<2;++se){var Ae=M.FullPaths[se];if(!Ae||Ae.length===0){for(xe=0;xe<17;++xe)re.write_shift(4,0);for(xe=0;xe<3;++xe)re.write_shift(4,-1);for(xe=0;xe<12;++xe)re.write_shift(4,0);continue}ye=M.FileIndex[se],se===0&&(ye.start=ye.size?ye.start-1:Q);var Ue=se===0&&K.root||ye.name;if(pe=2*(Ue.length+1),re.write_shift(64,Ue,"utf16le"),re.write_shift(2,pe),re.write_shift(1,ye.type),re.write_shift(1,ye.color),re.write_shift(-4,ye.L),re.write_shift(-4,ye.R),re.write_shift(-4,ye.C),ye.clsid)re.write_shift(16,ye.clsid,"hex");else for(xe=0;xe<4;++xe)re.write_shift(4,0);re.write_shift(4,ye.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,ye.start),re.write_shift(4,ye.size),re.write_shift(4,0)}for(se=1;se<M.FileIndex.length;++se)if(ye=M.FileIndex[se],ye.size>=4096)if(re.l=ye.start+1<<9,la&&Buffer.isBuffer(ye.content))ye.content.copy(re,re.l,0,ye.size),re.l+=ye.size+511&-512;else{for(xe=0;xe<ye.size;++xe)re.write_shift(1,ye.content[xe]);for(;xe&511;++xe)re.write_shift(1,0)}for(se=1;se<M.FileIndex.length;++se)if(ye=M.FileIndex[se],ye.size>0&&ye.size<4096)if(la&&Buffer.isBuffer(ye.content))ye.content.copy(re,re.l,0,ye.size),re.l+=ye.size+63&-64;else{for(xe=0;xe<ye.size;++xe)re.write_shift(1,ye.content[xe]);for(;xe&63;++xe)re.write_shift(1,0)}if(la)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function R(M,te){var K=M.FullPaths.map(function(xe){return xe.toUpperCase()}),Z=K.map(function(xe){var pe=xe.split("/");return pe[pe.length-(xe.slice(-1)=="/"?2:1)]}),re=!1;te.charCodeAt(0)===47?(re=!0,te=K[0].slice(0,-1)+te):re=te.indexOf("/")!==-1;var se=te.toUpperCase(),he=re===!0?K.indexOf(se):Z.indexOf(se);if(he!==-1)return M.FileIndex[he];var Ne=!se.match(jl);for(se=se.replace(ar,""),Ne&&(se=se.replace(jl,"!")),he=0;he<K.length;++he)if((Ne?K[he].replace(jl,"!"):K[he]).replace(ar,"")==se||(Ne?Z[he].replace(jl,"!"):Z[he]).replace(ar,"")==se)return M.FileIndex[he];return null}var _=64,Q=-2,C="d0cf11e0a1b11ae1",z=[208,207,17,224,161,177,26,225],S="00000000000000000000000000000000",D={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:C,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:S,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function H(M,te,K){u();var Z=P(M,K);c.writeFileSync(te,Z)}function U(M){for(var te=new Array(M.length),K=0;K<M.length;++K)te[K]=String.fromCharCode(M[K]);return te.join("")}function B(M,te){var K=P(M,te);switch(te&&te.type||"buffer"){case"file":return u(),c.writeFileSync(te.filename,K),K;case"binary":return typeof K=="string"?K:U(K);case"base64":return dc(typeof K=="string"?K:U(K));case"buffer":if(la)return Buffer.isBuffer(K)?K:qs(K);case"array":return typeof K=="string"?wr(K):K}return K}var X;function T(M){try{var te=M.InflateRaw,K=new te;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)X=M;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function L(M,te){if(!X)return ke(M,te);var K=X.InflateRaw,Z=new K,re=Z._processChunk(M.slice(M.l),Z._finishFlushFlag);return M.l+=Z.bytesRead,re}function V(M){return X?X.deflateRawSync(M):Xe(M)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(M){var te=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(te>>16|te>>8|te)&255}for(var ce=typeof Uint8Array<"u",W=ce?new Uint8Array(256):[],le=0;le<256;++le)W[le]=ae(le);function I(M,te){var K=W[M&255];return te<=8?K>>>8-te:(K=K<<8|W[M>>8&255],te<=16?K>>>16-te:(K=K<<8|W[M>>16&255],K>>>24-te))}function q(M,te){var K=te&7,Z=te>>>3;return(M[Z]|(K<=6?0:M[Z+1]<<8))>>>K&3}function ne(M,te){var K=te&7,Z=te>>>3;return(M[Z]|(K<=5?0:M[Z+1]<<8))>>>K&7}function G(M,te){var K=te&7,Z=te>>>3;return(M[Z]|(K<=4?0:M[Z+1]<<8))>>>K&15}function ee(M,te){var K=te&7,Z=te>>>3;return(M[Z]|(K<=3?0:M[Z+1]<<8))>>>K&31}function ie(M,te){var K=te&7,Z=te>>>3;return(M[Z]|(K<=1?0:M[Z+1]<<8))>>>K&127}function we(M,te,K){var Z=te&7,re=te>>>3,se=(1<<K)-1,he=M[re]>>>Z;return K<8-Z||(he|=M[re+1]<<8-Z,K<16-Z)||(he|=M[re+2]<<16-Z,K<24-Z)||(he|=M[re+3]<<24-Z),he&se}function je(M,te,K){var Z=te&7,re=te>>>3;return Z<=5?M[re]|=(K&7)<<Z:(M[re]|=K<<Z&255,M[re+1]=(K&7)>>8-Z),te+3}function Me(M,te,K){var Z=te&7,re=te>>>3;return K=(K&1)<<Z,M[re]|=K,te+1}function $e(M,te,K){var Z=te&7,re=te>>>3;return K<<=Z,M[re]|=K&255,K>>>=8,M[re+1]=K,te+8}function Ie(M,te,K){var Z=te&7,re=te>>>3;return K<<=Z,M[re]|=K&255,K>>>=8,M[re+1]=K&255,M[re+2]=K>>>8,te+16}function We(M,te){var K=M.length,Z=2*K>te?2*K:te+5,re=0;if(K>=te)return M;if(la){var se=l1(Z);if(M.copy)M.copy(se);else for(;re<M.length;++re)se[re]=M[re];return se}else if(ce){var he=new Uint8Array(Z);if(he.set)he.set(M);else for(;re<K;++re)he[re]=M[re];return he}return M.length=Z,M}function Ve(M){for(var te=new Array(M),K=0;K<M;++K)te[K]=0;return te}function Ze(M,te,K){var Z=1,re=0,se=0,he=0,Ne=0,xe=M.length,pe=ce?new Uint16Array(32):Ve(32);for(se=0;se<32;++se)pe[se]=0;for(se=xe;se<K;++se)M[se]=0;xe=M.length;var ye=ce?new Uint16Array(xe):Ve(xe);for(se=0;se<xe;++se)pe[re=M[se]]++,Z<re&&(Z=re),ye[se]=0;for(pe[0]=0,se=1;se<=Z;++se)pe[se+16]=Ne=Ne+pe[se-1]<<1;for(se=0;se<xe;++se)Ne=M[se],Ne!=0&&(ye[se]=pe[Ne+16]++);var Ae=0;for(se=0;se<xe;++se)if(Ae=M[se],Ae!=0)for(Ne=I(ye[se],Z)>>Z-Ae,he=(1<<Z+4-Ae)-1;he>=0;--he)te[Ne|he<<Ae]=Ae&15|se<<4;return Z}var Fe=ce?new Uint16Array(512):Ve(512),na=ce?new Uint16Array(32):Ve(32);if(!ce){for(var oa=0;oa<512;++oa)Fe[oa]=0;for(oa=0;oa<32;++oa)na[oa]=0}(function(){for(var M=[],te=0;te<32;te++)M.push(5);Ze(M,na,32);var K=[];for(te=0;te<=143;te++)K.push(8);for(;te<=255;te++)K.push(9);for(;te<=279;te++)K.push(7);for(;te<=287;te++)K.push(8);Ze(K,Fe,288)})();var $a=function(){for(var te=ce?new Uint8Array(32768):[],K=0,Z=0;K<me.length-1;++K)for(;Z<me[K+1];++Z)te[Z]=K;for(;Z<32768;++Z)te[Z]=29;var re=ce?new Uint8Array(259):[];for(K=0,Z=0;K<de.length-1;++K)for(;Z<de[K+1];++Z)re[Z]=K;function se(Ne,xe){for(var pe=0;pe<Ne.length;){var ye=Math.min(65535,Ne.length-pe),Ae=pe+ye==Ne.length;for(xe.write_shift(1,+Ae),xe.write_shift(2,ye),xe.write_shift(2,~ye&65535);ye-- >0;)xe[xe.l++]=Ne[pe++]}return xe.l}function he(Ne,xe){for(var pe=0,ye=0,Ae=ce?new Uint16Array(32768):[];ye<Ne.length;){var Ue=Math.min(65535,Ne.length-ye);if(Ue<10){for(pe=je(xe,pe,+(ye+Ue==Ne.length)),pe&7&&(pe+=8-(pe&7)),xe.l=pe/8|0,xe.write_shift(2,Ue),xe.write_shift(2,~Ue&65535);Ue-- >0;)xe[xe.l++]=Ne[ye++];pe=xe.l*8;continue}pe=je(xe,pe,+(ye+Ue==Ne.length)+2);for(var ze=0;Ue-- >0;){var De=Ne[ye];ze=(ze<<5^De)&32767;var Be=-1,ea=0;if((Be=Ae[ze])&&(Be|=ye&-32768,Be>ye&&(Be-=32768),Be<ye))for(;Ne[Be+ea]==Ne[ye+ea]&&ea<250;)++ea;if(ea>2){De=re[ea],De<=22?pe=$e(xe,pe,W[De+1]>>1)-1:($e(xe,pe,3),pe+=5,$e(xe,pe,W[De-23]>>5),pe+=3);var Xa=De<8?0:De-4>>2;Xa>0&&(Ie(xe,pe,ea-de[De]),pe+=Xa),De=te[ye-Be],pe=$e(xe,pe,W[De]>>3),pe-=3;var qa=De<4?0:De-2>>1;qa>0&&(Ie(xe,pe,ye-Be-me[De]),pe+=qa);for(var It=0;It<ea;++It)Ae[ze]=ye&32767,ze=(ze<<5^Ne[ye])&32767,++ye;Ue-=ea-1}else De<=143?De=De+48:pe=Me(xe,pe,1),pe=$e(xe,pe,W[De]),Ae[ze]=ye&32767,++ye}pe=$e(xe,pe,0)-1}return xe.l=(pe+7)/8|0,xe.l}return function(xe,pe){return xe.length<8?se(xe,pe):he(xe,pe)}}();function Xe(M){var te=Ee(50+Math.floor(M.length*1.1)),K=$a(M,te);return te.slice(0,K)}var va=ce?new Uint16Array(32768):Ve(32768),Y=ce?new Uint16Array(32768):Ve(32768),oe=ce?new Uint16Array(128):Ve(128),ue=1,ge=1;function _e(M,te){var K=ee(M,te)+257;te+=5;var Z=ee(M,te)+1;te+=5;var re=G(M,te)+4;te+=4;for(var se=0,he=ce?new Uint8Array(19):Ve(19),Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],xe=1,pe=ce?new Uint8Array(8):Ve(8),ye=ce?new Uint8Array(8):Ve(8),Ae=he.length,Ue=0;Ue<re;++Ue)he[O[Ue]]=se=ne(M,te),xe<se&&(xe=se),pe[se]++,te+=3;var ze=0;for(pe[0]=0,Ue=1;Ue<=xe;++Ue)ye[Ue]=ze=ze+pe[Ue-1]<<1;for(Ue=0;Ue<Ae;++Ue)(ze=he[Ue])!=0&&(Ne[Ue]=ye[ze]++);var De=0;for(Ue=0;Ue<Ae;++Ue)if(De=he[Ue],De!=0){ze=W[Ne[Ue]]>>8-De;for(var Be=(1<<7-De)-1;Be>=0;--Be)oe[ze|Be<<De]=De&7|Ue<<3}var ea=[];for(xe=1;ea.length<K+Z;)switch(ze=oe[ie(M,te)],te+=ze&7,ze>>>=3){case 16:for(se=3+q(M,te),te+=2,ze=ea[ea.length-1];se-- >0;)ea.push(ze);break;case 17:for(se=3+ne(M,te),te+=3;se-- >0;)ea.push(0);break;case 18:for(se=11+ie(M,te),te+=7;se-- >0;)ea.push(0);break;default:ea.push(ze),xe<ze&&(xe=ze);break}var Xa=ea.slice(0,K),qa=ea.slice(K);for(Ue=K;Ue<286;++Ue)Xa[Ue]=0;for(Ue=Z;Ue<30;++Ue)qa[Ue]=0;return ue=Ze(Xa,va,286),ge=Ze(qa,Y,30),te}function Le(M,te){if(M[0]==3&&!(M[1]&3))return[Tn(te),2];for(var K=0,Z=0,re=l1(te||1<<18),se=0,he=re.length>>>0,Ne=0,xe=0;!(Z&1);){if(Z=ne(M,K),K+=3,Z>>>1)Z>>1==1?(Ne=9,xe=5):(K=_e(M,K),Ne=ue,xe=ge);else{K&7&&(K+=8-(K&7));var pe=M[K>>>3]|M[(K>>>3)+1]<<8;if(K+=32,pe>0)for(!te&&he<se+pe&&(re=We(re,se+pe),he=re.length);pe-- >0;)re[se++]=M[K>>>3],K+=8;continue}for(;;){!te&&he<se+32767&&(re=We(re,se+32767),he=re.length);var ye=we(M,K,Ne),Ae=Z>>>1==1?Fe[ye]:va[ye];if(K+=Ae&15,Ae>>>=4,!(Ae>>>8&255))re[se++]=Ae;else{if(Ae==256)break;Ae-=257;var Ue=Ae<8?0:Ae-4>>2;Ue>5&&(Ue=0);var ze=se+de[Ae];Ue>0&&(ze+=we(M,K,Ue),K+=Ue),ye=we(M,K,xe),Ae=Z>>>1==1?na[ye]:Y[ye],K+=Ae&15,Ae>>>=4;var De=Ae<4?0:Ae-2>>1,Be=me[Ae];for(De>0&&(Be+=we(M,K,De),K+=De),!te&&he<ze&&(re=We(re,ze+100),he=re.length);se<ze;)re[se]=re[se-Be],++se}}}return te?[re,K+7>>>3]:[re.slice(0,se),K+7>>>3]}function ke(M,te){var K=M.slice(M.l||0),Z=Le(K,te);return M.l+=Z[1],Z[0]}function He(M,te){if(M)typeof console<"u"&&console.error(te);else throw new Error(te)}function ka(M,te){var K=M;At(K,0);var Z=[],re=[],se={FileIndex:Z,FullPaths:re};E(se,{root:te.root});for(var he=K.length-4;(K[he]!=80||K[he+1]!=75||K[he+2]!=5||K[he+3]!=6)&&he>=0;)--he;K.l=he+4,K.l+=4;var Ne=K.read_shift(2);K.l+=6;var xe=K.read_shift(4);for(K.l=xe,he=0;he<Ne;++he){K.l+=20;var pe=K.read_shift(4),ye=K.read_shift(4),Ae=K.read_shift(2),Ue=K.read_shift(2),ze=K.read_shift(2);K.l+=8;var De=K.read_shift(4),Be=l(K.slice(K.l+Ae,K.l+Ae+Ue));K.l+=Ae+Ue+ze;var ea=K.l;K.l=De+4,Qe(K,pe,ye,se,Be),K.l=ea}return se}function Qe(M,te,K,Z,re){M.l+=2;var se=M.read_shift(2),he=M.read_shift(2),Ne=o(M);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var xe=M.read_shift(4),pe=M.read_shift(4),ye=M.read_shift(4),Ae=M.read_shift(2),Ue=M.read_shift(2),ze="",De=0;De<Ae;++De)ze+=String.fromCharCode(M[M.l++]);if(Ue){var Be=l(M.slice(M.l,M.l+Ue));(Be[21589]||{}).mt&&(Ne=Be[21589].mt),((re||{})[21589]||{}).mt&&(Ne=re[21589].mt)}M.l+=Ue;var ea=M.slice(M.l,M.l+pe);switch(he){case 8:ea=L(M,ye);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var Xa=!1;se&8&&(xe=M.read_shift(4),xe==134695760&&(xe=M.read_shift(4),Xa=!0),pe=M.read_shift(4),ye=M.read_shift(4)),pe!=te&&He(Xa,"Bad compressed size: "+te+" != "+pe),ye!=K&&He(Xa,"Bad uncompressed size: "+K+" != "+ye),Ou(Z,ze,ea,{unsafe:!0,mt:Ne})}function sl(M,te){var K=te||{},Z=[],re=[],se=Ee(1),he=K.compression?8:0,Ne=0,xe=0,pe=0,ye=0,Ae=0,Ue=M.FullPaths[0],ze=Ue,De=M.FileIndex[0],Be=[],ea=0;for(xe=1;xe<M.FullPaths.length;++xe)if(ze=M.FullPaths[xe].slice(Ue.length),De=M.FileIndex[xe],!(!De.size||!De.content||ze=="Sh33tJ5")){var Xa=ye,qa=Ee(ze.length);for(pe=0;pe<ze.length;++pe)qa.write_shift(1,ze.charCodeAt(pe)&127);qa=qa.slice(0,qa.l),Be[Ae]=fT.buf(De.content,0);var It=De.content;he==8&&(It=V(It)),se=Ee(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Ne),se.write_shift(2,he),De.mt?i(se,De.mt):se.write_shift(4,0),se.write_shift(-4,Be[Ae]),se.write_shift(4,It.length),se.write_shift(4,De.content.length),se.write_shift(2,qa.length),se.write_shift(2,0),ye+=se.length,Z.push(se),ye+=qa.length,Z.push(qa),ye+=It.length,Z.push(It),se=Ee(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Ne),se.write_shift(2,he),se.write_shift(4,0),se.write_shift(-4,Be[Ae]),se.write_shift(4,It.length),se.write_shift(4,De.content.length),se.write_shift(2,qa.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,Xa),ea+=se.l,re.push(se),ea+=qa.length,re.push(qa),++Ae}return se=Ee(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Ae),se.write_shift(2,Ae),se.write_shift(4,ea),se.write_shift(4,ye),se.write_shift(2,0),Nt([Nt(Z),Nt(re),se])}var Pi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ck(M,te){if(M.ctype)return M.ctype;var K=M.name||"",Z=K.match(/\.([^\.]+)$/);return Z&&Pi[Z[1]]||te&&(Z=(K=te).match(/[\.\\]([^\.\\])+$/),Z&&Pi[Z[1]])?Pi[Z[1]]:"application/octet-stream"}function Tk(M){for(var te=dc(M),K=[],Z=0;Z<te.length;Z+=76)K.push(te.slice(Z,Z+76));return K.join(`\r
`)+`\r
`}function Fk(M){var te=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var ye=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(ye.length==1?"0"+ye:ye)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Z=te.split(`\r
`),re=0;re<Z.length;++re){var se=Z[re];if(se.length==0){K.push("");continue}for(var he=0;he<se.length;){var Ne=76,xe=se.slice(he,he+Ne);xe.charAt(Ne-1)=="="?Ne--:xe.charAt(Ne-2)=="="?Ne-=2:xe.charAt(Ne-3)=="="&&(Ne-=3),xe=se.slice(he,he+Ne),he+=Ne,he<se.length&&(xe+="="),K.push(xe)}}return K.join(`\r
`)}function _k(M){for(var te=[],K=0;K<M.length;++K){for(var Z=M[K];K<=M.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+M[++K];te.push(Z)}for(var re=0;re<te.length;++re)te[re]=te[re].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return wr(te.join(`\r
`))}function Ak(M,te,K){for(var Z="",re="",se="",he,Ne=0;Ne<10;++Ne){var xe=te[Ne];if(!xe||xe.match(/^\s*$/))break;var pe=xe.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":Z=pe[2].trim();break;case"content-type":se=pe[2].trim();break;case"content-transfer-encoding":re=pe[2].trim();break}}switch(++Ne,re.toLowerCase()){case"base64":he=wr(Fr(te.slice(Ne).join("")));break;case"quoted-printable":he=_k(te.slice(Ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var ye=Ou(M,Z.slice(K.length),he,{unsafe:!0});se&&(ye.ctype=se)}function Rk(M,te){if(U(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=te&&te.root||"",Z=(la&&Buffer.isBuffer(M)?M.toString("binary"):U(M)).split(`\r
`),re=0,se="";for(re=0;re<Z.length;++re)if(se=Z[re],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),K||(K=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),se.slice(0,K.length)!=K););var he=(Z[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Ne="--"+(he[1]||""),xe=[],pe=[],ye={FileIndex:xe,FullPaths:pe};E(ye);var Ae,Ue=0;for(re=0;re<Z.length;++re){var ze=Z[re];ze!==Ne&&ze!==Ne+"--"||(Ue++&&Ak(ye,Z.slice(Ae,re),K),Ae=re)}return ye}function Dk(M,te){var K=te||{},Z=K.boundary||"SheetJS";Z="------="+Z;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],se=M.FullPaths[0],he=se,Ne=M.FileIndex[0],xe=1;xe<M.FullPaths.length;++xe)if(he=M.FullPaths[xe].slice(se.length),Ne=M.FileIndex[xe],!(!Ne.size||!Ne.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ea){return"_x"+ea.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ea){return"_u"+ea.charCodeAt(0).toString(16)+"_"});for(var pe=Ne.content,ye=la&&Buffer.isBuffer(pe)?pe.toString("binary"):U(pe),Ae=0,Ue=Math.min(1024,ye.length),ze=0,De=0;De<=Ue;++De)(ze=ye.charCodeAt(De))>=32&&ze<128&&++Ae;var Be=Ae>=Ue*4/5;re.push(Z),re.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+he),re.push("Content-Transfer-Encoding: "+(Be?"quoted-printable":"base64")),re.push("Content-Type: "+Ck(Ne,he)),re.push(""),re.push(Be?Fk(ye):Tk(ye))}return re.push(Z+`--\r
`),re.join(`\r
`)}function Pk(M){var te={};return E(te,M),te}function Ou(M,te,K,Z){var re=Z&&Z.unsafe;re||E(M);var se=!re&&Ge.find(M,te);if(!se){var he=M.FullPaths[0];te.slice(0,he.length)==he?he=te:(he.slice(-1)!="/"&&(he+="/"),he=(he+te).replace("//","/")),se={name:s(te),type:2},M.FileIndex.push(se),M.FullPaths.push(he),re||Ge.utils.cfb_gc(M)}return se.content=K,se.size=K?K.length:0,Z&&(Z.CLSID&&(se.clsid=Z.CLSID),Z.mt&&(se.mt=Z.mt),Z.ct&&(se.ct=Z.ct)),se}function Ok(M,te){E(M);var K=Ge.find(M,te);if(K){for(var Z=0;Z<M.FileIndex.length;++Z)if(M.FileIndex[Z]==K)return M.FileIndex.splice(Z,1),M.FullPaths.splice(Z,1),!0}return!1}function Ik(M,te,K){E(M);var Z=Ge.find(M,te);if(Z){for(var re=0;re<M.FileIndex.length;++re)if(M.FileIndex[re]==Z)return M.FileIndex[re].name=s(K),M.FullPaths[re]=K,!0}return!1}function Mk(M){k(M,!0)}return a.find=R,a.read=A,a.parse=d,a.write=B,a.writeFile=H,a.utils={cfb_new:Pk,cfb_add:Ou,cfb_del:Ok,cfb_mov:Ik,cfb_gc:Mk,ReadShift:$l,CheckField:gE,prep_blob:At,bconcat:Nt,use_zlib:T,_deflateRaw:Xe,_inflateRaw:ke,consts:D},a}();function mT(e){return typeof e=="string"?vu(e):Array.isArray(e)?LC(e):e}function Lc(e,a,t){if(typeof Deno<"u"){if(t&&typeof a=="string")switch(t){case"utf8":a=new TextEncoder(t).encode(a);break;case"binary":a=vu(a);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,a)}var r=t=="utf8"?ms(a):a;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var s=new Blob([mT(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(a)&&(a=In(a)),l.write(a),l.close(),a}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function xT(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);a.open("r"),a.encoding="binary";var t=a.read();return a.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function at(e){for(var a=Object.keys(e),t=[],r=0;r<a.length;++r)Object.prototype.hasOwnProperty.call(e,a[r])&&t.push(a[r]);return t}function p1(e,a){for(var t=[],r=at(e),s=0;s!==r.length;++s)t[e[r[s]][a]]==null&&(t[e[r[s]][a]]=r[s]);return t}function wu(e){for(var a=[],t=at(e),r=0;r!==t.length;++r)a[e[t[r]]]=t[r];return a}function Eu(e){for(var a=[],t=at(e),r=0;r!==t.length;++r)a[e[t[r]]]=parseInt(t[r],10);return a}function hT(e){for(var a=[],t=at(e),r=0;r!==t.length;++r)a[e[t[r]]]==null&&(a[e[t[r]]]=[]),a[e[t[r]]].push(t[r]);return a}var L0=new Date(1899,11,30,0,0,0);function bt(e,a){var t=e.getTime(),r=L0.getTime()+(e.getTimezoneOffset()-L0.getTimezoneOffset())*6e4;return(t-r)/(24*60*60*1e3)}var Kw=new Date,pT=L0.getTime()+(Kw.getTimezoneOffset()-L0.getTimezoneOffset())*6e4,g1=Kw.getTimezoneOffset();function ku(e){var a=new Date;return a.setTime(e*24*60*60*1e3+pT),a.getTimezoneOffset()!==g1&&a.setTime(a.getTime()+(a.getTimezoneOffset()-g1)*6e4),a}function gT(e){var a=0,t=0,r=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(t=1,i>3&&(r=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}a+=t*parseInt(s[i],10)}return a}var y1=new Date("2017-02-19T19:06:09.000Z"),Jw=isNaN(y1.getFullYear())?new Date("2/19/17"):y1,yT=Jw.getFullYear()==2017;function La(e,a){var t=new Date(e);if(yT)return a>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):a<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Jw.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function pi(e,a){if(la&&Buffer.isBuffer(e)){if(a){if(e[0]==255&&e[1]==254)return ms(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ms(Uw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(a){if(e[0]==255&&e[1]==254)return ms(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ms(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return t[i]||i})}catch{}for(var r=[],s=0;s!=e.length;++s)r.push(String.fromCharCode(e[s]));return r.join("")}function Ba(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=Ba(e[t]));return a}function Za(e,a){for(var t="";t.length<a;)t+=e;return t}function as(e){var a=Number(e);if(!isNaN(a))return isFinite(a)?a:NaN;if(!/\d/.test(e))return a;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(a=Number(r))||(r=r.replace(/[(](.*)[)]/,function(s,i){return t=-t,i}),!isNaN(a=Number(r)))?a/t:a}var vT=["january","february","march","april","may","june","july","august","september","october","november","december"];function zo(e){var a=new Date(e),t=new Date(NaN),r=a.getYear(),s=a.getMonth(),i=a.getDate();if(isNaN(i))return t;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&vT.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return r<0||r>8099?t:(s>0||i>1)&&r!=101?a:e.match(/[^-0-9:,\/\\]/)?t:a}var bT=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,s){if(e||typeof r=="string")return t.split(r);for(var i=t.split(r),o=[i[0]],l=1;l<i.length;++l)o.push(s),o.push(i[l]);return o}}();function Zw(e){return e?e.content&&e.type?pi(e.content,!0):e.data?Nl(e.data):e.asNodeBuffer&&la?Nl(e.asNodeBuffer().toString("binary")):e.asBinary?Nl(e.asBinary()):e._data&&e._data.getContent?Nl(pi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Qw(e){if(!e)return null;if(e.data)return i1(e.data);if(e.asNodeBuffer&&la)return e.asNodeBuffer();if(e._data&&e._data.getContent){var a=e._data.getContent();return typeof a=="string"?i1(a):Array.prototype.slice.call(a)}return e.content&&e.type?e.content:null}function wT(e){return e&&e.name.slice(-4)===".bin"?Qw(e):Zw(e)}function Pr(e,a){for(var t=e.FullPaths||at(e.files),r=a.toLowerCase().replace(/[\/]/g,"\\"),s=r.replace(/\\/g,"/"),i=0;i<t.length;++i){var o=t[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==o||s==o)return e.files?e.files[t[i]]:e.FileIndex[i]}return null}function Mh(e,a){var t=Pr(e,a);if(t==null)throw new Error("Cannot find file "+a+" in zip");return t}function ct(e,a,t){if(!t)return wT(Mh(e,a));if(!a)return null;try{return ct(e,a)}catch{return null}}function Er(e,a,t){if(!t)return Zw(Mh(e,a));if(!a)return null;try{return Er(e,a)}catch{return null}}function ET(e,a,t){return Qw(Mh(e,a))}function v1(e){for(var a=e.FullPaths||at(e.files),t=[],r=0;r<a.length;++r)a[r].slice(-1)!="/"&&t.push(a[r].replace(/^Root Entry[\/]/,""));return t.sort()}function sa(e,a,t){if(e.FullPaths){if(typeof t=="string"){var r;return la?r=qs(t):r=BC(t),Ge.utils.cfb_add(e,a,r)}Ge.utils.cfb_add(e,a,t)}else e.file(a,t)}function Uh(){return Ge.utils.cfb_new()}function eE(e,a){switch(a.type){case"base64":return Ge.read(e,{type:"base64"});case"binary":return Ge.read(e,{type:"binary"});case"buffer":case"array":return Ge.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+a.type)}function Sl(e,a){if(e.charAt(0)=="/")return e.slice(1);var t=a.split("/");a.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var s=r.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var ot=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,kT=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,b1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,NT=/<[^>]*>/g,Wt=ot.match(b1)?b1:NT,jT=/<\w*:/,ST=/<(\/?)\w+:/;function Ke(e,a,t){for(var r={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(a||(r[0]=e.slice(0,s)),s===e.length)return r;var o=e.match(kT),l=0,c="",u=0,d="",f="",m=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(d=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(m=(s=f.charCodeAt(i+1))==34||s==39?1:0,c=f.slice(i+1+m,f.length-m),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),r[d]=c,r[d.toLowerCase()]=c;else{var x=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(r[x]&&d.slice(l-3,l)=="ext")continue;r[x]=c,r[x.toLowerCase()]=c}}return r}function Es(e){return e.replace(ST,"<$1")}var aE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Lh=wu(aE),ha=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,a=/_x([\da-fA-F]{4})_/ig;return function t(r){var s=r+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(l,c){return aE[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(a,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return t(s.slice(0,i))+s.slice(i+9,o)+t(s.slice(o+3))}}(),Bh=/[&<>'"]/g,CT=/[\u0000-\u0008\u000b-\u001f]/g;function Fa(e){var a=e+"";return a.replace(Bh,function(t){return Lh[t]}).replace(CT,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function w1(e){return Fa(e).replace(/ /g,"_x0020_")}var tE=/[\u0000-\u001f]/g;function zh(e){var a=e+"";return a.replace(Bh,function(t){return Lh[t]}).replace(/\n/g,"<br/>").replace(tE,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function TT(e){var a=e+"";return a.replace(Bh,function(t){return Lh[t]}).replace(tE,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var E1=function(){var e=/&#(\d+);/g;function a(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,a)}}();function FT(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ua(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Sf(e){for(var a="",t=0,r=0,s=0,i=0,o=0,l=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){a+=String.fromCharCode(r);continue}if(s=e.charCodeAt(t++),r>191&&r<224){o=(r&31)<<6,o|=s&63,a+=String.fromCharCode(o);continue}if(i=e.charCodeAt(t++),r<240){a+=String.fromCharCode((r&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(t++),l=((r&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,a+=String.fromCharCode(55296+(l>>>10&1023)),a+=String.fromCharCode(56320+(l&1023))}return a}function k1(e){var a=Tn(2*e.length),t,r,s=1,i=0,o=0,l;for(r=0;r<e.length;r+=s)s=1,(l=e.charCodeAt(r))<128?t=l:l<224?(t=(l&31)*64+(e.charCodeAt(r+1)&63),s=2):l<240?(t=(l&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),s=3):(s=4,t=(l&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(a[i++]=o&255,a[i++]=o>>>8,o=0),a[i++]=t%256,a[i++]=t>>>8;return a.slice(0,i).toString("ucs2")}function N1(e){return qs(e,"binary").toString("utf8")}var gd="foo bar baz",Ra=la&&(N1(gd)==Sf(gd)&&N1||k1(gd)==Sf(gd)&&k1)||Sf,ms=la?function(e){return qs(e,"utf8").toString("binary")}:function(e){for(var a=[],t=0,r=0,s=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:a.push(String.fromCharCode(r));break;case r<2048:a.push(String.fromCharCode(192+(r>>6))),a.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,s=e.charCodeAt(t++)-56320+(r<<10),a.push(String.fromCharCode(240+(s>>18&7))),a.push(String.fromCharCode(144+(s>>12&63))),a.push(String.fromCharCode(128+(s>>6&63))),a.push(String.fromCharCode(128+(s&63)));break;default:a.push(String.fromCharCode(224+(r>>12))),a.push(String.fromCharCode(128+(r>>6&63))),a.push(String.fromCharCode(128+(r&63)))}return a.join("")},fc=function(){var e={};return function(t,r){var s=t+"|"+(r||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),rE=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(a){return[new RegExp("&"+a[0]+";","ig"),a[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)r=r.replace(e[s][0],e[s][1]);return r}}(),_T=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),AT=/<\/?(?:vt:)?variant>/g,RT=/<(?:vt:)([^>]*)>([\s\S]*)</;function j1(e,a){var t=Ke(e),r=e.match(_T(t.baseType))||[],s=[];if(r.length!=t.size){if(a.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return s}return r.forEach(function(i){var o=i.replace(AT,"").match(RT);o&&s.push({v:Ra(o[2]),t:o[1]})}),s}var sE=/(^\s|\s$|\n)/;function Dt(e,a){return"<"+e+(a.match(sE)?' xml:space="preserve"':"")+">"+a+"</"+e+">"}function mc(e){return at(e).map(function(a){return" "+a+'="'+e[a]+'"'}).join("")}function Pe(e,a,t){return"<"+e+(t!=null?mc(t):"")+(a!=null?(a.match(sE)?' xml:space="preserve"':"")+">"+a+"</"+e:"/")+">"}function sx(e,a){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(a)throw t}return""}function DT(e,a){switch(typeof e){case"string":var t=Pe("vt:lpwstr",Fa(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Pe((e|0)==e?"vt:i4":"vt:r8",Fa(String(e)));case"boolean":return Pe("vt:bool",e?"true":"false")}if(e instanceof Date)return Pe("vt:filetime",sx(e));throw new Error("Unable to serialize "+e)}function $h(e){if(la&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ra(In(Ph(e)));throw new Error("Bad input format: expected Buffer or string")}var xc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,pt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ci=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],yr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function PT(e,a){for(var t=1-2*(e[a+7]>>>7),r=((e[a+7]&127)<<4)+(e[a+6]>>>4&15),s=e[a+6]&15,i=5;i>=0;--i)s=s*256+e[a+i];return r==2047?s==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,s+=Math.pow(2,52)),t*Math.pow(2,r-52)*s)}function OT(e,a,t){var r=(a<0||1/a==-1/0?1:0)<<7,s=0,i=0,o=r?-a:a;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(a)?26985:0);for(var l=0;l<=5;++l,i/=256)e[t+l]=i&255;e[t+6]=(s&15)<<4|i&15,e[t+7]=s>>4|r}var S1=function(e){for(var a=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var s=0,i=e[0][r].length;s<i;s+=t)a.push.apply(a,e[0][r].slice(s,s+t));return a},C1=la?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(a){return Buffer.isBuffer(a)?a:qs(a)})):S1(e)}:S1,T1=function(e,a,t){for(var r=[],s=a;s<t;s+=2)r.push(String.fromCharCode(Ps(e,s)));return r.join("").replace(ar,"")},Vh=la?function(e,a,t){return Buffer.isBuffer(e)?e.toString("utf16le",a,t).replace(ar,""):T1(e,a,t)}:T1,F1=function(e,a,t){for(var r=[],s=a;s<a+t;++s)r.push(("0"+e[s].toString(16)).slice(-2));return r.join("")},nE=la?function(e,a,t){return Buffer.isBuffer(e)?e.toString("hex",a,a+t):F1(e,a,t)}:F1,_1=function(e,a,t){for(var r=[],s=a;s<t;s++)r.push(String.fromCharCode(Ki(e,s)));return r.join("")},Bc=la?function(a,t,r){return Buffer.isBuffer(a)?a.toString("utf8",t,r):_1(a,t,r)}:_1,iE=function(e,a){var t=vr(e,a);return t>0?Bc(e,a+4,a+4+t-1):""},oE=iE,lE=function(e,a){var t=vr(e,a);return t>0?Bc(e,a+4,a+4+t-1):""},cE=lE,dE=function(e,a){var t=2*vr(e,a);return t>0?Bc(e,a+4,a+4+t-1):""},uE=dE,fE=function(a,t){var r=vr(a,t);return r>0?Vh(a,t+4,t+4+r):""},mE=fE,xE=function(e,a){var t=vr(e,a);return t>0?Bc(e,a+4,a+4+t):""},hE=xE,pE=function(e,a){return PT(e,a)},B0=pE,Hh=function(a){return Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array};la&&(oE=function(a,t){if(!Buffer.isBuffer(a))return iE(a,t);var r=a.readUInt32LE(t);return r>0?a.toString("utf8",t+4,t+4+r-1):""},cE=function(a,t){if(!Buffer.isBuffer(a))return lE(a,t);var r=a.readUInt32LE(t);return r>0?a.toString("utf8",t+4,t+4+r-1):""},uE=function(a,t){if(!Buffer.isBuffer(a))return dE(a,t);var r=2*a.readUInt32LE(t);return a.toString("utf16le",t+4,t+4+r-1)},mE=function(a,t){if(!Buffer.isBuffer(a))return fE(a,t);var r=a.readUInt32LE(t);return a.toString("utf16le",t+4,t+4+r)},hE=function(a,t){if(!Buffer.isBuffer(a))return xE(a,t);var r=a.readUInt32LE(t);return a.toString("utf8",t+4,t+4+r)},B0=function(a,t){return Buffer.isBuffer(a)?a.readDoubleLE(t):pE(a,t)},Hh=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array});var Ki=function(e,a){return e[a]},Ps=function(e,a){return e[a+1]*256+e[a]},IT=function(e,a){var t=e[a+1]*256+e[a];return t<32768?t:(65535-t+1)*-1},vr=function(e,a){return e[a+3]*(1<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a]},qn=function(e,a){return e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]},MT=function(e,a){return e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]};function $l(e,a){var t="",r,s,i=[],o,l,c,u;switch(a){case"dbcs":if(u=this.l,la&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(Ps(this,u)),u+=2;e*=2;break;case"utf8":t=Bc(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Vh(this,this.l,this.l+e);break;case"wstr":return $l.call(this,e,"dbcs");case"lpstr-ansi":t=oE(this,this.l),e=4+vr(this,this.l);break;case"lpstr-cp":t=cE(this,this.l),e=4+vr(this,this.l);break;case"lpwstr":t=uE(this,this.l),e=4+2*vr(this,this.l);break;case"lpp4":e=4+vr(this,this.l),t=mE(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+vr(this,this.l),t=hE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(o=Ki(this,this.l+e++))!==0;)i.push(pd(o));t=i.join("");break;case"_wstr":for(e=0,t="";(o=Ps(this,this.l+e))!==0;)i.push(pd(o)),e+=2;e+=2,t=i.join("");break;case"dbcs-cont":for(t="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ki(this,u),this.l=u+1,l=$l.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(pd(Ps(this,u))),u+=2}t=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ki(this,u),this.l=u+1,l=$l.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(pd(Ki(this,u))),u+=1}t=i.join("");break;default:switch(e){case 1:return r=Ki(this,this.l),this.l++,r;case 2:return r=(a==="i"?IT:Ps)(this,this.l),this.l+=2,r;case 4:case-4:return a==="i"||!(this[this.l+3]&128)?(r=(e>0?qn:MT)(this,this.l),this.l+=4,r):(s=vr(this,this.l),this.l+=4,s);case 8:case-8:if(a==="f")return e==8?s=B0(this,this.l):s=B0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=nE(this,this.l,e);break}}return this.l+=e,t}var UT=function(e,a,t){e[t]=a&255,e[t+1]=a>>>8&255,e[t+2]=a>>>16&255,e[t+3]=a>>>24&255},LT=function(e,a,t){e[t]=a&255,e[t+1]=a>>8&255,e[t+2]=a>>16&255,e[t+3]=a>>24&255},BT=function(e,a,t){e[t]=a&255,e[t+1]=a>>>8&255};function zT(e,a,t){var r=0,s=0;if(t==="dbcs"){for(s=0;s!=a.length;++s)BT(this,a.charCodeAt(s),this.l+2*s);r=2*a.length}else if(t==="sbcs"){for(a=a.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=a.length;++s)this[this.l+s]=a.charCodeAt(s)&255;r=a.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(a.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(a.length,e);++s){var o=a.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=a&255;break;case 2:r=2,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255;break;case 3:r=3,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255,a>>>=8,this[this.l+2]=a&255;break;case 4:r=4,UT(this,a,this.l);break;case 8:if(r=8,t==="f"){OT(this,a,this.l);break}case 16:break;case-4:r=4,LT(this,a,this.l);break}return this.l+=r,this}function gE(e,a){var t=nE(this,this.l,e.length>>1);if(t!==e)throw new Error(a+"Expected "+e+" saw "+t);this.l+=e.length>>1}function At(e,a){e.l=a,e.read_shift=$l,e.chk=gE,e.write_shift=zT}function Yt(e,a){e.l+=a}function Ee(e){var a=Tn(e);return At(a,0),a}function Ys(e,a,t){if(e){var r,s,i;At(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=bc[l]||bc[65535];for(r=e.read_shift(1),i=r&127,s=1;s<4&&r&128;++s)i+=((r=e.read_shift(1))&127)<<7*s;c=e.l+i;var d=u.f&&u.f(e,i,t);if(e.l=c,a(d,u,l))return}}}function lr(){var e=[],a=la?256:2048,t=function(u){var d=Ee(u);return At(d,0),d},r=t(a),s=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},i=function(u){return r&&u<r.length-r.l?r:(s(),r=t(Math.max(u+1,a)))},o=function(){return s(),Nt(e)},l=function(u){s(),r=u,r.l==null&&(r.l=r.length),i(a)};return{next:i,push:l,end:o,_bufs:e}}function Te(e,a,t,r){var s=+a,i;if(!isNaN(s)){r||(r=bc[s].p||(t||[]).length||0),i=1+(s>=128?1:0)+1,r>=128&&++i,r>=16384&&++i,r>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&Hh(t)&&e.push(t)}}function Vl(e,a,t){var r=Ba(e);if(a.s?(r.cRel&&(r.c+=a.s.c),r.rRel&&(r.r+=a.s.r)):(r.cRel&&(r.c+=a.c),r.rRel&&(r.r+=a.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function A1(e,a,t){var r=Ba(e);return r.s=Vl(r.s,a.s,t),r.e=Vl(r.e,a.s,t),r}function Hl(e,a){if(e.cRel&&e.c<0)for(e=Ba(e);e.c<0;)e.c+=a>8?16384:256;if(e.rRel&&e.r<0)for(e=Ba(e);e.r<0;)e.r+=a>8?1048576:a>5?65536:16384;var t=Ye(e);return!e.cRel&&e.cRel!=null&&(t=HT(t)),!e.rRel&&e.rRel!=null&&(t=$T(t)),t}function Cf(e,a){return e.s.r==0&&!e.s.rRel&&e.e.r==(a.biff>=12?1048575:a.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Wa(e.s.c)+":"+(e.e.cRel?"":"$")+Wa(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(a.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+nt(e.s.r)+":"+(e.e.rRel?"":"$")+nt(e.e.r):Hl(e.s,a.biff)+":"+Hl(e.e,a.biff)}function Gh(e){return parseInt(VT(e),10)-1}function nt(e){return""+(e+1)}function $T(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function VT(e){return e.replace(/\$(\d+)$/,"$1")}function Xh(e){for(var a=GT(e),t=0,r=0;r!==a.length;++r)t=26*t+a.charCodeAt(r)-64;return t-1}function Wa(e){if(e<0)throw new Error("invalid column "+e);var a="";for(++e;e;e=Math.floor((e-1)/26))a=String.fromCharCode((e-1)%26+65)+a;return a}function HT(e){return e.replace(/^([A-Z])/,"$$$1")}function GT(e){return e.replace(/^\$([A-Z])/,"$1")}function XT(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ka(e){for(var a=0,t=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=48&&s<=57?a=10*a+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:a-1}}function Ye(e){for(var a=e.c+1,t="";a;a=(a-1)/26|0)t=String.fromCharCode((a-1)%26+65)+t;return t+(e.r+1)}function fr(e){var a=e.indexOf(":");return a==-1?{s:Ka(e),e:Ka(e)}:{s:Ka(e.slice(0,a)),e:Ka(e.slice(a+1))}}function ra(e,a){return typeof a>"u"||typeof a=="number"?ra(e.s,e.e):(typeof e!="string"&&(e=Ye(e)),typeof a!="string"&&(a=Ye(a)),e==a?e:e+":"+a)}function pa(e){var a={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,s=0,i=e.length;for(t=0;r<i&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)t=26*t+s;for(a.s.c=--t,t=0;r<i&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)t=10*t+s;if(a.s.r=--t,r===i||s!=10)return a.e.c=a.s.c,a.e.r=a.s.r,a;for(++r,t=0;r!=i&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)t=26*t+s;for(a.e.c=--t,t=0;r!=i&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)t=10*t+s;return a.e.r=--t,a}function R1(e,a){var t=e.t=="d"&&a instanceof Date;if(e.z!=null)try{return e.w=Xr(e.z,t?bt(a):a)}catch{}try{return e.w=Xr((e.XF||{}).numFmtId||(t?14:0),t?bt(a):a)}catch{return""+a}}function Hs(e,a,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Ws[e.v]||e.v:a==null?R1(e,e.v):R1(e,a))}function Mn(e,a){var t=a&&a.sheet?a.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function yE(e,a,t){var r=t||{},s=e?Array.isArray(e):r.dense,i=e||(s?[]:{}),o=0,l=0;if(i&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var c=typeof r.origin=="string"?Ka(r.origin):r.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=pa(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=a.length;++f)if(a[f]){if(!Array.isArray(a[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=a[f].length;++m)if(!(typeof a[f][m]>"u")){var x={v:a[f][m]},h=o+f,g=l+m;if(u.s.r>h&&(u.s.r=h),u.s.c>g&&(u.s.c=g),u.e.r<h&&(u.e.r=h),u.e.c<g&&(u.e.c=g),a[f][m]&&typeof a[f][m]=="object"&&!Array.isArray(a[f][m])&&!(a[f][m]instanceof Date))x=a[f][m];else if(Array.isArray(x.v)&&(x.f=a[f][m][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(r.nullError)x.t="e",x.v=0;else if(r.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=r.dateNF||qe[14],r.cellDates?(x.t="d",x.w=Xr(x.z,bt(x.v))):(x.t="n",x.v=bt(x.v),x.w=Xr(x.z,x.v))):x.t="s";if(s)i[h]||(i[h]=[]),i[h][g]&&i[h][g].z&&(x.z=i[h][g].z),i[h][g]=x;else{var p=Ye({c:g,r:h});i[p]&&i[p].z&&(x.z=i[p].z),i[p]=x}}}return u.s.c<1e7&&(i["!ref"]=ra(u)),i}function el(e,a){return yE(null,e,a)}function qT(e){return e.read_shift(4,"i")}function ts(e,a){return a||(a=Ee(4)),a.write_shift(4,e),a}function qt(e){var a=e.read_shift(4);return a===0?"":e.read_shift(a,"dbcs")}function St(e,a){var t=!1;return a==null&&(t=!0,a=Ee(4+2*e.length)),a.write_shift(4,e.length),e.length>0&&a.write_shift(0,e,"dbcs"),t?a.slice(0,a.l):a}function YT(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function WT(e,a){return a||(a=Ee(4)),a.write_shift(2,0),a.write_shift(2,0),a}function qh(e,a){var t=e.l,r=e.read_shift(1),s=qt(e),i=[],o={t:s,h:s};if(r&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(YT(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=t+a,o}function KT(e,a){var t=!1;return a==null&&(t=!0,a=Ee(15+4*e.t.length)),a.write_shift(1,0),St(e.t,a),t?a.slice(0,a.l):a}var JT=qh;function ZT(e,a){var t=!1;return a==null&&(t=!0,a=Ee(23+4*e.t.length)),a.write_shift(1,1),St(e.t,a),a.write_shift(4,1),WT({},a),t?a.slice(0,a.l):a}function Yr(e){var a=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:a,iStyleRef:t}}function Ti(e,a){return a==null&&(a=Ee(8)),a.write_shift(-4,e.c),a.write_shift(3,e.iStyleRef||e.s),a.write_shift(1,0),a}function Fi(e){var a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:a}}function _i(e,a){return a==null&&(a=Ee(4)),a.write_shift(3,e.iStyleRef||e.s),a.write_shift(1,0),a}var QT=qt,vE=St;function Yh(e){var a=e.read_shift(4);return a===0||a===4294967295?"":e.read_shift(a,"dbcs")}function z0(e,a){var t=!1;return a==null&&(t=!0,a=Ee(127)),a.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&a.write_shift(0,e,"dbcs"),t?a.slice(0,a.l):a}var e5=qt,nx=Yh,Wh=z0;function Kh(e){var a=e.slice(e.l,e.l+4),t=a[0]&1,r=a[0]&2;e.l+=4;var s=r===0?B0([0,0,0,0,a[0]&252,a[1],a[2],a[3]],0):qn(a,0)>>2;return t?s/100:s}function bE(e,a){a==null&&(a=Ee(4));var t=0,r=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(r=1,t=1),r)a.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function wE(e){var a={s:{},e:{}};return a.s.r=e.read_shift(4),a.e.r=e.read_shift(4),a.s.c=e.read_shift(4),a.e.c=e.read_shift(4),a}function a5(e,a){return a||(a=Ee(16)),a.write_shift(4,e.s.r),a.write_shift(4,e.e.r),a.write_shift(4,e.s.c),a.write_shift(4,e.e.c),a}var Ai=wE,al=a5;function Vt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function gi(e,a){return(a||Ee(8)).write_shift(8,e,"f")}function t5(e){var a={},t=e.read_shift(1),r=t>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,r){case 0:a.auto=1;break;case 1:a.index=s;var u=si[s];u&&(a.rgb=pc(u));break;case 2:a.rgb=pc([o,l,c]);break;case 3:a.theme=s;break}return i!=0&&(a.tint=i>0?i/32767:i/32768),a}function $0(e,a){if(a||(a=Ee(8)),!e||e.auto)return a.write_shift(4,0),a.write_shift(4,0),a;e.index!=null?(a.write_shift(1,2),a.write_shift(1,e.index)):e.theme!=null?(a.write_shift(1,6),a.write_shift(1,e.theme)):(a.write_shift(1,5),a.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),a.write_shift(2,t),!e.rgb||e.theme!=null)a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),a.write_shift(1,parseInt(r.slice(0,2),16)),a.write_shift(1,parseInt(r.slice(2,4),16)),a.write_shift(1,parseInt(r.slice(4,6),16)),a.write_shift(1,255)}return a}function r5(e){var a=e.read_shift(1);e.l++;var t={fBold:a&1,fItalic:a&2,fUnderline:a&4,fStrikeout:a&8,fOutline:a&16,fShadow:a&32,fCondense:a&64,fExtend:a&128};return t}function s5(e,a){a||(a=Ee(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return a.write_shift(1,t),a.write_shift(1,0),a}function EE(e,a){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,a==1?"lpstr":"lpwstr")}function n5(e){return EE(e,1)}function i5(e){return EE(e,2)}var Jh=2,ir=3,yd=11,D1=12,V0=19,vd=64,o5=65,l5=71,c5=4108,d5=4126,wt=80,kE=81,u5=[wt,kE],ix={1:{n:"CodePage",t:Jh},2:{n:"Category",t:wt},3:{n:"PresentationFormat",t:wt},4:{n:"ByteCount",t:ir},5:{n:"LineCount",t:ir},6:{n:"ParagraphCount",t:ir},7:{n:"SlideCount",t:ir},8:{n:"NoteCount",t:ir},9:{n:"HiddenCount",t:ir},10:{n:"MultimediaClipCount",t:ir},11:{n:"ScaleCrop",t:yd},12:{n:"HeadingPairs",t:c5},13:{n:"TitlesOfParts",t:d5},14:{n:"Manager",t:wt},15:{n:"Company",t:wt},16:{n:"LinksUpToDate",t:yd},17:{n:"CharacterCount",t:ir},19:{n:"SharedDoc",t:yd},22:{n:"HyperlinksChanged",t:yd},23:{n:"AppVersion",t:ir,p:"version"},24:{n:"DigSig",t:o5},26:{n:"ContentType",t:wt},27:{n:"ContentStatus",t:wt},28:{n:"Language",t:wt},29:{n:"Version",t:wt},255:{},2147483648:{n:"Locale",t:V0},2147483651:{n:"Behavior",t:V0},1919054434:{}},ox={1:{n:"CodePage",t:Jh},2:{n:"Title",t:wt},3:{n:"Subject",t:wt},4:{n:"Author",t:wt},5:{n:"Keywords",t:wt},6:{n:"Comments",t:wt},7:{n:"Template",t:wt},8:{n:"LastAuthor",t:wt},9:{n:"RevNumber",t:wt},10:{n:"EditTime",t:vd},11:{n:"LastPrinted",t:vd},12:{n:"CreatedDate",t:vd},13:{n:"ModifiedDate",t:vd},14:{n:"PageCount",t:ir},15:{n:"WordCount",t:ir},16:{n:"CharCount",t:ir},17:{n:"Thumbnail",t:l5},18:{n:"Application",t:wt},19:{n:"DocSecurity",t:ir},255:{},2147483648:{n:"Locale",t:V0},2147483651:{n:"Behavior",t:V0},1919054434:{}},P1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},f5=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function m5(e){return e.map(function(a){return[a>>16&255,a>>8&255,a&255]})}var x5=m5([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),si=Ba(x5),Ws={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},NE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},lx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},bd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Zh(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function h5(e){var a=Zh();if(!e||!e.match)return a;var t={};if((e.match(Wt)||[]).forEach(function(r){var s=Ke(r);switch(s[0].replace(jT,"<")){case"<?xml":break;case"<Types":a.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":a[lx[s.ContentType]]!==void 0&&a[lx[s.ContentType]].push(s.PartName);break}}),a.xmlns!==pt.CT)throw new Error("Unknown Namespace: "+a.xmlns);return a.calcchain=a.calcchains.length>0?a.calcchains[0]:"",a.sst=a.strs.length>0?a.strs[0]:"",a.style=a.styles.length>0?a.styles[0]:"",a.defaults=t,delete a.calcchains,a}function jE(e,a){var t=hT(lx),r=[],s;r[r.length]=ot,r[r.length]=Pe("Types",null,{xmlns:pt.CT,"xmlns:xsd":pt.xsd,"xmlns:xsi":pt.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Pe("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],r[r.length]=Pe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:bd[c][a.bookType]||bd[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){r[r.length]=Pe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:bd[c][a.bookType]||bd[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){r[r.length]=Pe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:t[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var da={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hc(e){var a=e.lastIndexOf("/");return e.slice(0,a+1)+"_rels/"+e.slice(a+1)+".rels"}function Gl(e,a){var t={"!id":{}};if(!e)return t;a.charAt(0)!=="/"&&(a="/"+a);var r={};return(e.match(Wt)||[]).forEach(function(s){var i=Ke(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Sl(i.Target,a);t[l]=o,r[i.Id]=o}}),t["!id"]=r,t}function So(e){var a=[ot,Pe("Relationships",null,{xmlns:pt.RELS})];return at(e["!id"]).forEach(function(t){a[a.length]=Pe("Relationship",null,e["!id"][t])}),a.length>2&&(a[a.length]="</Relationships>",a[1]=a[1].replace("/>",">")),a.join("")}function Sa(e,a,t,r,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),a<0)for(a=e["!idx"];e["!id"]["rId"+a];++a);if(e["!idx"]=a+1,s.Id="rId"+a,s.Type=r,s.Target=t,[da.HLINK,da.XPATH,da.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+a);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,a}var p5="application/vnd.oasis.opendocument.spreadsheet";function g5(e,a){for(var t=$h(e),r,s;r=xc.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(s=Ke(r[0],!1),s.path=="/"&&s.type!==p5)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(a&&a.WTF)throw r}}function y5(e){var a=[ot];a.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),a.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)a.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return a.push("</manifest:manifest>"),a.join("")}function O1(e,a,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+a+`"/>
`,`  </rdf:Description>
`].join("")}function v5(e,a){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+a+`"/>
`,`  </rdf:Description>
`].join("")}function b5(e){var a=[ot];a.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)a.push(O1(e[t][0],e[t][1])),a.push(v5("",e[t][0]));return a.push(O1("","Document","pkg")),a.push("</rdf:RDF>"),a.join("")}function SE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+O0.version+"</meta:generator></office:meta></office:document-meta>"}var Vr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],w5=function(){for(var e=new Array(Vr.length),a=0;a<Vr.length;++a){var t=Vr[a],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[a]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function CE(e){var a={};e=Ra(e);for(var t=0;t<Vr.length;++t){var r=Vr[t],s=e.match(w5[t]);s!=null&&s.length>0&&(a[r[1]]=ha(s[1])),r[2]==="date"&&a[r[1]]&&(a[r[1]]=La(a[r[1]]))}return a}function Tf(e,a,t,r,s){s[e]!=null||a==null||a===""||(s[e]=a,a=Fa(a),r[r.length]=t?Pe(e,a,t):Dt(e,a))}function TE(e,a){var t=a||{},r=[ot,Pe("cp:coreProperties",null,{"xmlns:cp":pt.CORE_PROPS,"xmlns:dc":pt.dc,"xmlns:dcterms":pt.dcterms,"xmlns:dcmitype":pt.dcmitype,"xmlns:xsi":pt.xsi})],s={};if(!e&&!t.Props)return r.join("");e&&(e.CreatedDate!=null&&Tf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:sx(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s),e.ModifiedDate!=null&&Tf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:sx(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s));for(var i=0;i!=Vr.length;++i){var o=Vr[i],l=t.Props&&t.Props[o[1]]!=null?t.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Tf(o[0],l,null,r,s)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var ni=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],FE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function _E(e,a,t,r){var s=[];if(typeof e=="string")s=j1(e,r);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(d){return{v:d}}));var o=typeof a=="string"?j1(a,r).map(function(d){return d.v}):a,l=0,c=0;if(o.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=c,t.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=o.slice(l,l+c);break}l+=c}}function E5(e,a,t){var r={};return a||(a={}),e=Ra(e),ni.forEach(function(s){var i=(e.match(fc(s[0]))||[])[1];switch(s[2]){case"string":i&&(a[s[1]]=ha(i));break;case"bool":a[s[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(r[s[1]]=o[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&_E(r.HeadingPairs,r.TitlesOfParts,a,t),a}function AE(e){var a=[],t=Pe;return e||(e={}),e.Application="SheetJS",a[a.length]=ot,a[a.length]=Pe("Properties",null,{xmlns:pt.EXT_PROPS,"xmlns:vt":pt.vt}),ni.forEach(function(r){if(e[r[1]]!==void 0){var s;switch(r[2]){case"string":s=Fa(String(e[r[1]]));break;case"bool":s=e[r[1]]?"true":"false";break}s!==void 0&&(a[a.length]=t(r[0],s))}}),a[a.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),a[a.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+Fa(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),a.length>2&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var k5=/<[^>]+>[^<]*/g;function N5(e,a){var t={},r="",s=e.match(k5);if(s)for(var i=0;i!=s.length;++i){var o=s[i],l=Ke(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":r=ha(l.name);break;case"</property>":r=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":t[r]=ha(d);break;case"bool":t[r]=Ua(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(d,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(d);break;case"filetime":case"date":t[r]=La(d);break;case"cy":case"error":t[r]=ha(d);break;default:if(u.slice(-1)=="/")break;a.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(a.WTF)throw new Error(o)}}}return t}function RE(e){var a=[ot,Pe("Properties",null,{xmlns:pt.CUST_PROPS,"xmlns:vt":pt.vt})];if(!e)return a.join("");var t=1;return at(e).forEach(function(s){++t,a[a.length]=Pe("property",DT(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Fa(s)})}),a.length>2&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var cx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ff;function j5(e,a,t){Ff||(Ff=wu(cx)),a=Ff[a]||a,e[a]=t}function S5(e,a){var t=[];return at(cx).map(function(r){for(var s=0;s<Vr.length;++s)if(Vr[s][1]==r)return Vr[s];for(s=0;s<ni.length;++s)if(ni[s][1]==r)return ni[s];throw r}).forEach(function(r){if(e[r[1]]!=null){var s=a&&a.Props&&a.Props[r[1]]!=null?a.Props[r[1]]:e[r[1]];switch(r[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(Dt(cx[r[1]]||r[1],s))}}),Pe("DocumentProperties",t.join(""),{xmlns:yr.o})}function C5(e,a){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",s=[];return e&&at(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Vr.length;++o)if(i==Vr[o][1])return;for(o=0;o<ni.length;++o)if(i==ni[o][1])return;for(o=0;o<t.length;++o)if(i==t[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Pe(w1(i),l,{"dt:dt":c}))}}),a&&at(a).forEach(function(i){if(Object.prototype.hasOwnProperty.call(a,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=a[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Pe(w1(i),o,{"dt:dt":l}))}}),"<"+r+' xmlns="'+yr.o+'">'+s.join("")+"</"+r+">"}function Qh(e){var a=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+a/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function T5(e){var a=typeof e=="string"?new Date(Date.parse(e)):e,t=a.getTime()/1e3+11644473600,r=t%Math.pow(2,32),s=(t-r)/Math.pow(2,32);r*=1e7,s*=1e7;var i=r/Math.pow(2,32)|0;i>0&&(r=r%Math.pow(2,32),s+=i);var o=Ee(8);return o.write_shift(4,r),o.write_shift(4,s),o}function DE(e,a,t){var r=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return s}function PE(e,a,t){var r=e.read_shift(0,"lpwstr");return r}function OE(e,a,t){return a===31?PE(e):DE(e,a,t)}function dx(e,a,t){return OE(e,a,t===!1?0:4)}function F5(e,a){if(!a)throw new Error("VtUnalignedString must have positive length");return OE(e,a,0)}function _5(e){for(var a=e.read_shift(4),t=[],r=0;r!=a;++r){var s=e.l;t[r]=e.read_shift(0,"lpwstr").replace(ar,""),e.l-s&2&&(e.l+=2)}return t}function A5(e){for(var a=e.read_shift(4),t=[],r=0;r!=a;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(ar,"");return t}function R5(e){var a=e.l,t=H0(e,kE);e[e.l]==0&&e[e.l+1]==0&&e.l-a&2&&(e.l+=2);var r=H0(e,ir);return[t,r]}function D5(e){for(var a=e.read_shift(4),t=[],r=0;r<a/2;++r)t.push(R5(e));return t}function I1(e,a){for(var t=e.read_shift(4),r={},s=0;s!=t;++s){var i=e.read_shift(4),o=e.read_shift(4);r[i]=e.read_shift(o,a===1200?"utf16le":"utf8").replace(ar,"").replace(jl,"!"),a===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function IE(e){var a=e.read_shift(4),t=e.slice(e.l,e.l+a);return e.l+=a,(a&3)>0&&(e.l+=4-(a&3)&3),t}function P5(e){var a={};return a.Size=e.read_shift(4),e.l+=a.Size+3-(a.Size-1)%4,a}function H0(e,a,t){var r=e.read_shift(2),s,i=t||{};if(e.l+=2,a!==D1&&r!==a&&u5.indexOf(a)===-1&&!((a&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+a+" saw "+r);switch(a===D1?r:a){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return DE(e,r,4).replace(ar,"");case 31:return PE(e);case 64:return Qh(e);case 65:return IE(e);case 71:return P5(e);case 80:return dx(e,r,!i.raw).replace(ar,"");case 81:return F5(e,r).replace(ar,"");case 4108:return D5(e);case 4126:case 4127:return r==4127?_5(e):A5(e);default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+r)}}function M1(e,a){var t=Ee(4),r=Ee(4);switch(t.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,a);break;case 5:r=Ee(8),r.write_shift(8,a,"f");break;case 11:r.write_shift(4,a?1:0);break;case 64:r=T5(a);break;case 31:case 80:for(r=Ee(4+2*(a.length+1)+(a.length%2?0:2)),r.write_shift(4,a.length+1),r.write_shift(0,a,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+a)}return Nt([t,r])}function U1(e,a){var t=e.l,r=e.read_shift(4),s=e.read_shift(4),i=[],o=0,l=0,c=-1,u={};for(o=0;o!=s;++o){var d=e.read_shift(4),f=e.read_shift(4);i[o]=[d,f+t]}i.sort(function(w,b){return w[1]-b[1]});var m={};for(o=0;o!=s;++o){if(e.l!==i[o][1]){var x=!0;if(o>0&&a)switch(a[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,x=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],x=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],x=!1);break}if((!a||o==0)&&e.l<=i[o][1]&&(x=!1,e.l=i[o][1]),x)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(a){var h=a[i[o][0]];if(m[h.n]=H0(e,h.t,{raw:!0}),h.p==="version"&&(m[h.n]=String(m[h.n]>>16)+"."+("0000"+String(m[h.n]&65535)).slice(-4)),h.n=="CodePage")switch(m[h.n]){case 0:m[h.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Zr(l=m[h.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[h.n])}}else if(i[o][0]===1){if(l=m.CodePage=H0(e,Jh),Zr(l),c!==-1){var g=e.l;e.l=i[c][1],u=I1(e,l),e.l=g}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}u=I1(e,l)}else{var p=u[i[o][0]],v;switch(e[e.l]){case 65:e.l+=4,v=IE(e);break;case 30:e.l+=4,v=dx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=dx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=rt(e,4);break;case 64:e.l+=4,v=La(Qh(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[p]=v}}return e.l=t+r,m}var ME=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function O5(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function L1(e,a,t){var r=Ee(8),s=[],i=[],o=8,l=0,c=Ee(8),u=Ee(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),s.push(u),o+=8+c.length,!a){u=Ee(8),u.write_shift(4,0),s.unshift(u);var d=[Ee(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=Ee(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Nt(d),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(a&&!a[e[l][0]])&&!(ME.indexOf(e[l][0])>-1||FE.indexOf(e[l][0])>-1)&&e[l][1]!=null){var m=e[l][1],x=0;if(a){x=+a[e[l][0]];var h=t[x];if(h.p=="version"&&typeof m=="string"){var g=m.split(".");m=(+g[0]<<16)+(+g[1]||0)}c=M1(h.t,m)}else{var p=O5(m);p==-1&&(p=31,m=String(m)),c=M1(p,m)}i.push(c),u=Ee(8),u.write_shift(4,a?x:2+l),s.push(u),o+=8+c.length}var v=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,v),v+=i[l].length;return r.write_shift(4,o),r.write_shift(4,i.length),Nt([r].concat(s).concat(i))}function B1(e,a,t){var r=e.content;if(!r)return{};At(r,0);var s,i,o,l,c=0;r.chk("feff","Byte Order: "),r.read_shift(2);var u=r.read_shift(4),d=r.read_shift(16);if(d!==Ge.utils.consts.HEADER_CLSID&&d!==t)throw new Error("Bad PropertySet CLSID "+d);if(s=r.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=r.read_shift(16),l=r.read_shift(4),s===1&&l!==r.l)throw new Error("Length mismatch: "+l+" !== "+r.l);s===2&&(o=r.read_shift(16),c=r.read_shift(4));var f=U1(r,a),m={SystemIdentifier:u};for(var x in f)m[x]=f[x];if(m.FMTID=i,s===1)return m;if(c-r.l==2&&(r.l+=2),r.l!==c)throw new Error("Length mismatch 2: "+r.l+" !== "+c);var h;try{h=U1(r,null)}catch{}for(x in h)m[x]=h[x];return m.FMTID=[i,o],m}function z1(e,a,t,r,s,i){var o=Ee(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ge.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,a,"hex"),o.write_shift(4,s?68:48);var c=L1(e,t,r);if(l.push(c),s){var u=L1(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Nt(l)}function Zs(e,a){return e.read_shift(a),null}function I5(e,a){a||(a=Ee(e));for(var t=0;t<e;++t)a.write_shift(1,0);return a}function M5(e,a,t){for(var r=[],s=e.l+a;e.l<s;)r.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return r}function rt(e,a){return e.read_shift(a)===1}function Zt(e,a){return a||(a=Ee(2)),a.write_shift(2,+!!e),a}function dt(e){return e.read_shift(2,"u")}function Ir(e,a){return a||(a=Ee(2)),a.write_shift(2,e),a}function UE(e,a){return M5(e,a,dt)}function U5(e){var a=e.read_shift(1),t=e.read_shift(1);return t===1?a:a===1}function LE(e,a,t){return t||(t=Ee(2)),t.write_shift(1,a=="e"?+e:+!!e),t.write_shift(1,a=="e"?1:0),t}function zc(e,a,t){var r=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var o=r?e.read_shift(r,s):"";return o}function L5(e){var a=e.read_shift(2),t=e.read_shift(1),r=t&4,s=t&8,i=1+(t&1),o=0,l,c={};s&&(o=e.read_shift(2)),r&&(l=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",d=a===0?"":e.read_shift(a,u);return s&&(e.l+=4*o),r&&(e.l+=l),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function B5(e){var a=e.t||"",t=Ee(3);t.write_shift(2,a.length),t.write_shift(1,1);var r=Ee(2*a.length);r.write_shift(2*a.length,a,"utf16le");var s=[t,r];return Nt(s)}function yi(e,a,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(a,"cpstr");if(t.biff>=12)return e.read_shift(a,"dbcs-cont")}var s=e.read_shift(1);return s===0?r=e.read_shift(a,"sbcs-cont"):r=e.read_shift(a,"dbcs-cont"),r}function $c(e,a,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):yi(e,r,t)}function Ri(e,a,t){if(t.biff>5)return $c(e,a,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function BE(e,a,t){return t||(t=Ee(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function z5(e){var a=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[a,t]}function $5(e){var a=e.read_shift(4),t=e.l,r=!1;a>24&&(e.l+=a-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var s=e.read_shift((r?a-24:a)>>1,"utf16le").replace(ar,"");return r&&(e.l+=24),s}function V5(e){for(var a=e.read_shift(2),t="";a-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return t+r.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(ar,"");return t+o}function H5(e,a){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return $5(e);case"0303000000000000c000000000000046":return V5(e);default:throw new Error("Unsupported Moniker "+t)}}function wd(e){var a=e.read_shift(4),t=a>0?e.read_shift(a,"utf16le").replace(ar,""):"";return t}function $1(e,a){a||(a=Ee(6+e.length*2)),a.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)a.write_shift(2,e.charCodeAt(t));return a.write_shift(2,0),a}function G5(e,a){var t=e.l+a,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var s=e.read_shift(2);e.l+=2;var i,o,l,c,u="",d,f;s&16&&(i=wd(e,t-e.l)),s&128&&(o=wd(e,t-e.l)),(s&257)===257&&(l=wd(e,t-e.l)),(s&257)===1&&(c=H5(e,t-e.l)),s&8&&(u=wd(e,t-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(f=Qh(e)),e.l=t;var m=o||l||c||"";m&&u&&(m+="#"+u),m||(m="#"+u),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var x={Target:m};return d&&(x.guid=d),f&&(x.time=f),i&&(x.Tooltip=i),x}function X5(e){var a=Ee(512),t=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var s=r.indexOf("#"),i=s>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3;break}a.write_shift(4,2),a.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(t=0;t<o.length;++t)a.write_shift(4,o[t]);if(i==28)r=r.slice(1),$1(r,a);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<o.length;++t)a.write_shift(1,parseInt(o[t],16));var l=s>-1?r.slice(0,s):r;for(a.write_shift(4,2*(l.length+1)),t=0;t<l.length;++t)a.write_shift(2,l.charCodeAt(t));a.write_shift(2,0),i&8&&$1(s>-1?r.slice(s+1):"",a)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<o.length;++t)a.write_shift(1,parseInt(o[t],16));for(var c=0;r.slice(c*3,c*3+3)=="../"||r.slice(c*3,c*3+3)=="..\\";)++c;for(a.write_shift(2,c),a.write_shift(4,r.length-3*c+1),t=0;t<r.length-3*c;++t)a.write_shift(1,r.charCodeAt(t+3*c)&255);for(a.write_shift(1,0),a.write_shift(2,65535),a.write_shift(2,57005),t=0;t<6;++t)a.write_shift(4,0)}return a.slice(0,a.l)}function zE(e){var a=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1);return[a,t,r,s]}function $E(e,a){var t=zE(e);return t[3]=0,t}function ks(e){var a=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:a,c:t,ixfe:r}}function vi(e,a,t,r){return r||(r=Ee(6)),r.write_shift(2,e),r.write_shift(2,a),r.write_shift(2,t||0),r}function q5(e){var a=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:a,flags:t}}function Y5(e,a,t){return a===0?"":Ri(e,a,t)}function W5(e,a,t){var r=t.biff>8?4:2,s=e.read_shift(r),i=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[s,i,o]}function VE(e){var a=e.read_shift(2),t=Kh(e);return[a,t]}function K5(e,a,t){e.l+=4,a-=4;var r=e.l+a,s=zc(e,a,t),i=e.read_shift(2);if(r-=e.l,i!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+i);return e.l+=i,s}function Nu(e){var a=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{s:{c:r,r:a},e:{c:s,r:t}}}function HE(e,a){return a||(a=Ee(8)),a.write_shift(2,e.s.r),a.write_shift(2,e.e.r),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c),a}function GE(e){var a=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),s=e.read_shift(1);return{s:{c:r,r:a},e:{c:s,r:t}}}var J5=GE;function XE(e){e.l+=4;var a=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,a,r]}function Z5(e){var a={};return e.l+=4,e.l+=16,a.fSharedNote=e.read_shift(2),e.l+=4,a}function Q5(e){var a={};return e.l+=4,e.cf=e.read_shift(2),a}function Mt(e){e.l+=2,e.l+=e.read_shift(2)}var e6={0:Mt,4:Mt,5:Mt,6:Mt,7:Q5,8:Mt,9:Mt,10:Mt,11:Mt,12:Mt,13:Z5,14:Mt,15:Mt,16:Mt,17:Mt,18:Mt,19:Mt,20:Mt,21:XE};function a6(e,a){for(var t=e.l+a,r=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{r.push(e6[s](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function Ed(e,a){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),a-=2,a>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(a>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(a),t}function ep(e,a,t){var r=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,s=8;break;case"biff4":r=4,s=6;break;case"biff3":r=3,s=6;break;case"biff2":r=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ee(s);return i.write_shift(2,r),i.write_shift(2,a),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function t6(e,a){return a===0||e.read_shift(2),1200}function r6(e,a,t){if(t.enc)return e.l+=a,"";var r=e.l,s=Ri(e,0,t);return e.read_shift(a+r-e.l),s}function s6(e,a){var t=!a||a.biff==8,r=Ee(t?112:54);for(r.write_shift(a.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function n6(e,a,t){var r=t&&t.biff==8||a==2?e.read_shift(2):(e.l+=a,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function i6(e,a,t){var r=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=zc(e,0,t);return o.length===0&&(o="Sheet1"),{pos:r,hs:s,dt:i,name:o}}function o6(e,a){var t=!a||a.biff>=8?2:1,r=Ee(8+t*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),a.biff>=8&&r.write_shift(1,1),r.write_shift(t*e.name.length,e.name,a.biff<8?"sbcs":"utf16le");var s=r.slice(0,r.l);return s.l=r.l,s}function l6(e,a){for(var t=e.l+a,r=e.read_shift(4),s=e.read_shift(4),i=[],o=0;o!=s&&e.l<t;++o)i.push(L5(e));return i.Count=r,i.Unique=s,i}function c6(e,a){var t=Ee(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var r=[],s=0;s<e.length;++s)r[s]=B5(e[s]);var i=Nt([t].concat(r));return i.parts=[t.length].concat(r.map(function(o){return o.length})),i}function d6(e,a){var t={};return t.dsst=e.read_shift(2),e.l+=a-2,t}function u6(e){var a={};a.r=e.read_shift(2),a.c=e.read_shift(2),a.cnt=e.read_shift(2)-a.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(a.level=r&7),r&32&&(a.hidden=!0),r&64&&(a.hpt=t/20),a}function f6(e){var a=q5(e);if(a.type!=2211)throw new Error("Invalid Future Record "+a.type);var t=e.read_shift(4);return t!==0}function m6(e){return e.read_shift(2),e.read_shift(4)}function V1(e,a,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var s=e.read_shift(2);t&&t.biff==2&&(r=1-(s>>15),s&=32767);var i={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[i,s]}function x6(e){var a=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[a,t],Dim:[r,s],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function h6(){var e=Ee(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function p6(e,a,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function g6(e){var a=Ee(18),t=1718;return e&&e.RTL&&(t|=64),a.write_shift(2,t),a.write_shift(4,0),a.write_shift(4,64),a.write_shift(4,0),a.write_shift(4,0),a}function y6(){}function v6(e,a,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=zc(e,0,t),r}function b6(e,a){var t=e.name||"Arial",r=a&&a.biff==5,s=r?15+t.length:16+2*t.length,i=Ee(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,t.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),i}function w6(e){var a=ks(e);return a.isst=e.read_shift(4),a}function E6(e,a,t,r){var s=Ee(10);return vi(e,a,r,s),s.write_shift(4,t),s}function k6(e,a,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+a,s=ks(e);t.biff==2&&e.l++;var i=$c(e,r-e.l,t);return s.val=i,s}function N6(e,a,t,r,s){var i=!s||s.biff==8,o=Ee(8+ +i+(1+i)*t.length);return vi(e,a,r,o),o.write_shift(2,t.length),i&&o.write_shift(1,1),o.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),o}function j6(e,a,t){var r=e.read_shift(2),s=Ri(e,0,t);return[r,s]}function S6(e,a,t,r){var s=t&&t.biff==5;r||(r=Ee(s?3+a.length:5+2*a.length)),r.write_shift(2,e),r.write_shift(s?1:2,a.length),s||r.write_shift(1,1),r.write_shift((s?1:2)*a.length,a,s?"sbcs":"utf16le");var i=r.length>r.l?r.slice(0,r.l):r;return i.l==null&&(i.l=i.length),i}var C6=Ri;function H1(e,a,t){var r=e.l+a,s=t.biff==8||!t.biff?4:2,i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=r,{s:{r:i,c:l},e:{r:o,c}}}function T6(e,a){var t=a.biff==8||!a.biff?4:2,r=Ee(2*t+6);return r.write_shift(t,e.s.r),r.write_shift(t,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function F6(e){var a=e.read_shift(2),t=e.read_shift(2),r=VE(e);return{r:a,c:t,ixfe:r[0],rknum:r[1]}}function _6(e,a){for(var t=e.l+a-2,r=e.read_shift(2),s=e.read_shift(2),i=[];e.l<t;)i.push(VE(e));if(e.l!==t)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r,c:s,C:o,rkrec:i}}function A6(e,a){for(var t=e.l+a-2,r=e.read_shift(2),s=e.read_shift(2),i=[];e.l<t;)i.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r,c:s,C:o,ixfe:i}}function R6(e,a,t,r){var s={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=f5[l>>26],r.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function D6(e,a,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,a-=6,r.data=R6(e,a,r.fStyle,t),r}function G1(e,a,t,r){var s=t&&t.biff==5;r||(r=Ee(s?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,a<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),r.write_shift(4,i),r.write_shift(4,0),s||r.write_shift(4,0),r.write_shift(2,0),r}function P6(e){e.l+=4;var a=[e.read_shift(2),e.read_shift(2)];if(a[0]!==0&&a[0]--,a[1]!==0&&a[1]--,a[0]>7||a[1]>7)throw new Error("Bad Gutters: "+a.join("|"));return a}function O6(e){var a=Ee(8);return a.write_shift(4,0),a.write_shift(2,0),a.write_shift(2,0),a}function X1(e,a,t){var r=ks(e);(t.biff==2||a==9)&&++e.l;var s=U5(e);return r.val=s,r.t=s===!0||s===!1?"b":"e",r}function I6(e,a,t,r,s,i){var o=Ee(8);return vi(e,a,r,o),LE(t,i,o),o}function M6(e,a,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=ks(e),s=Vt(e);return r.val=s,r}function U6(e,a,t,r){var s=Ee(14);return vi(e,a,r,s),gi(t,s),s}var q1=Y5;function L6(e,a,t){var r=e.l+a,s=e.read_shift(2),i=e.read_shift(2);if(t.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=yi(e,i),l=[];r>e.l;)l.push($c(e));return[i,s,o,l]}function Y1(e,a,t){var r=e.read_shift(2),s,i={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(s=K5(e,a-2,t)),i.body=s||e.read_shift(a-2),typeof s=="string"&&(i.Name=s),i}var B6=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function W1(e,a,t){var r=e.l+a,s=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var u=yi(e,o,t);s&32&&(u=B6[u.charCodeAt(0)]);var d=r-e.l;t&&t.biff==2&&--d;var f=r==e.l||l===0||!(d>0)?[]:aR(e,d,t,l);return{chKey:i,Name:u,itab:c,rgce:f}}function qE(e,a,t){if(t.biff<8)return z6(e,a,t);for(var r=[],s=e.l+a,i=e.read_shift(t.biff>8?4:2);i--!==0;)r.push(W5(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return r}function z6(e,a,t){e[e.l+1]==3&&e[e.l]++;var r=zc(e,a,t);return r.charCodeAt(0)==3?r.slice(1):r}function $6(e,a,t){if(t.biff<8){e.l+=a;return}var r=e.read_shift(2),s=e.read_shift(2),i=yi(e,r,t),o=yi(e,s,t);return[i,o]}function V6(e,a,t){var r=GE(e);e.l++;var s=e.read_shift(1);return a-=8,[tR(e,a,t),s,r]}function K1(e,a,t){var r=J5(e);switch(t.biff){case 2:e.l++,a-=7;break;case 3:case 4:e.l+=2,a-=8;break;default:e.l+=6,a-=12}return[r,QA(e,a,t)]}function H6(e){var a=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[a,t,r]}function G6(e,a,t){if(!(t.biff<8)){var r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=Ri(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:s},l,o,i]}}function X6(e,a,t){return G6(e,a,t)}function q6(e,a){for(var t=[],r=e.read_shift(2);r--;)t.push(Nu(e));return t}function Y6(e){var a=Ee(2+e.length*8);a.write_shift(2,e.length);for(var t=0;t<e.length;++t)HE(e[t],a);return a}function W6(e,a,t){if(t&&t.biff<8)return J6(e,a,t);var r=XE(e),s=a6(e,a-22,r[1]);return{cmo:r,ft:s}}var K6={8:function(e,a){var t=e.l+a;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:r}}};function J6(e,a,t){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,a-=36;var o=[];return o.push((K6[r]||Yt)(e,a,t)),{cmo:[s,r,i],ft:o}}function Z6(e,a,t){var r=e.l,s="";try{e.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=z5(e,6,t);var l=e.read_shift(2);e.read_shift(2),dt(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-r!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=yi(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(d?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=r+a,{t:s}}catch{return e.l=r+a,{t:s}}}function Q6(e,a){var t=Nu(e);e.l+=16;var r=G5(e,a-24);return[t,r]}function eF(e){var a=Ee(24),t=Ka(e[0]);a.write_shift(2,t.r),a.write_shift(2,t.r),a.write_shift(2,t.c),a.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)a.write_shift(1,parseInt(r[s],16));return Nt([a,X5(e[1])])}function aF(e,a){e.read_shift(2);var t=Nu(e),r=e.read_shift((a-10)/2,"dbcs-cont");return r=r.replace(ar,""),[t,r]}function tF(e){var a=e[1].Tooltip,t=Ee(10+2*(a.length+1));t.write_shift(2,2048);var r=Ka(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s=0;s<a.length;++s)t.write_shift(2,a.charCodeAt(s));return t.write_shift(2,0),t}function rF(e){var a=[0,0],t;return t=e.read_shift(2),a[0]=P1[t]||t,t=e.read_shift(2),a[1]=P1[t]||t,a}function sF(e){return e||(e=Ee(4)),e.write_shift(2,1),e.write_shift(2,1),e}function nF(e){for(var a=e.read_shift(2),t=[];a-- >0;)t.push($E(e));return t}function iF(e){for(var a=e.read_shift(2),t=[];a-- >0;)t.push($E(e));return t}function oF(e){e.l+=2;var a={cxfs:0,crc:0};return a.cxfs=e.read_shift(2),a.crc=e.read_shift(4),a}function YE(e,a,t){if(!t.cellStyles)return Yt(e,a);var r=t&&t.biff>=12?4:2,s=e.read_shift(r),i=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(2);r==2&&(e.l+=2);var u={s,e:i,w:o,ixfe:l,flags:c};return(t.biff>=5||!t.biff)&&(u.level=c>>8&7),u}function lF(e,a){var t=Ee(12);t.write_shift(2,a),t.write_shift(2,a),t.write_shift(2,e.width*256),t.write_shift(2,0);var r=0;return e.hidden&&(r|=1),t.write_shift(1,r),r=e.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function cF(e,a){var t={};return a<32||(e.l+=16,t.header=Vt(e),t.footer=Vt(e),e.l+=2),t}function dF(e,a,t){var r={area:!1};if(t.biff!=5)return e.l+=a,r;var s=e.read_shift(1);return e.l+=3,s&16&&(r.area=!0),r}function uF(e){for(var a=Ee(2*e),t=0;t<e;++t)a.write_shift(2,t+1);return a}var fF=ks,mF=UE,xF=$c;function hF(e){var a=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),s={fmt:a,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,s}function pF(e,a,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=ks(e);++e.l;var s=Ri(e,a-7,t);return r.t="str",r.val=s,r}function gF(e){var a=ks(e);++e.l;var t=Vt(e);return a.t="n",a.val=t,a}function yF(e,a,t){var r=Ee(15);return Xc(r,e,a),r.write_shift(8,t,"f"),r}function vF(e){var a=ks(e);++e.l;var t=e.read_shift(2);return a.t="n",a.val=t,a}function bF(e,a,t){var r=Ee(9);return Xc(r,e,a),r.write_shift(2,t),r}function wF(e){var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,"sbcs-cont")}function EF(e,a){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=a-13}function kF(e,a,t){var r=e.l+a,s=ks(e),i=e.read_shift(2),o=yi(e,i,t);return e.l=r,s.t="str",s.val=o,s}var NF=[2,3,48,49,131,139,140,245],ux=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},a=wu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(l,c){var u=[],d=Tn(1);switch(c.type){case"base64":d=wr(Fr(l));break;case"binary":d=wr(l);break;case"buffer":case"array":d=l;break}At(d,0);var f=d.read_shift(1),m=!!(f&136),x=!1,h=!1;switch(f){case 2:break;case 3:break;case 48:x=!0,m=!0;break;case 49:x=!0,m=!0;break;case 131:break;case 139:break;case 140:h=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,p=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(p=d.read_shift(2));var v=d.read_shift(2),w=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=e[d[d.l]]),d.l+=1,d.l+=2),h&&(d.l+=36);for(var b=[],y={},j=Math.min(d.length,f==2?521:p-10-(x?264:0)),A=h?32:11;d.l<j&&d[d.l]!=13;)switch(y={},y.name=rx.utils.decode(w,d.slice(d.l,d.l+A)).replace(/[\u0000\r\n].*$/g,""),d.l+=A,y.type=String.fromCharCode(d.read_shift(1)),f!=2&&!h&&(y.offset=d.read_shift(4)),y.len=d.read_shift(1),f==2&&(y.offset=d.read_shift(2)),y.dec=d.read_shift(1),y.name.length&&b.push(y),f!=2&&(d.l+=h?13:14),y.type){case"B":(!x||y.len!=8)&&c.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+y.type)}if(d[d.l]!==13&&(d.l=p-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=p;var E=0,F=0;for(u[0]=[],F=0;F!=b.length;++F)u[0][F]=b[F].name;for(;g-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++E]=[],F=0,F=0;F!=b.length;++F){var k=d.slice(d.l,d.l+b[F].len);d.l+=b[F].len,At(k,0);var P=rx.utils.decode(w,k);switch(b[F].type){case"C":P.trim().length&&(u[E][F]=P.replace(/\s+$/,""));break;case"D":P.length===8?u[E][F]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):u[E][F]=P;break;case"F":u[E][F]=parseFloat(P.trim());break;case"+":case"I":u[E][F]=h?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":u[E][F]=!0;break;case"N":case"F":u[E][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[E][F]="##MEMO##"+(h?parseInt(P.trim(),10):k.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(u[E][F]=+P||0);break;case"@":u[E][F]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":u[E][F]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":u[E][F]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][F]=-k.read_shift(-8,"f");break;case"B":if(x&&b[F].len==8){u[E][F]=k.read_shift(8,"f");break}case"G":case"P":k.l+=b[F].len;break;case"0":if(b[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[F].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=b,u}function r(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=el(t(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(l,c){try{return Mn(r(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&Zr(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=lr(),f=q0(l,{header:1,raw:!0,cellDates:!0}),m=f[0],x=f.slice(1),h=l["!cols"]||[],g=0,p=0,v=0,w=1;for(g=0;g<m.length;++g){if(((h[g]||{}).DBF||{}).name){m[g]=h[g].DBF.name,++v;continue}if(m[g]!=null){if(++v,typeof m[g]=="number"&&(m[g]=m[g].toString(10)),typeof m[g]!="string")throw new Error("DBF Invalid column name "+m[g]+" |"+typeof m[g]+"|");if(m.indexOf(m[g])!==g){for(p=0;p<1024;++p)if(m.indexOf(m[g]+"_"+p)==-1){m[g]+="_"+p;break}}}}var b=pa(l["!ref"]),y=[],j=[],A=[];for(g=0;g<=b.e.c-b.s.c;++g){var E="",F="",k=0,P=[];for(p=0;p<x.length;++p)x[p][g]!=null&&P.push(x[p][g]);if(P.length==0||m[g]==null){y[g]="?";continue}for(p=0;p<P.length;++p){switch(typeof P[p]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=P[p]instanceof Date?"D":"C";break;default:F="C"}k=Math.max(k,String(P[p]).length),E=E&&E!=F?"C":F}k>250&&(k=250),F=((h[g]||{}).DBF||{}).type,F=="C"&&h[g].DBF.len>k&&(k=h[g].DBF.len),E=="B"&&F=="N"&&(E="N",A[g]=h[g].DBF.dec,k=h[g].DBF.len),j[g]=E=="C"||F=="N"?k:i[E]||0,w+=j[g],y[g]=E}var R=d.next(32);for(R.write_shift(4,318902576),R.write_shift(4,x.length),R.write_shift(2,296+32*v),R.write_shift(2,w),g=0;g<4;++g)R.write_shift(4,0);for(R.write_shift(4,0|(+a[Mw]||3)<<8),g=0,p=0;g<m.length;++g)if(m[g]!=null){var _=d.next(32),Q=(m[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);_.write_shift(1,Q,"sbcs"),_.write_shift(1,y[g]=="?"?"C":y[g],"sbcs"),_.write_shift(4,p),_.write_shift(1,j[g]||i[y[g]]||0),_.write_shift(1,A[g]||0),_.write_shift(1,2),_.write_shift(4,0),_.write_shift(1,0),_.write_shift(4,0),_.write_shift(4,0),p+=j[g]||i[y[g]]||0}var C=d.next(264);for(C.write_shift(4,13),g=0;g<65;++g)C.write_shift(4,0);for(g=0;g<x.length;++g){var z=d.next(w);for(z.write_shift(1,0),p=0;p<m.length;++p)if(m[p]!=null)switch(y[p]){case"L":z.write_shift(1,x[g][p]==null?63:x[g][p]?84:70);break;case"B":z.write_shift(8,x[g][p]||0,"f");break;case"N":var S="0";for(typeof x[g][p]=="number"&&(S=x[g][p].toFixed(A[p]||0)),v=0;v<j[p]-S.length;++v)z.write_shift(1,32);z.write_shift(1,S,"sbcs");break;case"D":x[g][p]?(z.write_shift(4,("0000"+x[g][p].getFullYear()).slice(-4),"sbcs"),z.write_shift(2,("00"+(x[g][p].getMonth()+1)).slice(-2),"sbcs"),z.write_shift(2,("00"+x[g][p].getDate()).slice(-2),"sbcs")):z.write_shift(8,"00000000","sbcs");break;case"C":var D=String(x[g][p]!=null?x[g][p]:"").slice(0,j[p]);for(z.write_shift(1,D,"sbcs"),v=0;v<j[p]-D.length;++v)z.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:r,from_sheet:o}}(),WE=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},a=new RegExp("\x1BN("+at(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,x){var h=e[x];return typeof h=="number"?o1(h):h},r=function(m,x,h){var g=x.charCodeAt(0)-32<<4|h.charCodeAt(0)-48;return g==59?m:o1(g)};e["|"]=254;function s(m,x){switch(x.type){case"base64":return i(Fr(m),x);case"binary":return i(m,x);case"buffer":return i(la&&Buffer.isBuffer(m)?m.toString("binary"):In(m),x);case"array":return i(pi(m),x)}throw new Error("Unrecognized type "+x.type)}function i(m,x){var h=m.split(/[\n\r]+/),g=-1,p=-1,v=0,w=0,b=[],y=[],j=null,A={},E=[],F=[],k=[],P=0,R;for(+x.codepage>=0&&Zr(+x.codepage);v!==h.length;++v){P=0;var _=h[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(a,t),Q=_.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),C=Q[0],z;if(_.length>0)switch(C){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&y.push(_.slice(3).replace(/;;/g,";"));break;case"C":var S=!1,D=!1,H=!1,U=!1,B=-1,X=-1;for(w=1;w<Q.length;++w)switch(Q[w].charAt(0)){case"A":break;case"X":p=parseInt(Q[w].slice(1))-1,D=!0;break;case"Y":for(g=parseInt(Q[w].slice(1))-1,D||(p=0),R=b.length;R<=g;++R)b[R]=[];break;case"K":z=Q[w].slice(1),z.charAt(0)==='"'?z=z.slice(1,z.length-1):z==="TRUE"?z=!0:z==="FALSE"?z=!1:isNaN(as(z))?isNaN(zo(z).getDate())||(z=La(z)):(z=as(z),j!==null&&Zo(j)&&(z=ku(z))),S=!0;break;case"E":U=!0;var T=Co(Q[w].slice(1),{r:g,c:p});b[g][p]=[b[g][p],T];break;case"S":H=!0,b[g][p]=[b[g][p],"S5S"];break;case"G":break;case"R":B=parseInt(Q[w].slice(1))-1;break;case"C":X=parseInt(Q[w].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+_)}if(S&&(b[g][p]&&b[g][p].length==2?b[g][p][0]=z:b[g][p]=z,j=null),H){if(U)throw new Error("SYLK shared formula cannot have own formula");var L=B>-1&&b[B][X];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");b[g][p][1]=m3(L[1],{r:g-B,c:p-X})}break;case"F":var V=0;for(w=1;w<Q.length;++w)switch(Q[w].charAt(0)){case"X":p=parseInt(Q[w].slice(1))-1,++V;break;case"Y":for(g=parseInt(Q[w].slice(1))-1,R=b.length;R<=g;++R)b[R]=[];break;case"M":P=parseInt(Q[w].slice(1))/20;break;case"F":break;case"G":break;case"P":j=y[parseInt(Q[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=Q[w].slice(1).split(" "),R=parseInt(k[0],10);R<=parseInt(k[1],10);++R)P=parseInt(k[2],10),F[R-1]=P===0?{hidden:!0}:{wch:P},Fn(F[R-1]);break;case"C":p=parseInt(Q[w].slice(1))-1,F[p]||(F[p]={});break;case"R":g=parseInt(Q[w].slice(1))-1,E[g]||(E[g]={}),P>0?(E[g].hpt=P,E[g].hpx=Vo(P)):P===0&&(E[g].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+_)}V<1&&(j=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+_)}}return E.length>0&&(A["!rows"]=E),F.length>0&&(A["!cols"]=F),x&&x.sheetRows&&(b=b.slice(0,x.sheetRows)),[b,A]}function o(m,x){var h=s(m,x),g=h[0],p=h[1],v=el(g,x);return at(p).forEach(function(w){v[w]=p[w]}),v}function l(m,x){return Mn(o(m,x),x)}function c(m,x,h,g){var p="C;Y"+(h+1)+";X"+(g+1)+";K";switch(m.t){case"n":p+=m.v||0,m.f&&!m.F&&(p+=";E"+ip(m.f,{r:h,c:g}));break;case"b":p+=m.v?"TRUE":"FALSE";break;case"e":p+=m.w||m.v;break;case"d":p+='"'+(m.w||m.v)+'"';break;case"s":p+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function u(m,x){x.forEach(function(h,g){var p="F;W"+(g+1)+" "+(g+1)+" ";h.hidden?p+="0":(typeof h.width=="number"&&!h.wpx&&(h.wpx=gc(h.width)),typeof h.wpx=="number"&&!h.wch&&(h.wch=yc(h.wpx)),typeof h.wch=="number"&&(p+=Math.round(h.wch))),p.charAt(p.length-1)!=" "&&m.push(p)})}function d(m,x){x.forEach(function(h,g){var p="F;";h.hidden?p+="M0;":h.hpt?p+="M"+20*h.hpt+";":h.hpx&&(p+="M"+20*vc(h.hpx)+";"),p.length>2&&m.push(p+"R"+(g+1))})}function f(m,x){var h=["ID;PWXL;N;E"],g=[],p=pa(m["!ref"]),v,w=Array.isArray(m),b=`\r
`;h.push("P;PGeneral"),h.push("F;P0;DG0G8;M255"),m["!cols"]&&u(h,m["!cols"]),m["!rows"]&&d(h,m["!rows"]),h.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var y=p.s.r;y<=p.e.r;++y)for(var j=p.s.c;j<=p.e.c;++j){var A=Ye({r:y,c:j});v=w?(m[y]||[])[j]:m[A],!(!v||v.v==null&&(!v.f||v.F))&&g.push(c(v,m,y,j))}return h.join(b)+b+g.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),KE=function(){function e(i,o){switch(o.type){case"base64":return a(Fr(i),o);case"binary":return a(i,o);case"buffer":return a(la&&Buffer.isBuffer(i)?i.toString("binary"):In(i),o);case"array":return a(pi(i),o)}throw new Error("Unrecognized type "+o.type)}function a(i,o){for(var l=i.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var m=l[d].trim().split(","),x=m[0],h=m[1];++d;for(var g=l[d]||"";(g.match(/["]/g)||[]).length&1&&d<l.length-1;)g+=`
`+l[++d];switch(g=g.trim(),+x){case-1:if(g==="BOT"){f[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[c][u]=!0:g==="FALSE"?f[c][u]=!1:isNaN(as(h))?isNaN(zo(h).getDate())?f[c][u]=h:f[c][u]=La(h):f[c][u]=as(h),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function t(i,o){return el(e(i,o),o)}function r(i,o){return Mn(t(i,o),o)}var s=function(){var i=function(c,u,d,f,m){c.push(u),c.push(d+","+f),c.push('"'+m.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=pa(c["!ref"]),f,m=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var x=d.s.r;x<=d.e.r;++x){o(u,-1,0,"BOT");for(var h=d.s.c;h<=d.e.c;++h){var g=Ye({r:x,c:h});if(f=m?(c[x]||[])[h]:c[g],!f){o(u,1,0,"");continue}switch(f.t){case"n":var p=f.w;!p&&f.v!=null&&(p=f.v),p==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,p,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Xr(f.z||qe[14],bt(La(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var v=`\r
`,w=u.join(v);return w}}();return{to_workbook:r,to_sheet:t,from_sheet:s}}(),JE=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function a(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,m){for(var x=f.split(`
`),h=-1,g=-1,p=0,v=[];p!==x.length;++p){var w=x[p].trim().split(":");if(w[0]==="cell"){var b=Ka(w[1]);if(v.length<=b.r)for(h=v.length;h<=b.r;++h)v[h]||(v[h]=[]);switch(h=b.r,g=b.c,w[2]){case"t":v[h][g]=e(w[3]);break;case"v":v[h][g]=+w[3];break;case"vtf":var y=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[h][g]=!!+w[4];break;default:v[h][g]=+w[4];break}w[2]=="vtf"&&(v[h][g]=[v[h][g],y])}}}return m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}function r(f,m){return el(t(f,m),m)}function s(f,m){return Mn(r(f,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var m=[],x=[],h,g="",p=fr(f["!ref"]),v=Array.isArray(f),w=p.s.r;w<=p.e.r;++w)for(var b=p.s.c;b<=p.e.c;++b)if(g=Ye({r:w,c:b}),h=v?(f[w]||[])[b]:f[g],!(!h||h.v==null||h.t==="z")){switch(x=["cell",g,"t"],h.t){case"s":case"str":x.push(a(h.v));break;case"n":h.f?(x[2]="vtf",x[3]="n",x[4]=h.v,x[5]=a(h.f)):(x[2]="v",x[3]=h.v);break;case"b":x[2]="vt"+(h.f?"f":"c"),x[3]="nl",x[4]=h.v?"1":"0",x[5]=a(h.f||(h.v?"TRUE":"FALSE"));break;case"d":var y=bt(La(h.v));x[2]="vtc",x[3]="nd",x[4]=""+y,x[5]=h.w||Xr(h.z||qe[14],y);break;case"e":continue}m.push(x.join(":"))}return m.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(f){return[i,o,l,o,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:r,from_sheet:d}}(),$o=function(){function e(d,f,m,x,h){h.raw?f[m][x]=d:d===""||(d==="TRUE"?f[m][x]=!0:d==="FALSE"?f[m][x]=!1:isNaN(as(d))?isNaN(zo(d).getDate())?f[m][x]=d:f[m][x]=La(d):f[m][x]=as(d))}function a(d,f){var m=f||{},x=[];if(!d||d.length===0)return x;for(var h=d.split(/[\r\n]/),g=h.length-1;g>=0&&h[g].length===0;)--g;for(var p=10,v=0,w=0;w<=g;++w)v=h[w].indexOf(" "),v==-1?v=h[w].length:v++,p=Math.max(p,v);for(w=0;w<=g;++w){x[w]=[];var b=0;for(e(h[w].slice(0,p).trim(),x,w,b,m),b=1;b<=(h[w].length-p)/10+1;++b)e(h[w].slice(p+(b-1)*10,p+b*10).trim(),x,w,b,m)}return m.sheetRows&&(x=x.slice(0,m.sheetRows)),x}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function s(d){for(var f={},m=!1,x=0,h=0;x<d.length;++x)(h=d.charCodeAt(x))==34?m=!m:!m&&h in t&&(f[h]=(f[h]||0)+1);h=[];for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&h.push([f[x],x]);if(!h.length){f=r;for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&h.push([f[x],x])}return h.sort(function(g,p){return g[0]-p[0]||r[g[1]]-r[p[1]]}),t[h.pop()[1]]||44}function i(d,f){var m=f||{},x="",h=m.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(x=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(x=d.charAt(4),d=d.slice(6)):x=s(d.slice(0,1024)):m&&m.FS?x=m.FS:x=s(d.slice(0,1024));var p=0,v=0,w=0,b=0,y=0,j=x.charCodeAt(0),A=!1,E=0,F=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var k=m.dateNF!=null?dT(m.dateNF):null;function P(){var R=d.slice(b,y),_={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)_.t="z";else if(m.raw)_.t="s",_.v=R;else if(R.trim().length===0)_.t="s",_.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(_.t="s",_.v=R.slice(2,-1).replace(/""/g,'"')):L_(R)?(_.t="n",_.f=R.slice(1)):(_.t="s",_.v=R);else if(R=="TRUE")_.t="b",_.v=!0;else if(R=="FALSE")_.t="b",_.v=!1;else if(!isNaN(w=as(R)))_.t="n",m.cellText!==!1&&(_.w=R),_.v=w;else if(!isNaN(zo(R).getDate())||k&&R.match(k)){_.z=m.dateNF||qe[14];var Q=0;k&&R.match(k)&&(R=uT(R,m.dateNF,R.match(k)||[]),Q=1),m.cellDates?(_.t="d",_.v=La(R,Q)):(_.t="n",_.v=bt(La(R,Q))),m.cellText!==!1&&(_.w=Xr(_.z,_.v instanceof Date?bt(_.v):_.v)),m.cellNF||delete _.z}else _.t="s",_.v=R;if(_.t=="z"||(m.dense?(h[p]||(h[p]=[]),h[p][v]=_):h[Ye({c:v,r:p})]=_),b=y+1,F=d.charCodeAt(b),g.e.c<v&&(g.e.c=v),g.e.r<p&&(g.e.r=p),E==j)++v;else if(v=0,++p,m.sheetRows&&m.sheetRows<=p)return!0}e:for(;y<d.length;++y)switch(E=d.charCodeAt(y)){case 34:F===34&&(A=!A);break;case j:case 10:case 13:if(!A&&P())break e;break}return y-b>0&&P(),h["!ref"]=ra(g),h}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):el(a(d,f),f)}function l(d,f){var m="",x=f.type=="string"?[0,0,0,0]:xp(d,f);switch(f.type){case"base64":m=Fr(d);break;case"binary":m=d;break;case"buffer":f.codepage==65001?m=d.toString("utf8"):(f.codepage,m=la&&Buffer.isBuffer(d)?d.toString("binary"):In(d));break;case"array":m=pi(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+f.type)}return x[0]==239&&x[1]==187&&x[2]==191?m=Ra(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=Ra(m):f.type=="binary",m.slice(0,19)=="socialcalc:version:"?JE.to_sheet(f.type=="string"?m:Ra(m),f):o(m,f)}function c(d,f){return Mn(l(d,f),f)}function u(d){for(var f=[],m=pa(d["!ref"]),x,h=Array.isArray(d),g=m.s.r;g<=m.e.r;++g){for(var p=[],v=m.s.c;v<=m.e.c;++v){var w=Ye({r:g,c:v});if(x=h?(d[g]||[])[v]:d[w],!x||x.v==null){p.push("          ");continue}for(var b=(x.w||(Hs(x),x.w)||"").slice(0,10);b.length<10;)b+=" ";p.push(b+(v===0?" ":""))}f.push(p.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function jF(e,a){var t=a||{},r=!!t.WTF;t.WTF=!0;try{var s=WE.to_workbook(e,t);return t.WTF=r,s}catch(i){if(t.WTF=r,!i.message.match(/SYLK bad record ID/)&&r)throw i;return $o.to_workbook(e,a)}}var ii=function(){function e(T,L,V){if(T){At(T,T.l||0);for(var O=V.Enum||B;T.l<T.length;){var de=T.read_shift(2),me=O[de]||O[65535],ae=T.read_shift(2),ce=T.l+ae,W=me.f&&me.f(T,ae,V);if(T.l=ce,L(W,me,de))return}}}function a(T,L){switch(L.type){case"base64":return t(wr(Fr(T)),L);case"binary":return t(wr(T),L);case"buffer":case"array":return t(T,L)}throw"Unsupported type "+L.type}function t(T,L){if(!T)return T;var V=L||{},O=V.dense?[]:{},de="Sheet1",me="",ae=0,ce={},W=[],le=[],I={s:{r:0,c:0},e:{r:0,c:0}},q=V.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)V.Enum=B,e(T,function(ie,we,je){switch(je){case 0:V.vers=ie,ie>=4096&&(V.qpro=!0);break;case 6:I=ie;break;case 204:ie&&(me=ie);break;case 222:me=ie;break;case 15:case 51:V.qpro||(ie[1].v=ie[1].v.slice(1));case 13:case 14:case 16:je==14&&(ie[2]&112)==112&&(ie[2]&15)>1&&(ie[2]&15)<15&&(ie[1].z=V.dateNF||qe[14],V.cellDates&&(ie[1].t="d",ie[1].v=ku(ie[1].v))),V.qpro&&ie[3]>ae&&(O["!ref"]=ra(I),ce[de]=O,W.push(de),O=V.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},ae=ie[3],de=me||"Sheet"+(ae+1),me="");var Me=V.dense?(O[ie[0].r]||[])[ie[0].c]:O[Ye(ie[0])];if(Me){Me.t=ie[1].t,Me.v=ie[1].v,ie[1].z!=null&&(Me.z=ie[1].z),ie[1].f!=null&&(Me.f=ie[1].f);break}V.dense?(O[ie[0].r]||(O[ie[0].r]=[]),O[ie[0].r][ie[0].c]=ie[1]):O[Ye(ie[0])]=ie[1];break}},V);else if(T[2]==26||T[2]==14)V.Enum=X,T[2]==14&&(V.qpro=!0,T.l=0),e(T,function(ie,we,je){switch(je){case 204:de=ie;break;case 22:ie[1].v=ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ie[3]>ae&&(O["!ref"]=ra(I),ce[de]=O,W.push(de),O=V.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},ae=ie[3],de="Sheet"+(ae+1)),q>0&&ie[0].r>=q)break;V.dense?(O[ie[0].r]||(O[ie[0].r]=[]),O[ie[0].r][ie[0].c]=ie[1]):O[Ye(ie[0])]=ie[1],I.e.c<ie[0].c&&(I.e.c=ie[0].c),I.e.r<ie[0].r&&(I.e.r=ie[0].r);break;case 27:ie[14e3]&&(le[ie[14e3][0]]=ie[14e3][1]);break;case 1537:le[ie[0]]=ie[1],ie[0]==ae&&(de=ie[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(O["!ref"]=ra(I),ce[me||de]=O,W.push(me||de),!le.length)return{SheetNames:W,Sheets:ce};for(var ne={},G=[],ee=0;ee<le.length;++ee)ce[W[ee]]?(G.push(le[ee]||W[ee]),ne[le[ee]]=ce[le[ee]]||ce[W[ee]]):(G.push(le[ee]),ne[le[ee]]={"!ref":"A1"});return{SheetNames:G,Sheets:ne}}function r(T,L){var V=L||{};if(+V.codepage>=0&&Zr(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var O=lr(),de=pa(T["!ref"]),me=Array.isArray(T),ae=[];Oe(O,0,i(1030)),Oe(O,6,c(de));for(var ce=Math.min(de.e.r,8191),W=de.s.r;W<=ce;++W)for(var le=nt(W),I=de.s.c;I<=de.e.c;++I){W===de.s.r&&(ae[I]=Wa(I));var q=ae[I]+le,ne=me?(T[W]||[])[I]:T[q];if(!(!ne||ne.t=="z"))if(ne.t=="n")(ne.v|0)==ne.v&&ne.v>=-32768&&ne.v<=32767?Oe(O,13,x(W,I,ne.v)):Oe(O,14,g(W,I,ne.v));else{var G=Hs(ne);Oe(O,15,f(W,I,G.slice(0,239)))}}return Oe(O,1),O.end()}function s(T,L){var V=L||{};if(+V.codepage>=0&&Zr(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var O=lr();Oe(O,0,o(T));for(var de=0,me=0;de<T.SheetNames.length;++de)(T.Sheets[T.SheetNames[de]]||{})["!ref"]&&Oe(O,27,U(T.SheetNames[de],me++));var ae=0;for(de=0;de<T.SheetNames.length;++de){var ce=T.Sheets[T.SheetNames[de]];if(!(!ce||!ce["!ref"])){for(var W=pa(ce["!ref"]),le=Array.isArray(ce),I=[],q=Math.min(W.e.r,8191),ne=W.s.r;ne<=q;++ne)for(var G=nt(ne),ee=W.s.c;ee<=W.e.c;++ee){ne===W.s.r&&(I[ee]=Wa(ee));var ie=I[ee]+G,we=le?(ce[ne]||[])[ee]:ce[ie];if(!(!we||we.t=="z"))if(we.t=="n")Oe(O,23,P(ne,ee,ae,we.v));else{var je=Hs(we);Oe(O,22,E(ne,ee,ae,je.slice(0,239)))}}++ae}}return Oe(O,1),O.end()}function i(T){var L=Ee(2);return L.write_shift(2,T),L}function o(T){var L=Ee(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var V=0,O=0,de=0,me=0;me<T.SheetNames.length;++me){var ae=T.SheetNames[me],ce=T.Sheets[ae];if(!(!ce||!ce["!ref"])){++de;var W=fr(ce["!ref"]);V<W.e.r&&(V=W.e.r),O<W.e.c&&(O=W.e.c)}}return V>8191&&(V=8191),L.write_shift(2,V),L.write_shift(1,de),L.write_shift(1,O),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function l(T,L,V){var O={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&V.qpro?(O.s.c=T.read_shift(1),T.l++,O.s.r=T.read_shift(2),O.e.c=T.read_shift(1),T.l++,O.e.r=T.read_shift(2),O):(O.s.c=T.read_shift(2),O.s.r=T.read_shift(2),L==12&&V.qpro&&(T.l+=2),O.e.c=T.read_shift(2),O.e.r=T.read_shift(2),L==12&&V.qpro&&(T.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function c(T){var L=Ee(8);return L.write_shift(2,T.s.c),L.write_shift(2,T.s.r),L.write_shift(2,T.e.c),L.write_shift(2,T.e.r),L}function u(T,L,V){var O=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(O[0].c=T.read_shift(1),O[3]=T.read_shift(1),O[0].r=T.read_shift(2),T.l+=2):(O[2]=T.read_shift(1),O[0].c=T.read_shift(2),O[0].r=T.read_shift(2)),O}function d(T,L,V){var O=T.l+L,de=u(T,L,V);if(de[1].t="s",V.vers==20768){T.l++;var me=T.read_shift(1);return de[1].v=T.read_shift(me,"utf8"),de}return V.qpro&&T.l++,de[1].v=T.read_shift(O-T.l,"cstr"),de}function f(T,L,V){var O=Ee(7+V.length);O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,T),O.write_shift(1,39);for(var de=0;de<O.length;++de){var me=V.charCodeAt(de);O.write_shift(1,me>=128?95:me)}return O.write_shift(1,0),O}function m(T,L,V){var O=u(T,L,V);return O[1].v=T.read_shift(2,"i"),O}function x(T,L,V){var O=Ee(7);return O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,T),O.write_shift(2,V,"i"),O}function h(T,L,V){var O=u(T,L,V);return O[1].v=T.read_shift(8,"f"),O}function g(T,L,V){var O=Ee(13);return O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,T),O.write_shift(8,V,"f"),O}function p(T,L,V){var O=T.l+L,de=u(T,L,V);if(de[1].v=T.read_shift(8,"f"),V.qpro)T.l=O;else{var me=T.read_shift(2);y(T.slice(T.l,T.l+me),de),T.l+=me}return de}function v(T,L,V){var O=L&32768;return L&=-32769,L=(O?T:0)+(L>=8192?L-16384:L),(O?"":"$")+(V?Wa(L):nt(L))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function y(T,L){At(T,0);for(var V=[],O=0,de="",me="",ae="",ce="";T.l<T.length;){var W=T[T.l++];switch(W){case 0:V.push(T.read_shift(8,"f"));break;case 1:me=v(L[0].c,T.read_shift(2),!0),de=v(L[0].r,T.read_shift(2),!1),V.push(me+de);break;case 2:{var le=v(L[0].c,T.read_shift(2),!0),I=v(L[0].r,T.read_shift(2),!1);me=v(L[0].c,T.read_shift(2),!0),de=v(L[0].r,T.read_shift(2),!1),V.push(le+I+":"+me+de)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(T.read_shift(2));break;case 6:{for(var q="";W=T[T.l++];)q+=String.fromCharCode(W);V.push('"'+q.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:ce=V.pop(),ae=V.pop(),V.push(["AND","OR"][W-20]+"("+ae+","+ce+")");break;default:if(W<32&&b[W])ce=V.pop(),ae=V.pop(),V.push(ae+b[W]+ce);else if(w[W]){if(O=w[W][1],O==69&&(O=T[T.l++]),O>V.length){console.error("WK1 bad formula parse 0x"+W.toString(16)+":|"+V.join("|")+"|");return}var ne=V.slice(-O);V.length-=O,V.push(w[W][0]+"("+ne.join(",")+")")}else return W<=7?console.error("WK1 invalid opcode "+W.toString(16)):W<=24?console.error("WK1 unsupported op "+W.toString(16)):W<=30?console.error("WK1 invalid opcode "+W.toString(16)):W<=115?console.error("WK1 unsupported function opcode "+W.toString(16)):console.error("WK1 unrecognized opcode "+W.toString(16))}}V.length==1?L[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function j(T){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=T.read_shift(2),L[3]=T[T.l++],L[0].c=T[T.l++],L}function A(T,L){var V=j(T);return V[1].t="s",V[1].v=T.read_shift(L-4,"cstr"),V}function E(T,L,V,O){var de=Ee(6+O.length);de.write_shift(2,T),de.write_shift(1,V),de.write_shift(1,L),de.write_shift(1,39);for(var me=0;me<O.length;++me){var ae=O.charCodeAt(me);de.write_shift(1,ae>=128?95:ae)}return de.write_shift(1,0),de}function F(T,L){var V=j(T);V[1].v=T.read_shift(2);var O=V[1].v>>1;if(V[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return V[1].v=O,V}function k(T,L){var V=j(T),O=T.read_shift(4),de=T.read_shift(4),me=T.read_shift(2);if(me==65535)return O===0&&de===3221225472?(V[1].t="e",V[1].v=15):O===0&&de===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var ae=me&32768;return me=(me&32767)-16446,V[1].v=(1-ae*2)*(de*Math.pow(2,me+32)+O*Math.pow(2,me)),V}function P(T,L,V,O){var de=Ee(14);if(de.write_shift(2,T),de.write_shift(1,V),de.write_shift(1,L),O==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var me=0,ae=0,ce=0,W=0;return O<0&&(me=1,O=-O),ae=Math.log2(O)|0,O/=Math.pow(2,ae-31),W=O>>>0,W&2147483648||(O/=2,++ae,W=O>>>0),O-=W,W|=2147483648,W>>>=0,O*=Math.pow(2,32),ce=O>>>0,de.write_shift(4,ce),de.write_shift(4,W),ae+=16383+(me?32768:0),de.write_shift(2,ae),de}function R(T,L){var V=k(T);return T.l+=L-14,V}function _(T,L){var V=j(T),O=T.read_shift(4);return V[1].v=O>>6,V}function Q(T,L){var V=j(T),O=T.read_shift(8,"f");return V[1].v=O,V}function C(T,L){var V=Q(T);return T.l+=L-10,V}function z(T,L){return T[T.l+L-1]==0?T.read_shift(L,"cstr"):""}function S(T,L){var V=T[T.l++];V>L-1&&(V=L-1);for(var O="";O.length<V;)O+=String.fromCharCode(T[T.l++]);return O}function D(T,L,V){if(!(!V.qpro||L<21)){var O=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var de=T.read_shift(L-21,"cstr");return[O,de]}}function H(T,L){for(var V={},O=T.l+L;T.l<O;){var de=T.read_shift(2);if(de==14e3){for(V[de]=[0,""],V[de][0]=T.read_shift(2);T[T.l];)V[de][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return V}function U(T,L){var V=Ee(5+T.length);V.write_shift(2,14e3),V.write_shift(2,L);for(var O=0;O<T.length;++O){var de=T.charCodeAt(O);V[V.l++]=de>127?95:de}return V[V.l++]=0,V}var B={0:{n:"BOF",f:dt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:h},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:z},222:{n:"SHEETNAMELP",f:S},65535:{n:""}},X={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:H},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:_},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:C},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:D},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:a}}();function SF(e){var a={},t=e.match(Wt),r=0,s=!1;if(t)for(;r!=t.length;++r){var i=Ke(t[r]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":a.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;a.cp=Ah[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":a.outline=1;break;case"</outline>":break;case"<rFont":a.name=i.val;break;case"<sz":a.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":a.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":a.uval="double";break;case"singleAccounting":a.uval="single-accounting";break;case"doubleAccounting":a.uval="double-accounting";break}case"<u>":case"<u/>":a.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":a.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":a.i=1;break;case"</i>":break;case"<color":i.rgb&&(a.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":a.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":a.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return a}var CF=function(){var e=fc("t"),a=fc("rPr");function t(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:ha(o[1])},c=i.match(a);return c&&(l.s=SF(c[1])),l}var r=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(r,"").split(s).map(t).filter(function(l){return l.v})}}(),TF=function(){var a=/(\r\n|\n)/g;function t(s,i,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function r(s){var i=[[],s.v,[]];return s.v?(s.s&&t(s.s,i[0],i[2]),i[0].join("")+i[1].replace(a,"<br/>")+i[2].join("")):""}return function(i){return i.map(r).join("")}}(),FF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_F=/<(?:\w+:)?r>/,AF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ap(e,a){var t=a?a.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=ha(Ra(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Ra(e),t&&(r.h=zh(r.t))):e.match(_F)&&(r.r=Ra(e),r.t=ha(Ra((e.replace(AF,"").match(FF)||[]).join("").replace(Wt,""))),t&&(r.h=TF(CF(r.r)))),r):{t:""}}var RF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,DF=/<(?:\w+:)?(?:si|sstItem)>/g,PF=/<\/(?:\w+:)?(?:si|sstItem)>/;function OF(e,a){var t=[],r="";if(!e)return t;var s=e.match(RF);if(s){r=s[2].replace(DF,"").split(PF);for(var i=0;i!=r.length;++i){var o=ap(r[i].trim(),a);o!=null&&(t[t.length]=o)}s=Ke(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}var IF=/^\s|\s$|[\t\n\r]/;function ZE(e,a){if(!a.bookSST)return"";var t=[ot];t[t.length]=Pe("sst",null,{xmlns:Ci[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var s=e[r],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(IF)&&(i+=' xml:space="preserve"'),i+=">"+Fa(s.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function MF(e){return[e.read_shift(4),e.read_shift(4)]}function UF(e,a){var t=[],r=!1;return Ys(e,function(i,o,l){switch(l){case 159:t.Count=i[0],t.Unique=i[1];break;case 19:t.push(i);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(o.T,!r||a.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t}function LF(e,a){return a||(a=Ee(8)),a.write_shift(4,e.Count),a.write_shift(4,e.Unique),a}var BF=KT;function zF(e){var a=lr();Te(a,159,LF(e));for(var t=0;t<e.length;++t)Te(a,19,BF(e[t]));return Te(a,160),a.end()}function QE(e){for(var a=[],t=e.split(""),r=0;r<t.length;++r)a[r]=t[r].charCodeAt(0);return a}function Ls(e,a){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),a>=4&&(e.l+=a-4),t}function $F(e){var a={};return a.id=e.read_shift(0,"lpp4"),a.R=Ls(e,4),a.U=Ls(e,4),a.W=Ls(e,4),a}function VF(e){for(var a=e.read_shift(4),t=e.l+a-4,r={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function HF(e){var a=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)a.push(VF(e));return a}function GF(e){var a=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)a.push(e.read_shift(0,"lpp4"));return a}function XF(e){var a={};return e.read_shift(4),e.l+=4,a.id=e.read_shift(0,"lpp4"),a.name=e.read_shift(0,"lpp4"),a.R=Ls(e,4),a.U=Ls(e,4),a.W=Ls(e,4),a}function qF(e){var a=XF(e);if(a.ename=e.read_shift(0,"8lpp4"),a.blksz=e.read_shift(4),a.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return a}function e3(e,a){var t=e.l+a,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var s=!1;switch(r.AlgID){case 26126:case 26127:case 26128:s=r.Flags==36;break;case 26625:s=r.Flags==4;break;case 0:s=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function a3(e,a){var t={},r=e.l+a;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function YF(e){var a=Ls(e);switch(a.Minor){case 2:return[a.Minor,WF(e)];case 3:return[a.Minor,KF()];case 4:return[a.Minor,JF(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+a.Minor)}function WF(e){var a=e.read_shift(4);if((a&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=e3(e,t),s=a3(e,e.length-e.l);return{t:"Std",h:r,v:s}}function KF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function JF(e){var a=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(Wt,function(i){var o=Ke(i);switch(Es(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":a.forEach(function(l){r[l]=o[l]});break;case"<dataIntegrity":r.encryptedHmacKey=o.encryptedHmacKey,r.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(o);break;default:throw o[0]}}),r}function ZF(e,a){var t={},r=t.EncryptionVersionInfo=Ls(e,4);if(a-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),a-=4;var s=e.read_shift(4);return a-=4,t.EncryptionHeader=e3(e,s),a-=s,t.EncryptionVerifier=a3(e,a),t}function QF(e){var a={},t=a.EncryptionVersionInfo=Ls(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return a.Salt=e.read_shift(16),a.EncryptedVerifier=e.read_shift(16),a.EncryptedVerifierHash=e.read_shift(16),a}function tp(e){var a=0,t,r=QE(e),s=r.length+1,i,o,l,c,u;for(t=Tn(s),t[0]=r.length,i=1;i!=s;++i)t[i]=r[i-1];for(i=s-1;i>=0;--i)o=t[i],l=a&16384?1:0,c=a<<1&32767,u=l|c,a=u^o;return a^52811}var t3=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],a=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(o){return(o/2|o*128)&255},s=function(o,l){return r(o^l)},i=function(o){for(var l=a[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=t[c]),d*=2,--c;return l};return function(o){for(var l=QE(o),c=i(l),u=l.length,d=Tn(16),f=0;f!=16;++f)d[f]=0;var m,x,h;for((u&1)===1&&(m=c>>8,d[u]=s(e[0],m),--u,m=c&255,x=l[l.length-1],d[u]=s(x,m));u>0;)--u,m=c>>8,d[u]=s(l[u],m),--u,m=c&255,d[u]=s(l[u],m);for(u=15,h=15-l.length;h>0;)m=c>>8,d[u]=s(e[h],m),--u,--h,m=c&255,d[u]=s(l[u],m),--u,--h;return d}}(),e8=function(e,a,t,r,s){s||(s=a),r||(r=t3(e));var i,o;for(i=0;i!=a.length;++i)o=a[i],o^=r[t],o=(o>>5|o<<3)&255,s[i]=o,++t;return[s,t,r]},a8=function(e){var a=0,t=t3(e);return function(r){var s=e8("",r,a,t);return a=s[1],s[0]}};function t8(e,a,t,r){var s={key:dt(e),verificationBytes:dt(e)};return t.password&&(s.verifier=tp(t.password)),r.valid=s.verificationBytes===s.verifier,r.valid&&(r.insitu=a8(t.password)),s}function r8(e,a,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=QF(e):r.Data=ZF(e,a),r}function s8(e,a,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?r8(e,a-2,r):t8(e,t.biff>=8?a:a-2,t,r),r}var r3=function(){function e(s,i){switch(i.type){case"base64":return a(Fr(s),i);case"binary":return a(s,i);case"buffer":return a(la&&Buffer.isBuffer(s)?s.toString("binary"):In(s),i);case"array":return a(pi(s),i)}throw new Error("Unrecognized type "+i.type)}function a(s,i){var o=i||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var m=/\\\w+\b/g,x=0,h,g=-1;h=m.exec(d);){switch(h[0]){case"\\cell":var p=d.slice(x,m.lastIndex-h[0].length);if(p[0]==" "&&(p=p.slice(1)),++g,p.length){var v={v:p,t:"s"};Array.isArray(l)?l[f][g]=v:l[Ye({r:f,c:g})]=v}break}x=m.lastIndex}g>u.e.c&&(u.e.c=g)}),l["!ref"]=ra(u),l}function t(s,i){return Mn(e(s,i),i)}function r(s){for(var i=["{\\rtf1\\ansi"],o=pa(s["!ref"]),l,c=Array.isArray(s),u=o.s.r;u<=o.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=Ye({r:u,c:d});l=c?(s[u]||[])[d]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Hs(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}}();function n8(e){var a=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(a.slice(0,2),16),parseInt(a.slice(2,4),16),parseInt(a.slice(4,6),16)]}function pc(e){for(var a=0,t=1;a!=3;++a)t=t*256+(e[a]>255?255:e[a]<0?0:e[a]);return t.toString(16).toUpperCase().slice(1)}function i8(e){var a=e[0]/255,t=e[1]/255,r=e[2]/255,s=Math.max(a,t,r),i=Math.min(a,t,r),o=s-i;if(o===0)return[0,0,a];var l=0,c=0,u=s+i;switch(c=o/(u>1?2-u:u),s){case a:l=((t-r)/o+6)%6;break;case t:l=(r-a)/o+2;break;case r:l=(a-t)/o+4;break}return[l/6,c,u/2]}function o8(e){var a=e[0],t=e[1],r=e[2],s=t*2*(r<.5?r:1-r),i=r-s/2,o=[i,i,i],l=6*a,c;if(t!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function G0(e,a){if(a===0)return e;var t=i8(n8(e));return a<0?t[2]=t[2]*(1+a):t[2]=1-(1-t[2])*(1-a),pc(o8(t))}var s3=6,l8=15,c8=1,$t=s3;function gc(e){return Math.floor((e+Math.round(128/$t)/256)*$t)}function yc(e){return Math.floor((e-5)/$t*100+.5)/100}function X0(e){return Math.round((e*$t+5)/$t*256)/256}function _f(e){return X0(yc(gc(e)))}function rp(e){var a=Math.abs(e-_f(e)),t=$t;if(a>.005)for($t=c8;$t<l8;++$t)Math.abs(e-_f(e))<=a&&(a=Math.abs(e-_f(e)),t=$t);$t=t}function Fn(e){e.width?(e.wpx=gc(e.width),e.wch=yc(e.wpx),e.MDW=$t):e.wpx?(e.wch=yc(e.wpx),e.width=X0(e.wch),e.MDW=$t):typeof e.wch=="number"&&(e.width=X0(e.wch),e.wpx=gc(e.width),e.MDW=$t),e.customWidth&&delete e.customWidth}var d8=96,n3=d8;function vc(e){return e*96/n3}function Vo(e){return e*n3/96}var u8={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function f8(e,a,t,r){a.Borders=[];var s={},i=!1;(e[0].match(Wt)||[]).forEach(function(o){var l=Ke(o);switch(Es(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Ua(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Ua(l.diagonalDown)),a.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function m8(e,a,t,r){a.Fills=[];var s={},i=!1;(e[0].match(Wt)||[]).forEach(function(o){var l=Ke(o);switch(Es(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},a.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":a.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function x8(e,a,t,r){a.Fonts=[];var s={},i=!1;(e[0].match(Wt)||[]).forEach(function(o){var l=Ke(o);switch(Es(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":a.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=Ra(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Ua(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Ua(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Ua(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Ua(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Ua(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Ua(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Ua(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Ah[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Ua(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=si[s.color.index];s.color.index==81&&(c=si[1]),c||(c=si[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=G0(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function h8(e,a,t){a.NumberFmt=[];for(var r=at(qe),s=0;s<r.length;++s)a.NumberFmt[r[s]]=qe[r[s]];var i=e[0].match(Wt);if(i)for(s=0;s<i.length;++s){var o=Ke(i[s]);switch(Es(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=ha(Ra(o.formatCode)),c=parseInt(o.numFmtId,10);if(a.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&a.NumberFmt[c]!=null;--c);a.NumberFmt[c]=l}Us(l,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function p8(e){var a=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)e[r]!=null&&(a[a.length]=Pe("numFmt",null,{numFmtId:r,formatCode:Fa(e[r])}))}),a.length===1?"":(a[a.length]="</numFmts>",a[0]=Pe("numFmts",null,{count:a.length-2}).replace("/>",">"),a.join(""))}var kd=["numFmtId","fillId","fontId","borderId","xfId"],Nd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function g8(e,a,t){a.CellXf=[];var r,s=!1;(e[0].match(Wt)||[]).forEach(function(i){var o=Ke(i),l=0;switch(Es(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=o,delete r[0],l=0;l<kd.length;++l)r[kd[l]]&&(r[kd[l]]=parseInt(r[kd[l]],10));for(l=0;l<Nd.length;++l)r[Nd[l]]&&(r[Nd[l]]=Ua(r[Nd[l]]));if(a.NumberFmt&&r.numFmtId>392){for(l=392;l>60;--l)if(a.NumberFmt[r.numFmtId]==a.NumberFmt[l]){r.numFmtId=l;break}}a.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Ua(o.wrapText)),r.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function y8(e){var a=[];return a[a.length]=Pe("cellXfs",null),e.forEach(function(t){a[a.length]=Pe("xf",null,t)}),a[a.length]="</cellXfs>",a.length===2?"":(a[0]=Pe("cellXfs",null,{count:a.length-2}).replace("/>",">"),a.join(""))}var v8=function(){var a=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(a))&&h8(f,d,u),(f=l.match(s))&&x8(f,d,c,u),(f=l.match(r))&&m8(f,d,c,u),(f=l.match(i))&&f8(f,d,c,u),(f=l.match(t))&&g8(f,d,u),d}}();function i3(e,a){var t=[ot,Pe("styleSheet",null,{xmlns:Ci[0],"xmlns:vt":pt.vt})],r;return e.SSF&&(r=p8(e.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=y8(a.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function b8(e,a){var t=e.read_shift(2),r=qt(e);return[t,r]}function w8(e,a,t){t||(t=Ee(6+4*a.length)),t.write_shift(2,e),St(a,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function E8(e,a,t){var r={};r.sz=e.read_shift(2)/20;var s=r5(e);s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1);var i=e.read_shift(2);switch(i===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var l=e.read_shift(1);l>0&&(r.family=l);var c=e.read_shift(1);switch(c>0&&(r.charset=c),e.l++,r.color=t5(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=qt(e),r}function k8(e,a){a||(a=Ee(25+4*32)),a.write_shift(2,e.sz*20),s5(e,a),a.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),a.write_shift(2,t),a.write_shift(1,e.underline||0),a.write_shift(1,e.family||0),a.write_shift(1,e.charset||0),a.write_shift(1,0),$0(e.color,a);var r=0;return r=2,a.write_shift(1,r),St(e.name,a),a.length>a.l?a.slice(0,a.l):a}var N8=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Af,j8=Yt;function J1(e,a){a||(a=Ee(4*3+8*7+16*1)),Af||(Af=wu(N8));var t=Af[e.patternType];t==null&&(t=40),a.write_shift(4,t);var r=0;if(t!=40)for($0({auto:1},a),$0({auto:1},a);r<12;++r)a.write_shift(4,0);else{for(;r<4;++r)a.write_shift(4,0);for(;r<12;++r)a.write_shift(4,0)}return a.length>a.l?a.slice(0,a.l):a}function S8(e,a){var t=e.l+a,r=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:s}}function o3(e,a,t){t||(t=Ee(16)),t.write_shift(2,a||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function gl(e,a){return a||(a=Ee(10)),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(4,0),a}var C8=Yt;function T8(e,a){return a||(a=Ee(51)),a.write_shift(1,0),gl(null,a),gl(null,a),gl(null,a),gl(null,a),gl(null,a),a.length>a.l?a.slice(0,a.l):a}function F8(e,a){return a||(a=Ee(12+4*10)),a.write_shift(4,e.xfId),a.write_shift(2,1),a.write_shift(1,0),a.write_shift(1,0),z0(e.name||"",a),a.length>a.l?a.slice(0,a.l):a}function _8(e,a,t){var r=Ee(2052);return r.write_shift(4,e),z0(a,r),z0(t,r),r.length>r.l?r.slice(0,r.l):r}function A8(e,a,t){var r={};r.NumberFmt=[];for(var s in qe)r.NumberFmt[s]=qe[s];r.CellXf=[],r.Fonts=[];var i=[],o=!1;return Ys(e,function(c,u,d){switch(d){case 44:r.NumberFmt[c[0]]=c[1],Us(c[1],c[0]);break;case 43:r.Fonts.push(c),c.color.theme!=null&&a&&a.themeElements&&a.themeElements.clrScheme&&(c.color.rgb=G0(a.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&r.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!o||t.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),r}function R8(e,a){if(a){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)a[s]!=null&&++t}),t!=0&&(Te(e,615,ts(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)a[s]!=null&&Te(e,44,w8(s,a[s]))}),Te(e,616))}}function D8(e){var a=1;Te(e,611,ts(a)),Te(e,43,k8({sz:12,color:{theme:1},name:"Calibri",family:2})),Te(e,612)}function P8(e){var a=2;Te(e,603,ts(a)),Te(e,45,J1({patternType:"none"})),Te(e,45,J1({patternType:"gray125"})),Te(e,604)}function O8(e){var a=1;Te(e,613,ts(a)),Te(e,46,T8()),Te(e,614)}function I8(e){var a=1;Te(e,626,ts(a)),Te(e,47,o3({numFmtId:0},65535)),Te(e,627)}function M8(e,a){Te(e,617,ts(a.length)),a.forEach(function(t){Te(e,47,o3(t,0))}),Te(e,618)}function U8(e){var a=1;Te(e,619,ts(a)),Te(e,48,F8({xfId:0,name:"Normal"})),Te(e,620)}function L8(e){var a=0;Te(e,505,ts(a)),Te(e,506)}function B8(e){var a=0;Te(e,508,_8(a,"TableStyleMedium9","PivotStyleMedium4")),Te(e,509)}function z8(e,a){var t=lr();return Te(t,278),R8(t,e.SSF),D8(t),P8(t),O8(t),I8(t),M8(t,a.cellXfs),U8(t),L8(t),B8(t),Te(t,279),t.end()}var $8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function V8(e,a,t){a.themeElements.clrScheme=[];var r={};(e[0].match(Wt)||[]).forEach(function(s){var i=Ke(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=i.val;break;case"<a:sysClr":r.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(a.themeElements.clrScheme[$8.indexOf(i[0])]=r,r={}):r.name=i[0].slice(3,i[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function H8(){}function G8(){}var X8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,q8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Y8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function W8(e,a,t){a.themeElements={};var r;[["clrScheme",X8,V8],["fontScheme",q8,H8],["fmtScheme",Y8,G8]].forEach(function(s){if(!(r=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](r,a,t)})}var K8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function l3(e,a){(!e||e.length===0)&&(e=sp());var t,r={};if(!(t=e.match(K8)))throw new Error("themeElements not found in theme");return W8(t[0],r,a),r.raw=e,r}function sp(e,a){if(a&&a.themeXLSX)return a.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[ot];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function J8(e,a,t){var r=e.l+a,s=e.read_shift(4);if(s!==124226){if(!t.cellStyles){e.l=r;return}var i=e.slice(e.l);e.l=r;var o;try{o=eE(i,{type:"array"})}catch{return}var l=Er(o,"theme/theme/theme1.xml",!0);if(l)return l3(l,t)}}function Z8(e){return e.read_shift(4)}function Q8(e){var a={};switch(a.xclrType=e.read_shift(2),a.nTintShade=e.read_shift(2),a.xclrType){case 0:e.l+=4;break;case 1:a.xclrValue=e_(e,4);break;case 2:a.xclrValue=zE(e);break;case 3:a.xclrValue=Z8(e);break;case 4:e.l+=4;break}return e.l+=8,a}function e_(e,a){return Yt(e,a)}function a_(e,a){return Yt(e,a)}function t_(e){var a=e.read_shift(2),t=e.read_shift(2)-4,r=[a];switch(a){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=Q8(e);break;case 6:r[1]=a_(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+a+" "+t)}return r}function r_(e,a){var t=e.l+a;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(t_(e,t-e.l));return{ixfe:r,ext:i}}function s_(e,a){a.forEach(function(t){switch(t[0]){}})}function n_(e,a){return{flags:e.read_shift(4),version:e.read_shift(4),name:qt(e)}}function i_(e){var a=Ee(12+2*e.name.length);return a.write_shift(4,e.flags),a.write_shift(4,e.version),St(e.name,a),a.slice(0,a.l)}function o_(e){for(var a=[],t=e.read_shift(4);t-- >0;)a.push([e.read_shift(4),e.read_shift(4)]);return a}function l_(e){var a=Ee(4+8*e.length);a.write_shift(4,e.length);for(var t=0;t<e.length;++t)a.write_shift(4,e[t][0]),a.write_shift(4,e[t][1]);return a}function c_(e,a){var t=Ee(8+2*a.length);return t.write_shift(4,e),St(a,t),t.slice(0,t.l)}function d_(e){return e.l+=4,e.read_shift(4)!=0}function u_(e,a){var t=Ee(8);return t.write_shift(4,e),t.write_shift(4,1),t}function f_(e,a,t){var r={Types:[],Cell:[],Value:[]},s=t||{},i=[],o=!1,l=2;return Ys(e,function(c,u,d){switch(d){case 335:r.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?r.Cell.push({type:r.Types[f[0]-1].name,index:f[1]}):l==0&&r.Value.push({type:r.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!u.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function m_(){var e=lr();return Te(e,332),Te(e,334,ts(1)),Te(e,335,i_({name:"XLDAPR",version:12e4,flags:3496657072})),Te(e,336),Te(e,339,c_(1,"XLDAPR")),Te(e,52),Te(e,35,ts(514)),Te(e,4096,ts(0)),Te(e,4097,Ir(1)),Te(e,36),Te(e,53),Te(e,340),Te(e,337,u_(1)),Te(e,51,l_([[1,0]])),Te(e,338),Te(e,333),e.end()}function x_(e,a,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var s=!1,i=2,o;return e.replace(Wt,function(l){var c=Ke(l);switch(Es(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<r.Types.length;++u)r.Types[u].name==c.name&&(o=r.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?r.Cell.push({type:r.Types[c.t-1].name,index:+c.v}):i==0&&r.Value.push({type:r.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),r}function c3(){var e=[ot];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function h_(e){var a=[];if(!e)return a;var t=1;return(e.match(Wt)||[]).forEach(function(r){var s=Ke(r);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,a.push(s);break}}),a}function p_(e){var a={};a.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),a.r=Ye(t);var r=e.read_shift(1);return r&2&&(a.l="1"),r&8&&(a.a="1"),a}function g_(e,a,t){var r=[];return Ys(e,function(i,o,l){switch(l){case 63:r.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function y_(e,a,t,r){if(!e)return e;var s=r||{},i=!1;Ys(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function v_(e,a){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return a["!id"][t].Target}var xo=1024;function d3(e,a){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[Pe("xml",null,{"xmlns:v":yr.v,"xmlns:o":yr.o,"xmlns:x":yr.x,"xmlns:mv":yr.mv}).replace(/\/>/,">"),Pe("o:shapelayout",Pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Pe("v:shapetype",[Pe("v:stroke",null,{joinstyle:"miter"}),Pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];xo<e*1e3;)xo+=1e3;return a.forEach(function(i){var o=Ka(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Pe("v:fill",c,l),d={on:"t",obscured:"t"};++xo,s=s.concat(["<v:shape"+mc({id:"_x0000_s"+xo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Pe("v:shadow",null,d),Pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Dt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Dt("x:AutoFill","False"),Dt("x:Row",String(o.r)),Dt("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Z1(e,a,t,r){var s=Array.isArray(e),i;a.forEach(function(o){var l=Ka(o.ref);if(s?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},s?e[l.r][l.c]=i:e[o.ref]=i;var c=pa(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=ra(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:t};o.h&&(d.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!t&&i.c[f].T)return;t&&!i.c[f].T&&i.c.splice(f,1)}if(t&&r){for(f=0;f<r.length;++f)if(d.a==r[f].id){d.a=r[f].name||d.a;break}}i.c.push(d)})}function b_(e,a){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&t.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Ke(l[0]),u={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Ka(c.ref);if(!(a.sheetRows&&a.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!f&&!!f[1]&&ap(f[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),a.cellHTML&&(u.h=m.h),r.push(u)}}}}),r}function u3(e){var a=[ot,Pe("comments",null,{xmlns:Ci[0]})],t=[];return a.push("<authors>"),e.forEach(function(r){r[1].forEach(function(s){var i=Fa(s.a);t.indexOf(i)==-1&&(t.push(i),a.push("<author>"+i+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),a.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),a.push("<author>SheetJ5</author>")),a.push("</authors>"),a.push("<commentList>"),e.forEach(function(r){var s=0,i=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?s=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(c){c.a&&(s=t.indexOf(Fa(c.a))),i.push(c.t||"")}),a.push('<comment ref="'+r[0]+'" authorId="'+s+'"><text>'),i.length<=1)a.push(Dt("t",Fa(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;a.push(Dt("t",Fa(o)))}a.push("</text></comment>")}),a.push("</commentList>"),a.length>2&&(a[a.length]="</comments>",a[1]=a[1].replace("/>",">")),a.join("")}function w_(e,a){var t=[],r=!1,s={},i=0;return e.replace(Wt,function(l,c){var u=Ke(l);switch(Es(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&a.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),t}function E_(e,a,t){var r=[ot,Pe("ThreadedComments",null,{xmlns:pt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&a.indexOf(o.a)==-1&&a.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+a.indexOf(o.a)).slice(-12)+"}"),r.push(Pe("threadedComment",Dt("text",o.t||""),c))})}),r.push("</ThreadedComments>"),r.join("")}function k_(e,a){var t=[],r=!1;return e.replace(Wt,function(i){var o=Ke(i);switch(Es(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&a.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),t}function N_(e){var a=[ot,Pe("personList",null,{xmlns:pt.TCMNT,"xmlns:x":Ci[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,r){a.push(Pe("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),a.push("</personList>"),a.join("")}function j_(e){var a={};a.iauthor=e.read_shift(4);var t=Ai(e);return a.rfx=t.s,a.ref=Ye(t.s),e.l+=16,a}function S_(e,a){return a==null&&(a=Ee(36)),a.write_shift(4,e[1].iauthor),al(e[0],a),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a}var C_=qt;function T_(e){return St(e.slice(0,54))}function F_(e,a){var t=[],r=[],s={},i=!1;return Ys(e,function(l,c,u){switch(u){case 632:r.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=r[s.iauthor],delete s.iauthor,a.sheetRows&&s.rfx&&a.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),t}function __(e){var a=lr(),t=[];return Te(a,628),Te(a,630),e.forEach(function(r){r[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),Te(a,632,T_(s.a)))})}),Te(a,631),Te(a,633),e.forEach(function(r){r[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var i={s:Ka(r[0]),e:Ka(r[0])};Te(a,635,S_([i,s])),s.t&&s.t.length>0&&Te(a,637,ZT(s)),Te(a,636),delete s.iauthor})}),Te(a,634),Te(a,629),a.end()}var A_="application/vnd.ms-office.vbaProject";function R_(e){var a=Ge.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ge.utils.cfb_add(a,s,e.FileIndex[r].content)}}),Ge.write(a)}function D_(e,a){a.FullPaths.forEach(function(t,r){if(r!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ge.utils.cfb_add(e,s,a.FileIndex[r].content)}})}var f3=["xlsb","xlsm","xlam","biff8","xla"];function P_(){return{"!type":"dialog"}}function O_(){return{"!type":"dialog"}}function I_(){return{"!type":"macro"}}function M_(){return{"!type":"macro"}}var Co=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,a={r:0,c:0};function t(r,s,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=a.c:--d,c?u+=a.r:--u,s+(l?"":"$")+Wa(d)+(c?"":"$")+nt(u)}return function(s,i){return a=i,s.replace(e,t)}}(),np=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ip=function(){return function(a,t){return a.replace(np,function(r,s,i,o,l,c){var u=Xh(o)-(i?0:t.c),d=Gh(c)-(l?0:t.r),f=d==0?"":l?d+1:"["+d+"]",m=u==0?"":i?u+1:"["+u+"]";return s+"R"+f+"C"+m})}}();function m3(e,a){return e.replace(np,function(t,r,s,i,o,l){return r+(s=="$"?s+i:Wa(Xh(i)+a.c))+(o=="$"?o+l:nt(Gh(l)+a.r))})}function U_(e,a,t){var r=fr(a),s=r.s,i=Ka(t),o={r:i.r-s.r,c:i.c-s.c};return m3(e,o)}function L_(e){return e.length!=1}function Q1(e){return e.replace(/_xlfn\./g,"")}function lt(e){e.l+=1}function _n(e,a){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function x3(e,a,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return h3(e);t.biff==12&&(r=4)}var s=e.read_shift(r),i=e.read_shift(r),o=_n(e),l=_n(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function h3(e){var a=_n(e),t=_n(e),r=e.read_shift(1),s=e.read_shift(1);return{s:{r:a[0],c:r,cRel:a[1],rRel:a[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function B_(e,a,t){if(t.biff<8)return h3(e);var r=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),i=_n(e),o=_n(e);return{s:{r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function p3(e,a,t){if(t&&t.biff>=2&&t.biff<=5)return z_(e);var r=e.read_shift(t&&t.biff==12?4:2),s=_n(e);return{r,c:s[0],cRel:s[1],rRel:s[2]}}function z_(e){var a=_n(e),t=e.read_shift(1);return{r:a[0],c:t,cRel:a[1],rRel:a[2]}}function $_(e){var a=e.read_shift(2),t=e.read_shift(2);return{r:a,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function V_(e,a,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return H_(e);var s=e.read_shift(r>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:l}}function H_(e){var a=e.read_shift(2),t=e.read_shift(1),r=(a&32768)>>15,s=(a&16384)>>14;return a&=16383,r==1&&a>=8192&&(a=a-16384),s==1&&t>=128&&(t=t-256),{r:a,c:t,cRel:s,rRel:r}}function G_(e,a,t){var r=(e[e.l++]&96)>>5,s=x3(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,s]}function X_(e,a,t){var r=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=x3(e,i,t);return[r,s,o]}function q_(e,a,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function Y_(e,a,t){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[r,s]}function W_(e,a,t){var r=(e[e.l++]&96)>>5,s=B_(e,a-1,t);return[r,s]}function K_(e,a,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function ey(e){var a=e[e.l+1]&1,t=1;return e.l+=4,[a,t]}function J_(e,a,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),s=[],i=0;i<=r;++i)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function Z_(e,a,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function Q_(e,a,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function eA(e){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(2)]}function aA(e,a,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function g3(e){var a=e.read_shift(1),t=e.read_shift(1);return[a,t]}function tA(e){return e.read_shift(2),g3(e)}function rA(e){return e.read_shift(2),g3(e)}function sA(e,a,t){var r=(e[e.l]&96)>>5;e.l+=1;var s=p3(e,0,t);return[r,s]}function nA(e,a,t){var r=(e[e.l]&96)>>5;e.l+=1;var s=V_(e,0,t);return[r,s]}function iA(e,a,t){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var i=p3(e,0,t);return[r,s,i]}function oA(e,a,t){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[dR[s],b3[s],r]}function lA(e,a,t){var r=e[e.l++],s=e.read_shift(1),i=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:cA(e);return[s,(i[0]===0?b3:cR)[i[1]]]}function cA(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function dA(e,a,t){e.l+=t&&t.biff==2?3:4}function uA(e,a,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[r,s]}function fA(e){return e.l++,Ws[e.read_shift(1)]}function mA(e){return e.l++,e.read_shift(2)}function xA(e){return e.l++,e.read_shift(1)!==0}function hA(e){return e.l++,Vt(e)}function pA(e,a,t){return e.l++,zc(e,a-1,t)}function gA(e,a){var t=[e.read_shift(1)];if(a==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=rt(e,1)?"TRUE":"FALSE",a!=12&&(e.l+=7);break;case 37:case 16:t[1]=Ws[e[e.l]],e.l+=a==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Vt(e);break;case 2:t[1]=Ri(e,0,{biff:a>0&&a<8?2:a});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function yA(e,a,t){for(var r=e.read_shift(t.biff==12?4:2),s=[],i=0;i!=r;++i)s.push((t.biff==12?Ai:Nu)(e));return s}function vA(e,a,t){var r=0,s=0;t.biff==12?(r=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--s==0&&(s=256));for(var i=0,o=[];i!=r&&(o[i]=[]);++i)for(var l=0;l!=s;++l)o[i][l]=gA(e,t.biff);return o}function bA(e,a,t){var r=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,i=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,i]}function wA(e,a,t){if(t.biff==5)return EA(e);var r=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[r,s,i]}function EA(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[a,t,r]}function kA(e,a,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[r,s]}function NA(e,a,t){var r=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[r,s]}function jA(e,a,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function SA(e,a,t){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[r,s]}var CA=Yt,TA=Yt,FA=Yt;function Vc(e,a,t){return e.l+=2,[$_(e)]}function op(e){return e.l+=6,[]}var _A=Vc,AA=op,RA=op,DA=Vc;function y3(e){return e.l+=2,[dt(e),e.read_shift(2)&1]}var PA=Vc,OA=y3,IA=op,MA=Vc,UA=Vc,LA=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function BA(e){e.l+=2;var a=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=LA[t>>2&31];return{ixti:a,coltype:t&3,rt:o,idx:r,c:s,C:i}}function zA(e){return e.l+=2,[e.read_shift(4)]}function $A(e,a,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function VA(e,a,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function HA(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[a,t]}function GA(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[a,t]}function XA(e){return e.l+=4,[0,0]}var ay={1:{n:"PtgExp",f:uA},2:{n:"PtgTbl",f:FA},3:{n:"PtgAdd",f:lt},4:{n:"PtgSub",f:lt},5:{n:"PtgMul",f:lt},6:{n:"PtgDiv",f:lt},7:{n:"PtgPower",f:lt},8:{n:"PtgConcat",f:lt},9:{n:"PtgLt",f:lt},10:{n:"PtgLe",f:lt},11:{n:"PtgEq",f:lt},12:{n:"PtgGe",f:lt},13:{n:"PtgGt",f:lt},14:{n:"PtgNe",f:lt},15:{n:"PtgIsect",f:lt},16:{n:"PtgUnion",f:lt},17:{n:"PtgRange",f:lt},18:{n:"PtgUplus",f:lt},19:{n:"PtgUminus",f:lt},20:{n:"PtgPercent",f:lt},21:{n:"PtgParen",f:lt},22:{n:"PtgMissArg",f:lt},23:{n:"PtgStr",f:pA},26:{n:"PtgSheet",f:$A},27:{n:"PtgEndSheet",f:VA},28:{n:"PtgErr",f:fA},29:{n:"PtgBool",f:xA},30:{n:"PtgInt",f:mA},31:{n:"PtgNum",f:hA},32:{n:"PtgArray",f:K_},33:{n:"PtgFunc",f:oA},34:{n:"PtgFuncVar",f:lA},35:{n:"PtgName",f:bA},36:{n:"PtgRef",f:sA},37:{n:"PtgArea",f:G_},38:{n:"PtgMemArea",f:kA},39:{n:"PtgMemErr",f:CA},40:{n:"PtgMemNoMem",f:TA},41:{n:"PtgMemFunc",f:NA},42:{n:"PtgRefErr",f:jA},43:{n:"PtgAreaErr",f:q_},44:{n:"PtgRefN",f:nA},45:{n:"PtgAreaN",f:W_},46:{n:"PtgMemAreaN",f:HA},47:{n:"PtgMemNoMemN",f:GA},57:{n:"PtgNameX",f:wA},58:{n:"PtgRef3d",f:iA},59:{n:"PtgArea3d",f:X_},60:{n:"PtgRefErr3d",f:SA},61:{n:"PtgAreaErr3d",f:Y_},255:{}},qA={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},YA={1:{n:"PtgElfLel",f:y3},2:{n:"PtgElfRw",f:MA},3:{n:"PtgElfCol",f:_A},6:{n:"PtgElfRwV",f:UA},7:{n:"PtgElfColV",f:DA},10:{n:"PtgElfRadical",f:PA},11:{n:"PtgElfRadicalS",f:IA},13:{n:"PtgElfColS",f:AA},15:{n:"PtgElfColSV",f:RA},16:{n:"PtgElfRadicalLel",f:OA},25:{n:"PtgList",f:BA},29:{n:"PtgSxName",f:zA},255:{}},WA={0:{n:"PtgAttrNoop",f:XA},1:{n:"PtgAttrSemi",f:aA},2:{n:"PtgAttrIf",f:Q_},4:{n:"PtgAttrChoose",f:J_},8:{n:"PtgAttrGoto",f:Z_},16:{n:"PtgAttrSum",f:dA},32:{n:"PtgAttrBaxcel",f:ey},33:{n:"PtgAttrBaxcel",f:ey},64:{n:"PtgAttrSpace",f:tA},65:{n:"PtgAttrSpaceSemi",f:rA},128:{n:"PtgAttrIfError",f:eA},255:{}};function Hc(e,a,t,r){if(r.biff<8)return Yt(e,a);for(var s=e.l+a,i=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=vA(e,0,r),i.push(t[o][1]);break;case"PtgMemArea":t[o][2]=yA(e,t[o][1],r),i.push(t[o][2]);break;case"PtgExp":r&&r.biff==12&&(t[o][1][1]=e.read_shift(4),i.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return a=s-e.l,a!==0&&i.push(Yt(e,a)),i}function Gc(e,a,t){for(var r=e.l+a,s,i,o=[];r!=e.l;)a=r-e.l,i=e[e.l],s=ay[i]||ay[qA[i]],(i===24||i===25)&&(s=(i===24?YA:WA)[e[e.l+1]]),!s||!s.f?Yt(e,a):o.push([s.n,s.f(e,a,t)]);return o}function KA(e){for(var a=[],t=0;t<e.length;++t){for(var r=e[t],s=[],i=0;i<r.length;++i){var o=r[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}a.push(s.join(","))}return a.join(";")}var JA={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ZA(e,a){if(!e&&!(a&&a.biff<=5&&a.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function v3(e,a,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[a]))return e.SheetNames[a];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[a];if(t.biff<8)return a>1e4&&(a-=65536),a<0&&(a=-a),a==0?"":e.XTI[a-1];if(!r)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[r[0]][0]){case 357:return s=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return s=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[r[0]][0][3]?(s=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function ty(e,a,t){var r=v3(e,a,t);return r=="#REF"?r:ZA(r,t)}function zt(e,a,t,r,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,m=0,x,h="";if(!e[0]||!e[0][0])return"";for(var g=-1,p="",v=0,w=e[0].length;v<w;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:p=Za(" ",e[0][g][1][1]);break;case 1:p=Za("\r",e[0][g][1][1]);break;default:if(p="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+p,g=-1}l.push(u+JA[b[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Vl(b[1][1],o,s),l.push(Hl(d,i));break;case"PtgRefN":d=t?Vl(b[1][1],t,s):b[1][1],l.push(Hl(d,i));break;case"PtgRef3d":f=b[1][1],d=Vl(b[1][2],o,s),h=ty(r,f,s),l.push(h+"!"+Hl(d,i));break;case"PtgFunc":case"PtgFuncVar":var y=b[1][0],j=b[1][1];y||(y=0),y&=127;var A=y==0?[]:l.slice(-y);l.length-=y,j==="User"&&(j=A.shift()),l.push(j+"("+A.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":x=A1(b[1][1],t?{s:t}:o,s),l.push(Cf(x,s));break;case"PtgArea":x=A1(b[1][1],o,s),l.push(Cf(x,s));break;case"PtgArea3d":f=b[1][1],x=b[1][2],h=ty(r,f,s),l.push(h+"!"+Cf(x,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=b[1][2];var E=(r.names||[])[m-1]||(r[0]||[])[m],F=E?E.Name:"SH33TJSNAME"+String(m);F&&F.slice(0,6)=="_xlfn."&&!s.xlfn&&(F=F.slice(6)),l.push(F);break;case"PtgNameX":var k=b[1][1];m=b[1][2];var P;if(s.biff<=5)k<0&&(k=-k),r[k]&&(P=r[k][m]);else{var R="";if(((r[k]||[])[0]||[])[0]==14849||(((r[k]||[])[0]||[])[0]==1025?r[k][m]&&r[k][m].itab>0&&(R=r.SheetNames[r[k][m].itab-1]+"!"):R=r.SheetNames[m-1]+"!"),r[k]&&r[k][m])R+=r[k][m].Name;else if(r[0]&&r[0][m])R+=r[0][m].Name;else{var _=(v3(r,k,s)||"").split(";;");_[m-1]?R=_[m-1]:R+="SH33TJSERRX"}l.push(R);break}P||(P={Name:"SH33TJSERRY"}),l.push(P.Name);break;case"PtgParen":var Q="(",C=")";if(g>=0){switch(p="",e[0][g][1][0]){case 2:Q=Za(" ",e[0][g][1][1])+Q;break;case 3:Q=Za("\r",e[0][g][1][1])+Q;break;case 4:C=Za(" ",e[0][g][1][1])+C;break;case 5:C=Za("\r",e[0][g][1][1])+C;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(Q+l.pop()+C);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var z={c:t.c,r:t.r};if(r.sharedf[Ye(d)]){var S=r.sharedf[Ye(d)];l.push(zt(S,o,z,r,s))}else{var D=!1;for(c=0;c!=r.arrayf.length;++c)if(u=r.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(zt(u[1],o,z,r,s)),D=!0;break}D||l.push(b[1])}break;case"PtgArray":l.push("{"+KA(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var H=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&H.indexOf(e[0][v][0])==-1){b=e[0][g];var U=!0;switch(b[1][0]){case 4:U=!1;case 0:p=Za(" ",b[1][1]);break;case 5:U=!1;case 1:p=Za("\r",b[1][1]);break;default:if(p="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((U?p:"")+l.pop()+(U?"":p)),g=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function QA(e,a,t){var r=e.l+a,s=t.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],Yt(e,a-2)];var l=Gc(e,o,t);return a!==o+s&&(i=Hc(e,a-o-s,l,t)),e.l=r,[l,i]}function eR(e,a,t){var r=e.l+a,s=t.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],Yt(e,a-2)];var l=Gc(e,o,t);return a!==o+s&&(i=Hc(e,a-o-s,l,t)),e.l=r,[l,i]}function aR(e,a,t,r){var s=e.l+a,i=Gc(e,r,t),o;return s!==e.l&&(o=Hc(e,s-e.l,i,t)),[i,o]}function tR(e,a,t){var r=e.l+a,s,i=e.read_shift(2),o=Gc(e,i,t);return i==65535?[[],Yt(e,a-2)]:(a!==i+2&&(s=Hc(e,r-i-2,o,t)),[o,s])}function rR(e){var a;if(Ps(e,e.l+6)!==65535)return[Vt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return a=e[e.l+2]===1,e.l+=8,[a,"b"];case 2:return a=e[e.l+2],e.l+=8,[a,"e"];case 3:return e.l+=8,["","s"]}return[]}function sR(e){if(e==null){var a=Ee(8);return a.write_shift(1,3),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,65535),a}else if(typeof e=="number")return gi(e);return gi(0)}function Rf(e,a,t){var r=e.l+a,s=ks(e);t.biff==2&&++e.l;var i=rR(e),o=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var l=eR(e,r-e.l,t);return{cell:s,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function nR(e,a,t,r,s){var i=vi(a,t,s),o=sR(e.v),l=Ee(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=Ee(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Nt([i,o,l,u]);return f}function ju(e,a,t){var r=e.read_shift(4),s=Gc(e,r,t),i=e.read_shift(4),o=i>0?Hc(e,i,s,t):null;return[s,o]}var iR=ju,Su=ju,oR=ju,lR=ju,cR={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},b3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dR={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ry(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(a,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function uR(e){var a="of:="+e.replace(np,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return a.replace(/;/g,"|").replace(/,/g,";")}function Df(e){var a=e.split(":"),t=a[0].split(".")[0];return[t,a[0].split(".")[1]+(a.length>1?":"+(a[1].split(".")[1]||a[1].split(".")[0]):"")]}function fR(e){return e.replace(/\./,"!")}var Xl={},To={},ql=typeof Map<"u";function lp(e,a,t){var r=0,s=e.length;if(t){if(ql?t.has(a):Object.prototype.hasOwnProperty.call(t,a)){for(var i=ql?t.get(a):t[a];r<i.length;++r)if(e[i[r]].t===a)return e.Count++,i[r]}}else for(;r<s;++r)if(e[r].t===a)return e.Count++,r;return e[s]={t:a},e.Count++,e.Unique++,t&&(ql?(t.has(a)||t.set(a,[]),t.get(a).push(s)):(Object.prototype.hasOwnProperty.call(t,a)||(t[a]=[]),t[a].push(s))),s}function Cu(e,a){var t={min:e+1,max:e+1},r=-1;return a.MDW&&($t=a.MDW),a.width!=null?t.customWidth=1:a.wpx!=null?r=yc(a.wpx):a.wch!=null&&(r=a.wch),r>-1?(t.width=X0(r),t.customWidth=1):a.width!=null&&(t.width=a.width),a.hidden&&(t.hidden=!0),a.level!=null&&(t.outlineLevel=t.level=a.level),t}function oi(e,a){if(e){var t=[.7,.7,.75,.75,.3,.3];a=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Un(e,a,t){var r=t.revssf[a.z!=null?a.z:"General"],s=60,i=e.length;if(r==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){Us(a.z,s),t.ssf[s]=a.z,t.revssf[a.z]=r=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===r)return s;return e[i]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function w3(e,a,t,r,s,i){try{r.cellNF&&(e.z=qe[a])}catch(l){if(r.WTF)throw l}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=La(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(qe[a]==null&&Us(cT[a]||"General",a),e.t==="e")e.w=e.w||Ws[e.v];else if(a===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=uc(e.v);else if(e.t==="d"){var o=bt(e.v);(o|0)===o?e.w=o.toString(10):e.w=uc(o)}else{if(e.v===void 0)return"";e.w=hi(e.v,To)}else e.t==="d"?e.w=Xr(a,bt(e.v),To):e.w=Xr(a,e.v,To)}catch(l){if(r.WTF)throw l}if(r.cellStyles&&t!=null)try{e.s=i.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=G0(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=G0(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(r.WTF&&i.Fills)throw l}}}function mR(e,a,t){if(e&&e["!ref"]){var r=pa(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function xR(e,a){var t=pa(a);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=ra(t))}var hR=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pR=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,gR=/<(?:\w:)?hyperlink [^>]*>/mg,yR=/"(\w*:\w*)"/,vR=/<(?:\w:)?col\b[^>]*[\/]?>/g,bR=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wR=/<(?:\w:)?pageMargins[^>]*\/>/g,E3=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ER=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,kR=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function NR(e,a,t,r,s,i,o){if(!e)return e;r||(r={"!id":{}});var l=a.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(pR);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var m=u.match(E3);m?cp(m[0],l,s,t):(m=u.match(ER))&&SR(m[0],m[1]||"",l,s,t);var x=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var h=u.slice(x,x+50).match(yR);h&&xR(l,h[1])}var g=u.match(kR);g&&g[1]&&LR(g[1],s);var p=[];if(a.cellStyles){var v=u.match(vR);v&&PR(p,v)}f&&$R(f[1],l,a,c,i,o);var w=d.match(bR);w&&(l["!autofilter"]=IR(w[0]));var b=[],y=d.match(hR);if(y)for(x=0;x!=y.length;++x)b[x]=pa(y[x].slice(y[x].indexOf('"')+1));var j=d.match(gR);j&&AR(l,j,r);var A=d.match(wR);if(A&&(l["!margins"]=RR(Ke(A[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=ra(c)),a.sheetRows>0&&l["!ref"]){var E=pa(l["!ref"]);a.sheetRows<=+E.e.r&&(E.e.r=a.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ra(E))}return p.length>0&&(l["!cols"]=p),b.length>0&&(l["!merges"]=b),l}function jR(e){if(e.length===0)return"";for(var a='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)a+='<mergeCell ref="'+ra(e[t])+'"/>';return a+"</mergeCells>"}function cp(e,a,t,r){var s=Ke(e);t.Sheets[r]||(t.Sheets[r]={}),s.codeName&&(t.Sheets[r].CodeName=ha(Ra(s.codeName)))}function SR(e,a,t,r,s){cp(e.slice(0,e.indexOf(">")),t,r,s)}function CR(e,a,t,r,s){var i=!1,o={},l=null;if(r.bookType!=="xlsx"&&a.vbaraw){var c=a.SheetNames[t];try{a.Workbook&&(c=a.Workbook.Sheets[t].CodeName||c)}catch{}i=!0,o.codeName=ms(Fa(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+Pe("outlinePr",null,u)}!i&&!l||(s[s.length]=Pe("sheetPr",l,o))}var TR=["objects","scenarios","selectLockedCells","selectUnlockedCells"],FR=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _R(e){var a={sheet:1};return TR.forEach(function(t){e[t]!=null&&e[t]&&(a[t]="1")}),FR.forEach(function(t){e[t]!=null&&!e[t]&&(a[t]="0")}),e.password&&(a.password=tp(e.password).toString(16).toUpperCase()),Pe("sheetProtection",null,a)}function AR(e,a,t){for(var r=Array.isArray(e),s=0;s!=a.length;++s){var i=Ke(Ra(a[s]),!0);if(!i.ref)return;var o=((t||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+ha(i.location))):(i.Target="#"+ha(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=pa(i.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Ye({c:u,r:c});r?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function RR(e){var a={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(a[t]=parseFloat(e[t]))}),a}function DR(e){return oi(e),Pe("pageMargins",null,e)}function PR(e,a){for(var t=!1,r=0;r!=a.length;++r){var s=Ke(a[r],!0);s.hidden&&(s.hidden=Ua(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,rp(s.width)),Fn(s);i<=o;)e[i++]=Ba(s)}}function OR(e,a){for(var t=["<cols>"],r,s=0;s!=a.length;++s)(r=a[s])&&(t[t.length]=Pe("col",null,Cu(s,r)));return t[t.length]="</cols>",t.join("")}function IR(e){var a={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return a}function MR(e,a,t,r){var s=typeof e.ref=="string"?e.ref:ra(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,o=fr(s);o.s.r==o.e.r&&(o.e.r=fr(a["!ref"]).e.r,s=ra(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+t.SheetNames[r]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),Pe("autoFilter",null,{ref:s})}var UR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function LR(e,a){a.Views||(a.Views=[{}]),(e.match(UR)||[]).forEach(function(t,r){var s=Ke(t);a.Views[r]||(a.Views[r]={}),+s.zoomScale&&(a.Views[r].zoom=+s.zoomScale),Ua(s.rightToLeft)&&(a.Views[r].RTL=!0)})}function BR(e,a,t,r){var s={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Pe("sheetViews",Pe("sheetView",null,s),{})}function zR(e,a,t,r){if(e.c&&t["!comments"].push([a,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Ws[e.v];break;case"d":r&&r.cellDates?s=La(e.v,-1).toISOString():(e=Ba(e),e.t="n",s=""+(e.v=bt(La(e.v)))),typeof e.z>"u"&&(e.z=qe[14]);break;default:s=e.v;break}var l=Dt("v",Fa(s)),c={r:a},u=Un(r.cellXfs,e,r);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){l=Dt("v",""+lp(r.Strings,e.v,r.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,a.length)==a?{t:"array",ref:e.F}:null;l=Pe("f",Fa(e.f),d)+(e.v!=null?l:"")}return e.l&&t["!links"].push([a,e.l]),e.D&&(c.cm=1),Pe("c",l,c)}var $R=function(){var e=/<(?:\w+:)?c[ \/>]/,a=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=fc("v"),o=fc("f");return function(c,u,d,f,m,x){for(var h=0,g="",p=[],v=[],w=0,b=0,y=0,j="",A,E,F=0,k=0,P,R,_=0,Q=0,C=Array.isArray(x.CellXf),z,S=[],D=[],H=Array.isArray(u),U=[],B={},X=!1,T=!!d.sheetStubs,L=c.split(a),V=0,O=L.length;V!=O;++V){g=L[V].trim();var de=g.length;if(de!==0){var me=0;e:for(h=0;h<de;++h)switch(g[h]){case">":if(g[h-1]!="/"){++h;break e}if(d&&d.cellStyles){if(E=Ke(g.slice(me,h),!0),F=E.r!=null?parseInt(E.r,10):F+1,k=-1,d.sheetRows&&d.sheetRows<F)continue;B={},X=!1,E.ht&&(X=!0,B.hpt=parseFloat(E.ht),B.hpx=Vo(B.hpt)),E.hidden=="1"&&(X=!0,B.hidden=!0),E.outlineLevel!=null&&(X=!0,B.level=+E.outlineLevel),X&&(U[F-1]=B)}break;case"<":me=h;break}if(me>=h)break;if(E=Ke(g.slice(me,h),!0),F=E.r!=null?parseInt(E.r,10):F+1,k=-1,!(d.sheetRows&&d.sheetRows<F)){f.s.r>F-1&&(f.s.r=F-1),f.e.r<F-1&&(f.e.r=F-1),d&&d.cellStyles&&(B={},X=!1,E.ht&&(X=!0,B.hpt=parseFloat(E.ht),B.hpx=Vo(B.hpt)),E.hidden=="1"&&(X=!0,B.hidden=!0),E.outlineLevel!=null&&(X=!0,B.level=+E.outlineLevel),X&&(U[F-1]=B)),p=g.slice(h).split(e);for(var ae=0;ae!=p.length&&p[ae].trim().charAt(0)=="<";++ae);for(p=p.slice(ae),h=0;h!=p.length;++h)if(g=p[h].trim(),g.length!==0){if(v=g.match(t),w=h,b=0,y=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(w=0,j=v[1],b=0;b!=j.length&&!((y=j.charCodeAt(b)-64)<1||y>26);++b)w=26*w+y;--w,k=w}else++k;for(b=0;b!=g.length&&g.charCodeAt(b)!==62;++b);if(++b,E=Ke(g.slice(0,b),!0),E.r||(E.r=Ye({r:F-1,c:k})),j=g.slice(b),A={t:""},(v=j.match(i))!=null&&v[1]!==""&&(A.v=ha(v[1])),d.cellFormula){if((v=j.match(o))!=null&&v[1]!==""){if(A.f=ha(Ra(v[1])).replace(/\r\n/g,`
`),d.xlfn||(A.f=Q1(A.f)),v[0].indexOf('t="array"')>-1)A.F=(j.match(s)||[])[1],A.F.indexOf(":")>-1&&S.push([pa(A.F),A.F]);else if(v[0].indexOf('t="shared"')>-1){R=Ke(v[0]);var ce=ha(Ra(v[1]));d.xlfn||(ce=Q1(ce)),D[parseInt(R.si,10)]=[R,ce,E.r]}}else(v=j.match(/<f[^>]*\/>/))&&(R=Ke(v[0]),D[R.si]&&(A.f=U_(D[R.si][1],D[R.si][2],E.r)));var W=Ka(E.r);for(b=0;b<S.length;++b)W.r>=S[b][0].s.r&&W.r<=S[b][0].e.r&&W.c>=S[b][0].s.c&&W.c<=S[b][0].e.c&&(A.F=S[b][1])}if(E.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(T)A.t="z";else continue;else A.t=E.t||"n";switch(f.s.c>k&&(f.s.c=k),f.e.c<k&&(f.e.c=k),A.t){case"n":if(A.v==""||A.v==null){if(!T)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v>"u"){if(!T)continue;A.t="z"}else P=Xl[parseInt(A.v,10)],A.v=P.t,A.r=P.r,d.cellHTML&&(A.h=P.h);break;case"str":A.t="s",A.v=A.v!=null?Ra(A.v):"",d.cellHTML&&(A.h=zh(A.v));break;case"inlineStr":v=j.match(r),A.t="s",v!=null&&(P=ap(v[1]))?(A.v=P.t,d.cellHTML&&(A.h=P.h)):A.v="";break;case"b":A.v=Ua(A.v);break;case"d":d.cellDates?A.v=La(A.v,1):(A.v=bt(La(A.v,1)),A.t="n");break;case"e":(!d||d.cellText!==!1)&&(A.w=A.v),A.v=NE[A.v];break}if(_=Q=0,z=null,C&&E.s!==void 0&&(z=x.CellXf[E.s],z!=null&&(z.numFmtId!=null&&(_=z.numFmtId),d.cellStyles&&z.fillId!=null&&(Q=z.fillId))),w3(A,_,Q,d,m,x),d.cellDates&&C&&A.t=="n"&&Zo(qe[_])&&(A.t="d",A.v=ku(A.v)),E.cm&&d.xlmeta){var le=(d.xlmeta.Cell||[])[+E.cm-1];le&&le.type=="XLDAPR"&&(A.D=!0)}if(H){var I=Ka(E.r);u[I.r]||(u[I.r]=[]),u[I.r][I.c]=A}else u[E.r]=A}}}}U.length>0&&(u["!rows"]=U)}}();function VR(e,a,t,r){var s=[],i=[],o=pa(e["!ref"]),l="",c,u="",d=[],f=0,m=0,x=e["!rows"],h=Array.isArray(e),g={r:u},p,v=-1;for(m=o.s.c;m<=o.e.c;++m)d[m]=Wa(m);for(f=o.s.r;f<=o.e.r;++f){for(i=[],u=nt(f),m=o.s.c;m<=o.e.c;++m){c=d[m]+u;var w=h?(e[f]||[])[m]:e[c];w!==void 0&&(l=zR(w,c,e,a))!=null&&i.push(l)}(i.length>0||x&&x[f])&&(g={r:u},x&&x[f]&&(p=x[f],p.hidden&&(g.hidden=1),v=-1,p.hpx?v=vc(p.hpx):p.hpt&&(v=p.hpt),v>-1&&(g.ht=v,g.customHeight=1),p.level&&(g.outlineLevel=p.level)),s[s.length]=Pe("row",i.join(""),g))}if(x)for(;f<x.length;++f)x&&x[f]&&(g={r:f+1},p=x[f],p.hidden&&(g.hidden=1),v=-1,p.hpx?v=vc(p.hpx):p.hpt&&(v=p.hpt),v>-1&&(g.ht=v,g.customHeight=1),p.level&&(g.outlineLevel=p.level),s[s.length]=Pe("row","",g));return s.join("")}function k3(e,a,t,r){var s=[ot,Pe("worksheet",null,{xmlns:Ci[0],"xmlns:r":pt.r})],i=t.SheetNames[e],o=0,l="",c=t.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=pa(u);if(d.e.c>16383||d.e.r>1048575){if(a.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=ra(d)}r||(r={}),c["!comments"]=[];var f=[];CR(c,t,e,a,s),s[s.length]=Pe("dimension",null,{ref:u}),s[s.length]=BR(c,a,e,t),a.sheetFormat&&(s[s.length]=Pe("sheetFormatPr",null,{defaultRowHeight:a.sheetFormat.defaultRowHeight||"16",baseColWidth:a.sheetFormat.baseColWidth||"10",outlineLevelRow:a.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=OR(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=VR(c,a),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=_R(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=MR(c["!autofilter"],c,t,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=jR(c["!merges"]));var m=-1,x,h=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(x={ref:g[0]},g[1].Target.charAt(0)!="#"&&(h=Sa(r,-1,Fa(g[1].Target).replace(/#.*$/,""),da.HLINK),x["r:id"]="rId"+h),(m=g[1].Target.indexOf("#"))>-1&&(x.location=Fa(g[1].Target.slice(m+1))),g[1].Tooltip&&(x.tooltip=Fa(g[1].Tooltip)),s[s.length]=Pe("hyperlink",null,x))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=DR(c["!margins"])),(!a||a.ignoreEC||a.ignoreEC==null)&&(s[s.length]=Dt("ignoredErrors",Pe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(h=Sa(r,-1,"../drawings/drawing"+(e+1)+".xml",da.DRAW),s[s.length]=Pe("drawing",null,{"r:id":"rId"+h}),c["!drawing"]=f),c["!comments"].length>0&&(h=Sa(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",da.VML),s[s.length]=Pe("legacyDrawing",null,{"r:id":"rId"+h}),c["!legacy"]=h),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function HR(e,a){var t={},r=e.l+a;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=r,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=s/20),t}function GR(e,a,t){var r=Ee(145),s=(t["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var i=320;s.hpx?i=vc(s.hpx)*20:s.hpt&&(i=s.hpt*20),r.write_shift(2,i),r.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var l=0,c=r.l;r.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(a.s.c>d+1<<10||a.e.c<d<<10)){for(var f=-1,m=-1,x=d<<10;x<d+1<<10;++x){u.c=x;var h=Array.isArray(t)?(t[u.r]||[])[u.c]:t[Ye(u)];h&&(f<0&&(f=x),m=x)}f<0||(++l,r.write_shift(4,f),r.write_shift(4,m))}var g=r.l;return r.l=c,r.write_shift(4,l),r.l=g,r.length>r.l?r.slice(0,r.l):r}function XR(e,a,t,r){var s=GR(r,t,a);(s.length>17||(a["!rows"]||[])[r])&&Te(e,0,s)}var qR=Ai,YR=al;function WR(){}function KR(e,a){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=QT(e),t}function JR(e,a,t){t==null&&(t=Ee(84+4*e.length));var r=192;a&&(a.above&&(r&=-65),a.left&&(r&=-129)),t.write_shift(1,r);for(var s=1;s<3;++s)t.write_shift(1,0);return $0({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),vE(e,t),t.slice(0,t.l)}function ZR(e){var a=Yr(e);return[a]}function QR(e,a,t){return t==null&&(t=Ee(8)),Ti(a,t)}function e7(e){var a=Fi(e);return[a]}function a7(e,a,t){return t==null&&(t=Ee(4)),_i(a,t)}function t7(e){var a=Yr(e),t=e.read_shift(1);return[a,t,"b"]}function r7(e,a,t){return t==null&&(t=Ee(9)),Ti(a,t),t.write_shift(1,e.v?1:0),t}function s7(e){var a=Fi(e),t=e.read_shift(1);return[a,t,"b"]}function n7(e,a,t){return t==null&&(t=Ee(5)),_i(a,t),t.write_shift(1,e.v?1:0),t}function i7(e){var a=Yr(e),t=e.read_shift(1);return[a,t,"e"]}function o7(e,a,t){return t==null&&(t=Ee(9)),Ti(a,t),t.write_shift(1,e.v),t}function l7(e){var a=Fi(e),t=e.read_shift(1);return[a,t,"e"]}function c7(e,a,t){return t==null&&(t=Ee(8)),_i(a,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function d7(e){var a=Yr(e),t=e.read_shift(4);return[a,t,"s"]}function u7(e,a,t){return t==null&&(t=Ee(12)),Ti(a,t),t.write_shift(4,a.v),t}function f7(e){var a=Fi(e),t=e.read_shift(4);return[a,t,"s"]}function m7(e,a,t){return t==null&&(t=Ee(8)),_i(a,t),t.write_shift(4,a.v),t}function x7(e){var a=Yr(e),t=Vt(e);return[a,t,"n"]}function h7(e,a,t){return t==null&&(t=Ee(16)),Ti(a,t),gi(e.v,t),t}function N3(e){var a=Fi(e),t=Vt(e);return[a,t,"n"]}function p7(e,a,t){return t==null&&(t=Ee(12)),_i(a,t),gi(e.v,t),t}function g7(e){var a=Yr(e),t=Kh(e);return[a,t,"n"]}function y7(e,a,t){return t==null&&(t=Ee(12)),Ti(a,t),bE(e.v,t),t}function v7(e){var a=Fi(e),t=Kh(e);return[a,t,"n"]}function b7(e,a,t){return t==null&&(t=Ee(8)),_i(a,t),bE(e.v,t),t}function w7(e){var a=Yr(e),t=qh(e);return[a,t,"is"]}function E7(e){var a=Yr(e),t=qt(e);return[a,t,"str"]}function k7(e,a,t){return t==null&&(t=Ee(12+4*e.v.length)),Ti(a,t),St(e.v,t),t.length>t.l?t.slice(0,t.l):t}function N7(e){var a=Fi(e),t=qt(e);return[a,t,"str"]}function j7(e,a,t){return t==null&&(t=Ee(8+4*e.v.length)),_i(a,t),St(e.v,t),t.length>t.l?t.slice(0,t.l):t}function S7(e,a,t){var r=e.l+a,s=Yr(e);s.r=t["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(t.cellFormula){e.l+=2;var l=Su(e,r-e.l,t);o[3]=zt(l,null,s,t.supbooks,t)}else e.l=r;return o}function C7(e,a,t){var r=e.l+a,s=Yr(e);s.r=t["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(t.cellFormula){e.l+=2;var l=Su(e,r-e.l,t);o[3]=zt(l,null,s,t.supbooks,t)}else e.l=r;return o}function T7(e,a,t){var r=e.l+a,s=Yr(e);s.r=t["!row"];var i=Vt(e),o=[s,i,"n"];if(t.cellFormula){e.l+=2;var l=Su(e,r-e.l,t);o[3]=zt(l,null,s,t.supbooks,t)}else e.l=r;return o}function F7(e,a,t){var r=e.l+a,s=Yr(e);s.r=t["!row"];var i=qt(e),o=[s,i,"str"];if(t.cellFormula){e.l+=2;var l=Su(e,r-e.l,t);o[3]=zt(l,null,s,t.supbooks,t)}else e.l=r;return o}var _7=Ai,A7=al;function R7(e,a){return a==null&&(a=Ee(4)),a.write_shift(4,e),a}function D7(e,a){var t=e.l+a,r=Ai(e),s=Yh(e),i=qt(e),o=qt(e),l=qt(e);e.l=t;var c={rfx:r,relId:s,loc:i,display:l};return o&&(c.Tooltip=o),c}function P7(e,a){var t=Ee(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));al({s:Ka(e[0]),e:Ka(e[0])},t),Wh("rId"+a,t);var r=e[1].Target.indexOf("#"),s=r==-1?"":e[1].Target.slice(r+1);return St(s||"",t),St(e[1].Tooltip||"",t),St("",t),t.slice(0,t.l)}function O7(){}function I7(e,a,t){var r=e.l+a,s=wE(e),i=e.read_shift(1),o=[s];if(o[2]=i,t.cellFormula){var l=iR(e,r-e.l,t);o[1]=l}else e.l=r;return o}function M7(e,a,t){var r=e.l+a,s=Ai(e),i=[s];if(t.cellFormula){var o=lR(e,r-e.l,t);i[1]=o,e.l=r}else e.l=r;return i}function U7(e,a,t){t==null&&(t=Ee(18));var r=Cu(e,a);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var s=0;return a.hidden&&(s|=1),typeof r.width=="number"&&(s|=2),a.level&&(s|=a.level<<8),t.write_shift(2,s),t}var j3=["left","right","top","bottom","header","footer"];function L7(e){var a={};return j3.forEach(function(t){a[t]=Vt(e)}),a}function B7(e,a){return a==null&&(a=Ee(6*8)),oi(e),j3.forEach(function(t){gi(e[t],a)}),a}function z7(e){var a=e.read_shift(2);return e.l+=28,{RTL:a&32}}function $7(e,a,t){t==null&&(t=Ee(30));var r=924;return(((a||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function V7(e){var a=Ee(24);return a.write_shift(4,4),a.write_shift(4,1),al(e,a),a}function H7(e,a){return a==null&&(a=Ee(16*4+2)),a.write_shift(2,e.password?tp(e.password):0),a.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?a.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):a.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),a}function G7(){}function X7(){}function q7(e,a,t,r,s,i,o){if(!e)return e;var l=a||{};r||(r={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,m=!1,x,h,g,p,v,w,b,y,j,A=[];l.biff=12,l["!row"]=0;var E=0,F=!1,k=[],P={},R=l.supbooks||s.supbooks||[[]];if(R.sharedf=P,R.arrayf=k,R.SheetNames=s.SheetNames||s.Sheets.map(function(H){return H.name}),!l.supbooks&&(l.supbooks=R,s.Names))for(var _=0;_<s.Names.length;++_)R[0][_+1]=s.Names[_];var Q=[],C=[],z=!1;bc[16]={n:"BrtShortReal",f:N3};var S;if(Ys(e,function(U,B,X){if(!m)switch(X){case 148:u=U;break;case 0:x=U,l.sheetRows&&l.sheetRows<=x.r&&(m=!0),y=nt(p=x.r),l["!row"]=x.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=Vo(U.hpt)),C[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(h={t:U[2]},U[2]){case"n":h.v=U[1];break;case"s":b=Xl[U[1]],h.v=b.t,h.r=b.r;break;case"b":h.v=!!U[1];break;case"e":h.v=U[1],l.cellText!==!1&&(h.w=Ws[h.v]);break;case"str":h.t="s",h.v=U[1];break;case"is":h.t="s",h.v=U[1].t;break}if((g=o.CellXf[U[0].iStyleRef])&&w3(h,g.numFmtId,null,l,i,o),v=U[0].c==-1?v+1:U[0].c,l.dense?(c[p]||(c[p]=[]),c[p][v]=h):c[Wa(v)+y]=h,l.cellFormula){for(F=!1,E=0;E<k.length;++E){var T=k[E];x.r>=T[0].s.r&&x.r<=T[0].e.r&&v>=T[0].s.c&&v<=T[0].e.c&&(h.F=ra(T[0]),F=!0)}!F&&U.length>3&&(h.f=U[3])}if(d.s.r>x.r&&(d.s.r=x.r),d.s.c>v&&(d.s.c=v),d.e.r<x.r&&(d.e.r=x.r),d.e.c<v&&(d.e.c=v),l.cellDates&&g&&h.t=="n"&&Zo(qe[g.numFmtId])){var L=Yn(h.v);L&&(h.t="d",h.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}S&&(S.type=="XLDAPR"&&(h.D=!0),S=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;h={t:"z",v:void 0},v=U[0].c==-1?v+1:U[0].c,l.dense?(c[p]||(c[p]=[]),c[p][v]=h):c[Wa(v)+y]=h,d.s.r>x.r&&(d.s.r=x.r),d.s.c>v&&(d.s.c=v),d.e.r<x.r&&(d.e.r=x.r),d.e.c<v&&(d.e.c=v),S&&(S.type=="XLDAPR"&&(h.D=!0),S=void 0);break;case 176:A.push(U);break;case 49:S=((l.xlmeta||{}).Cell||[])[U-1];break;case 494:var V=r["!id"][U.relId];for(V?(U.Target=V.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=V):U.relId==""&&(U.Target="#"+U.loc),p=U.rfx.s.r;p<=U.rfx.e.r;++p)for(v=U.rfx.s.c;v<=U.rfx.e.c;++v)l.dense?(c[p]||(c[p]=[]),c[p][v]||(c[p][v]={t:"z",v:void 0}),c[p][v].l=U):(w=Ye({c:v,r:p}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=U);break;case 426:if(!l.cellFormula)break;k.push(U),j=l.dense?c[p][v]:c[Wa(v)+y],j.f=zt(U[1],d,{r:x.r,c:v},R,l),j.F=ra(U[0]);break;case 427:if(!l.cellFormula)break;P[Ye(U[0].s)]=U[1],j=l.dense?c[p][v]:c[Wa(v)+y],j.f=zt(U[1],d,{r:x.r,c:v},R,l);break;case 60:if(!l.cellStyles)break;for(;U.e>=U.s;)Q[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},z||(z=!0,rp(U.w/256)),Fn(Q[U.e+1]);break;case 161:c["!autofilter"]={ref:ra(U)};break;case 476:c["!margins"]=U;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),U.name&&(s.Sheets[t].CodeName=U.name),(U.above||U.left)&&(c["!outline"]={above:U.above,left:U.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),U.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!B.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+X.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=ra(u||d)),l.sheetRows&&c["!ref"]){var D=pa(c["!ref"]);l.sheetRows<=+D.e.r&&(D.e.r=l.sheetRows-1,D.e.r>d.e.r&&(D.e.r=d.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>d.e.c&&(D.e.c=d.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),c["!fullref"]=c["!ref"],c["!ref"]=ra(D))}return A.length>0&&(c["!merges"]=A),Q.length>0&&(c["!cols"]=Q),C.length>0&&(c["!rows"]=C),c}function Y7(e,a,t,r,s,i,o){if(a.v===void 0)return!1;var l="";switch(a.t){case"b":l=a.v?"1":"0";break;case"d":a=Ba(a),a.z=a.z||qe[14],a.v=bt(La(a.v)),a.t="n";break;case"n":case"e":l=""+a.v;break;default:l=a.v;break}var c={r:t,c:r};switch(c.s=Un(s.cellXfs,a,s),a.l&&i["!links"].push([Ye(c),a.l]),a.c&&i["!comments"].push([Ye(c),a.c]),a.t){case"s":case"str":return s.bookSST?(l=lp(s.Strings,a.v,s.revStrings),c.t="s",c.v=l,o?Te(e,18,m7(a,c)):Te(e,7,u7(a,c))):(c.t="str",o?Te(e,17,j7(a,c)):Te(e,6,k7(a,c))),!0;case"n":return a.v==(a.v|0)&&a.v>-1e3&&a.v<1e3?o?Te(e,13,b7(a,c)):Te(e,2,y7(a,c)):o?Te(e,16,p7(a,c)):Te(e,5,h7(a,c)),!0;case"b":return c.t="b",o?Te(e,15,n7(a,c)):Te(e,4,r7(a,c)),!0;case"e":return c.t="e",o?Te(e,14,c7(a,c)):Te(e,3,o7(a,c)),!0}return o?Te(e,12,a7(a,c)):Te(e,1,QR(a,c)),!0}function W7(e,a,t,r){var s=pa(a["!ref"]||"A1"),i,o="",l=[];Te(e,145);var c=Array.isArray(a),u=s.e.r;a["!rows"]&&(u=Math.max(s.e.r,a["!rows"].length-1));for(var d=s.s.r;d<=u;++d){o=nt(d),XR(e,a,s,d);var f=!1;if(d<=s.e.r)for(var m=s.s.c;m<=s.e.c;++m){d===s.s.r&&(l[m]=Wa(m)),i=l[m]+o;var x=c?(a[d]||[])[m]:a[i];if(!x){f=!1;continue}f=Y7(e,x,d,m,r,a,f)}}Te(e,146)}function K7(e,a){!a||!a["!merges"]||(Te(e,177,R7(a["!merges"].length)),a["!merges"].forEach(function(t){Te(e,176,A7(t))}),Te(e,178))}function J7(e,a){!a||!a["!cols"]||(Te(e,390),a["!cols"].forEach(function(t,r){t&&Te(e,60,U7(r,t))}),Te(e,391))}function Z7(e,a){!a||!a["!ref"]||(Te(e,648),Te(e,649,V7(pa(a["!ref"]))),Te(e,650))}function Q7(e,a,t){a["!links"].forEach(function(r){if(r[1].Target){var s=Sa(t,-1,r[1].Target.replace(/#.*$/,""),da.HLINK);Te(e,494,P7(r,s))}}),delete a["!links"]}function eD(e,a,t,r){if(a["!comments"].length>0){var s=Sa(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",da.VML);Te(e,551,Wh("rId"+s)),a["!legacy"]=s}}function aD(e,a,t,r){if(a["!autofilter"]){var s=a["!autofilter"],i=typeof s.ref=="string"?s.ref:ra(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,l=fr(i);l.s.r==l.e.r&&(l.e.r=fr(a["!ref"]).e.r,i=ra(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+t.SheetNames[r]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),Te(e,161,al(pa(i))),Te(e,162)}}function tD(e,a,t){Te(e,133),Te(e,137,$7(a,t)),Te(e,138),Te(e,134)}function rD(e,a){a["!protect"]&&Te(e,535,H7(a["!protect"]))}function sD(e,a,t,r){var s=lr(),i=t.SheetNames[e],o=t.Sheets[i]||{},l=i;try{t&&t.Workbook&&(l=t.Workbook.Sheets[e].CodeName||l)}catch{}var c=pa(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(a.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Te(s,129),(t.vbaraw||o["!outline"])&&Te(s,147,JR(l,o["!outline"])),Te(s,148,YR(c)),tD(s,o,t.Workbook),J7(s,o),W7(s,o,e,a),rD(s,o),aD(s,o,t,e),K7(s,o),Q7(s,o,r),o["!margins"]&&Te(s,476,B7(o["!margins"])),(!a||a.ignoreEC||a.ignoreEC==null)&&Z7(s,o),eD(s,o,e,r),Te(s,130),s.end()}function nD(e){var a=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(a[+o[1]]=t?+o[2]:o[2])});var s=ha((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){r=i.replace(/<.*?>/g,"")}),[a,s,r]}function iD(e,a,t,r,s,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var m=nD(f);d.s.r=d.s.c=0,d.e.c=l,u=Wa(l),m[0].forEach(function(x,h){o[u+nt(h)]={t:"n",v:x,z:m[1]},c=h}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=ra(d)),o}function oD(e,a,t,r,s){if(!e)return e;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(E3);return l&&cp(l[0],i,s,t),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}function lD(e,a){e.l+=10;var t=qt(e);return{name:t}}function cD(e,a,t,r,s){if(!e)return e;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ys(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),c.name&&(s.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},a),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}var dp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],dD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uD=[],fD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function sy(e,a){for(var t=0;t!=e.length;++t)for(var r=e[t],s=0;s!=a.length;++s){var i=a[s];if(r[i[0]]==null)r[i[0]]=i[1];else switch(i[2]){case"bool":typeof r[i[0]]=="string"&&(r[i[0]]=Ua(r[i[0]]));break;case"int":typeof r[i[0]]=="string"&&(r[i[0]]=parseInt(r[i[0]],10));break}}}function ny(e,a){for(var t=0;t!=a.length;++t){var r=a[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=Ua(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function S3(e){ny(e.WBProps,dp),ny(e.CalcPr,fD),sy(e.WBView,dD),sy(e.Sheets,uD),To.date1904=Ua(e.WBProps.date1904)}function mD(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ua(e.Workbook.WBProps.date1904)?"true":"false"}var xD="][*?/\\".split("");function C3(e,a){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return xD.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function hD(e,a,t){e.forEach(function(r,s){C3(r);for(var i=0;i<s;++i)if(r==e[i])throw new Error("Duplicate Sheet Name: "+r);if(t){var o=a&&a[s]&&a[s].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function pD(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var a=e.Workbook&&e.Workbook.Sheets||[];hD(e.SheetNames,a,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)mR(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var gD=/<\w+:workbook/;function yD(e,a){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,s="xmlns",i={},o=0;if(e.replace(Wt,function(c,u){var d=Ke(c);switch(Es(d[0])){case"<?xml":break;case"<workbook":c.match(gD)&&(s="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],t.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":dp.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":t.WBProps[f[0]]=Ua(d[f[0]]);break;case"int":t.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:t.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(t.WBProps.CodeName=Ra(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],t.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=ha(Ra(d.name)),delete d[0],t.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":i={},i.Name=Ra(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),Ua(d.hidden||"0")&&(i.Hidden=!0),o=u+c.length;break;case"</definedName>":i.Ref=ha(Ra(e.slice(o,u))),t.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],t.CalcPr=d;break;case"<calcPr/>":delete d[0],t.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&a.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Ci.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return S3(t),t}function T3(e){var a=[ot];a[a.length]=Pe("workbook",null,{xmlns:Ci[0],"xmlns:r":pt.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(dp.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(r[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),a[a.length]=Pe("workbookPr",null,r);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(a[a.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),a[a.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',a[a.length]="</bookViews>"}for(a[a.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Fa(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}a[a.length]=Pe("sheet",null,o)}return a[a.length]="</sheets>",t&&(a[a.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(a[a.length]=Pe("definedName",Fa(l.Ref),c))}),a[a.length]="</definedNames>"),a.length>2&&(a[a.length]="</workbook>",a[1]=a[1].replace("/>",">")),a.join("")}function vD(e,a){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=nx(e),t.name=qt(e),t}function bD(e,a){return a||(a=Ee(127)),a.write_shift(4,e.Hidden),a.write_shift(4,e.iTabID),Wh(e.strRelID,a),St(e.name.slice(0,31),a),a.length>a.l?a.slice(0,a.l):a}function wD(e,a){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=a>8?qt(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function ED(e,a){a||(a=Ee(72));var t=0;return e&&e.filterPrivacy&&(t|=8),a.write_shift(4,t),a.write_shift(4,0),vE(e&&e.CodeName||"ThisWorkbook",a),a.slice(0,a.l)}function kD(e,a){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=a-8,t}function ND(e,a,t){var r=e.l+a;e.l+=4,e.l+=1;var s=e.read_shift(4),i=e5(e),o=oR(e,0,t),l=Yh(e);e.l=r;var c={Name:i,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function jD(e,a){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],s=!1;a||(a={}),a.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],bc[16]={n:"BrtFRTArchID$",f:kD},Ys(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(a.SID=c.Sheet),c.Ref=zt(c.Ptg,null,null,o,a),delete a.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(d),s=!0;break;case 36:r.pop(),s=!1;break;case 37:r.push(d),s=!0;break;case 38:r.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||a.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},a),S3(t),t.Names=i,t.supbooks=o,t}function SD(e,a){Te(e,143);for(var t=0;t!=a.SheetNames.length;++t){var r=a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t]&&a.Workbook.Sheets[t].Hidden||0,s={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:a.SheetNames[t]};Te(e,156,bD(s))}Te(e,144)}function CD(e,a){a||(a=Ee(127));for(var t=0;t!=4;++t)a.write_shift(4,0);return St("SheetJS",a),St(O0.version,a),St(O0.version,a),St("7262",a),a.length>a.l?a.slice(0,a.l):a}function TD(e,a){a||(a=Ee(29)),a.write_shift(-4,0),a.write_shift(-4,460),a.write_shift(4,28800),a.write_shift(4,17600),a.write_shift(4,500),a.write_shift(4,e),a.write_shift(4,e);var t=120;return a.write_shift(1,t),a.length>a.l?a.slice(0,a.l):a}function FD(e,a){if(!(!a.Workbook||!a.Workbook.Sheets)){for(var t=a.Workbook.Sheets,r=0,s=-1,i=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&s==-1?s=r:t[r].Hidden==1&&i==-1&&(i=r);i>s||(Te(e,135),Te(e,158,TD(s)),Te(e,136))}}function _D(e,a){var t=lr();return Te(t,131),Te(t,128,CD()),Te(t,153,ED(e.Workbook&&e.Workbook.WBProps||null)),FD(t,e),SD(t,e),Te(t,132),t.end()}function AD(e,a,t){return a.slice(-4)===".bin"?jD(e,t):yD(e,t)}function RD(e,a,t,r,s,i,o,l){return a.slice(-4)===".bin"?q7(e,r,t,s,i,o,l):NR(e,r,t,s,i,o,l)}function DD(e,a,t,r,s,i,o,l){return a.slice(-4)===".bin"?cD(e,r,t,s,i):oD(e,r,t,s,i)}function PD(e,a,t,r,s,i,o,l){return a.slice(-4)===".bin"?I_():M_()}function OD(e,a,t,r,s,i,o,l){return a.slice(-4)===".bin"?P_():O_()}function ID(e,a,t,r){return a.slice(-4)===".bin"?A8(e,t,r):v8(e,t,r)}function MD(e,a,t){return l3(e,t)}function UD(e,a,t){return a.slice(-4)===".bin"?UF(e,t):OF(e,t)}function LD(e,a,t){return a.slice(-4)===".bin"?F_(e,t):b_(e,t)}function BD(e,a,t){return a.slice(-4)===".bin"?g_(e):h_(e)}function zD(e,a,t,r){return t.slice(-4)===".bin"?y_(e,a,t,r):void 0}function $D(e,a,t){return a.slice(-4)===".bin"?f_(e,a,t):x_(e,a,t)}function VD(e,a,t){return(a.slice(-4)===".bin"?_D:T3)(e)}function HD(e,a,t,r,s){return(a.slice(-4)===".bin"?sD:k3)(e,t,r,s)}function GD(e,a,t){return(a.slice(-4)===".bin"?z8:i3)(e,t)}function XD(e,a,t){return(a.slice(-4)===".bin"?zF:ZE)(e,t)}function qD(e,a,t){return(a.slice(-4)===".bin"?__:u3)(e)}function YD(e){return(e.slice(-4)===".bin"?m_:c3)()}var F3=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,_3=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Wr(e,a){var t=e.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var s=e.match(F3),i,o,l,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(_3),(o=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),r[l]=i[2].slice(1,i[2].length-1));return r}function WD(e){var a=e.split(/\s+/),t={};if(a.length===1)return t;var r=e.match(F3),s,i,o,l;if(r)for(l=0;l!=r.length;++l)s=r[l].match(_3),(i=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),t[o]=s[2].slice(1,s[2].length-1));return t}var Yl;function KD(e,a){var t=Yl[e]||ha(e);return t==="General"?hi(a):Xr(t,a)}function JD(e,a,t,r){var s=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ua(r);break;case"i2":case"int":s=parseInt(r,10);break;case"r4":case"float":s=parseFloat(r);break;case"date":case"dateTime.tz":s=La(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[ha(a)]=s}function ZD(e,a,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ws[e.v]:a==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=uc(e.v):e.w=hi(e.v):e.w=KD(a||"General",e.v)}catch(i){if(t.WTF)throw i}try{var r=Yl[a]||a||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&Zo(r)){var s=Yn(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(t.WTF)throw i}}}function QD(e,a,t){if(t.cellStyles&&a.Interior){var r=a.Interior;r.Pattern&&(r.patternType=u8[r.Pattern]||r.Pattern)}e[a.ID]=a}function eP(e,a,t,r,s,i,o,l,c,u){var d="General",f=r.StyleID,m={};u=u||{};var x=[],h=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(d=i[f].nf),i[f].Interior&&x.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=Ua(e);break;case"String":r.t="s",r.r=E1(ha(e)),r.v=e.indexOf("<")>-1?ha(a||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(La(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=ha(e):r.v<60&&(r.v=r.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=NE[e],u.cellText!==!1&&(r.w=e);break;default:e==""&&a==""?r.t="z":(r.t="s",r.v=E1(a||e));break}if(ZD(r,d,u),u.cellFormula!==!1)if(r.Formula){var g=ha(r.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),r.f=Co(g,s),delete r.Formula,r.ArrayRange=="RC"?r.F=Co("RC:RC",s):r.ArrayRange&&(r.F=Co(r.ArrayRange,s),c.push([pa(r.F),r.F]))}else for(h=0;h<c.length;++h)s.r>=c[h][0].s.r&&s.r<=c[h][0].e.r&&s.c>=c[h][0].s.c&&s.c<=c[h][0].e.c&&(r.F=c[h][1]);u.cellStyles&&(x.forEach(function(p){!m.patternType&&p.patternType&&(m.patternType=p.patternType)}),r.s=m),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function aP(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Pf(e,a){var t=a||{};Qo();var r=Nl($h(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=Ra(r));var s=r.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Ba(t);return o.type="string",$o.to_workbook(r,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(we){s.indexOf("<"+we)>=0&&(i=!0)}),i)return BP(r,t);Yl={"General Number":"General","General Date":qe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":qe[15],"Short Date":qe[14],"Long Time":qe[19],"Medium Time":qe[18],"Short Time":qe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:qe[2],Standard:qe[4],Percent:qe[10],Scientific:qe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],m=t.dense?[]:{},x="",h={},g={},p=Wr('<Data ss:Type="String">'),v=0,w=0,b=0,y={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},A={},E="",F=0,k=[],P={},R={},_=0,Q=[],C=[],z={},S=[],D,H=!1,U=[],B=[],X={},T=0,L=0,V={Sheets:[],WBProps:{date1904:!1}},O={};xc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";l=xc.exec(r);)switch(l[3]=(de=l[3]).toLowerCase()){case"data":if(de=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?eP(r.slice(v,l.index),E,p,c[c.length-1][0]=="comment"?z:h,{c:w,r:b},j,S[w],g,U,t):(E="",p=Wr(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(C.length>0&&(h.c=C),(!t.sheetRows||t.sheetRows>b)&&h.v!==void 0&&(t.dense?(m[b]||(m[b]=[]),m[b][w]=h):m[Wa(w)+nt(b)]=h),h.HRef&&(h.l={Target:ha(h.HRef)},h.HRefScreenTip&&(h.l.Tooltip=h.HRefScreenTip),delete h.HRef,delete h.HRefScreenTip),(h.MergeAcross||h.MergeDown)&&(T=w+(parseInt(h.MergeAcross,10)|0),L=b+(parseInt(h.MergeDown,10)|0),k.push({s:{c:w,r:b},e:{c:T,r:L}})),!t.sheetStubs)h.MergeAcross?w=T+1:++w;else if(h.MergeAcross||h.MergeDown){for(var me=w;me<=T;++me)for(var ae=b;ae<=L;++ae)(me>w||ae>b)&&(t.dense?(m[ae]||(m[ae]=[]),m[ae][me]={t:"z"}):m[Wa(me)+nt(ae)]={t:"z"});w=T+1}else++w;else h=WD(l[0]),h.Index&&(w=+h.Index-1),w<y.s.c&&(y.s.c=w),w>y.e.c&&(y.e.c=w),l[0].slice(-2)==="/>"&&++w,C=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<y.s.r&&(y.s.r=b),b>y.e.r&&(y.e.r=b),l[0].slice(-2)==="/>"&&(g=Wr(l[0]),g.Index&&(b=+g.Index-1)),w=0,++b):(g=Wr(l[0]),g.Index&&(b=+g.Index-1),X={},(g.AutoFitHeight=="0"||g.Height)&&(X.hpx=parseInt(g.Height,10),X.hpt=vc(X.hpx),B[b]=X),g.Hidden=="1"&&(X.hidden=!0,B[b]=X));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(x),y.s.r<=y.e.r&&y.s.c<=y.e.c&&(m["!ref"]=ra(y),t.sheetRows&&t.sheetRows<=y.e.r&&(m["!fullref"]=m["!ref"],y.e.r=t.sheetRows-1,m["!ref"]=ra(y))),k.length&&(m["!merges"]=k),S.length>0&&(m["!cols"]=S),B.length>0&&(m["!rows"]=B),d[x]=m}else y={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=w=0,c.push([l[3],!1]),u=Wr(l[0]),x=ha(u.Name),m=t.dense?[]:{},k=[],U=[],B=[],O={name:x,Hidden:0},V.Sheets.push(O);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),S=[],H=!1}break;case"style":l[1]==="/"?QD(j,A,t):A=Wr(l[0]);break;case"numberformat":A.nf=ha(Wr(l[0]).Format||"General"),Yl[A.nf]&&(A.nf=Yl[A.nf]);for(var ce=0;ce!=392&&qe[ce]!=A.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(qe[ce]==null){Us(A.nf,ce);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(D=Wr(l[0]),D.Hidden&&(D.hidden=!0,delete D.Hidden),D.Width&&(D.wpx=parseInt(D.Width,10)),!H&&D.wpx>10){H=!0,$t=s3;for(var W=0;W<S.length;++W)S[W]&&Fn(S[W])}H&&Fn(D),S[D.Index-1||S.length]=D;for(var le=0;le<+D.Span;++le)S[S.length]=Ba(D);break;case"namedrange":if(l[1]==="/")break;V.Names||(V.Names=[]);var I=Ke(l[0]),q={Name:I.Name,Ref:Co(I.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(q.Sheet=V.Sheets.length-1),V.Names.push(q);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?E+=r.slice(F,l.index):F=l.index+l[0].length;break;case"interior":if(!t.cellStyles)break;A.Interior=Wr(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?j5(P,de,r.slice(_,l.index)):_=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));aP(z),C.push(z)}else c.push([l[3],!1]),u=Wr(l[0]),z={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ne=Wr(l[0]);m["!autofilter"]={ref:Co(ne.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return dy(r,t);var G=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:G=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:G=!1}break;case"excelworkbook":switch(l[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:G=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:G=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(r.slice(_,l.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else _=l.index+l[0].length;break;case"header":m["!margins"]||oi(m["!margins"]={},"xlml"),isNaN(+Ke(l[0]).Margin)||(m["!margins"].header=+Ke(l[0]).Margin);break;case"footer":m["!margins"]||oi(m["!margins"]={},"xlml"),isNaN(+Ke(l[0]).Margin)||(m["!margins"].footer=+Ke(l[0]).Margin);break;case"pagemargins":var ee=Ke(l[0]);m["!margins"]||oi(m["!margins"]={},"xlml"),isNaN(+ee.Top)||(m["!margins"].top=+ee.Top),isNaN(+ee.Left)||(m["!margins"].left=+ee.Left),isNaN(+ee.Right)||(m["!margins"].right=+ee.Right),isNaN(+ee.Bottom)||(m["!margins"].bottom=+ee.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:G=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:G=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:G=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:G=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:G=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:G=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:G=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:G=!1}break;case"smarttags":break;default:G=!1;break}if(G||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?JD(R,de,Q,r.slice(_,l.index)):(Q=l,_=l.index+l[0].length);break}if(t.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ie={};return!t.bookSheets&&!t.bookProps&&(ie.Sheets=d),ie.SheetNames=f,ie.Workbook=V,ie.SSF=Ba(qe),ie.Props=P,ie.Custprops=R,ie}function fx(e,a){switch(fp(a=a||{}),a.type||"base64"){case"base64":return Pf(Fr(e),a);case"binary":case"buffer":case"file":return Pf(e,a);case"array":return Pf(In(e),a)}}function tP(e,a){var t=[];return e.Props&&t.push(S5(e.Props,a)),e.Custprops&&t.push(C5(e.Props,e.Custprops)),t.join("")}function rP(){return""}function sP(e,a){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return a.cellXfs.forEach(function(r,s){var i=[];i.push(Pe("NumberFormat",null,{"ss:Format":Fa(qe[r.numFmtId])}));var o={"ss:ID":"s"+(21+s)};t.push(Pe("Style",i.join(""),o))}),Pe("Styles",t.join(""))}function A3(e){return Pe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ip(e.Ref,{r:0,c:0})})}function nP(e){if(!((e||{}).Workbook||{}).Names)return"";for(var a=e.Workbook.Names,t=[],r=0;r<a.length;++r){var s=a[r];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(A3(s)))}return Pe("Names",t.join(""))}function iP(e,a,t,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var s=r.Workbook.Names,i=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==t&&(l.Name.match(/^_xlfn\./)||i.push(A3(l)))}return i.join("")}function oP(e,a,t,r){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Pe("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)s.push(Pe("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&!(r.Workbook.Sheets[i]&&!r.Workbook.Sheets[i].Hidden);++i);i==t&&s.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Dt("ProtectContents","True")),e["!protect"].objects&&s.push(Dt("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Dt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Dt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Dt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Pe("WorksheetOptions",s.join(""),{xmlns:yr.x})}function lP(e){return e.map(function(a){var t=FT(a.t||""),r=Pe("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Pe("Comment",r,{"ss:Author":a.a})}).join("")}function cP(e,a,t,r,s,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Fa(ip(e.f,o))),e.F&&e.F.slice(0,a.length)==a){var c=Ka(e.F.slice(a.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Fa(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Fa(e.l.Tooltip))),t["!merges"])for(var u=t["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",m="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",m=String(e.v);break;case"b":f="Boolean",m=e.v?"1":"0";break;case"e":f="Error",m=Ws[e.v];break;case"d":f="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||qe[14]);break;case"s":f="String",m=TT(e.v||"");break}var x=Un(r.cellXfs,e,r);l["ss:StyleID"]="s"+(21+x),l["ss:Index"]=o.c+1;var h=e.v!=null?m:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+h+"</Data>";return(e.c||[]).length>0&&(g+=lP(e.c)),Pe("Cell",g,l)}function dP(e,a){var t='<Row ss:Index="'+(e+1)+'"';return a&&(a.hpt&&!a.hpx&&(a.hpx=Vo(a.hpt)),a.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+a.hpx+'"'),a.hidden&&(t+=' ss:Hidden="1"')),t+">"}function uP(e,a,t,r){if(!e["!ref"])return"";var s=pa(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(p,v){Fn(p);var w=!!p.width,b=Cu(v,p),y={"ss:Index":v+1};w&&(y["ss:Width"]=gc(b.width)),p.hidden&&(y["ss:Hidden"]="1"),l.push(Pe("Column",null,y))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[dP(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var m=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>u)&&!(i[o].e.c<f)&&!(i[o].e.r<u)){(i[o].s.c!=f||i[o].s.r!=u)&&(m=!0);break}if(!m){var x={r:u,c:f},h=Ye(x),g=c?(e[u]||[])[f]:e[h];d.push(cP(g,h,e,a,t,r,x))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function fP(e,a,t){var r=[],s=t.SheetNames[e],i=t.Sheets[s],o=i?iP(i,a,e,t):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=i?uP(i,a,e,t):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(oP(i,a,e,t)),r.join("")}function mP(e,a){a||(a={}),e.SSF||(e.SSF=Ba(qe)),e.SSF&&(Qo(),bu(e.SSF),a.revssf=Eu(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF,a.cellXfs=[],Un(a.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(tP(e,a)),t.push(rP()),t.push(""),t.push("");for(var r=0;r<e.SheetNames.length;++r)t.push(Pe("Worksheet",fP(r,a,e),{"ss:Name":Fa(e.SheetNames[r])}));return t[2]=sP(e,a),t[3]=nP(e),ot+Pe("Workbook",t.join(""),{xmlns:yr.ss,"xmlns:o":yr.o,"xmlns:x":yr.x,"xmlns:ss":yr.ss,"xmlns:dt":yr.dt,"xmlns:html":yr.html})}function xP(e){var a={},t=e.content;if(t.l=28,a.AnsiUserType=t.read_shift(0,"lpstr-ansi"),a.AnsiClipboardFormat=n5(t),t.length-t.l<=4)return a;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,a.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(a.UnicodeClipboardFormat=i5(t),r=t.read_shift(4),r==0||r>40))return a;t.l-=4,a.Reserved2=t.read_shift(0,"lpwstr")}var hP=[60,1084,2066,2165,2175];function pP(e,a,t,r,s){var i=r,o=[],l=t.slice(t.l,t.l+i);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),t.l+=i;for(var c=Ps(t,t.l),u=mx[c],d=0;u!=null&&hP.indexOf(c)>-1;)i=Ps(t,t.l+2),d=t.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=t.slice(d,t.l+4+i),o.push(l),t.l+=4+i,u=mx[c=Ps(t,t.l)];var f=Nt(o);At(f,0);var m=0;f.lens=[];for(var x=0;x<o.length;++x)f.lens.push(m),m+=o[x].length;if(f.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+r;return a.f(f,f.length,s)}function os(e,a,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,a.cellNF&&(e.z=qe[r])}catch(i){if(a.WTF)throw i}if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||Ws[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=uc(e.v):e.w=hi(e.v):e.w=Xr(r,e.v,{date1904:!!t,dateNF:a&&a.dateNF})}catch(i){if(a.WTF)throw i}if(a.cellDates&&r&&e.t=="n"&&Zo(qe[r]||String(r))){var s=Yn(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function jd(e,a,t){return{v:e,ixfe:a,t}}function gP(e,a){var t={opts:{}},r={},s=a.dense?[]:{},i={},o={},l=null,c=[],u="",d={},f,m="",x,h,g,p,v={},w=[],b,y,j=[],A=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},k=function(Xe){return Xe<8?si[Xe]:Xe<64&&A[Xe-8]||si[Xe]},P=function(Xe,va,Y){var oe=va.XF.data;if(!(!oe||!oe.patternType||!Y||!Y.cellStyles)){va.s={},va.s.patternType=oe.patternType;var ue;(ue=pc(k(oe.icvFore)))&&(va.s.fgColor={rgb:ue}),(ue=pc(k(oe.icvBack)))&&(va.s.bgColor={rgb:ue})}},R=function(Xe,va,Y){if(!(X>1)&&!(Y.sheetRows&&Xe.r>=Y.sheetRows)){if(Y.cellStyles&&va.XF&&va.XF.data&&P(Xe,va,Y),delete va.ixfe,delete va.XF,f=Xe,m=Ye(Xe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Xe.r<o.s.r&&(o.s.r=Xe.r),Xe.c<o.s.c&&(o.s.c=Xe.c),Xe.r+1>o.e.r&&(o.e.r=Xe.r+1),Xe.c+1>o.e.c&&(o.e.c=Xe.c+1),Y.cellFormula&&va.f){for(var oe=0;oe<w.length;++oe)if(!(w[oe][0].s.c>Xe.c||w[oe][0].s.r>Xe.r)&&!(w[oe][0].e.c<Xe.c||w[oe][0].e.r<Xe.r)){va.F=ra(w[oe][0]),(w[oe][0].s.c!=Xe.c||w[oe][0].s.r!=Xe.r)&&delete va.f,va.f&&(va.f=""+zt(w[oe][1],o,Xe,U,_));break}}Y.dense?(s[Xe.r]||(s[Xe.r]=[]),s[Xe.r][Xe.c]=va):s[m]=va}},_={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!a&&!!a.cellStyles,WTF:!!a&&!!a.wtf};a.password&&(_.password=a.password);var Q,C=[],z=[],S=[],D=[],H=!1,U=[];U.SheetNames=_.snames,U.sharedf=_.sharedf,U.arrayf=_.arrayf,U.names=[],U.XTI=[];var B=0,X=0,T=0,L=[],V=[],O;_.codepage=1200,Zr(1200);for(var de=!1;e.l<e.length-1;){var me=e.l,ae=e.read_shift(2);if(ae===0&&B===10)break;var ce=e.l===e.length?0:e.read_shift(2),W=mx[ae];if(W&&W.f){if(a.bookSheets&&B===133&&ae!==133)break;if(B=ae,W.r===2||W.r==12){var le=e.read_shift(2);if(ce-=2,!_.enc&&le!==ae&&((le&255)<<8|le>>8)!==ae)throw new Error("rt mismatch: "+le+"!="+ae);W.r==12&&(e.l+=10,ce-=10)}var I={};if(ae===10?I=W.f(e,ce,_):I=pP(ae,W,e,ce,_),X==0&&[9,521,1033,2057].indexOf(B)===-1)continue;switch(ae){case 34:t.opts.Date1904=E.WBProps.date1904=I;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(_.enc||(e.l=0),_.enc=I,!a.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=I;break;case 66:var q=Number(I);switch(q){case 21010:q=1200;break;case 32768:q=1e4;break;case 32769:q=1252;break}Zr(_.codepage=q),de=!0;break;case 317:_.rrtabid=I;break;case 25:_.winlocked=I;break;case 439:t.opts.RefreshAll=I;break;case 12:t.opts.CalcCount=I;break;case 16:t.opts.CalcDelta=I;break;case 17:t.opts.CalcIter=I;break;case 13:t.opts.CalcMode=I;break;case 14:t.opts.CalcPrecision=I;break;case 95:t.opts.CalcSaveRecalc=I;break;case 15:_.CalcRefMode=I;break;case 2211:t.opts.FullCalc=I;break;case 129:I.fDialog&&(s["!type"]="dialog"),I.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),I.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:j.push(I);break;case 430:U.push([I]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(I);break;case 24:case 536:O={Name:I.Name,Ref:zt(I.rgce,o,null,U,_)},I.itab>0&&(O.Sheet=I.itab-1),U.names.push(O),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(V[I.itab-1]={ref:ra(I.rgce[0][0][1][2])});break;case 22:_.ExternCount=I;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(I),U.XTI=U.XTI.concat(I);break;case 2196:if(_.biff<8)break;O!=null&&(O.Comment=I[1]);break;case 18:s["!protect"]=I;break;case 19:I!==0&&_.WTF&&console.error("Password verifier: "+I);break;case 133:i[I.pos]=I,_.snames.push(I.name);break;case 10:{if(--X)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=ra(o),a.sheetRows&&a.sheetRows<=o.e.r){var ne=o.e.r;o.e.r=a.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=ra(o),o.e.r=ne}o.e.r++,o.e.c++}C.length>0&&(s["!merges"]=C),z.length>0&&(s["!objects"]=z),S.length>0&&(s["!cols"]=S),D.length>0&&(s["!rows"]=D),E.Sheets.push(F)}u===""?d=s:r[u]=s,s=a.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(_.biff===8&&(_.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),_.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(_.biff=5,de=!0,Zr(_.codepage=28591)),_.biff==8&&I.BIFFVer==0&&I.dt==16&&(_.biff=2),X++)break;if(s=a.dense?[]:{},_.biff<8&&!de&&(de=!0,Zr(_.codepage=a.codepage||1252)),_.biff<5||I.BIFFVer==0&&I.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var G={pos:e.l-ce,name:u};i[G.pos]=G,_.snames.push(u)}else u=(i[me]||{name:""}).name;I.dt==32&&(s["!type"]="chart"),I.dt==64&&(s["!type"]="macro"),C=[],z=[],_.arrayf=w=[],S=[],D=[],H=!1,F={Hidden:(i[me]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(a.dense?(s[I.r]||[])[I.c]:s[Ye({c:I.c,r:I.r})])&&++I.c,b={ixfe:I.ixfe,XF:j[I.ixfe]||{},v:I.val,t:"n"},T>0&&(b.z=L[b.ixfe>>8&63]),os(b,a,t.opts.Date1904),R({c:I.c,r:I.r},b,a);break;case 5:case 517:b={ixfe:I.ixfe,XF:j[I.ixfe],v:I.val,t:I.t},T>0&&(b.z=L[b.ixfe>>8&63]),os(b,a,t.opts.Date1904),R({c:I.c,r:I.r},b,a);break;case 638:b={ixfe:I.ixfe,XF:j[I.ixfe],v:I.rknum,t:"n"},T>0&&(b.z=L[b.ixfe>>8&63]),os(b,a,t.opts.Date1904),R({c:I.c,r:I.r},b,a);break;case 189:for(var ee=I.c;ee<=I.C;++ee){var ie=I.rkrec[ee-I.c][0];b={ixfe:ie,XF:j[ie],v:I.rkrec[ee-I.c][1],t:"n"},T>0&&(b.z=L[b.ixfe>>8&63]),os(b,a,t.opts.Date1904),R({c:ee,r:I.r},b,a)}break;case 6:case 518:case 1030:{if(I.val=="String"){l=I;break}if(b=jd(I.val,I.cell.ixfe,I.tt),b.XF=j[b.ixfe],a.cellFormula){var we=I.formula;if(we&&we[0]&&we[0][0]&&we[0][0][0]=="PtgExp"){var je=we[0][0][1][0],Me=we[0][0][1][1],$e=Ye({r:je,c:Me});v[$e]?b.f=""+zt(I.formula,o,I.cell,U,_):b.F=((a.dense?(s[je]||[])[Me]:s[$e])||{}).F}else b.f=""+zt(I.formula,o,I.cell,U,_)}T>0&&(b.z=L[b.ixfe>>8&63]),os(b,a,t.opts.Date1904),R(I.cell,b,a),l=I}break;case 7:case 519:if(l)l.val=I,b=jd(I,l.cell.ixfe,"s"),b.XF=j[b.ixfe],a.cellFormula&&(b.f=""+zt(l.formula,o,l.cell,U,_)),T>0&&(b.z=L[b.ixfe>>8&63]),os(b,a,t.opts.Date1904),R(l.cell,b,a),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(I);var Ie=Ye(I[0].s);if(x=a.dense?(s[I[0].s.r]||[])[I[0].s.c]:s[Ie],a.cellFormula&&x){if(!l||!Ie||!x)break;x.f=""+zt(I[1],o,I[0],U,_),x.F=ra(I[0])}}break;case 1212:{if(!a.cellFormula)break;if(m){if(!l)break;v[Ye(l.cell)]=I[0],x=a.dense?(s[l.cell.r]||[])[l.cell.c]:s[Ye(l.cell)],(x||{}).f=""+zt(I[0],o,f,U,_)}}break;case 253:b=jd(c[I.isst].t,I.ixfe,"s"),c[I.isst].h&&(b.h=c[I.isst].h),b.XF=j[b.ixfe],T>0&&(b.z=L[b.ixfe>>8&63]),os(b,a,t.opts.Date1904),R({c:I.c,r:I.r},b,a);break;case 513:a.sheetStubs&&(b={ixfe:I.ixfe,XF:j[I.ixfe],t:"z"},T>0&&(b.z=L[b.ixfe>>8&63]),os(b,a,t.opts.Date1904),R({c:I.c,r:I.r},b,a));break;case 190:if(a.sheetStubs)for(var We=I.c;We<=I.C;++We){var Ve=I.ixfe[We-I.c];b={ixfe:Ve,XF:j[Ve],t:"z"},T>0&&(b.z=L[b.ixfe>>8&63]),os(b,a,t.opts.Date1904),R({c:We,r:I.r},b,a)}break;case 214:case 516:case 4:b=jd(I.val,I.ixfe,"s"),b.XF=j[b.ixfe],T>0&&(b.z=L[b.ixfe>>8&63]),os(b,a,t.opts.Date1904),R({c:I.c,r:I.r},b,a);break;case 0:case 512:X===1&&(o=I);break;case 252:c=I;break;case 1054:if(_.biff==4){L[T++]=I[1];for(var Ze=0;Ze<T+163&&qe[Ze]!=I[1];++Ze);Ze>=163&&Us(I[1],T+163)}else Us(I[1],I[0]);break;case 30:{L[T++]=I;for(var Fe=0;Fe<T+163&&qe[Fe]!=I;++Fe);Fe>=163&&Us(I,T+163)}break;case 229:C=C.concat(I);break;case 93:z[I.cmo[0]]=_.lastobj=I;break;case 438:_.lastobj.TxO=I;break;case 127:_.lastobj.ImData=I;break;case 440:for(p=I[0].s.r;p<=I[0].e.r;++p)for(g=I[0].s.c;g<=I[0].e.c;++g)x=a.dense?(s[p]||[])[g]:s[Ye({c:g,r:p})],x&&(x.l=I[1]);break;case 2048:for(p=I[0].s.r;p<=I[0].e.r;++p)for(g=I[0].s.c;g<=I[0].e.c;++g)x=a.dense?(s[p]||[])[g]:s[Ye({c:g,r:p})],x&&x.l&&(x.l.Tooltip=I[1]);break;case 28:{if(_.biff<=5&&_.biff>=2)break;x=a.dense?(s[I[0].r]||[])[I[0].c]:s[Ye(I[0])];var na=z[I[2]];x||(a.dense?(s[I[0].r]||(s[I[0].r]=[]),x=s[I[0].r][I[0].c]={t:"z"}):x=s[Ye(I[0])]={t:"z"},o.e.r=Math.max(o.e.r,I[0].r),o.s.r=Math.min(o.s.r,I[0].r),o.e.c=Math.max(o.e.c,I[0].c),o.s.c=Math.min(o.s.c,I[0].c)),x.c||(x.c=[]),h={a:I[1],t:na.TxO.t},x.c.push(h)}break;case 2173:s_(j[I.ixfe],I.ext);break;case 125:{if(!_.cellStyles)break;for(;I.e>=I.s;)S[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},H||(H=!0,rp(I.w/256)),Fn(S[I.e+1])}break;case 520:{var oa={};I.level!=null&&(D[I.r]=oa,oa.level=I.level),I.hidden&&(D[I.r]=oa,oa.hidden=!0),I.hpt&&(D[I.r]=oa,oa.hpt=I.hpt,oa.hpx=Vo(I.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||oi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=I;break;case 161:s["!margins"]||oi(s["!margins"]={}),s["!margins"].header=I.header,s["!margins"].footer=I.footer;break;case 574:I.RTL&&(E.Views[0].RTL=!0);break;case 146:A=I;break;case 2198:Q=I;break;case 140:y=I;break;case 442:u?F.CodeName=I||F.name:E.WBProps.CodeName=I||"ThisWorkbook";break}}else W||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=ce}return t.SheetNames=at(i).sort(function($a,Xe){return Number($a)-Number(Xe)}).map(function($a){return i[$a].name}),a.bookSheets||(t.Sheets=r),!t.SheetNames.length&&d["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=d)):t.Preamble=d,t.Sheets&&V.forEach(function($a,Xe){t.Sheets[t.SheetNames[Xe]]["!autofilter"]=$a}),t.Strings=c,t.SSF=Ba(qe),_.enc&&(t.Encryption=_.enc),Q&&(t.Themes=Q),t.Metadata={},y!==void 0&&(t.Metadata.Country=y),U.names.length>0&&(E.Names=U.names),t.Workbook=E,t}var Wl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function yP(e,a,t){var r=Ge.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var s=B1(r,ix,Wl.DSI);for(var i in s)a[i]=s[i]}catch(u){if(t.WTF)throw u}var o=Ge.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=B1(o,ox,Wl.SI);for(var c in l)a[c]==null&&(a[c]=l[c])}catch(u){if(t.WTF)throw u}a.HeadingPairs&&a.TitlesOfParts&&(_E(a.HeadingPairs,a.TitlesOfParts,a,t),delete a.HeadingPairs,delete a.TitlesOfParts)}function vP(e,a){var t=[],r=[],s=[],i=0,o,l=p1(ix,"n"),c=p1(ox,"n");if(e.Props)for(o=at(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?t:Object.prototype.hasOwnProperty.call(c,o[i])?r:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=at(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?t:Object.prototype.hasOwnProperty.call(c,o[i])?r:s).push([o[i],e.Custprops[o[i]]]);var u=[];for(i=0;i<s.length;++i)ME.indexOf(s[i][0])>-1||FE.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);r.length&&Ge.utils.cfb_add(a,"/SummaryInformation",z1(r,Wl.SI,c,ox)),(t.length||u.length)&&Ge.utils.cfb_add(a,"/DocumentSummaryInformation",z1(t,Wl.DSI,l,ix,u.length?u:null,Wl.UDI))}function R3(e,a){a||(a={}),fp(a),Dh(),a.codepage&&Rh(a.codepage);var t,r;if(e.FullPaths){if(Ge.find(e,"/encryption"))throw new Error("File is password-protected");t=Ge.find(e,"!CompObj"),r=Ge.find(e,"/Workbook")||Ge.find(e,"/Book")}else{switch(a.type){case"base64":e=wr(Fr(e));break;case"binary":e=wr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}At(e,0),r={content:e}}var s,i;if(t&&xP(t),a.bookProps&&!a.bookSheets)s={};else{var o=la?"buffer":"array";if(r&&r.content)s=gP(r.content,a);else if((i=Ge.find(e,"PerfectOffice_MAIN"))&&i.content)s=ii.to_workbook(i.content,(a.type=o,a));else if((i=Ge.find(e,"NativeContent_MAIN"))&&i.content)s=ii.to_workbook(i.content,(a.type=o,a));else throw(i=Ge.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a.bookVBA&&e.FullPaths&&Ge.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=R_(e))}var l={};return e.FullPaths&&yP(e,l,a),s.Props=s.Custprops=l,a.bookFiles&&(s.cfb=e),s}function bP(e,a){var t=a||{},r=Ge.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Ge.utils.cfb_add(r,s,D3(e,t)),t.biff==8&&(e.Props||e.Custprops)&&vP(e,r),t.biff==8&&e.vbaraw&&D_(r,Ge.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var bc={0:{f:HR},1:{f:ZR},2:{f:g7},3:{f:i7},4:{f:t7},5:{f:x7},6:{f:E7},7:{f:d7},8:{f:F7},9:{f:T7},10:{f:S7},11:{f:C7},12:{f:e7},13:{f:v7},14:{f:l7},15:{f:s7},16:{f:N3},17:{f:N7},18:{f:f7},19:{f:qh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ND},40:{},42:{},43:{f:E8},44:{f:b8},45:{f:j8},46:{f:C8},47:{f:S8},48:{},49:{f:qT},50:{},51:{f:o_},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:YE},62:{f:w7},63:{f:p_},64:{f:G7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Yt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:z7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:KR},148:{f:qR,p:16},151:{f:O7},152:{},153:{f:wD},154:{},155:{},156:{f:vD},157:{},158:{},159:{T:1,f:MF},160:{T:-1},161:{T:1,f:Ai},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:n_},336:{T:-1},337:{f:d_,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:qE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:I7},427:{f:M7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:L7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:WR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:D7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:C_},633:{T:1},634:{T:-1},635:{T:1,f:j_},636:{T:-1},637:{f:JT},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:lD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:X7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},mx={6:{f:Rf},10:{f:Zs},12:{f:dt},13:{f:dt},14:{f:rt},15:{f:rt},16:{f:Vt},17:{f:rt},18:{f:rt},19:{f:dt},20:{f:q1},21:{f:q1},23:{f:qE},24:{f:W1},25:{f:rt},26:{},27:{},28:{f:X6},29:{},34:{f:rt},35:{f:Y1},38:{f:Vt},39:{f:Vt},40:{f:Vt},41:{f:Vt},42:{f:rt},43:{f:rt},47:{f:s8},49:{f:v6},51:{f:dt},60:{},61:{f:x6},64:{f:rt},65:{f:y6},66:{f:dt},77:{},80:{},81:{},82:{},85:{f:dt},89:{},90:{},91:{},92:{f:r6},93:{f:W6},94:{},95:{f:rt},96:{},97:{},99:{f:rt},125:{f:YE},128:{f:P6},129:{f:n6},130:{f:dt},131:{f:rt},132:{f:rt},133:{f:i6},134:{},140:{f:rF},141:{f:dt},144:{},146:{f:iF},151:{},152:{},153:{},154:{},155:{},156:{f:dt},157:{},158:{},160:{f:mF},161:{f:cF},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:_6},190:{f:A6},193:{f:Zs},197:{},198:{},199:{},200:{},201:{},202:{f:rt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:dt},220:{},221:{f:rt},222:{},224:{f:D6},225:{f:t6},226:{f:Zs},227:{},229:{f:q6},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:l6},253:{f:w6},255:{f:d6},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:UE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:rt},353:{f:Zs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:L6},431:{f:rt},432:{},433:{},434:{},437:{},438:{f:Z6},439:{f:rt},440:{f:Q6},441:{},442:{f:$c},443:{},444:{f:dt},445:{},446:{},448:{f:Zs},449:{f:m6,r:2},450:{f:Zs},512:{f:H1},513:{f:fF},515:{f:M6},516:{f:k6},517:{f:X1},519:{f:xF},520:{f:u6},523:{},545:{f:K1},549:{f:V1},566:{},574:{f:p6},638:{f:F6},659:{},1048:{},1054:{f:j6},1084:{},1212:{f:V6},2048:{f:aF},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ed},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Zs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:oF,r:12},2173:{f:r_,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:rt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:$6,r:12},2197:{},2198:{f:J8,r:12},2199:{},2200:{},2201:{},2202:{f:H6,r:12},2203:{f:Zs},2204:{},2205:{},2206:{},2207:{},2211:{f:f6},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:dt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:dF},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:nF},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:H1},1:{},2:{f:vF},3:{f:gF},4:{f:pF},5:{f:X1},7:{f:wF},8:{},9:{f:Ed},11:{},22:{f:dt},30:{f:C6},31:{},32:{},33:{f:K1},36:{},37:{f:V1},50:{f:EF},62:{},52:{},67:{},68:{f:dt},69:{},86:{},126:{},127:{f:hF},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:kF},223:{},234:{},354:{},421:{},518:{f:Rf},521:{f:Ed},536:{f:W1},547:{f:Y1},561:{},579:{},1030:{f:Rf},1033:{f:Ed},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Oe(e,a,t,r){var s=a;if(!isNaN(s)){var i=r||(t||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&Hh(t)&&e.push(t)}}function wP(e,a,t,r){var s=(t||[]).length||0;if(s<=8224)return Oe(e,a,t,s);var i=a;if(!isNaN(i)){for(var o=t.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(t.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(t.slice(c,c+u)),c+=u}}}function Xc(e,a,t){return e||(e=Ee(7)),e.write_shift(2,a),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function EP(e,a,t,r){var s=Ee(9);return Xc(s,e,a),LE(t,r||"b",s),s}function kP(e,a,t){var r=Ee(8+2*t.length);return Xc(r,e,a),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function NP(e,a,t,r){if(a.v!=null)switch(a.t){case"d":case"n":var s=a.t=="d"?bt(La(a.v)):a.v;s==(s|0)&&s>=0&&s<65536?Oe(e,2,bF(t,r,s)):Oe(e,3,yF(t,r,s));return;case"b":case"e":Oe(e,5,EP(t,r,a.v,a.t));return;case"s":case"str":Oe(e,4,kP(t,r,(a.v||"").slice(0,255)));return}Oe(e,1,Xc(null,t,r))}function jP(e,a,t,r){var s=Array.isArray(a),i=pa(a["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(r.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=ra(i)}for(var u=i.s.r;u<=i.e.r;++u){l=nt(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=Wa(d)),o=c[d]+l;var f=s?(a[u]||[])[d]:a[o];f&&NP(e,f,u,d)}}}function SP(e,a){for(var t=a||{},r=lr(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==t.sheet&&(s=i);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Oe(r,t.biff==4?1033:t.biff==3?521:9,ep(e,16,t)),jP(r,e.Sheets[e.SheetNames[s]],s,t),Oe(r,10),r.end()}function CP(e,a,t){Oe(e,49,b6({sz:12,name:"Arial"},t))}function TP(e,a,t){a&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)a[s]!=null&&Oe(e,1054,S6(s,a[s],t))})}function FP(e,a){var t=Ee(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Oe(e,2151,t),t=Ee(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),HE(pa(a["!ref"]||"A1"),t),t.write_shift(4,4),Oe(e,2152,t)}function _P(e,a){for(var t=0;t<16;++t)Oe(e,224,G1({numFmtId:0,style:!0},0,a));a.cellXfs.forEach(function(r){Oe(e,224,G1(r,0,a))})}function AP(e,a){for(var t=0;t<a["!links"].length;++t){var r=a["!links"][t];Oe(e,440,eF(r)),r[1].Tooltip&&Oe(e,2048,tF(r))}delete a["!links"]}function RP(e,a){if(a){var t=0;a.forEach(function(r,s){++t<=256&&r&&Oe(e,125,lF(Cu(s,r),s))})}}function DP(e,a,t,r,s){var i=16+Un(s.cellXfs,a,s);if(a.v==null&&!a.bf){Oe(e,513,vi(t,r,i));return}if(a.bf)Oe(e,6,nR(a,t,r,s,i));else switch(a.t){case"d":case"n":var o=a.t=="d"?bt(La(a.v)):a.v;Oe(e,515,U6(t,r,o,i));break;case"b":case"e":Oe(e,517,I6(t,r,a.v,i,s,a.t));break;case"s":case"str":if(s.bookSST){var l=lp(s.Strings,a.v,s.revStrings);Oe(e,253,E6(t,r,l,i))}else Oe(e,516,N6(t,r,(a.v||"").slice(0,255),i,s));break;default:Oe(e,513,vi(t,r,i))}}function PP(e,a,t){var r=lr(),s=t.SheetNames[e],i=t.Sheets[s]||{},o=(t||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),u=a.biff==8,d,f="",m=[],x=pa(i["!ref"]||"A1"),h=u?65536:16384;if(x.e.c>255||x.e.r>=h){if(a.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,h-1)}Oe(r,2057,ep(t,16,a)),Oe(r,13,Ir(1)),Oe(r,12,Ir(100)),Oe(r,15,Zt(!0)),Oe(r,17,Zt(!1)),Oe(r,16,gi(.001)),Oe(r,95,Zt(!0)),Oe(r,42,Zt(!1)),Oe(r,43,Zt(!1)),Oe(r,130,Ir(1)),Oe(r,128,O6()),Oe(r,131,Zt(!1)),Oe(r,132,Zt(!1)),u&&RP(r,i["!cols"]),Oe(r,512,T6(x,a)),u&&(i["!links"]=[]);for(var g=x.s.r;g<=x.e.r;++g){f=nt(g);for(var p=x.s.c;p<=x.e.c;++p){g===x.s.r&&(m[p]=Wa(p)),d=m[p]+f;var v=c?(i[g]||[])[p]:i[d];v&&(DP(r,v,g,p,a),u&&v.l&&i["!links"].push([d,v.l]))}}var w=l.CodeName||l.name||s;return u&&Oe(r,574,g6((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&Oe(r,229,Y6(i["!merges"])),u&&AP(r,i),Oe(r,442,BE(w)),u&&FP(r,i),Oe(r,10),r.end()}function OP(e,a,t){var r=lr(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},l=t.biff==8,c=t.biff==5;if(Oe(r,2057,ep(e,5,t)),t.bookType=="xla"&&Oe(r,135),Oe(r,225,l?Ir(1200):null),Oe(r,193,I5(2)),c&&Oe(r,191),c&&Oe(r,192),Oe(r,226),Oe(r,92,s6("SheetJS",t)),Oe(r,66,Ir(l?1200:1252)),l&&Oe(r,353,Ir(0)),l&&Oe(r,448),Oe(r,317,uF(e.SheetNames.length)),l&&e.vbaraw&&Oe(r,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";Oe(r,442,BE(u))}Oe(r,156,Ir(17)),Oe(r,25,Zt(!1)),Oe(r,18,Zt(!1)),Oe(r,19,Ir(0)),l&&Oe(r,431,Zt(!1)),l&&Oe(r,444,Ir(0)),Oe(r,61,h6()),Oe(r,64,Zt(!1)),Oe(r,141,Ir(0)),Oe(r,34,Zt(mD(e)=="true")),Oe(r,14,Zt(!0)),l&&Oe(r,439,Zt(!1)),Oe(r,218,Ir(0)),CP(r,e,t),TP(r,e.SSF,t),_P(r,t),l&&Oe(r,352,Zt(!1));var d=r.end(),f=lr();l&&Oe(f,140,sF()),l&&t.Strings&&wP(f,252,c6(t.Strings)),Oe(f,10);var m=f.end(),x=lr(),h=0,g=0;for(g=0;g<e.SheetNames.length;++g)h+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var p=d.length+h+m.length;for(g=0;g<e.SheetNames.length;++g){var v=i[g]||{};Oe(x,133,o6({pos:p,hs:v.Hidden||0,dt:0,name:e.SheetNames[g]},t)),p+=a[g].length}var w=x.end();if(h!=w.length)throw new Error("BS8 "+h+" != "+w.length);var b=[];return d.length&&b.push(d),w.length&&b.push(w),m.length&&b.push(m),Nt(b)}function IP(e,a){var t=a||{},r=[];e&&!e.SSF&&(e.SSF=Ba(qe)),e&&e.SSF&&(Qo(),bu(e.SSF),t.revssf=Eu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,mp(t),t.cellXfs=[],Un(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)r[r.length]=PP(s,t,e);return r.unshift(OP(e,r,t)),Nt(r)}function D3(e,a){for(var t=0;t<=e.SheetNames.length;++t){var r=e.Sheets[e.SheetNames[t]];if(!(!r||!r["!ref"])){var s=fr(r["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var i=a||{};switch(i.biff||2){case 8:case 5:return IP(e,a);case 4:case 3:case 2:return SP(e,a)}throw new Error("invalid type "+i.bookType+" for BIFF")}function iy(e,a){var t=a||{},r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,l=i&&i.index||e.length,c=bT(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,m=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},h=[];for(o=0;o<c.length;++o){var g=c[o].trim(),p=g.slice(0,3).toLowerCase();if(p=="<tr"){if(++u,t.sheetRows&&t.sheetRows<=u){--u;break}d=0;continue}if(!(p!="<td"&&p!="<th")){var v=g.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var w=v[l].trim();if(w.match(/<t[dh]/i)){for(var b=w,y=0;b.charAt(0)=="<"&&(y=b.indexOf(">"))>-1;)b=b.slice(y+1);for(var j=0;j<h.length;++j){var A=h[j];A.s.c==d&&A.s.r<u&&u<=A.e.r&&(d=A.e.c+1,j=-1)}var E=Ke(w.slice(0,w.indexOf(">")));m=E.colspan?+E.colspan:1,((f=+E.rowspan)>1||m>1)&&h.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+m-1}});var F=E.t||E["data-t"]||"";if(!b.length){d+=m;continue}if(b=rE(b),x.s.r>u&&(x.s.r=u),x.e.r<u&&(x.e.r=u),x.s.c>d&&(x.s.c=d),x.e.c<d&&(x.e.c=d),!b.length){d+=m;continue}var k={t:"s",v:b};t.raw||!b.trim().length||F=="s"||(b==="TRUE"?k={t:"b",v:!0}:b==="FALSE"?k={t:"b",v:!1}:isNaN(as(b))?isNaN(zo(b).getDate())||(k={t:"d",v:La(b)},t.cellDates||(k={t:"n",v:bt(k.v)}),k.z=t.dateNF||qe[14]):k={t:"n",v:as(b)}),t.dense?(r[u]||(r[u]=[]),r[u][d]=k):r[Ye({r:u,c:d})]=k,d+=m}}}}return r["!ref"]=ra(x),h.length&&(r["!merges"]=h),r}function MP(e,a,t,r){for(var s=e["!merges"]||[],i=[],o=a.s.c;o<=a.e.c;++o){for(var l=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>t||s[u].s.c>o)&&!(s[u].e.r<t||s[u].e.c<o)){if(s[u].s.r<t||s[u].s.c<o){l=-1;break}l=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(l<0)){var d=Ye({r:t,c:o}),f=r.dense?(e[t]||[])[o]:e[d],m=f&&f.v!=null&&(f.h||zh(f.w||(Hs(f),f.w)||""))||"",x={};l>1&&(x.rowspan=l),c>1&&(x.colspan=c),r.editable?m='<span contenteditable="true">'+m+"</span>":f&&(x["data-t"]=f&&f.t||"z",f.v!=null&&(x["data-v"]=f.v),f.z!=null&&(x["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),x.id=(r.id||"sjs")+"-"+d,i.push(Pe("td",m,x))}}var h="<tr>";return h+i.join("")+"</tr>"}var UP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',LP="</body></html>";function BP(e,a){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Mn(iy(t[0],a),a);var r=pp();return t.forEach(function(s,i){gp(r,iy(s,a),"Sheet"+(i+1))}),r}function zP(e,a,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function P3(e,a){var t=a||{},r=t.header!=null?t.header:UP,s=t.footer!=null?t.footer:LP,i=[r],o=fr(e["!ref"]);t.dense=Array.isArray(e),i.push(zP(e,o,t));for(var l=o.s.r;l<=o.e.r;++l)i.push(MP(e,o,l,t));return i.push("</table>"+s),i.join("")}function O3(e,a,t){var r=t||{},s=0,i=0;if(r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var o=typeof r.origin=="string"?Ka(r.origin):r.origin;s=o.r,i=o.c}var l=a.getElementsByTagName("tr"),c=Math.min(r.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var d=fr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],m=0,x=e["!rows"]||(e["!rows"]=[]),h=0,g=0,p=0,v=0,w=0,b=0;for(e["!cols"]||(e["!cols"]=[]);h<l.length&&g<c;++h){var y=l[h];if(oy(y)){if(r.display)continue;x[g]={hidden:!0}}var j=y.children;for(p=v=0;p<j.length;++p){var A=j[p];if(!(r.display&&oy(A))){var E=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):rE(A.innerHTML),F=A.getAttribute("data-z")||A.getAttribute("z");for(m=0;m<f.length;++m){var k=f[m];k.s.c==v+i&&k.s.r<g+s&&g+s<=k.e.r&&(v=k.e.c+1-i,m=-1)}b=+A.getAttribute("colspan")||1,((w=+A.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:g+s,c:v+i},e:{r:g+s+(w||1)-1,c:v+i+(b||1)-1}});var P={t:"s",v:E},R=A.getAttribute("data-t")||A.getAttribute("t")||"";E!=null&&(E.length==0?P.t=R||"z":r.raw||E.trim().length==0||R=="s"||(E==="TRUE"?P={t:"b",v:!0}:E==="FALSE"?P={t:"b",v:!1}:isNaN(as(E))?isNaN(zo(E).getDate())||(P={t:"d",v:La(E)},r.cellDates||(P={t:"n",v:bt(P.v)}),P.z=r.dateNF||qe[14]):P={t:"n",v:as(E)})),P.z===void 0&&F!=null&&(P.z=F);var _="",Q=A.getElementsByTagName("A");if(Q&&Q.length)for(var C=0;C<Q.length&&!(Q[C].hasAttribute("href")&&(_=Q[C].getAttribute("href"),_.charAt(0)!="#"));++C);_&&_.charAt(0)!="#"&&(P.l={Target:_}),r.dense?(e[g+s]||(e[g+s]=[]),e[g+s][v+i]=P):e[Ye({c:v+i,r:g+s})]=P,u.e.c<v+i&&(u.e.c=v+i),v+=b}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+s),e["!ref"]=ra(u),g>=c&&(e["!fullref"]=ra((u.e.r=l.length-h+g-1+s,u))),e}function I3(e,a){var t=a||{},r=t.dense?[]:{};return O3(r,e,a)}function $P(e,a){return Mn(I3(e,a),a)}function oy(e){var a="",t=VP(e);return t&&(a=t(e).getPropertyValue("display")),a||(a=e.style&&e.style.display),a==="none"}function VP(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function HP(e){var a=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=ha(a.replace(/<[^>]*>/g,""));return[t]}var ly={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function M3(e,a){var t=a||{},r=$h(e),s=[],i,o,l={name:""},c="",u=0,d,f,m={},x=[],h=t.dense?[]:{},g,p,v={value:""},w="",b=0,y=[],j=-1,A=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,k={},P=[],R={},_=0,Q=0,C=[],z=1,S=1,D=[],H={Names:[]},U={},B=["",""],X=[],T={},L="",V=0,O=!1,de=!1,me=0;for(xc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=xc.exec(r);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?h["!ref"]=ra(E):h["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=E.e.r&&(h["!fullref"]=h["!ref"],E.e.r=t.sheetRows-1,h["!ref"]=ra(E)),P.length&&(h["!merges"]=P),C.length&&(h["!rows"]=C),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),x.push(d.name),m[d.name]=h,de=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=Ke(g[0],!1),j=A=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,h=t.dense?[]:{},P=[],C=[],de=!0);break;case"table-row-group":g[1]==="/"?--F:++F;break;case"table-row":case"":if(g[1]==="/"){j+=z,z=1;break}if(f=Ke(g[0],!1),f.?j=f.-1:j==-1&&(j=0),z=+f["number-rows-repeated"]||1,z<10)for(me=0;me<z;++me)F>0&&(C[j+me]={level:F});A=-1;break;case"covered-table-cell":g[1]!=="/"&&++A,t.sheetStubs&&(t.dense?(h[j]||(h[j]=[]),h[j][A]={t:"z"}):h[Ye({r:j,c:A})]={t:"z"}),w="",y=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++A,v=Ke(g[0],!1),S=parseInt(v["number-columns-repeated"]||"1",10),p={t:"z",v:null},v.formula&&t.cellFormula!=!1&&(p.f=ry(ha(v.formula))),(v.||v["value-type"])=="string"&&(p.t="s",p.v=ha(v["string-value"]||""),t.dense?(h[j]||(h[j]=[]),h[j][A]=p):h[Ye({r:j,c:A})]=p),A+=S-1;else if(g[1]!=="/"){++A,w="",b=0,y=[],S=1;var ae=z?j+z-1:j;if(A>E.e.c&&(E.e.c=A),A<E.s.c&&(E.s.c=A),j<E.s.r&&(E.s.r=j),ae>E.e.r&&(E.e.r=ae),v=Ke(g[0],!1),X=[],T={},p={t:v.||v["value-type"],v:null},t.cellFormula)if(v.formula&&(v.formula=ha(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(_=parseInt(v["number-matrix-rows-spanned"],10)||0,Q=parseInt(v["number-matrix-columns-spanned"],10)||0,R={s:{r:j,c:A},e:{r:j+_-1,c:A+Q-1}},p.F=ra(R),D.push([R,p.F])),v.formula)p.f=ry(v.formula);else for(me=0;me<D.length;++me)j>=D[me][0].s.r&&j<=D[me][0].e.r&&A>=D[me][0].s.c&&A<=D[me][0].e.c&&(p.F=D[me][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(_=parseInt(v["number-rows-spanned"],10)||0,Q=parseInt(v["number-columns-spanned"],10)||0,R={s:{r:j,c:A},e:{r:j+_-1,c:A+Q-1}},P.push(R)),v["number-columns-repeated"]&&(S=parseInt(v["number-columns-repeated"],10)),p.t){case"boolean":p.t="b",p.v=Ua(v["boolean-value"]);break;case"float":p.t="n",p.v=parseFloat(v.value);break;case"percentage":p.t="n",p.v=parseFloat(v.value);break;case"currency":p.t="n",p.v=parseFloat(v.value);break;case"date":p.t="d",p.v=La(v["date-value"]),t.cellDates||(p.t="n",p.v=bt(p.v)),p.z="m/d/yy";break;case"time":p.t="n",p.v=gT(v["time-value"])/86400,t.cellDates&&(p.t="d",p.v=ku(p.v)),p.z="HH:MM:SS";break;case"number":p.t="n",p.v=parseFloat(v.);break;default:if(p.t==="string"||p.t==="text"||!p.t)p.t="s",v["string-value"]!=null&&(w=ha(v["string-value"]),y=[]);else throw new Error("Unsupported value type "+p.t)}}else{if(O=!1,p.t==="s"&&(p.v=w||"",y.length&&(p.R=y),O=b==0),U.Target&&(p.l=U),X.length>0&&(p.c=X,X=[]),w&&t.cellText!==!1&&(p.w=w),O&&(p.t="z",delete p.v),(!O||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=j))for(var ce=0;ce<z;++ce){if(S=parseInt(v["number-columns-repeated"]||"1",10),t.dense)for(h[j+ce]||(h[j+ce]=[]),h[j+ce][A]=ce==0?p:Ba(p);--S>0;)h[j+ce][A+S]=Ba(p);else for(h[Ye({r:j+ce,c:A})]=p;--S>0;)h[Ye({r:j+ce,c:A+S})]=Ba(p);E.e.c<=A&&(E.e.c=A)}S=parseInt(v["number-columns-repeated"]||"1",10),A+=S-1,S=0,p={},w="",y=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i;T.t=w,y.length&&(T.R=y),T.a=L,X.push(T)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);L="",V=0,w="",b=0,y=[];break;case"creator":g[1]==="/"?L=r.slice(V,g.index):V=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);w="",b=0,y=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(k[l.name]=c,(i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(c="",l=Ke(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ke(g[0],!1),c+=ly[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ke(g[0],!1),c+=ly[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=r.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":o=Ke(g[0],!1),B=Df(o["cell-range-address"]);var W={Name:o.name,Ref:B[0]+"!"+B[1]};de&&(W.Sheet=x.length),H.Names.push(W);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var le=HP(r.slice(b,g.index));w=(w.length>0?w+`
`:"")+le[0]}else Ke(g[0],!1),b=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{B=Df(Ke(g[0])["target-range-address"]),m[B[0]]["!autofilter"]={ref:B[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(U=Ke(g[0],!1),!U.href)break;U.Target=ha(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(B=Df(U.Target.slice(1)),U.Target="#"+B[0]+"!"+B[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(g)}}var I={Sheets:m,SheetNames:x,Workbook:H};return t.bookSheets&&delete I.Sheets,I}function cy(e,a){a=a||{},Pr(e,"META-INF/manifest.xml")&&g5(ct(e,"META-INF/manifest.xml"),a);var t=Er(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=M3(Ra(t),a);return Pr(e,"meta.xml")&&(r.Props=CE(ct(e,"meta.xml"))),r}function dy(e,a){return M3(e,a)}var GP=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),a="<office:document-styles "+mc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ot+a}}(),uy=function(){var e=function(i){return Fa(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},a=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Fa(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=fr(i["!ref"]||"A1"),m=i["!merges"]||[],x=0,h=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",p=i["!rows"]||[];for(u=0;u<f.s.r;++u)g=p[u]?' table:style-name="ro'+p[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=f.e.r;++u){for(g=p[u]?' table:style-name="ro'+p[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<f.s.c;++d)c.push(a);for(;d<=f.e.c;++d){var v=!1,w={},b="";for(x=0;x!=m.length;++x)if(!(m[x].s.c>d)&&!(m[x].s.r>u)&&!(m[x].e.c<d)&&!(m[x].e.r<u)){(m[x].s.c!=d||m[x].s.r!=u)&&(v=!0),w["table:number-columns-spanned"]=m[x].e.c-m[x].s.c+1,w["table:number-rows-spanned"]=m[x].e.r-m[x].s.r+1;break}if(v){c.push(t);continue}var y=Ye({r:u,c:d}),j=h?(i[u]||[])[d]:i[y];if(j&&j.f&&(w["table:formula"]=Fa(uR(j.f)),j.F&&j.F.slice(0,y.length)==y)){var A=fr(j.F);w["table:number-matrix-columns-spanned"]=A.e.c-A.s.c+1,w["table:number-matrix-rows-spanned"]=A.e.r-A.s.r+1}if(!j){c.push(a);continue}switch(j.t){case"b":b=j.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=j.v?"true":"false";break;case"n":b=j.w||String(j.v||0),w["office:value-type"]="float",w["office:value"]=j.v||0;break;case"s":case"str":b=j.v==null?"":j.v,w["office:value-type"]="string";break;case"d":b=j.w||La(j.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=La(j.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(a);continue}var E=e(b);if(j.l&&j.l.Target){var F=j.l.Target;F=F.charAt(0)=="#"?"#"+fR(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),E=Pe("text:a",E,{"xlink:href":F.replace(/&/g,"&amp;")})}c.push("          "+Pe("table:table-cell",Pe("text:p",E,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Fn(f),f.ods=l;var m=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ot],u=mc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=mc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(SE().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(r(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function U3(e,a){if(a.bookType=="fods")return uy(e,a);var t=Uh(),r="",s=[],i=[];return r="mimetype",sa(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",sa(t,r,uy(e,a)),s.push([r,"text/xml"]),i.push([r,"ContentFile"]),r="styles.xml",sa(t,r,GP(e,a)),s.push([r,"text/xml"]),i.push([r,"StylesFile"]),r="meta.xml",sa(t,r,ot+SE()),s.push([r,"text/xml"]),i.push([r,"MetadataFile"]),r="manifest.rdf",sa(t,r,b5(i)),s.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",sa(t,r,y5(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function bi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function xx(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ra(In(e))}function XP(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):wr(ms(e))}function qP(e,a){e:for(var t=0;t<=e.length-a.length;++t){for(var r=0;r<a.length;++r)if(e[t+r]!=a[r])continue e;return!0}return!1}function An(e){var a=e.reduce(function(s,i){return s+i.length},0),t=new Uint8Array(a),r=0;return e.forEach(function(s){t.set(s,r),r+=s.length}),t}function fy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function YP(e,a){for(var t=(e[a+15]&127)<<7|e[a+14]>>1,r=e[a+14]&1,s=a+13;s>=a;--s)r=r*256+e[s];return(e[a+15]&128?-r:r)*Math.pow(10,t-6176)}function WP(e,a,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,r-6176);e[a+15]|=r>>7,e[a+14]|=(r&127)<<1;for(var i=0;s>=1;++i,s/=256)e[a+i]=s&255;e[a+15]|=t>=0?0:128}function wc(e,a){var t=a?a[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return a&&(a[0]=t),r}function Na(e){var a=new Uint8Array(7);a[0]=e&127;var t=1;e:if(e>127){if(a[t-1]|=128,a[t]=e>>7&127,++t,e<=16383||(a[t-1]|=128,a[t]=e>>14&127,++t,e<=2097151)||(a[t-1]|=128,a[t]=e>>21&127,++t,e<=268435455)||(a[t-1]|=128,a[t]=e/256>>>21&127,++t,e<=34359738367)||(a[t-1]|=128,a[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;a[t-1]|=128,a[t]=e/16777216>>>21&127,++t}return a.slice(0,t)}function et(e){var a=0,t=e[a]&127;e:if(e[a++]>=128){if(t|=(e[a]&127)<<7,e[a++]<128||(t|=(e[a]&127)<<14,e[a++]<128)||(t|=(e[a]&127)<<21,e[a++]<128))break e;t|=(e[a]&127)<<28}return t}function ga(e){for(var a=[],t=[0];t[0]<e.length;){var r=t[0],s=wc(e,t),i=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(i){case 0:{for(var c=t[0];e[t[0]++]>=128;);l=e.slice(c,t[0])}break;case 5:o=4,l=e.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,l=e.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=wc(e,t),l=e.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(r))}var u={data:l,type:i};a[s]==null?a[s]=[u]:a[s].push(u)}return a}function Tt(e){var a=[];return e.forEach(function(t,r){t.forEach(function(s){s.data&&(a.push(Na(r*8+s.type)),s.type==2&&a.push(Na(s.data.length)),a.push(s.data))})}),An(a)}function up(e,a){return(e==null?void 0:e.map(function(t){return a(t.data)}))||[]}function Rr(e){for(var a,t=[],r=[0];r[0]<e.length;){var s=wc(e,r),i=ga(e.slice(r[0],r[0]+s));r[0]+=s;var o={id:et(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=ga(l.data),u=et(c[3][0].data);o.messages.push({meta:c,data:e.slice(r[0],r[0]+u)}),r[0]+=u}),(a=i[3])!=null&&a[0]&&(o.merge=et(i[3][0].data)>>>0>0),t.push(o)}return t}function Ui(e){var a=[];return e.forEach(function(t){var r=[];r[1]=[{data:Na(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Na(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Na(o.data.length)}],r[2].push({data:Tt(o.meta),type:2})});var i=Tt(r);a.push(Na(i.length)),a.push(i),s.forEach(function(o){return a.push(o)})}),An(a)}function KP(e,a){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=wc(a,t),s=[];t[0]<a.length;){var i=a[t[0]]&3;if(i==0){var o=a[t[0]++]>>2;if(o<60)++o;else{var l=o-59;o=a[t[0]],l>1&&(o|=a[t[0]+1]<<8),l>2&&(o|=a[t[0]+2]<<16),l>3&&(o|=a[t[0]+3]<<24),o>>>=0,o++,t[0]+=l}s.push(a.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var c=0,u=0;if(i==1?(u=(a[t[0]]>>2&7)+4,c=(a[t[0]++]&224)<<3,c|=a[t[0]++]):(u=(a[t[0]++]>>2)+1,i==2?(c=a[t[0]]|a[t[0]+1]<<8,t[0]+=2):(c=(a[t[0]]|a[t[0]+1]<<8|a[t[0]+2]<<16|a[t[0]+3]<<24)>>>0,t[0]+=4)),s=[An(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=An(s);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function Dr(e){for(var a=[],t=0;t<e.length;){var r=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,a.push(KP(r,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return An(a)}function Li(e){for(var a=[],t=0;t<e.length;){var r=Math.min(e.length-t,268435455),s=new Uint8Array(4);a.push(s);var i=Na(r),o=i.length;a.push(i),r<=60?(o++,a.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,a.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,a.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,a.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,a.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),a.push(e.slice(t,t+r)),o+=r,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,t+=r}return An(a)}function JP(e,a,t,r){var s=bi(e),i=s.getUint32(4,!0),o=(r>1?12:8)+fy(i&(r>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);i&512&&(l=s.getUint32(o,!0),o+=4),o+=fy(i&(r>1?12288:4096))*4,i&16&&(c=s.getUint32(o,!0),o+=4),i&32&&(u=s.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:a[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:t[l]};else if(c>-1)f={t:"s",v:a[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function ZP(e,a,t){var r=bi(e),s=r.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=YP(e,i),i+=16),s&2&&(u=r.getFloat64(i,!0),i+=8),s&4&&(d.setTime(d.getTime()+r.getFloat64(i,!0)*1e3),i+=8),s&8&&(l=r.getUint32(i,!0),i+=4),s&16&&(o=r.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:a[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:t[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function Of(e,a){var t=new Uint8Array(32),r=bi(t),s=12,i=0;switch(t[0]=5,e.t){case"n":t[1]=2,WP(t,s,e.v),i|=1,s+=16;break;case"b":t[1]=6,r.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(a.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,r.setUint32(s,a.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,i,!0),t.slice(0,s)}function If(e,a){var t=new Uint8Array(32),r=bi(t),s=12,i=0;switch(t[0]=3,e.t){case"n":t[2]=2,r.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":t[2]=6,r.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(a.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,r.setUint32(s,a.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,i,!0),t.slice(0,s)}function QP(e,a,t){switch(e[0]){case 0:case 1:case 2:case 3:return JP(e,a,t,e[0]);case 5:return ZP(e,a,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Bt(e){var a=ga(e);return wc(a[1][0].data)}function my(e,a){var t=ga(a.data),r=et(t[1][0].data),s=t[3],i=[];return(s||[]).forEach(function(o){var l=ga(o.data),c=et(l[1][0].data)>>>0;switch(r){case 1:i[c]=xx(l[3][0].data);break;case 8:{var u=e[Bt(l[9][0].data)][0],d=ga(u.data),f=e[Bt(d[1][0].data)][0],m=et(f.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var x=ga(f.data);i[c]=x[3].map(function(h){return xx(h.data)}).join("")}break}}),i}function eO(e,a){var t,r,s,i,o,l,c,u,d,f,m,x,h,g,p=ga(e),v=et(p[1][0].data)>>>0,w=et(p[2][0].data)>>>0,b=((r=(t=p[8])==null?void 0:t[0])==null?void 0:r.data)&&et(p[8][0].data)>0||!1,y,j;if((i=(s=p[7])==null?void 0:s[0])!=null&&i.data&&a!=0)y=(l=(o=p[7])==null?void 0:o[0])==null?void 0:l.data,j=(u=(c=p[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=p[4])==null?void 0:d[0])!=null&&f.data&&a!=1)y=(x=(m=p[4])==null?void 0:m[0])==null?void 0:x.data,j=(g=(h=p[3])==null?void 0:h[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(a," cell storage");for(var A=b?4:1,E=bi(y),F=[],k=0;k<y.length/2;++k){var P=E.getUint16(k*2,!0);P<65535&&F.push([k,P])}if(F.length!=w)throw"Expected ".concat(w," cells, found ").concat(F.length);var R=[];for(k=0;k<F.length-1;++k)R[F[k][0]]=j.subarray(F[k][1]*A,F[k+1][1]*A);return F.length>=1&&(R[F[F.length-1][0]]=j.subarray(F[F.length-1][1]*A)),{R:v,cells:R}}function aO(e,a){var t,r=ga(a.data),s=(t=r==null?void 0:r[7])!=null&&t[0]?et(r[7][0].data)>>>0>0?1:0:-1,i=up(r[5],function(o){return eO(o,s)});return{nrows:et(r[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function tO(e,a,t){var r,s=ga(a.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(et(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(et(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=ra(i);var o=ga(s[4][0].data),l=my(e,e[Bt(o[4][0].data)][0]),c=(r=o[17])!=null&&r[0]?my(e,e[Bt(o[17][0].data)][0]):[],u=ga(o[3][0].data),d=0;u[1].forEach(function(f){var m=ga(f.data),x=e[Bt(m[2][0].data)][0],h=et(x.meta[1][0].data);if(h!=6002)throw new Error("6001 unexpected reference to ".concat(h));var g=aO(e,x);g.data.forEach(function(p,v){p.forEach(function(w,b){var y=Ye({r:d+v,c:b}),j=QP(w,l,c);j&&(t[y]=j)})}),d+=g.nrows})}function rO(e,a){var t=ga(a.data),r={"!ref":"A1"},s=e[Bt(t[2][0].data)],i=et(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return tO(e,s[0],r),r}function sO(e,a){var t,r=ga(a.data),s={name:(t=r[1])!=null&&t[0]?xx(r[1][0].data):"",sheets:[]},i=up(r[2],Bt);return i.forEach(function(o){e[o].forEach(function(l){var c=et(l.meta[1][0].data);c==6e3&&s.sheets.push(rO(e,l))})}),s}function nO(e,a){var t=pp(),r=ga(a.data),s=up(r[1],Bt);if(s.forEach(function(i){e[i].forEach(function(o){var l=et(o.meta[1][0].data);if(l==2){var c=sO(e,o);c.sheets.forEach(function(u,d){gp(t,u,d==0?c.name:c.name+"_"+d,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Mf(e){var a,t,r,s,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Dr(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=Rr(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(r=(t=(a=i==null?void 0:i[1])==null?void 0:a[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:s[0].data)&&et(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(u){var d=et(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return nO(i,l)}function iO(e,a,t){var r,s,i,o;if(!((r=e[6])!=null&&r[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&et(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=bi(e[7][0].data),d=0,f=[],m=bi(e[4][0].data),x=0,h=[],g=0;g<a.length;++g){if(a[g]==null){u.setUint16(g*2,65535,!0),m.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),m.setUint16(g*2,x,!0);var p,v;switch(typeof a[g]){case"string":p=Of({t:"s",v:a[g]},t),v=If({t:"s",v:a[g]},t);break;case"number":p=Of({t:"n",v:a[g]},t),v=If({t:"n",v:a[g]},t);break;case"boolean":p=Of({t:"b",v:a[g]},t),v=If({t:"b",v:a[g]},t);break;default:throw new Error("Unsupported value "+a[g])}f.push(p),d+=p.length,h.push(v),x+=v.length,++c}for(e[2][0].data=Na(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),m.setUint16(g*2,65535,!0);return e[6][0].data=An(f),e[3][0].data=An(h),c}function oO(e,a){if(!a||!a.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=fr(t["!ref"]);r.s.r=r.s.c=0;var s=!1;r.e.c>9&&(s=!0,r.e.c=9),r.e.r>49&&(s=!0,r.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ra(r)));var i=q0(t,{range:r,header:1}),o=["~Sh33tJ5~"];i.forEach(function(L){return L.forEach(function(V){typeof V=="string"&&o.push(V)})});var l={},c=[],u=Ge.read(a.numbers,{type:"base64"});u.FileIndex.map(function(L,V){return[L,u.FullPaths[V]]}).forEach(function(L){var V=L[0],O=L[1];if(V.type==2&&V.name.match(/\.iwa/)){var de=V.content,me=Dr(de),ae=Rr(me);ae.forEach(function(ce){c.push(ce.id),l[ce.id]={deps:[],location:O,type:et(ce.messages[0].meta[1][0].data)}})}}),c.sort(function(L,V){return L-V});var d=c.filter(function(L){return L>1}).map(function(L){return[L,Na(L)]});u.FileIndex.map(function(L,V){return[L,u.FullPaths[V]]}).forEach(function(L){var V=L[0];if(L[1],!!V.name.match(/\.iwa/)){var O=Rr(Dr(V.content));O.forEach(function(de){de.messages.forEach(function(me){d.forEach(function(ae){de.messages.some(function(ce){return et(ce.meta[1][0].data)!=11006&&qP(ce.data,ae[1])})&&l[ae[0]].deps.push(de.id)})})})}});for(var f=Ge.find(u,l[1].location),m=Rr(Dr(f.content)),x,h=0;h<m.length;++h){var g=m[h];g.id==1&&(x=g)}var p=Bt(ga(x.messages[0].data)[1][0].data);for(f=Ge.find(u,l[p].location),m=Rr(Dr(f.content)),h=0;h<m.length;++h)g=m[h],g.id==p&&(x=g);for(p=Bt(ga(x.messages[0].data)[2][0].data),f=Ge.find(u,l[p].location),m=Rr(Dr(f.content)),h=0;h<m.length;++h)g=m[h],g.id==p&&(x=g);for(p=Bt(ga(x.messages[0].data)[2][0].data),f=Ge.find(u,l[p].location),m=Rr(Dr(f.content)),h=0;h<m.length;++h)g=m[h],g.id==p&&(x=g);var v=ga(x.messages[0].data);{v[6][0].data=Na(r.e.r+1),v[7][0].data=Na(r.e.c+1);var w=Bt(v[46][0].data),b=Ge.find(u,l[w].location),y=Rr(Dr(b.content));{for(var j=0;j<y.length&&y[j].id!=w;++j);if(y[j].id!=w)throw"Bad ColumnRowUIDMapArchive";var A=ga(y[j].messages[0].data);A[1]=[],A[2]=[],A[3]=[];for(var E=0;E<=r.e.c;++E){var F=[];F[1]=F[2]=[{type:0,data:Na(E+420690)}],A[1].push({type:2,data:Tt(F)}),A[2].push({type:0,data:Na(E)}),A[3].push({type:0,data:Na(E)})}A[4]=[],A[5]=[],A[6]=[];for(var k=0;k<=r.e.r;++k)F=[],F[1]=F[2]=[{type:0,data:Na(k+726270)}],A[4].push({type:2,data:Tt(F)}),A[5].push({type:0,data:Na(k)}),A[6].push({type:0,data:Na(k)});y[j].messages[0].data=Tt(A)}b.content=Li(Ui(y)),b.size=b.content.length,delete v[46];var P=ga(v[4][0].data);{P[7][0].data=Na(r.e.r+1);var R=ga(P[1][0].data),_=Bt(R[2][0].data);b=Ge.find(u,l[_].location),y=Rr(Dr(b.content));{if(y[0].id!=_)throw"Bad HeaderStorageBucket";var Q=ga(y[0].messages[0].data);for(k=0;k<i.length;++k){var C=ga(Q[2][0].data);C[1][0].data=Na(k),C[4][0].data=Na(i[k].length),Q[2][k]={type:Q[2][0].type,data:Tt(C)}}y[0].messages[0].data=Tt(Q)}b.content=Li(Ui(y)),b.size=b.content.length;var z=Bt(P[2][0].data);b=Ge.find(u,l[z].location),y=Rr(Dr(b.content));{if(y[0].id!=z)throw"Bad HeaderStorageBucket";for(Q=ga(y[0].messages[0].data),E=0;E<=r.e.c;++E)C=ga(Q[2][0].data),C[1][0].data=Na(E),C[4][0].data=Na(r.e.r+1),Q[2][E]={type:Q[2][0].type,data:Tt(C)};y[0].messages[0].data=Tt(Q)}b.content=Li(Ui(y)),b.size=b.content.length;var S=Bt(P[4][0].data);(function(){for(var L=Ge.find(u,l[S].location),V=Rr(Dr(L.content)),O,de=0;de<V.length;++de){var me=V[de];me.id==S&&(O=me)}var ae=ga(O.messages[0].data);{ae[3]=[];var ce=[];o.forEach(function(I,q){ce[1]=[{type:0,data:Na(q)}],ce[2]=[{type:0,data:Na(1)}],ce[3]=[{type:2,data:XP(I)}],ae[3].push({type:2,data:Tt(ce)})})}O.messages[0].data=Tt(ae);var W=Ui(V),le=Li(W);L.content=le,L.size=L.content.length})();var D=ga(P[3][0].data);{var H=D[1][0];delete D[2];var U=ga(H.data);{var B=Bt(U[2][0].data);(function(){for(var L=Ge.find(u,l[B].location),V=Rr(Dr(L.content)),O,de=0;de<V.length;++de){var me=V[de];me.id==B&&(O=me)}var ae=ga(O.messages[0].data);{delete ae[6],delete D[7];var ce=new Uint8Array(ae[5][0].data);ae[5]=[];for(var W=0,le=0;le<=r.e.r;++le){var I=ga(ce);W+=iO(I,i[le],o),I[1][0].data=Na(le),ae[5].push({data:Tt(I),type:2})}ae[1]=[{type:0,data:Na(r.e.c+1)}],ae[2]=[{type:0,data:Na(r.e.r+1)}],ae[3]=[{type:0,data:Na(W)}],ae[4]=[{type:0,data:Na(r.e.r+1)}]}O.messages[0].data=Tt(ae);var q=Ui(V),ne=Li(q);L.content=ne,L.size=L.content.length})()}H.data=Tt(U)}P[3][0].data=Tt(D)}v[4][0].data=Tt(P)}x.messages[0].data=Tt(v);var X=Ui(m),T=Li(X);return f.content=T,f.size=f.content.length,u}function L3(e){return function(t){for(var r=0;r!=e.length;++r){var s=e[r];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function fp(e){L3([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function mp(e){L3([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function lO(e){return da.WS.indexOf(e)>-1?"sheet":e==da.CS?"chart":e==da.DS?"dialog":e==da.MS?"macro":e&&e.length?e:"sheet"}function cO(e,a){if(!e)return 0;try{e=a.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,lO(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function dO(e,a,t,r,s,i,o,l,c,u,d,f){try{i[r]=Gl(Er(e,t,!0),a);var m=ct(e,a),x;switch(l){case"sheet":x=RD(m,a,s,c,i[r],u,d,f);break;case"chart":if(x=DD(m,a,s,c,i[r],u,d,f),!x||!x["!drawel"])break;var h=Sl(x["!drawel"].Target,a),g=hc(h),p=v_(Er(e,h,!0),Gl(Er(e,g,!0),h)),v=Sl(p,h),w=hc(v);x=iD(Er(e,v,!0),v,c,Gl(Er(e,w,!0),v),u,x);break;case"macro":x=PD(m,a,s,c,i[r],u,d,f);break;case"dialog":x=OD(m,a,s,c,i[r],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[r]=x;var b=[];i&&i[r]&&at(i[r]).forEach(function(y){var j="";if(i[r][y].Type==da.CMNT){j=Sl(i[r][y].Target,a);var A=LD(ct(e,j,!0),j,c);if(!A||!A.length)return;Z1(x,A,!1)}i[r][y].Type==da.TCMNT&&(j=Sl(i[r][y].Target,a),b=b.concat(w_(ct(e,j,!0),c)))}),b&&b.length&&Z1(x,b,!0,c.people||[])}catch(y){if(c.WTF)throw y}}function _r(e){return e.charAt(0)=="/"?e.slice(1):e}function uO(e,a){if(Qo(),a=a||{},fp(a),Pr(e,"META-INF/manifest.xml")||Pr(e,"objectdata.xml"))return cy(e,a);if(Pr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Mf<"u"){if(e.FileIndex)return Mf(e);var t=Ge.utils.cfb_new();return v1(e).forEach(function(C){sa(t,C,ET(e,C))}),Mf(t)}throw new Error("Unsupported NUMBERS file")}if(!Pr(e,"[Content_Types].xml"))throw Pr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Pr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=v1(e),s=h5(Er(e,"[Content_Types].xml")),i=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",ct(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!ct(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!a.bookSheets&&!a.bookProps){if(Xl=[],s.sst)try{Xl=UD(ct(e,_r(s.sst)),s.sst,a)}catch(C){if(a.WTF)throw C}a.cellStyles&&s.themes.length&&(c=MD(Er(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],a)),s.style&&(u=ID(ct(e,_r(s.style)),s.style,c,a))}s.links.map(function(C){try{var z=Gl(Er(e,hc(_r(C))),C);return zD(ct(e,_r(C)),z,C,a)}catch{}});var d=AD(ct(e,_r(s.workbooks[0])),s.workbooks[0],a),f={},m="";s.coreprops.length&&(m=ct(e,_r(s.coreprops[0]),!0),m&&(f=CE(m)),s.extprops.length!==0&&(m=ct(e,_r(s.extprops[0]),!0),m&&E5(m,f,a)));var x={};(!a.bookSheets||a.bookProps)&&s.custprops.length!==0&&(m=Er(e,_r(s.custprops[0]),!0),m&&(x=N5(m,a)));var h={};if((a.bookSheets||a.bookProps)&&(d.Sheets?o=d.Sheets.map(function(z){return z.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),a.bookProps&&(h.Props=f,h.Custprops=x),a.bookSheets&&typeof o<"u"&&(h.SheetNames=o),a.bookSheets?h.SheetNames:a.bookProps))return h;o={};var g={};a.bookDeps&&s.calcchain&&(g=BD(ct(e,_r(s.calcchain)),s.calcchain));var p=0,v={},w,b;{var y=d.Sheets;f.Worksheets=y.length,f.SheetNames=[];for(var j=0;j!=y.length;++j)f.SheetNames[j]=y[j].name}var A=i?"bin":"xml",E=s.workbooks[0].lastIndexOf("/"),F=(s.workbooks[0].slice(0,E+1)+"_rels/"+s.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Pr(e,F)||(F="xl/_rels/workbook."+A+".rels");var k=Gl(Er(e,F,!0),F.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(a.xlmeta=$D(ct(e,_r(s.metadata[0])),s.metadata[0],a)),(s.people||[]).length>=1&&(a.people=k_(ct(e,_r(s.people[0])),a)),k&&(k=cO(k,d.Sheets));var P=ct(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(p=0;p!=f.Worksheets;++p){var R="sheet";if(k&&k[p]?(w="xl/"+k[p][1].replace(/[\/]?xl\//,""),Pr(e,w)||(w=k[p][1]),Pr(e,w)||(w=F.replace(/_rels\/.*$/,"")+k[p][1]),R=k[p][2]):(w="xl/worksheets/sheet"+(p+1-P)+"."+A,w=w.replace(/sheet0\./,"sheet.")),b=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),a&&a.sheets!=null)switch(typeof a.sheets){case"number":if(p!=a.sheets)continue e;break;case"string":if(f.SheetNames[p].toLowerCase()!=a.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(a.sheets)){for(var _=!1,Q=0;Q!=a.sheets.length;++Q)typeof a.sheets[Q]=="number"&&a.sheets[Q]==p&&(_=1),typeof a.sheets[Q]=="string"&&a.sheets[Q].toLowerCase()==f.SheetNames[p].toLowerCase()&&(_=1);if(!_)continue e}}dO(e,w,b,f.SheetNames[p],p,v,o,R,a,d,c,u)}return h={Directory:s,Workbook:d,Props:f,Custprops:x,Deps:g,Sheets:o,SheetNames:f.SheetNames,Strings:Xl,Styles:u,Themes:c,SSF:Ba(qe)},a&&a.bookFiles&&(e.files?(h.keys=r,h.files=e.files):(h.keys=[],h.files={},e.FullPaths.forEach(function(C,z){C=C.replace(/^Root Entry[\/]/,""),h.keys.push(C),h.files[C]=e.FileIndex[z]}))),a&&a.bookVBA&&(s.vba.length>0?h.vbaraw=ct(e,_r(s.vba[0]),!0):s.defaults&&s.defaults.bin===A_&&(h.vbaraw=ct(e,"xl/vbaProject.bin",!0))),h}function fO(e,a){var t=a||{},r="Workbook",s=Ge.find(e,r);try{if(r="/!DataSpaces/Version",s=Ge.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if($F(s.content),r="/!DataSpaces/DataSpaceMap",s=Ge.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=HF(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ge.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=GF(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ge.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);qF(s.content)}catch{}if(r="/EncryptionInfo",s=Ge.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=YF(s.content);if(r="/EncryptedPackage",s=Ge.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,t.password||"",t);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function mO(e,a){return a.bookType=="ods"?U3(e,a):a.bookType=="numbers"?oO(e,a):a.bookType=="xlsb"?xO(e,a):hO(e,a)}function xO(e,a){xo=1024,e&&!e.SSF&&(e.SSF=Ba(qe)),e&&e.SSF&&(Qo(),bu(e.SSF),a.revssf=Eu(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,ql?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo);var t=a.bookType=="xlsb"?"bin":"xml",r=f3.indexOf(a.bookType)>-1,s=Zh();mp(a=a||{});var i=Uh(),o="",l=0;if(a.cellXfs=[],Un(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",sa(i,o,TE(e.Props,a)),s.coreprops.push(o),Sa(a.rels,2,o,da.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,sa(i,o,AE(e.Props)),s.extprops.push(o),Sa(a.rels,3,o,da.EXT_PROPS),e.Custprops!==e.Props&&at(e.Custprops||{}).length>0&&(o="docProps/custom.xml",sa(i,o,RE(e.Custprops)),s.custprops.push(o),Sa(a.rels,4,o,da.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+t,sa(i,o,HD(l-1,o,a,e,d)),s.sheets.push(o),Sa(a.wbrels,-1,"worksheets/sheet"+l+"."+t,da.WS[0])}if(f){var x=f["!comments"],h=!1,g="";x&&x.length>0&&(g="xl/comments"+l+"."+t,sa(i,g,qD(x,g)),s.comments.push(g),Sa(d,-1,"../comments"+l+"."+t,da.CMNT),h=!0),f["!legacy"]&&h&&sa(i,"xl/drawings/vmlDrawing"+l+".vml",d3(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&sa(i,hc(o),So(d))}return a.Strings!=null&&a.Strings.length>0&&(o="xl/sharedStrings."+t,sa(i,o,XD(a.Strings,o,a)),s.strs.push(o),Sa(a.wbrels,-1,"sharedStrings."+t,da.SST)),o="xl/workbook."+t,sa(i,o,VD(e,o)),s.workbooks.push(o),Sa(a.rels,1,o,da.WB),o="xl/theme/theme1.xml",sa(i,o,sp(e.Themes,a)),s.themes.push(o),Sa(a.wbrels,-1,"theme/theme1.xml",da.THEME),o="xl/styles."+t,sa(i,o,GD(e,o,a)),s.styles.push(o),Sa(a.wbrels,-1,"styles."+t,da.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",sa(i,o,e.vbaraw),s.vba.push(o),Sa(a.wbrels,-1,"vbaProject.bin",da.VBA)),o="xl/metadata."+t,sa(i,o,YD(o)),s.metadata.push(o),Sa(a.wbrels,-1,"metadata."+t,da.XLMETA),sa(i,"[Content_Types].xml",jE(s,a)),sa(i,"_rels/.rels",So(a.rels)),sa(i,"xl/_rels/workbook."+t+".rels",So(a.wbrels)),delete a.revssf,delete a.ssf,i}function hO(e,a){xo=1024,e&&!e.SSF&&(e.SSF=Ba(qe)),e&&e.SSF&&(Qo(),bu(e.SSF),a.revssf=Eu(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,ql?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo);var t="xml",r=f3.indexOf(a.bookType)>-1,s=Zh();mp(a=a||{});var i=Uh(),o="",l=0;if(a.cellXfs=[],Un(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",sa(i,o,TE(e.Props,a)),s.coreprops.push(o),Sa(a.rels,2,o,da.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,sa(i,o,AE(e.Props)),s.extprops.push(o),Sa(a.rels,3,o,da.EXT_PROPS),e.Custprops!==e.Props&&at(e.Custprops||{}).length>0&&(o="docProps/custom.xml",sa(i,o,RE(e.Custprops)),s.custprops.push(o),Sa(a.rels,4,o,da.CUST_PROPS));var d=["SheetJ5"];for(a.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],x=(m||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+l+"."+t,sa(i,o,k3(l-1,a,e,f)),s.sheets.push(o),Sa(a.wbrels,-1,"worksheets/sheet"+l+"."+t,da.WS[0])}if(m){var h=m["!comments"],g=!1,p="";if(h&&h.length>0){var v=!1;h.forEach(function(w){w[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(p="xl/threadedComments/threadedComment"+l+"."+t,sa(i,p,E_(h,d,a)),s.threadedcomments.push(p),Sa(f,-1,"../threadedComments/threadedComment"+l+"."+t,da.TCMNT)),p="xl/comments"+l+"."+t,sa(i,p,u3(h)),s.comments.push(p),Sa(f,-1,"../comments"+l+"."+t,da.CMNT),g=!0}m["!legacy"]&&g&&sa(i,"xl/drawings/vmlDrawing"+l+".vml",d3(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&sa(i,hc(o),So(f))}return a.Strings!=null&&a.Strings.length>0&&(o="xl/sharedStrings."+t,sa(i,o,ZE(a.Strings,a)),s.strs.push(o),Sa(a.wbrels,-1,"sharedStrings."+t,da.SST)),o="xl/workbook."+t,sa(i,o,T3(e)),s.workbooks.push(o),Sa(a.rels,1,o,da.WB),o="xl/theme/theme1.xml",sa(i,o,sp(e.Themes,a)),s.themes.push(o),Sa(a.wbrels,-1,"theme/theme1.xml",da.THEME),o="xl/styles."+t,sa(i,o,i3(e,a)),s.styles.push(o),Sa(a.wbrels,-1,"styles."+t,da.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",sa(i,o,e.vbaraw),s.vba.push(o),Sa(a.wbrels,-1,"vbaProject.bin",da.VBA)),o="xl/metadata."+t,sa(i,o,c3()),s.metadata.push(o),Sa(a.wbrels,-1,"metadata."+t,da.XLMETA),d.length>1&&(o="xl/persons/person.xml",sa(i,o,N_(d)),s.people.push(o),Sa(a.wbrels,-1,"persons/person.xml",da.PEOPLE)),sa(i,"[Content_Types].xml",jE(s,a)),sa(i,"_rels/.rels",So(a.rels)),sa(i,"xl/_rels/workbook."+t+".rels",So(a.wbrels)),delete a.revssf,delete a.ssf,i}function xp(e,a){var t="";switch((a||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Fr(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(a&&a.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function pO(e,a){return Ge.find(e,"EncryptedPackage")?fO(e,a):R3(e,a)}function gO(e,a){var t,r=e,s=a||{};return s.type||(s.type=la&&Buffer.isBuffer(e)?"buffer":"base64"),t=eE(r,s),uO(t,s)}function B3(e,a){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return fx(e.slice(t),a);default:break e}return $o.to_workbook(e,a)}function yO(e,a){var t="",r=xp(e,a);switch(a.type){case"base64":t=Fr(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=pi(e);break;default:throw new Error("Unrecognized type "+a.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=Ra(t)),a.type="binary",B3(t,a)}function vO(e,a){var t=e;return a.type=="base64"&&(t=Fr(t)),t=rx.utils.decode(1200,t.slice(2),"str"),a.type="binary",B3(t,a)}function bO(e){return e.match(/[^\x00-\x7F]/)?ms(e):e}function Uf(e,a,t,r){return r?(t.type="string",$o.to_workbook(e,t)):$o.to_workbook(a,t)}function hx(e,a){Dh();var t=a||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return hx(new Uint8Array(e),(t=Ba(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,s=[0,0,0,0],i=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),To={},t.dateNF&&(To.dateNF=t.dateNF),t.type||(t.type=la&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=la?"buffer":"binary",r=xT(e),typeof Uint8Array<"u"&&!la&&(t.type="array")),t.type=="string"&&(i=!0,t.type="binary",t.codepage=65001,r=bO(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return t=Ba(t),t.type="array",hx(Ph(r),t)}switch((s=xp(r,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return pO(Ge.read(r,t),t);break;case 9:if(s[1]<=8)return R3(r,t);break;case 60:return fx(r,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return jF(r,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return KE.to_workbook(r,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?gO(r,t):Uf(e,r,t,i);case 239:return s[3]===60?fx(r,t):Uf(e,r,t,i);case 255:if(s[1]===254)return vO(r,t);if(s[1]===0&&s[2]===2&&s[3]===0)return ii.to_workbook(r,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ii.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return ux.to_workbook(r,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return r3.to_workbook(r,t);break;case 10:case 13:case 32:return yO(r,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return NF.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?ux.to_workbook(r,t):Uf(e,r,t,i)}function z3(e,a){switch(a.type){case"base64":case"binary":break;case"buffer":case"array":a.type="";break;case"file":return Lc(a.file,Ge.write(e,{type:la?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");default:throw new Error("Unrecognized type "+a.type)}return Ge.write(e,a)}function wO(e,a){var t=Ba(a||{}),r=mO(e,t);return EO(r,t)}function EO(e,a){var t={},r=la?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(a.compression&&(t.compression="DEFLATE"),a.password)t.type=r;else switch(a.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+a.type)}var s=e.FullPaths?Ge.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!a.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(a.type=="binary"||a.type=="base64")return s;s=new Uint8Array(vu(s))}return a.password&&typeof encrypt_agile<"u"?z3(encrypt_agile(s,a.password),a):a.type==="file"?Lc(a.file,s):a.type=="string"?Ra(s):s}function kO(e,a){var t=a||{},r=bP(e,t);return z3(r,t)}function ds(e,a,t){t||(t="");var r=t+e;switch(a.type){case"base64":return dc(ms(r));case"binary":return ms(r);case"string":return e;case"file":return Lc(a.file,r,"utf8");case"buffer":return la?qs(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):ds(r,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type)}function NO(e,a){switch(a.type){case"base64":return dc(e);case"binary":return e;case"string":return e;case"file":return Lc(a.file,e,"binary");case"buffer":return la?qs(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type)}function Sd(e,a){switch(a.type){case"string":case"base64":case"binary":for(var t="",r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return a.type=="base64"?dc(t):a.type=="string"?Ra(t):t;case"file":return Lc(a.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+a.type)}}function $3(e,a){Dh(),pD(e);var t=Ba(a||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=$3(e,t);return t.type="array",vu(r)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return ds(mP(e,t),t);case"slk":case"sylk":return ds(WE.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return ds(P3(e.Sheets[e.SheetNames[s]],t),t);case"txt":return NO(V3(e.Sheets[e.SheetNames[s]],t),t);case"csv":return ds(hp(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return ds(KE.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return Sd(ux.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return ds($o.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return ds(r3.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return ds(JE.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return ds(U3(e,t),t);case"wk1":return Sd(ii.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return Sd(ii.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Sd(D3(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),kO(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return wO(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function jO(e){if(!e.bookType){var a={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=a[e.bookType]||e.bookType}}function gs(e,a,t){var r={};return r.type="file",r.file=a,jO(r),$3(e,r)}function SO(e,a,t,r,s,i,o,l){var c=nt(t),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!o||e[t])for(var x=a.s.c;x<=a.e.c;++x){var h=o?e[t][x]:e[r[x]+c];if(h===void 0||h.t===void 0){if(u===void 0)continue;i[x]!=null&&(m[i[x]]=u);continue}var g=h.v;switch(h.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+h.t)}if(i[x]!=null){if(g==null)if(h.t=="e"&&g===null)m[i[x]]=null;else if(u!==void 0)m[i[x]]=u;else if(d&&g===null)m[i[x]]=null;else continue;else m[i[x]]=d&&(h.t!=="n"||h.t==="n"&&l.rawNumbers!==!1)?g:Hs(h,g,l);g!=null&&(f=!1)}}return{row:m,isempty:f}}function q0(e,a){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=a||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof d){case"string":c=pa(d);break;case"number":c=pa(e["!ref"]),c.s.r=d;break;default:c=d}r>0&&(s=0);var f=nt(c.s.r),m=[],x=[],h=0,g=0,p=Array.isArray(e),v=c.s.r,w=0,b={};p&&!e[v]&&(e[v]=[]);var y=u.skipHidden&&e["!cols"]||[],j=u.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(y[w]||{}).hidden)switch(m[w]=Wa(w),t=p?e[v][w]:e[m[w]+f],r){case 1:i[w]=w-c.s.c;break;case 2:i[w]=m[w];break;case 3:i[w]=u.header[w-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),l=o=Hs(t,null,u),g=b[o]||0,!g)b[o]=1;else{do l=o+"_"+g++;while(b[l]);b[o]=g,b[l]=1}i[w]=l}for(v=c.s.r+s;v<=c.e.r;++v)if(!(j[v]||{}).hidden){var A=SO(e,c,v,m,r,i,p,u);(A.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(x[h++]=A.row)}return x.length=h,x}var xy=/"/g;function CO(e,a,t,r,s,i,o,l){for(var c=!0,u=[],d="",f=nt(t),m=a.s.c;m<=a.e.c;++m)if(r[m]){var x=l.dense?(e[t]||[])[m]:e[r[m]+f];if(x==null)d="";else if(x.v!=null){c=!1,d=""+(l.rawNumbers&&x.t=="n"?x.v:Hs(x,null,l));for(var h=0,g=0;h!==d.length;++h)if((g=d.charCodeAt(h))===s||g===i||g===34||l.forceQuotes){d='"'+d.replace(xy,'""')+'"';break}d=="ID"&&(d='"ID"')}else x.f!=null&&!x.F?(c=!1,d="="+x.f,d.indexOf(",")>=0&&(d='"'+d.replace(xy,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function hp(e,a){var t=[],r=a??{};if(e==null||e["!ref"]==null)return"";var s=pa(e["!ref"]),i=r.FS!==void 0?r.FS:",",o=i.charCodeAt(0),l=r.RS!==void 0?r.RS:`
`,c=l.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];r.dense=Array.isArray(e);for(var m=r.skipHidden&&e["!cols"]||[],x=r.skipHidden&&e["!rows"]||[],h=s.s.c;h<=s.e.c;++h)(m[h]||{}).hidden||(f[h]=Wa(h));for(var g=0,p=s.s.r;p<=s.e.r;++p)(x[p]||{}).hidden||(d=CO(e,s,p,f,o,c,i,r),d!=null&&(r.strip&&(d=d.replace(u,"")),(d||r.blankrows!==!1)&&t.push((g++?l:"")+d)));return delete r.dense,t.join("")}function V3(e,a){a||(a={}),a.FS="	",a.RS=`
`;var t=hp(e,a);return t}function TO(e){var a="",t,r="";if(e==null||e["!ref"]==null)return[];var s=pa(e["!ref"]),i="",o=[],l,c=[],u=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=Wa(l);for(var d=s.s.r;d<=s.e.r;++d)for(i=nt(d),l=s.s.c;l<=s.e.c;++l)if(a=o[l]+i,t=u?(e[d]||[])[l]:e[a],r="",t!==void 0){if(t.F!=null){if(a=t.F,!t.f)continue;r=t.f,a.indexOf(":")==-1&&(a=a+":"+a)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}c[c.length]=a+"="+r}return c}function H3(e,a,t){var r=t||{},s=+!r.skipHeader,i=e||{},o=0,l=0;if(i&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var c=typeof r.origin=="string"?Ka(r.origin):r.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+a.length-1+s}};if(i["!ref"]){var f=pa(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+a.length-1+s)}else o==-1&&(o=0,d.e.r=a.length-1+s);var m=r.header||[],x=0;a.forEach(function(g,p){at(g).forEach(function(v){(x=m.indexOf(v))==-1&&(m[x=m.length]=v);var w=g[v],b="z",y="",j=Ye({c:l+x,r:o+p+s});u=Ec(i,j),w&&typeof w=="object"&&!(w instanceof Date)?i[j]=w:(typeof w=="number"?b="n":typeof w=="boolean"?b="b":typeof w=="string"?b="s":w instanceof Date?(b="d",r.cellDates||(b="n",w=bt(w)),y=r.dateNF||qe[14]):w===null&&r.nullError&&(b="e",w=0),u?(u.t=b,u.v=w,delete u.w,delete u.R,y&&(u.z=y)):i[j]=u={t:b,v:w},y&&(u.z=y))})}),d.e.c=Math.max(d.e.c,l+m.length-1);var h=nt(o);if(s)for(x=0;x<m.length;++x)i[Wa(x+l)+h]={t:"s",v:m[x]};return i["!ref"]=ra(d),i}function FO(e,a){return H3(null,e,a)}function Ec(e,a,t){if(typeof a=="string"){if(Array.isArray(e)){var r=Ka(a);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[a]||(e[a]={t:"z"})}return typeof a!="number"?Ec(e,Ye(a)):Ec(e,Ye({r:a,c:t||0}))}function _O(e,a){if(typeof a=="number"){if(a>=0&&e.SheetNames.length>a)return a;throw new Error("Cannot find sheet # "+a)}else if(typeof a=="string"){var t=e.SheetNames.indexOf(a);if(t>-1)return t;throw new Error("Cannot find sheet name |"+a+"|")}else throw new Error("Cannot find sheet |"+a+"|")}function pp(){return{SheetNames:[],Sheets:{}}}function gp(e,a,t,r){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=o+s)!=-1;++s);}if(C3(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=a,t}function AO(e,a,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=_O(e,a);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function RO(e,a){return e.z=a,e}function G3(e,a,t){return a?(e.l={Target:a},t&&(e.l.Tooltip=t)):delete e.l,e}function DO(e,a,t){return G3(e,"#"+a,t)}function PO(e,a,t){e.c||(e.c=[]),e.c.push({t:a,a:t||"SheetJS"})}function OO(e,a,t,r){for(var s=typeof a!="string"?a:pa(a),i=typeof a=="string"?a:ra(a),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=Ec(e,o,l);c.t="n",c.F=i,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=t,r&&(c.D=!0))}return e}var ba={encode_col:Wa,encode_row:nt,encode_cell:Ye,encode_range:ra,decode_col:Xh,decode_row:Gh,split_cell:XT,decode_cell:Ka,decode_range:fr,format_cell:Hs,sheet_add_aoa:yE,sheet_add_json:H3,sheet_add_dom:O3,aoa_to_sheet:el,json_to_sheet:FO,table_to_sheet:I3,table_to_book:$P,sheet_to_csv:hp,sheet_to_txt:V3,sheet_to_json:q0,sheet_to_html:P3,sheet_to_formulae:TO,sheet_to_row_object_array:q0,sheet_get_cell:Ec,book_new:pp,book_append_sheet:gp,book_set_sheet_visibility:AO,cell_set_number_format:RO,cell_set_hyperlink:G3,cell_set_internal_link:DO,cell_add_comment:PO,sheet_set_array_formula:OO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function X3(e,a){return function(){return e.apply(a,arguments)}}const{toString:IO}=Object.prototype,{getPrototypeOf:yp}=Object,{iterator:Tu,toStringTag:q3}=Symbol,Fu=(e=>a=>{const t=IO.call(a);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),ns=e=>(e=e.toLowerCase(),a=>Fu(a)===e),_u=e=>a=>typeof a===e,{isArray:tl}=Array,Ho=_u("undefined");function qc(e){return e!==null&&!Ho(e)&&e.constructor!==null&&!Ho(e.constructor)&&cr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Y3=ns("ArrayBuffer");function MO(e){let a;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?a=ArrayBuffer.isView(e):a=e&&e.buffer&&Y3(e.buffer),a}const UO=_u("string"),cr=_u("function"),W3=_u("number"),Yc=e=>e!==null&&typeof e=="object",LO=e=>e===!0||e===!1,Wd=e=>{if(Fu(e)!=="object")return!1;const a=yp(e);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(q3 in e)&&!(Tu in e)},BO=e=>{if(!Yc(e)||qc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},zO=ns("Date"),$O=ns("File"),VO=ns("Blob"),HO=ns("FileList"),GO=e=>Yc(e)&&cr(e.pipe),XO=e=>{let a;return e&&(typeof FormData=="function"&&e instanceof FormData||cr(e.append)&&((a=Fu(e))==="formdata"||a==="object"&&cr(e.toString)&&e.toString()==="[object FormData]"))},qO=ns("URLSearchParams"),[YO,WO,KO,JO]=["ReadableStream","Request","Response","Headers"].map(ns),ZO=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wc(e,a,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),tl(e))for(r=0,s=e.length;r<s;r++)a.call(null,e[r],r,e);else{if(qc(e))return;const i=t?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(r=0;r<o;r++)l=i[r],a.call(null,e[l],l,e)}}function K3(e,a){if(qc(e))return null;a=a.toLowerCase();const t=Object.keys(e);let r=t.length,s;for(;r-- >0;)if(s=t[r],a===s.toLowerCase())return s;return null}const Wn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,J3=e=>!Ho(e)&&e!==Wn;function px(){const{caseless:e,skipUndefined:a}=J3(this)&&this||{},t={},r=(s,i)=>{const o=e&&K3(t,i)||i;Wd(t[o])&&Wd(s)?t[o]=px(t[o],s):Wd(s)?t[o]=px({},s):tl(s)?t[o]=s.slice():(!a||!Ho(s))&&(t[o]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Wc(arguments[s],r);return t}const QO=(e,a,t,{allOwnKeys:r}={})=>(Wc(a,(s,i)=>{t&&cr(s)?e[i]=X3(s,t):e[i]=s},{allOwnKeys:r}),e),eI=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),aI=(e,a,t,r)=>{e.prototype=Object.create(a.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:a.prototype}),t&&Object.assign(e.prototype,t)},tI=(e,a,t,r)=>{let s,i,o;const l={};if(a=a||{},e==null)return a;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)o=s[i],(!r||r(o,e,a))&&!l[o]&&(a[o]=e[o],l[o]=!0);e=t!==!1&&yp(e)}while(e&&(!t||t(e,a))&&e!==Object.prototype);return a},rI=(e,a,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=a.length;const r=e.indexOf(a,t);return r!==-1&&r===t},sI=e=>{if(!e)return null;if(tl(e))return e;let a=e.length;if(!W3(a))return null;const t=new Array(a);for(;a-- >0;)t[a]=e[a];return t},nI=(e=>a=>e&&a instanceof e)(typeof Uint8Array<"u"&&yp(Uint8Array)),iI=(e,a)=>{const r=(e&&e[Tu]).call(e);let s;for(;(s=r.next())&&!s.done;){const i=s.value;a.call(e,i[0],i[1])}},oI=(e,a)=>{let t;const r=[];for(;(t=e.exec(a))!==null;)r.push(t);return r},lI=ns("HTMLFormElement"),cI=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),hy=(({hasOwnProperty:e})=>(a,t)=>e.call(a,t))(Object.prototype),dI=ns("RegExp"),Z3=(e,a)=>{const t=Object.getOwnPropertyDescriptors(e),r={};Wc(t,(s,i)=>{let o;(o=a(s,i,e))!==!1&&(r[i]=o||s)}),Object.defineProperties(e,r)},uI=e=>{Z3(e,(a,t)=>{if(cr(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=e[t];if(cr(r)){if(a.enumerable=!1,"writable"in a){a.writable=!1;return}a.set||(a.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},fI=(e,a)=>{const t={},r=s=>{s.forEach(i=>{t[i]=!0})};return tl(e)?r(e):r(String(e).split(a)),t},mI=()=>{},xI=(e,a)=>e!=null&&Number.isFinite(e=+e)?e:a;function hI(e){return!!(e&&cr(e.append)&&e[q3]==="FormData"&&e[Tu])}const pI=e=>{const a=new Array(10),t=(r,s)=>{if(Yc(r)){if(a.indexOf(r)>=0)return;if(qc(r))return r;if(!("toJSON"in r)){a[s]=r;const i=tl(r)?[]:{};return Wc(r,(o,l)=>{const c=t(o,s+1);!Ho(c)&&(i[l]=c)}),a[s]=void 0,i}}return r};return t(e,0)},gI=ns("AsyncFunction"),yI=e=>e&&(Yc(e)||cr(e))&&cr(e.then)&&cr(e.catch),Q3=((e,a)=>e?setImmediate:a?((t,r)=>(Wn.addEventListener("message",({source:s,data:i})=>{s===Wn&&i===t&&r.length&&r.shift()()},!1),s=>{r.push(s),Wn.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",cr(Wn.postMessage)),vI=typeof queueMicrotask<"u"?queueMicrotask.bind(Wn):typeof process<"u"&&process.nextTick||Q3,bI=e=>e!=null&&cr(e[Tu]),be={isArray:tl,isArrayBuffer:Y3,isBuffer:qc,isFormData:XO,isArrayBufferView:MO,isString:UO,isNumber:W3,isBoolean:LO,isObject:Yc,isPlainObject:Wd,isEmptyObject:BO,isReadableStream:YO,isRequest:WO,isResponse:KO,isHeaders:JO,isUndefined:Ho,isDate:zO,isFile:$O,isBlob:VO,isRegExp:dI,isFunction:cr,isStream:GO,isURLSearchParams:qO,isTypedArray:nI,isFileList:HO,forEach:Wc,merge:px,extend:QO,trim:ZO,stripBOM:eI,inherits:aI,toFlatObject:tI,kindOf:Fu,kindOfTest:ns,endsWith:rI,toArray:sI,forEachEntry:iI,matchAll:oI,isHTMLForm:lI,hasOwnProperty:hy,hasOwnProp:hy,reduceDescriptors:Z3,freezeMethods:uI,toObjectSet:fI,toCamelCase:cI,noop:mI,toFiniteNumber:xI,findKey:K3,global:Wn,isContextDefined:J3,isSpecCompliantForm:hI,toJSONObject:pI,isAsyncFn:gI,isThenable:yI,setImmediate:Q3,asap:vI,isIterable:bI};function aa(e,a,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",a&&(this.code=a),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}be.inherits(aa,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:be.toJSONObject(this.config),code:this.code,status:this.status}}});const ek=aa.prototype,ak={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{ak[e]={value:e}});Object.defineProperties(aa,ak);Object.defineProperty(ek,"isAxiosError",{value:!0});aa.from=(e,a,t,r,s,i)=>{const o=Object.create(ek);be.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=a==null&&e?e.code:a;return aa.call(o,l,c,t,r,s),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const wI=null;function gx(e){return be.isPlainObject(e)||be.isArray(e)}function tk(e){return be.endsWith(e,"[]")?e.slice(0,-2):e}function py(e,a,t){return e?e.concat(a).map(function(s,i){return s=tk(s),!t&&i?"["+s+"]":s}).join(t?".":""):a}function EI(e){return be.isArray(e)&&!e.some(gx)}const kI=be.toFlatObject(be,{},null,function(a){return/^is[A-Z]/.test(a)});function Au(e,a,t){if(!be.isObject(e))throw new TypeError("target must be an object");a=a||new FormData,t=be.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,p){return!be.isUndefined(p[g])});const r=t.metaTokens,s=t.visitor||d,i=t.dots,o=t.indexes,c=(t.Blob||typeof Blob<"u"&&Blob)&&be.isSpecCompliantForm(a);if(!be.isFunction(s))throw new TypeError("visitor must be a function");function u(h){if(h===null)return"";if(be.isDate(h))return h.toISOString();if(be.isBoolean(h))return h.toString();if(!c&&be.isBlob(h))throw new aa("Blob is not supported. Use a Buffer instead.");return be.isArrayBuffer(h)||be.isTypedArray(h)?c&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function d(h,g,p){let v=h;if(h&&!p&&typeof h=="object"){if(be.endsWith(g,"{}"))g=r?g:g.slice(0,-2),h=JSON.stringify(h);else if(be.isArray(h)&&EI(h)||(be.isFileList(h)||be.endsWith(g,"[]"))&&(v=be.toArray(h)))return g=tk(g),v.forEach(function(b,y){!(be.isUndefined(b)||b===null)&&a.append(o===!0?py([g],y,i):o===null?g:g+"[]",u(b))}),!1}return gx(h)?!0:(a.append(py(p,g,i),u(h)),!1)}const f=[],m=Object.assign(kI,{defaultVisitor:d,convertValue:u,isVisitable:gx});function x(h,g){if(!be.isUndefined(h)){if(f.indexOf(h)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(h),be.forEach(h,function(v,w){(!(be.isUndefined(v)||v===null)&&s.call(a,v,be.isString(w)?w.trim():w,g,m))===!0&&x(v,g?g.concat(w):[w])}),f.pop()}}if(!be.isObject(e))throw new TypeError("data must be an object");return x(e),a}function gy(e){const a={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return a[r]})}function vp(e,a){this._pairs=[],e&&Au(e,this,a)}const rk=vp.prototype;rk.append=function(a,t){this._pairs.push([a,t])};rk.toString=function(a){const t=a?function(r){return a.call(this,r,gy)}:gy;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function NI(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function sk(e,a,t){if(!a)return e;const r=t&&t.encode||NI;be.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let i;if(s?i=s(a,t):i=be.isURLSearchParams(a)?a.toString():new vp(a,t).toString(r),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class yy{constructor(){this.handlers=[]}use(a,t,r){return this.handlers.push({fulfilled:a,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(a){this.handlers[a]&&(this.handlers[a]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(a){be.forEach(this.handlers,function(r){r!==null&&a(r)})}}const nk={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},jI=typeof URLSearchParams<"u"?URLSearchParams:vp,SI=typeof FormData<"u"?FormData:null,CI=typeof Blob<"u"?Blob:null,TI={isBrowser:!0,classes:{URLSearchParams:jI,FormData:SI,Blob:CI},protocols:["http","https","file","blob","url","data"]},bp=typeof window<"u"&&typeof document<"u",yx=typeof navigator=="object"&&navigator||void 0,FI=bp&&(!yx||["ReactNative","NativeScript","NS"].indexOf(yx.product)<0),_I=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",AI=bp&&window.location.href||"http://localhost",RI=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:bp,hasStandardBrowserEnv:FI,hasStandardBrowserWebWorkerEnv:_I,navigator:yx,origin:AI},Symbol.toStringTag,{value:"Module"})),Ht={...RI,...TI};function DI(e,a){return Au(e,new Ht.classes.URLSearchParams,{visitor:function(t,r,s,i){return Ht.isNode&&be.isBuffer(t)?(this.append(r,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...a})}function PI(e){return be.matchAll(/\w+|\[(\w*)]/g,e).map(a=>a[0]==="[]"?"":a[1]||a[0])}function OI(e){const a={},t=Object.keys(e);let r;const s=t.length;let i;for(r=0;r<s;r++)i=t[r],a[i]=e[i];return a}function ik(e){function a(t,r,s,i){let o=t[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=t.length;return o=!o&&be.isArray(s)?s.length:o,c?(be.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!l):((!s[o]||!be.isObject(s[o]))&&(s[o]=[]),a(t,r,s[o],i)&&be.isArray(s[o])&&(s[o]=OI(s[o])),!l)}if(be.isFormData(e)&&be.isFunction(e.entries)){const t={};return be.forEachEntry(e,(r,s)=>{a(PI(r),s,t,0)}),t}return null}function II(e,a,t){if(be.isString(e))try{return(a||JSON.parse)(e),be.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(e)}const Kc={transitional:nk,adapter:["xhr","http","fetch"],transformRequest:[function(a,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,i=be.isObject(a);if(i&&be.isHTMLForm(a)&&(a=new FormData(a)),be.isFormData(a))return s?JSON.stringify(ik(a)):a;if(be.isArrayBuffer(a)||be.isBuffer(a)||be.isStream(a)||be.isFile(a)||be.isBlob(a)||be.isReadableStream(a))return a;if(be.isArrayBufferView(a))return a.buffer;if(be.isURLSearchParams(a))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),a.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return DI(a,this.formSerializer).toString();if((l=be.isFileList(a))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Au(l?{"files[]":a}:a,c&&new c,this.formSerializer)}}return i||s?(t.setContentType("application/json",!1),II(a)):a}],transformResponse:[function(a){const t=this.transitional||Kc.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(be.isResponse(a)||be.isReadableStream(a))return a;if(a&&be.isString(a)&&(r&&!this.responseType||s)){const o=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(a,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?aa.from(l,aa.ERR_BAD_RESPONSE,this,null,this.response):l}}return a}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ht.classes.FormData,Blob:Ht.classes.Blob},validateStatus:function(a){return a>=200&&a<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};be.forEach(["delete","get","head","post","put","patch"],e=>{Kc.headers[e]={}});const MI=be.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),UI=e=>{const a={};let t,r,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),t=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!t||a[t]&&MI[t])&&(t==="set-cookie"?a[t]?a[t].push(r):a[t]=[r]:a[t]=a[t]?a[t]+", "+r:r)}),a},vy=Symbol("internals");function yl(e){return e&&String(e).trim().toLowerCase()}function Kd(e){return e===!1||e==null?e:be.isArray(e)?e.map(Kd):String(e)}function LI(e){const a=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)a[r[1]]=r[2];return a}const BI=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Lf(e,a,t,r,s){if(be.isFunction(r))return r.call(this,a,t);if(s&&(a=t),!!be.isString(a)){if(be.isString(r))return a.indexOf(r)!==-1;if(be.isRegExp(r))return r.test(a)}}function zI(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(a,t,r)=>t.toUpperCase()+r)}function $I(e,a){const t=be.toCamelCase(" "+a);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(s,i,o){return this[r].call(this,a,s,i,o)},configurable:!0})})}let dr=class{constructor(a){a&&this.set(a)}set(a,t,r){const s=this;function i(l,c,u){const d=yl(c);if(!d)throw new Error("header name must be a non-empty string");const f=be.findKey(s,d);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||c]=Kd(l))}const o=(l,c)=>be.forEach(l,(u,d)=>i(u,d,c));if(be.isPlainObject(a)||a instanceof this.constructor)o(a,t);else if(be.isString(a)&&(a=a.trim())&&!BI(a))o(UI(a),t);else if(be.isObject(a)&&be.isIterable(a)){let l={},c,u;for(const d of a){if(!be.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?be.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,t)}else a!=null&&i(t,a,r);return this}get(a,t){if(a=yl(a),a){const r=be.findKey(this,a);if(r){const s=this[r];if(!t)return s;if(t===!0)return LI(s);if(be.isFunction(t))return t.call(this,s,r);if(be.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(a,t){if(a=yl(a),a){const r=be.findKey(this,a);return!!(r&&this[r]!==void 0&&(!t||Lf(this,this[r],r,t)))}return!1}delete(a,t){const r=this;let s=!1;function i(o){if(o=yl(o),o){const l=be.findKey(r,o);l&&(!t||Lf(r,r[l],l,t))&&(delete r[l],s=!0)}}return be.isArray(a)?a.forEach(i):i(a),s}clear(a){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const i=t[r];(!a||Lf(this,this[i],i,a,!0))&&(delete this[i],s=!0)}return s}normalize(a){const t=this,r={};return be.forEach(this,(s,i)=>{const o=be.findKey(r,i);if(o){t[o]=Kd(s),delete t[i];return}const l=a?zI(i):String(i).trim();l!==i&&delete t[i],t[l]=Kd(s),r[l]=!0}),this}concat(...a){return this.constructor.concat(this,...a)}toJSON(a){const t=Object.create(null);return be.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=a&&be.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([a,t])=>a+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(a){return a instanceof this?a:new this(a)}static concat(a,...t){const r=new this(a);return t.forEach(s=>r.set(s)),r}static accessor(a){const r=(this[vy]=this[vy]={accessors:{}}).accessors,s=this.prototype;function i(o){const l=yl(o);r[l]||($I(s,o),r[l]=!0)}return be.isArray(a)?a.forEach(i):i(a),this}};dr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);be.reduceDescriptors(dr.prototype,({value:e},a)=>{let t=a[0].toUpperCase()+a.slice(1);return{get:()=>e,set(r){this[t]=r}}});be.freezeMethods(dr);function Bf(e,a){const t=this||Kc,r=a||t,s=dr.from(r.headers);let i=r.data;return be.forEach(e,function(l){i=l.call(t,i,s.normalize(),a?a.status:void 0)}),s.normalize(),i}function ok(e){return!!(e&&e.__CANCEL__)}function rl(e,a,t){aa.call(this,e??"canceled",aa.ERR_CANCELED,a,t),this.name="CanceledError"}be.inherits(rl,aa,{__CANCEL__:!0});function lk(e,a,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?e(t):a(new aa("Request failed with status code "+t.status,[aa.ERR_BAD_REQUEST,aa.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function VI(e){const a=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return a&&a[1]||""}function HI(e,a){e=e||10;const t=new Array(e),r=new Array(e);let s=0,i=0,o;return a=a!==void 0?a:1e3,function(c){const u=Date.now(),d=r[i];o||(o=u),t[s]=c,r[s]=u;let f=i,m=0;for(;f!==s;)m+=t[f++],f=f%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),u-o<a)return;const x=d&&u-d;return x?Math.round(m*1e3/x):void 0}}function GI(e,a){let t=0,r=1e3/a,s,i;const o=(u,d=Date.now())=>{t=d,s=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-t;f>=r?o(u,d):(s=u,i||(i=setTimeout(()=>{i=null,o(s)},r-f)))},()=>s&&o(s)]}const Y0=(e,a,t=3)=>{let r=0;const s=HI(50,250);return GI(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-r,u=s(c),d=o<=l;r=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[a?"download":"upload"]:!0};e(f)},t)},by=(e,a)=>{const t=e!=null;return[r=>a[0]({lengthComputable:t,total:e,loaded:r}),a[1]]},wy=e=>(...a)=>be.asap(()=>e(...a)),XI=Ht.hasStandardBrowserEnv?((e,a)=>t=>(t=new URL(t,Ht.origin),e.protocol===t.protocol&&e.host===t.host&&(a||e.port===t.port)))(new URL(Ht.origin),Ht.navigator&&/(msie|trident)/i.test(Ht.navigator.userAgent)):()=>!0,qI=Ht.hasStandardBrowserEnv?{write(e,a,t,r,s,i,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(a)}`];be.isNumber(t)&&l.push(`expires=${new Date(t).toUTCString()}`),be.isString(r)&&l.push(`path=${r}`),be.isString(s)&&l.push(`domain=${s}`),i===!0&&l.push("secure"),be.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const a=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return a?decodeURIComponent(a[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function YI(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function WI(e,a){return a?e.replace(/\/?\/$/,"")+"/"+a.replace(/^\/+/,""):e}function ck(e,a,t){let r=!YI(a);return e&&(r||t==!1)?WI(e,a):a}const Ey=e=>e instanceof dr?{...e}:e;function wi(e,a){a=a||{};const t={};function r(u,d,f,m){return be.isPlainObject(u)&&be.isPlainObject(d)?be.merge.call({caseless:m},u,d):be.isPlainObject(d)?be.merge({},d):be.isArray(d)?d.slice():d}function s(u,d,f,m){if(be.isUndefined(d)){if(!be.isUndefined(u))return r(void 0,u,f,m)}else return r(u,d,f,m)}function i(u,d){if(!be.isUndefined(d))return r(void 0,d)}function o(u,d){if(be.isUndefined(d)){if(!be.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function l(u,d,f){if(f in a)return r(u,d);if(f in e)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,f)=>s(Ey(u),Ey(d),f,!0)};return be.forEach(Object.keys({...e,...a}),function(d){const f=c[d]||s,m=f(e[d],a[d],d);be.isUndefined(m)&&f!==l||(t[d]=m)}),t}const dk=e=>{const a=wi({},e);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=a;if(a.headers=o=dr.from(o),a.url=sk(ck(a.baseURL,a.url,a.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),be.isFormData(t)){if(Ht.hasStandardBrowserEnv||Ht.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(be.isFunction(t.getHeaders)){const c=t.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&o.set(d,f)})}}if(Ht.hasStandardBrowserEnv&&(r&&be.isFunction(r)&&(r=r(a)),r||r!==!1&&XI(a.url))){const c=s&&i&&qI.read(i);c&&o.set(s,c)}return a},KI=typeof XMLHttpRequest<"u",JI=KI&&function(e){return new Promise(function(t,r){const s=dk(e);let i=s.data;const o=dr.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,f,m,x,h;function g(){x&&x(),h&&h(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let p=new XMLHttpRequest;p.open(s.method.toUpperCase(),s.url,!0),p.timeout=s.timeout;function v(){if(!p)return;const b=dr.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),j={data:!l||l==="text"||l==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:b,config:e,request:p};lk(function(E){t(E),g()},function(E){r(E),g()},j),p=null}"onloadend"in p?p.onloadend=v:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(v)},p.onabort=function(){p&&(r(new aa("Request aborted",aa.ECONNABORTED,e,p)),p=null)},p.onerror=function(y){const j=y&&y.message?y.message:"Network Error",A=new aa(j,aa.ERR_NETWORK,e,p);A.event=y||null,r(A),p=null},p.ontimeout=function(){let y=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const j=s.transitional||nk;s.timeoutErrorMessage&&(y=s.timeoutErrorMessage),r(new aa(y,j.clarifyTimeoutError?aa.ETIMEDOUT:aa.ECONNABORTED,e,p)),p=null},i===void 0&&o.setContentType(null),"setRequestHeader"in p&&be.forEach(o.toJSON(),function(y,j){p.setRequestHeader(j,y)}),be.isUndefined(s.withCredentials)||(p.withCredentials=!!s.withCredentials),l&&l!=="json"&&(p.responseType=s.responseType),u&&([m,h]=Y0(u,!0),p.addEventListener("progress",m)),c&&p.upload&&([f,x]=Y0(c),p.upload.addEventListener("progress",f),p.upload.addEventListener("loadend",x)),(s.cancelToken||s.signal)&&(d=b=>{p&&(r(!b||b.type?new rl(null,e,p):b),p.abort(),p=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const w=VI(s.url);if(w&&Ht.protocols.indexOf(w)===-1){r(new aa("Unsupported protocol "+w+":",aa.ERR_BAD_REQUEST,e));return}p.send(i||null)})},ZI=(e,a)=>{const{length:t}=e=e?e.filter(Boolean):[];if(a||t){let r=new AbortController,s;const i=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;r.abort(d instanceof aa?d:new rl(d instanceof Error?d.message:d))}};let o=a&&setTimeout(()=>{o=null,i(new aa(`timeout ${a} of ms exceeded`,aa.ETIMEDOUT))},a);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>be.asap(l),c}},QI=function*(e,a){let t=e.byteLength;if(t<a){yield e;return}let r=0,s;for(;r<t;)s=r+a,yield e.slice(r,s),r=s},e9=async function*(e,a){for await(const t of a9(e))yield*QI(t,a)},a9=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const a=e.getReader();try{for(;;){const{done:t,value:r}=await a.read();if(t)break;yield r}}finally{await a.cancel()}},ky=(e,a,t,r)=>{const s=e9(e,a);let i=0,o,l=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let f=d.byteLength;if(t){let m=i+=f;t(m)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},Ny=64*1024,{isFunction:Cd}=be,t9=(({Request:e,Response:a})=>({Request:e,Response:a}))(be.global),{ReadableStream:jy,TextEncoder:Sy}=be.global,Cy=(e,...a)=>{try{return!!e(...a)}catch{return!1}},r9=e=>{e=be.merge.call({skipUndefined:!0},t9,e);const{fetch:a,Request:t,Response:r}=e,s=a?Cd(a):typeof fetch=="function",i=Cd(t),o=Cd(r);if(!s)return!1;const l=s&&Cd(jy),c=s&&(typeof Sy=="function"?(h=>g=>h.encode(g))(new Sy):async h=>new Uint8Array(await new t(h).arrayBuffer())),u=i&&l&&Cy(()=>{let h=!1;const g=new t(Ht.origin,{body:new jy,method:"POST",get duplex(){return h=!0,"half"}}).headers.has("Content-Type");return h&&!g}),d=o&&l&&Cy(()=>be.isReadableStream(new r("").body)),f={stream:d&&(h=>h.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(h=>{!f[h]&&(f[h]=(g,p)=>{let v=g&&g[h];if(v)return v.call(g);throw new aa(`Response type '${h}' is not supported`,aa.ERR_NOT_SUPPORT,p)})});const m=async h=>{if(h==null)return 0;if(be.isBlob(h))return h.size;if(be.isSpecCompliantForm(h))return(await new t(Ht.origin,{method:"POST",body:h}).arrayBuffer()).byteLength;if(be.isArrayBufferView(h)||be.isArrayBuffer(h))return h.byteLength;if(be.isURLSearchParams(h)&&(h=h+""),be.isString(h))return(await c(h)).byteLength},x=async(h,g)=>{const p=be.toFiniteNumber(h.getContentLength());return p??m(g)};return async h=>{let{url:g,method:p,data:v,signal:w,cancelToken:b,timeout:y,onDownloadProgress:j,onUploadProgress:A,responseType:E,headers:F,withCredentials:k="same-origin",fetchOptions:P}=dk(h),R=a||fetch;E=E?(E+"").toLowerCase():"text";let _=ZI([w,b&&b.toAbortSignal()],y),Q=null;const C=_&&_.unsubscribe&&(()=>{_.unsubscribe()});let z;try{if(A&&u&&p!=="get"&&p!=="head"&&(z=await x(F,v))!==0){let X=new t(g,{method:"POST",body:v,duplex:"half"}),T;if(be.isFormData(v)&&(T=X.headers.get("content-type"))&&F.setContentType(T),X.body){const[L,V]=by(z,Y0(wy(A)));v=ky(X.body,Ny,L,V)}}be.isString(k)||(k=k?"include":"omit");const S=i&&"credentials"in t.prototype,D={...P,signal:_,method:p.toUpperCase(),headers:F.normalize().toJSON(),body:v,duplex:"half",credentials:S?k:void 0};Q=i&&new t(g,D);let H=await(i?R(Q,P):R(g,D));const U=d&&(E==="stream"||E==="response");if(d&&(j||U&&C)){const X={};["status","statusText","headers"].forEach(O=>{X[O]=H[O]});const T=be.toFiniteNumber(H.headers.get("content-length")),[L,V]=j&&by(T,Y0(wy(j),!0))||[];H=new r(ky(H.body,Ny,L,()=>{V&&V(),C&&C()}),X)}E=E||"text";let B=await f[be.findKey(f,E)||"text"](H,h);return!U&&C&&C(),await new Promise((X,T)=>{lk(X,T,{data:B,headers:dr.from(H.headers),status:H.status,statusText:H.statusText,config:h,request:Q})})}catch(S){throw C&&C(),S&&S.name==="TypeError"&&/Load failed|fetch/i.test(S.message)?Object.assign(new aa("Network Error",aa.ERR_NETWORK,h,Q),{cause:S.cause||S}):aa.from(S,S&&S.code,h,Q)}}},s9=new Map,uk=e=>{let a=e&&e.env||{};const{fetch:t,Request:r,Response:s}=a,i=[r,s,t];let o=i.length,l=o,c,u,d=s9;for(;l--;)c=i[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:r9(a)),d=u;return u};uk();const wp={http:wI,xhr:JI,fetch:{get:uk}};be.forEach(wp,(e,a)=>{if(e){try{Object.defineProperty(e,"name",{value:a})}catch{}Object.defineProperty(e,"adapterName",{value:a})}});const Ty=e=>`- ${e}`,n9=e=>be.isFunction(e)||e===null||e===!1;function i9(e,a){e=be.isArray(e)?e:[e];const{length:t}=e;let r,s;const i={};for(let o=0;o<t;o++){r=e[o];let l;if(s=r,!n9(r)&&(s=wp[(l=String(r)).toLowerCase()],s===void 0))throw new aa(`Unknown adapter '${l}'`);if(s&&(be.isFunction(s)||(s=s.get(a))))break;i[l||"#"+o]=s}if(!s){const o=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=t?o.length>1?`since :
`+o.map(Ty).join(`
`):" "+Ty(o[0]):"as no adapter specified";throw new aa("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return s}const fk={getAdapter:i9,adapters:wp};function zf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new rl(null,e)}function Fy(e){return zf(e),e.headers=dr.from(e.headers),e.data=Bf.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),fk.getAdapter(e.adapter||Kc.adapter,e)(e).then(function(r){return zf(e),r.data=Bf.call(e,e.transformResponse,r),r.headers=dr.from(r.headers),r},function(r){return ok(r)||(zf(e),r&&r.response&&(r.response.data=Bf.call(e,e.transformResponse,r.response),r.response.headers=dr.from(r.response.headers))),Promise.reject(r)})}const mk="1.13.1",Ru={};["object","boolean","number","function","string","symbol"].forEach((e,a)=>{Ru[e]=function(r){return typeof r===e||"a"+(a<1?"n ":" ")+e}});const _y={};Ru.transitional=function(a,t,r){function s(i,o){return"[Axios v"+mk+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,l)=>{if(a===!1)throw new aa(s(o," has been removed"+(t?" in "+t:"")),aa.ERR_DEPRECATED);return t&&!_y[o]&&(_y[o]=!0,console.warn(s(o," has been deprecated since v"+t+" and will be removed in the near future"))),a?a(i,o,l):!0}};Ru.spelling=function(a){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${a}`),!0)};function o9(e,a,t){if(typeof e!="object")throw new aa("options must be an object",aa.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const i=r[s],o=a[i];if(o){const l=e[i],c=l===void 0||o(l,i,e);if(c!==!0)throw new aa("option "+i+" must be "+c,aa.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new aa("Unknown option "+i,aa.ERR_BAD_OPTION)}}const Jd={assertOptions:o9,validators:Ru},ls=Jd.validators;let li=class{constructor(a){this.defaults=a||{},this.interceptors={request:new yy,response:new yy}}async request(a,t){try{return await this._request(a,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(a,t){typeof a=="string"?(t=t||{},t.url=a):t=a||{},t=wi(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:i}=t;r!==void 0&&Jd.assertOptions(r,{silentJSONParsing:ls.transitional(ls.boolean),forcedJSONParsing:ls.transitional(ls.boolean),clarifyTimeoutError:ls.transitional(ls.boolean)},!1),s!=null&&(be.isFunction(s)?t.paramsSerializer={serialize:s}:Jd.assertOptions(s,{encode:ls.function,serialize:ls.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Jd.assertOptions(t,{baseUrl:ls.spelling("baseURL"),withXsrfToken:ls.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&be.merge(i.common,i[t.method]);i&&be.forEach(["delete","get","head","post","put","patch","common"],h=>{delete i[h]}),t.headers=dr.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(c=c&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let d,f=0,m;if(!c){const h=[Fy.bind(this),void 0];for(h.unshift(...l),h.push(...u),m=h.length,d=Promise.resolve(t);f<m;)d=d.then(h[f++],h[f++]);return d}m=l.length;let x=t;for(;f<m;){const h=l[f++],g=l[f++];try{x=h(x)}catch(p){g.call(this,p);break}}try{d=Fy.call(this,x)}catch(h){return Promise.reject(h)}for(f=0,m=u.length;f<m;)d=d.then(u[f++],u[f++]);return d}getUri(a){a=wi(this.defaults,a);const t=ck(a.baseURL,a.url,a.allowAbsoluteUrls);return sk(t,a.params,a.paramsSerializer)}};be.forEach(["delete","get","head","options"],function(a){li.prototype[a]=function(t,r){return this.request(wi(r||{},{method:a,url:t,data:(r||{}).data}))}});be.forEach(["post","put","patch"],function(a){function t(r){return function(i,o,l){return this.request(wi(l||{},{method:a,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}li.prototype[a]=t(),li.prototype[a+"Form"]=t(!0)});let l9=class xk{constructor(a){if(typeof a!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(l=>{r.subscribe(l),i=l}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},a(function(i,o,l){r.reason||(r.reason=new rl(i,o,l),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(a){if(this.reason){a(this.reason);return}this._listeners?this._listeners.push(a):this._listeners=[a]}unsubscribe(a){if(!this._listeners)return;const t=this._listeners.indexOf(a);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const a=new AbortController,t=r=>{a.abort(r)};return this.subscribe(t),a.signal.unsubscribe=()=>this.unsubscribe(t),a.signal}static source(){let a;return{token:new xk(function(s){a=s}),cancel:a}}};function c9(e){return function(t){return e.apply(null,t)}}function d9(e){return be.isObject(e)&&e.isAxiosError===!0}const vx={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(vx).forEach(([e,a])=>{vx[a]=e});function hk(e){const a=new li(e),t=X3(li.prototype.request,a);return be.extend(t,li.prototype,a,{allOwnKeys:!0}),be.extend(t,a,null,{allOwnKeys:!0}),t.create=function(s){return hk(wi(e,s))},t}const Pa=hk(Kc);Pa.Axios=li;Pa.CanceledError=rl;Pa.CancelToken=l9;Pa.isCancel=ok;Pa.VERSION=mk;Pa.toFormData=Au;Pa.AxiosError=aa;Pa.Cancel=Pa.CanceledError;Pa.all=function(a){return Promise.all(a)};Pa.spread=c9;Pa.isAxiosError=d9;Pa.mergeConfig=wi;Pa.AxiosHeaders=dr;Pa.formToJSON=e=>ik(be.isHTMLForm(e)?new FormData(e):e);Pa.getAdapter=fk.getAdapter;Pa.HttpStatusCode=vx;Pa.default=Pa;const{Axios:xL,AxiosError:hL,CanceledError:pL,isCancel:gL,CancelToken:yL,VERSION:vL,all:bL,Cancel:wL,isAxiosError:EL,spread:kL,toFormData:NL,AxiosHeaders:jL,HttpStatusCode:SL,formToJSON:CL,getAdapter:TL,mergeConfig:FL}=Pa,$f="http://localhost:8080/api/configuracion-correo",W0={obtenerConfiguracionActiva:async()=>{var e,a,t;try{const r=await Pa.get(`${$f}/obtener-configuracion-mensaje`);if(!r.data||!r.data.success)throw new Error("No se recibi respuesta del servidor");const s=r.data.data.formatoCorreo;return{exitoso:!0,configuracion:{id:s.id,tipoFuente:s.tipoFuente,tamanoFuente:s.tamanoFuente,esCursiva:s.esCursiva,esSubrayado:s.esSubrayado,colorTexto:s.colorTexto,activo:!0}}}catch(r){console.error("Error al obtener configuracin activa:",r);let s="Error al obtener la configuracin activa";if(Pa.isAxiosError(r)){if(((e=r.response)==null?void 0:e.status)===404)return{exitoso:!0,configuracion:{tipoFuente:"Arial",tamanoFuente:14,esCursiva:!1,esSubrayado:!1,colorTexto:"#000000",activo:!0}};(t=(a=r.response)==null?void 0:a.data)!=null&&t.message?s=r.response.data.message:r.message&&(s=r.message)}else r instanceof Error&&(s=r.message);return{exitoso:!1,mensaje:s,configuracion:{tipoFuente:"Arial",tamanoFuente:14,esCursiva:!1,esSubrayado:!1,colorTexto:"#000000",activo:!0}}}},guardarConfiguracionFormato:async e=>{var a,t,r,s,i,o;try{if(!((a=e.tipoFuente)!=null&&a.trim()))return{exitoso:!1,mensaje:"El tipo de fuente es requerido"};const l=Number(e.tamanoFuente),c=Number.isFinite(l)&&l>0?l:14;if((!Number.isFinite(l)||l<=0)&&console.warn("tamanoFuente invlido recibido en frontend, se usar valor por defecto 14:",e.tamanoFuente),!((t=e.colorTexto)!=null&&t.match(/^#[0-9A-Fa-f]{6}$/)))return{exitoso:!1,mensaje:"El color de texto debe ser un cdigo hexadecimal vlido (ej: #000000)"};const u={tipoFuente:e.tipoFuente,tamanoFuente:c,esCursiva:e.esCursiva,esSubrayado:e.esSubrayado,colorTexto:e.colorTexto,activo:!0};try{console.log("Enviando al backend:",JSON.stringify(u));const d={mensaje:"predefinido",esPersonalizado:!1,formatoCorreo:u},f=await Pa.post(`${$f}/guardar-configuracion-mensaje`,d);return!f.data||!f.data.success?{exitoso:!1,mensaje:((r=f.data)==null?void 0:r.message)||"No se recibi respuesta del servidor"}:{exitoso:!0,mensaje:"Configuracin guardada correctamente",configuracion:{id:e.id,tipoFuente:u.tipoFuente,tamanoFuente:u.tamanoFuente,esCursiva:u.esCursiva,esSubrayado:u.esSubrayado,colorTexto:u.colorTexto,activo:u.activo}}}catch(d){return console.error("Error al guardar configuracin de formato:",d),{exitoso:!1,mensaje:`Error al guardar configuracin: ${d.message||"Error desconocido"}`}}}catch(l){console.error("Error al guardar configuracin de formato:",l);let c="Error al guardar la configuracin de formato";if(Pa.isAxiosError(l)){if((i=(s=l.response)==null?void 0:s.data)!=null&&i.message?c=l.response.data.message:l.message&&(c=l.message),((o=l.response)==null?void 0:o.status)===400)return{exitoso:!1,mensaje:c}}else l instanceof Error&&(c=l.message);return{exitoso:!1,mensaje:c}}},actualizarConfiguracionFormato:async e=>{var a,t,r,s,i,o,l;try{if(!e.id)return{exitoso:!1,mensaje:"Se requiere el ID de la configuracin para actualizarla"};if(!((a=e.tipoFuente)!=null&&a.trim()))return{exitoso:!1,mensaje:"El tipo de fuente es requerido"};if(!e.tamanoFuente||e.tamanoFuente<=0)return{exitoso:!1,mensaje:"El tamao de fuente debe ser mayor a 0"};if(!((t=e.colorTexto)!=null&&t.match(/^#[0-9A-Fa-f]{6}$/)))return{exitoso:!1,mensaje:"El color de texto debe ser un cdigo hexadecimal vlido (ej: #000000)"};const c={tipoFuente:e.tipoFuente,tamanoFuente:e.tamanoFuente,esCursiva:e.esCursiva,esSubrayado:e.esSubrayado,colorTexto:e.colorTexto,activo:!0},u={mensaje:"predefinido",esPersonalizado:!1,formatoCorreo:c},d=await Pa.post(`${$f}/guardar-configuracion-mensaje`,u);if(!d.data||!d.data.success)throw new Error(((r=d.data)==null?void 0:r.message)||"No se recibi respuesta del servidor");return{exitoso:!0,mensaje:"Configuracin de formato actualizada correctamente",configuracion:{id:e.id,tipoFuente:c.tipoFuente,tamanoFuente:c.tamanoFuente,esCursiva:c.esCursiva,esSubrayado:c.esSubrayado,colorTexto:c.colorTexto,activo:c.activo}}}catch(c){console.error("Error al actualizar configuracin de formato:",c);let u="Error al actualizar la configuracin de formato";if(Pa.isAxiosError(c)){if((i=(s=c.response)==null?void 0:s.data)!=null&&i.message?u=c.response.data.message:c.message&&(u=c.message),((o=c.response)==null?void 0:o.status)===400)return{exitoso:!1,mensaje:u};if(((l=c.response)==null?void 0:l.status)===404)return{exitoso:!1,mensaje:"La configuracin que intenta actualizar no existe"}}else c instanceof Error&&(u=c.message);return{exitoso:!1,mensaje:u}}},aplicarFormatoHTML:(e,a)=>{const t=[];a.tipoFuente&&t.push(`font-family: ${a.tipoFuente}`),a.tamanoFuente&&t.push(`font-size: ${a.tamanoFuente}px`),t.push(`font-style: ${a.esCursiva?"italic":"normal"}`),t.push(`text-decoration: ${a.esSubrayado?"underline":"none"}`),t.push("font-weight: normal"),a.colorTexto&&t.push(`color: ${a.colorTexto}`);const r=(e||"").replace(/\n/g,"<br>");return`<span style="${t.join("; ")}">${r}</span>`}};class u9{constructor(){this.baseUrl=Re("/correo")}async obtenerConfiguracionMensaje(){try{const a=await fetch(`${this.baseUrl}/configuracion-mensajes`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error(`Error HTTP: ${a.status} - ${a.statusText}`);const t=await a.json(),r=await this.obtenerMensajePredeterminado();let s;if(t.mensajesPersonalizados&&t.mensajesPersonalizados.length>0){const i=t.mensajesPersonalizados[0];s={asunto:i.asunto||"Factura Electrnica - {facturaInfo}",mensaje:r.mensaje||"",mensajePersonalizado:i.mensaje||"",esPersonalizado:!0}}else s={asunto:r.asunto||"Factura Electrnica - {facturaInfo}",mensaje:r.mensaje||"",mensajePersonalizado:"",esPersonalizado:!1};return{exitoso:!0,configuracion:s}}catch(a){return console.error("Error al obtener configuracin de correo:",a),{exitoso:!0,configuracion:{asunto:"Factura Electrnica - {facturaInfo}",mensaje:`Se ha generado su factura electrnica.

Gracias por su preferencia.`,esPersonalizado:!1}}}}async obtenerMensajePredeterminado(){try{const a=await fetch(`${this.baseUrl}/mensaje/completo`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error(`Error HTTP: ${a.status} - ${a.statusText}`);const t=await a.json();return{asunto:t.asunto||"Factura Electrnica - {facturaInfo}",mensaje:t.mensaje||"",esPersonalizado:!1}}catch(a){return console.error("Error al obtener mensaje predeterminado:",a),{asunto:"Factura Electrnica",mensaje:`Estimado cliente,

Se ha generado su factura electrnica.

Tenga un buen da

Datos de la factura
Serie:	EJEMPLO
Folio:	EJEMPLO
UUID:	EJEMPLO
RFC Receptor:	EJEMPLO

Gracias por su preferencia.

Atentamente,
Equipo de Facturacin Cibercom`,esPersonalizado:!1}}}async guardarConfiguracionMensaje(a){try{const t={mensajeSeleccionado:a.esPersonalizado?"personalizado":"completo",mensajesPersonalizados:a.esPersonalizado?[{id:"personalizado",nombre:"Mensaje Personalizado",asunto:a.asunto,mensaje:a.mensaje}]:[]};a.formatoCorreo&&(t.formatoCorreo=a.formatoCorreo);const r=await fetch(`${this.baseUrl}/configuracion-mensajes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error(`Error HTTP: ${r.status} - ${r.statusText}`);return{exitoso:!0,mensaje:(await r.json()).mensaje||"Configuracin guardada correctamente"}}catch(t){return console.error("Error al guardar configuracin de correo:",t),{exitoso:!1,mensaje:"Error al guardar la configuracin"}}}async restaurarMensajePredeterminado(){try{const a={mensajeSeleccionado:"completo",mensajesPersonalizados:[]},t=await fetch(`${this.baseUrl}/configuracion-mensajes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error(`Error HTTP: ${t.status} - ${t.statusText}`);return{exitoso:!0,mensaje:"Mensaje predeterminado restaurado correctamente",configuracion:await this.obtenerMensajePredeterminado()}}catch(a){return console.error("Error al restaurar mensaje predeterminado:",a),{exitoso:!1,mensaje:"Error al restaurar el mensaje predeterminado"}}}procesarMensaje(a,t){let r=a;return t.facturaInfo&&(r=r.replace(/{facturaInfo}/g,t.facturaInfo)),t.serie&&(r=r.replace(/{serie}/g,t.serie)),t.folio&&(r=r.replace(/{folio}/g,t.folio)),t.uuid&&(r=r.replace(/{uuid}/g,t.uuid)),t.rfcEmisor&&(r=r.replace(/{rfcEmisor}/g,t.rfcEmisor)),t.rfcReceptor&&(r=r.replace(/{rfcReceptor}/g,t.rfcReceptor)),r}async procesarMensajeConFormato(a,t){const r=this.procesarMensaje(a,t);try{const s=await W0.obtenerConfiguracionActiva();return s.exitoso&&s.configuracion?W0.aplicarFormatoHTML(r,s.configuracion):r.replace(/\n/g,"<br>")}catch(s){return console.error("Error al aplicar formato al mensaje:",s),r.replace(/\n/g,"<br>")}}async obtenerMensajeParaEnvio(){try{const a=await this.obtenerConfiguracionMensaje();return a.exitoso&&a.configuracion?a.configuracion:null}catch(a){return console.error("Error al obtener mensaje para envo:",a),null}}}const Jr=new u9,Ep=({isOpen:e,onClose:a,facturaUuid:t,facturaInfo:r,correoInicial:s="",rfcReceptor:i=""})=>{const[o,l]=N.useState(s),[c,u]=N.useState(""),[d,f]=N.useState(""),[m,x]=N.useState(!1),[h,g]=N.useState(null),[p,v]=N.useState(!1);N.useEffect(()=>{e&&w()},[e,t,r,i]);const w=async()=>{v(!0);try{const j=await Jr.obtenerMensajeParaEnvio();if(j){const A=`Estimado(a) cliente,

Se ha generado su factura electrnica.

Gracias por su preferencia.

Con los siguientes datos:
Serie de la factura: {serie}
Folio de la factura: {folio}
UUID de la factura: {uuid}
RFC del emisor: {rfcEmisor}
RFC del receptor: {rfcReceptor}

Atentamente,
Equipo de Facturacin Cibercom`,E=Jr.procesarMensaje(j.asunto,{facturaInfo:r,serie:r.split("-")[0]||"A",folio:r.split("-")[1]||"1",uuid:t,rfcEmisor:"EEJ920629TE3",rfcReceptor:i||""}),F=Jr.procesarMensaje(A,{facturaInfo:r,serie:r.split("-")[0]||"A",folio:r.split("-")[1]||"1",uuid:t,rfcEmisor:"EEJ920629TE3",rfcReceptor:i||""}),k=j.mensaje||"",P=`${F}

${k}`;u(E),f(P)}else{const E=Jr.procesarMensaje(`Estimado(a) cliente,

Se ha generado su factura electrnica.

Gracias por su preferencia.

Con los siguientes datos:
Serie de la factura: {serie}
Folio de la factura: {folio}
UUID de la factura: {uuid}
RFC del emisor: {rfcEmisor}
RFC del receptor: {rfcReceptor}

Atentamente,
Equipo de Facturacin Cibercom`,{facturaInfo:r,serie:r.split("-")[0]||"A",folio:r.split("-")[1]||"1",uuid:t,rfcEmisor:"EEJ920629TE3",rfcReceptor:i||""});u(`Factura Electrnica - ${r}`),f(`${E}

`)}}catch(j){console.error("Error al cargar configuracin predeterminada:",j);const E=Jr.procesarMensaje(`Estimado(a) cliente,

Se ha generado su factura electrnica.

Gracias por su preferencia.

Con los siguientes datos:
Serie de la factura: {serie}
Folio de la factura: {folio}
UUID de la factura: {uuid}
RFC del emisor: {rfcEmisor}
RFC del receptor: {rfcReceptor}

Atentamente,
Equipo de Facturacin Cibercom`,{facturaInfo:r,serie:r.split("-")[0]||"A",folio:r.split("-")[1]||"1",uuid:t,rfcEmisor:"EEJ920629TE3",rfcReceptor:i||""});u(`Factura Electrnica - ${r}`),f(`${E}

`)}finally{v(!1)}},b=async j=>{if(j.preventDefault(),!Pt.validarEmail(o)){g({tipo:"error",texto:"Por favor ingresa un correo electrnico vlido"});return}x(!0),g(null);try{const A=await Pt.enviarCorreoConPdfAdjunto({uuidFactura:t,correoReceptor:o,asunto:c,mensaje:d});A.success?(g({tipo:"success",texto:A.message}),setTimeout(()=>{a(),g(null)},2e3)):g({tipo:"error",texto:A.message})}catch(A){console.error("Error al enviar correo:",A),g({tipo:"error",texto:"Error al enviar el correo. Por favor intenta nuevamente."})}finally{x(!1)}},y=()=>{!m&&!p&&(g(null),l(s),u(""),f(""),a())};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Enviar Factura por Correo"}),n.jsx("button",{onClick:y,disabled:m||p,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-50",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[n.jsx("strong",{children:"Factura:"})," ",r]}),n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[n.jsx("strong",{children:"UUID:"})," ",t]})]}),n.jsxs("form",{onSubmit:b,className:"space-y-4",children:[n.jsx(J,{label:"Correo Electrnico del Destinatario *",name:"correoReceptor",type:"email",value:o,onChange:j=>l(j.target.value),required:!0,placeholder:"ejemplo@correo.com",disabled:m||p}),n.jsx(J,{label:"Asunto *",name:"asunto",type:"text",value:c,onChange:j=>u(j.target.value),required:!0,placeholder:p?"Cargando configuracin...":"Asunto del correo",disabled:m||p}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mensaje *"}),n.jsx("textarea",{name:"mensaje",value:d,onChange:j=>f(j.target.value),required:!0,placeholder:p?"Cargando configuracin...":"Mensaje del correo",disabled:m||p,rows:6,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed"})]}),n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-700 p-3 rounded-md",children:[n.jsx("p",{className:"font-medium mb-1",children:" Mensaje basado en configuracin predefinida"}),n.jsx("p",{children:"Puedes modificar el asunto y mensaje antes de enviar. Para cambiar los mensajes predeterminados, ve a Configuracin  Mensajes de Correo."})]}),h&&n.jsx("div",{className:`p-3 rounded-md text-sm ${h.tipo==="success"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:h.texto}),n.jsxs("div",{className:"flex space-x-3 pt-4",children:[n.jsx(fe,{type:"button",variant:"secondary",onClick:y,disabled:m||p,className:"flex-1",children:"Cancelar"}),n.jsx(fe,{type:"submit",variant:"primary",disabled:m||p||!o.trim()||!c.trim()||!d.trim(),className:"flex-1",children:p?n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Cargando..."]}):m?n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Enviando..."]}):"Enviar Correo"})]})]})]})}):null},f9=()=>{const[e,a]=N.useState(null),[t,r]=N.useState(!1),[s,i]=N.useState([]),[o,l]=N.useState(""),[c,u]=N.useState({isOpen:!1,facturaUuid:"",facturaInfo:"",correoInicial:"",rfcReceptor:""}),[d,f]=N.useState(null),[m,x]=N.useState(null),h=R=>{a(R.target.files?R.target.files[0]:null),i([]),l("")},g=R=>{if(!R)return"";if(typeof R=="number"){const C=new Date(1899,11,30);return new Date(C.getTime()+R*864e5).toISOString().split("T")[0]}const _=String(R).trim();if(_.match(/^\d{4}-\d{2}-\d{2}$/))return _;const Q=new Date(_);return isNaN(Q.getTime())?_:Q.toISOString().split("T")[0]},p=async R=>new Promise((_,Q)=>{const C=new FileReader;C.onload=z=>{var S,D;try{let H;if(R.name.endsWith(".csv"))H=((S=z.target)==null?void 0:S.result).split(`
`).map(me=>me.trim()).filter(me=>me).map(me=>{const ae=me.includes(";")?";":",";return me.split(ae).map(ce=>ce.trim().replace(/^"|"$/g,""))});else{const O=new Uint8Array((D=z.target)==null?void 0:D.result),de=hx(O,{type:"array",cellDates:!1,raw:!1}),me=de.Sheets[de.SheetNames[0]];H=ba.sheet_to_json(me,{header:1,defval:""})}if(H.length<2){Q(new Error("El archivo debe contener al menos una fila de datos (adems del encabezado)"));return}const U=(H[0]||[]).map(O=>String(O||"").toUpperCase().trim()),B=U.findIndex(O=>O.includes("UUID")),X=U.findIndex(O=>O.includes("FOLIO")),T=U.findIndex(O=>O.includes("TIENDA")),L=U.findIndex(O=>O.includes("FECHA"));if(B===-1||X===-1||T===-1||L===-1){Q(new Error("El archivo debe contener las columnas: UUID, Folio, Tienda, Fecha"));return}const V=[];for(let O=1;O<H.length;O++){const de=H[O],me=String(de[B]||"").trim(),ae=String(de[X]||"").trim(),ce=String(de[T]||"").trim();let W=de[L];W=g(W),me&&V.push({uuid:me,folio:ae,tienda:ce,fecha:String(W)})}if(V.length===0){Q(new Error("No se encontraron facturas vlidas en el archivo"));return}_(V)}catch(H){Q(new Error(`Error al procesar el archivo: ${(H==null?void 0:H.message)||"Error desconocido"}`))}},C.onerror=()=>Q(new Error("Error al leer el archivo")),R.name.endsWith(".csv")?C.readAsText(R):C.readAsArrayBuffer(R)}),v=async R=>{const _=R.toLowerCase().trim(),Q=async(H,U)=>{try{const B=await fetch(H,{signal:U});return B.ok?B:null}catch{return null}},C=new AbortController,z=setTimeout(()=>C.abort(),2e3);try{const H=await Q(kr(`/pac/status/${encodeURIComponent(_)}`),C.signal);if(clearTimeout(z),H)try{const U=await H.json();if(U!=null&&U.status)return U.status}catch{}}catch{clearTimeout(z)}const S=new AbortController,D=setTimeout(()=>S.abort(),2e3);try{const H=await Q(kr(`/pac/stamp/status/${encodeURIComponent(_)}`),S.signal);if(clearTimeout(D),H)try{const U=await H.json();if(U!=null&&U.status||U!=null&&U.codigo)return U.status||U.codigo}catch{}}catch{clearTimeout(D)}return"DESCONOCIDO"},w=async R=>{try{let _="DESCONOCIDO";try{_=await v(R.uuid)}catch{}if(_==="CANCELADA"||_==="2"||_==="CANCELADA EN SAT")return{uuid:R.uuid,folio:R.folio,tienda:R.tienda,fecha:R.fecha,estado:"error",mensaje:"La factura ya se encontraba cancelada",estatusAnterior:_,estatusNuevo:_};if(_==="1"||_==="EN PROCESO DE CANCELACION"||_==="EN_PROCESO")return{uuid:R.uuid,folio:R.folio,tienda:R.tienda,fecha:R.fecha,estado:"en_proceso",mensaje:"La factura ya est en proceso de cancelacin",estatusAnterior:_,estatusNuevo:_};const Q=localStorage.getItem("username")||"sistema",C=localStorage.getItem("perfil");let z="ADMINISTRADOR";try{if(C){const X=JSON.parse(C);z=(X==null?void 0:X.nombrePerfil)||"ADMINISTRADOR"}}catch{}const S={uuid:R.uuid,motivo:"02",usuario:Q,perfilUsuario:z};let D;try{D=await fetch(Re("/consulta-facturas/cancelar"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})}catch(X){return{uuid:R.uuid,folio:R.folio,tienda:R.tienda,fecha:R.fecha,estado:"error",mensaje:`Error de conexin: ${(X==null?void 0:X.message)||"No se pudo conectar al servidor"}`,estatusAnterior:_,error:X==null?void 0:X.message}}let H;try{H=await D.json()}catch{const T=await D.text().catch(()=>"Error desconocido");return{uuid:R.uuid,folio:R.folio,tienda:R.tienda,fecha:R.fecha,estado:"error",mensaje:`Error HTTP ${D.status}: ${T}`,estatusAnterior:_,error:T}}const U=H.mensaje||H.error||"",B=U.includes("EN_PROCESO")||U.includes("marcar")||U.includes("proceso");if(D.ok&&H.exitoso){await new Promise(T=>setTimeout(T,1500));let X="DESCONOCIDO";try{X=await v(R.uuid)}catch{}return X==="CANCELADA"||X==="2"||X==="CANCELADA EN SAT"?{uuid:R.uuid,folio:R.folio,tienda:R.tienda,fecha:R.fecha,estado:"success",mensaje:"Cancelada exitosamente",estatusAnterior:_,estatusNuevo:X}:X==="1"||X==="EN_PROCESO"||X==="4"||X==="EN_PROCESO_CANCELACION"||X==="EN PROCESO DE CANCELACION"||X==="67"||X==="EN ESPERA DE CANCELACION BOLETA QUE SUSTITUYE"?{uuid:R.uuid,folio:R.folio,tienda:R.tienda,fecha:R.fecha,estado:"en_proceso",mensaje:"En proceso de cancelacin",estatusAnterior:_,estatusNuevo:X}:{uuid:R.uuid,folio:R.folio,tienda:R.tienda,fecha:R.fecha,estado:"success",mensaje:H.mensaje||`Estado cambiado: ${_}  ${X}`,estatusAnterior:_,estatusNuevo:X}}else if(B||D.status===400){const X=B?"Cancelacin iniciada (en proceso, verificar estado en BD)":U||"Cancelacin en proceso (verificar estado en BD)";return{uuid:R.uuid,folio:R.folio,tienda:R.tienda,fecha:R.fecha,estado:"en_proceso",mensaje:X,estatusAnterior:_,estatusNuevo:"EN_PROCESO",error:U}}else return{uuid:R.uuid,folio:R.folio,tienda:R.tienda,fecha:R.fecha,estado:"error",mensaje:U||`Error HTTP ${D.status}`,estatusAnterior:_,error:U}}catch(_){return{uuid:R.uuid,folio:R.folio,tienda:R.tienda,fecha:R.fecha,estado:"error",mensaje:`Error de conexin: ${(_==null?void 0:_.message)||"Error desconocido"}`,error:_==null?void 0:_.message}}},b=async R=>{if(R.preventDefault(),!e){alert("Por favor, seleccione un archivo para la cancelacin masiva.");return}r(!0),i([]),l("Leyendo archivo...");try{const _=await p(e);l(`Procesando ${_.length} factura(s)...`);const Q=[];for(let D=0;D<_.length;D++){l(`Procesando factura ${D+1} de ${_.length}...`);const H=await w(_[D]);Q.push(H),i([...Q])}const C=Q.filter(D=>D.estado==="success").length,z=Q.filter(D=>D.estado==="error").length,S=Q.filter(D=>D.estado==="en_proceso").length;l(`Proceso finalizado. ${C} canceladas, ${S} en proceso, ${z} con error.`)}catch(_){l(`Error: ${(_==null?void 0:_.message)||"Error al procesar el archivo"}`),alert((_==null?void 0:_.message)||"Error al procesar el archivo")}finally{r(!1)}},y=()=>{if(s.length===0){alert("No hay datos para exportar.");return}const R=s.map(C=>({UUID:C.uuid,Folio:C.folio,Tienda:C.tienda,Fecha:C.fecha,Estado:C.estado==="success"?"Cancelada":C.estado==="en_proceso"?"En Proceso":"Error",Mensaje:C.mensaje,"Estatus Anterior":C.estatusAnterior||"","Estatus Nuevo":C.estatusNuevo||""})),_=ba.json_to_sheet(R),Q=ba.book_new();ba.book_append_sheet(Q,_,"CancelacionMasiva"),gs(Q,"cancelacion_masiva_resultados.xlsx")},j=async(R,_)=>{try{x(R),await ma.generarYDescargarPDF(R)}catch(Q){console.error("Error descargando PDF:",Q),alert(`Error al descargar PDF: ${(Q==null?void 0:Q.message)||"Error desconocido"}`)}finally{x(null)}},A=async R=>{try{f(R);const _=Re(`/factura/descargar-pdf/${R}`);window.open(_,"_blank")}catch(_){console.error("Error obteniendo vista previa:",_),alert(`Error al obtener vista previa: ${(_==null?void 0:_.message)||"Error desconocido"}`)}finally{f(null)}},E=async R=>{try{const _=await ma.obtenerFacturaPorUUID(R.uuid);u({isOpen:!0,facturaUuid:R.uuid,facturaInfo:`${R.folio} - ${R.tienda}`,correoInicial:"",rfcReceptor:_.rfcReceptor||""})}catch(_){console.error("Error obteniendo datos de factura:",_),u({isOpen:!0,facturaUuid:R.uuid,facturaInfo:`${R.folio} - ${R.tienda}`,correoInicial:"",rfcReceptor:""})}},F=()=>{u({isOpen:!1,facturaUuid:"",facturaInfo:"",correoInicial:"",rfcReceptor:""})},k="El archivo debe ser .xlsx o .csv y contener las siguientes columnas: UUID, Folio, Tienda, Fecha. La primera fila se considera encabezado.",P=()=>{const R=[["UUID","FOLIO","TIENDA","FECHA"],["12345678-1234-1234-1234-123456789012","FAC-001","S001","2024-01-15"],["23456789-2345-2345-2345-234567890123","FAC-002","S002","2024-01-16"],["34567890-3456-3456-3456-345678901234","FAC-003","S003","2024-01-17"]],_=ba.aoa_to_sheet(R);_["!cols"]=[{wch:40},{wch:15},{wch:10},{wch:12}];const Q=ba.book_new();ba.book_append_sheet(Q,_,"Cancelaciones"),gs(Q,"plantilla_cancelacion_masiva.xlsx")};return n.jsxs("div",{className:"space-y-6 p-4",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"bg-pink-100 p-2 rounded-full",children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-pink-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),n.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"Cancelacin Masiva"})]}),n.jsx("form",{onSubmit:b,className:"space-y-6",children:n.jsxs(ve,{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Cancelacin de Facturas Masiva"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:k}),n.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Archivo de Cancelacin Masiva:"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"file",accept:".xlsx,.csv",onChange:h,className:"flex-1 block w-full text-sm text-gray-700 dark:text-gray-100 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-primary-dark"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:P,title:"Descargar plantilla Excel de ejemplo",children:" Descargar Plantilla"})]})]}),n.jsx(fe,{type:"submit",variant:"primary",disabled:t||!e,children:t?"Procesando...":"Cancelar Masiva"})]}),e&&n.jsxs("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300",children:["Archivo seleccionado: ",n.jsx("span",{className:"font-semibold",children:e.name})]})]})}),n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[100px]",children:s.length>0?n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"font-semibold text-gray-700 dark:text-gray-100",children:o}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-sm text-left",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"UUID"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Folio"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tienda"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Estado"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Mensaje"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Acciones"})]})}),n.jsx("tbody",{children:s.map((R,_)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1 font-mono text-xs truncate max-w-xs text-gray-700 dark:text-gray-100",title:R.uuid,children:R.uuid}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:R.folio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:R.tienda}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:R.fecha}),n.jsx("td",{className:"px-2 py-1",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${R.estado==="success"?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100":R.estado==="en_proceso"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100":"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100"}`,children:R.estado==="success"?"Cancelada":R.estado==="en_proceso"?"En Proceso":"Error"})}),n.jsxs("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100 text-xs",children:[n.jsx("div",{className:"max-w-xs truncate",title:R.mensaje,children:R.mensaje}),R.estatusAnterior&&R.estatusNuevo&&n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[R.estatusAnterior,"  ",R.estatusNuevo]})]}),n.jsx("td",{className:"px-2 py-1",children:n.jsxs("div",{className:"flex flex-wrap gap-1",children:[n.jsx("button",{onClick:()=>j(R.uuid,R.folio),disabled:m===R.uuid,className:"text-xs px-2 py-1 text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200 disabled:opacity-50",title:"Descargar PDF",children:m===R.uuid?"...":"PDF"}),n.jsx("button",{onClick:()=>A(R.uuid),disabled:d===R.uuid,className:"text-xs px-2 py-1 text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200 disabled:opacity-50",title:"Vista Previa",children:d===R.uuid?"...":"Ver"}),n.jsx("button",{onClick:()=>E(R),className:"text-xs px-2 py-1 text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-200",title:"Enviar Gmail",children:"Gmail"})]})})]},_))})]})}),n.jsx("div",{className:"flex justify-end",children:n.jsx(fe,{type:"button",onClick:y,variant:"secondary",children:"Excel"})})]}):n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx("p",{className:"text-gray-400 dark:text-gray-500",children:o||"Los resultados del proceso de cancelacin aparecern aqu."})})}),n.jsx(Ep,{isOpen:c.isOpen,onClose:F,facturaUuid:c.facturaUuid,facturaInfo:c.facturaInfo,correoInicial:c.correoInicial,rfcReceptor:c.rfcReceptor})]})},ta=({label:e,name:a,checked:t,onChange:r,className:s="",disabled:i=!1})=>n.jsxs("div",{className:`flex items-center ${s}`,children:[n.jsx("input",{type:"checkbox",name:a,id:a,checked:t,onChange:r,disabled:i,className:`h-4 w-4 rounded border-gray-300 dark:border-gray-600 focus:ring-2 transition-colors duration-200 ${t?"text-primary dark:text-secondary focus:ring-primary dark:focus:ring-secondary":"text-gray-600 dark:text-gray-400"} disabled:opacity-50 disabled:cursor-not-allowed`}),n.jsx("label",{htmlFor:a,className:`ml-2 block text-sm text-gray-900 dark:text-gray-200 ${i?"text-gray-400 dark:text-gray-500":""}`,children:e})]}),m9=({label:e,namePrefix:a,values:t,onChange:r,required:s=!1,className:i="",disabled:o=!1,onSearchClick:l,error:c=!1})=>{const{theme:u}=N.useContext(Kt),d="px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 sm:text-sm transition-colors duration-200",f="border-gray-300 placeholder-gray-400 focus:ring-primary focus:border-primary bg-white text-gray-900",m="dark:border-gray-600 dark:placeholder-gray-500 dark:focus:ring-secondary dark:focus:border-secondary dark:bg-gray-700 dark:text-gray-100",x="disabled:bg-gray-100 disabled:dark:bg-gray-800 disabled:text-gray-500 disabled:dark:text-gray-400 disabled:cursor-not-allowed",h=c?"border-red-600 focus:ring-red-600 focus:border-red-600":"";return n.jsxs("div",{className:`mb-1 ${i}`,children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e,s&&n.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n.jsxs("div",{className:"flex space-x-2 items-stretch",children:[n.jsx("input",{type:"text",name:`${a}Iniciales`,id:`${a}Iniciales`,value:t.iniciales,onChange:r,placeholder:"Iniciales",required:s,disabled:o,className:`${d} ${u==="light"?f:m} ${x} ${h} flex-1 w-1/3`,maxLength:4}),n.jsx("input",{type:"text",name:`${a}Fecha`,id:`${a}Fecha`,value:t.fecha,onChange:r,placeholder:"AAMMDD",required:s,disabled:o,className:`${d} ${u==="light"?f:m} ${x} ${h} flex-1 w-1/3`,maxLength:6}),n.jsx("input",{type:"text",name:`${a}Homoclave`,id:`${a}Homoclave`,value:t.homoclave,onChange:r,placeholder:"Homoclave",required:s,disabled:o,className:`${d} ${u==="light"?f:m} ${x} ${h} flex-1 w-1/3`,maxLength:3}),l&&n.jsx(fe,{type:"button",onClick:l,disabled:o,variant:"primary",className:"self-end h-full",children:"Buscar"})]})]})},Di=({formData:e,handleChange:a,onRfcSearchClick:t,isRFCRequired:r=!0,isRazonSocialRequired:s=!0,isDomicilioFiscalRequired:i=!0,isRegimenFiscalRequired:o=!0,isUsoCfdiRequired:l=!0,isCorreoElectronicoRequired:c=!0,rfcDisabled:u=!1,isRegimenFiscalDisabled:d=!1,isUsoCfdiDisabled:f=!1,fieldErrors:m={},mostrarRazonSocial:x=!0,mostrarNombreCompleto:h=!0,ocultarRFC:g=!1})=>n.jsxs(n.Fragment,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Datos fiscales:"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2",children:[!g&&n.jsxs(n.Fragment,{children:[n.jsx(m9,{label:"RFC:",namePrefix:"rfc",values:{iniciales:e.rfcIniciales,fecha:e.rfcFecha,homoclave:e.rfcHomoclave},onChange:a,onSearchClick:t,required:r,className:"lg:col-span-2",disabled:u,error:!!m.rfc}),m.rfc&&n.jsx("div",{className:"lg:col-span-1",children:n.jsx("p",{className:"text-red-600 text-xs mt-1",children:m.rfc})}),n.jsx("div",{})]}),n.jsx(J,{label:"Correo Electrnico:",name:"correoElectronico",type:"email",value:e.correoElectronico,onChange:a,required:c,error:!!m.correoElectronico}),m.correoElectronico&&n.jsx("div",{className:"md:col-span-1 lg:col-span-1",children:n.jsx("p",{className:"text-red-600 text-xs mt-1",children:m.correoElectronico})}),x&&n.jsxs(n.Fragment,{children:[n.jsx(J,{label:"Razn Social:",name:"razonSocial",value:e.razonSocial,onChange:a,required:s,error:!!m.razonSocial}),m.razonSocial&&n.jsx("div",{className:"md:col-span-1 lg:col-span-1",children:n.jsx("p",{className:"text-red-600 text-xs mt-1",children:m.razonSocial})})]}),h&&n.jsxs(n.Fragment,{children:[n.jsx(J,{label:"Nombre:",name:"nombre",value:e.nombre,onChange:a}),m.nombre&&n.jsx("div",{className:"md:col-span-1 lg:col-span-1",children:n.jsx("p",{className:"text-red-600 text-xs mt-1",children:m.nombre})}),n.jsx(J,{label:"Paterno:",name:"paterno",value:e.paterno,onChange:a}),m.paterno&&n.jsx("div",{className:"md:col-span-1 lg:col-span-1",children:n.jsx("p",{className:"text-red-600 text-xs mt-1",children:m.paterno})}),n.jsx(J,{label:"Materno:",name:"materno",value:e.materno,onChange:a}),m.materno&&n.jsx("div",{className:"md:col-span-1 lg:col-span-1",children:n.jsx("p",{className:"text-red-600 text-xs mt-1",children:m.materno})})]}),n.jsx(Se,{label:"Pas:",name:"pais",value:e.pais,onChange:a,options:qr}),n.jsx(J,{label:"No. Registro Identidad Tributaria:",name:"noRegistroIdentidadTributaria",value:e.noRegistroIdentidadTributaria,onChange:a}),n.jsx(J,{label:"Domicilio Fiscal:",name:"domicilioFiscal",value:e.domicilioFiscal,onChange:a,required:i,error:!!m.domicilioFiscal}),m.domicilioFiscal&&n.jsx("div",{className:"md:col-span-1 lg:col-span-1",children:n.jsx("p",{className:"text-red-600 text-xs mt-1",children:m.domicilioFiscal})}),n.jsx(Se,{label:"Rgimen Fiscal:",name:"regimenFiscal",value:e.regimenFiscal,onChange:a,options:gt,required:o,disabled:d,error:!!m.regimenFiscal}),m.regimenFiscal&&n.jsx("div",{className:"md:col-span-1 lg:col-span-1",children:n.jsx("p",{className:"text-red-600 text-xs mt-1",children:m.regimenFiscal})}),n.jsx(Se,{label:"Uso CFDI:",name:"usoCfdi",value:e.usoCfdi,onChange:a,options:yt,required:l,disabled:f,error:!!m.usoCfdi}),m.usoCfdi&&n.jsx("div",{className:"md:col-span-1 lg:col-span-1",children:n.jsx("p",{className:"text-red-600 text-xs mt-1",children:m.usoCfdi})})]})]}),ys=({label:e,name:a,value:t,onChange:r,placeholder:s,required:i=!1,className:o="",rows:l=3,disabled:c=!1})=>{const{theme:u}=N.useContext(Kt),d=a||`textarea-${e.toLowerCase().replace(/\s+/g,"-")}`;return n.jsxs("div",{className:`mb-1 ${o}`,children:[n.jsxs("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e,i&&n.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n.jsx("textarea",{name:d,id:d,value:t,onChange:r,placeholder:s||`Ingrese ${e.toLowerCase()}`,required:i,rows:l,disabled:c,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 sm:text-sm transition-colors duration-200 ${u==="light"?"border-gray-300 placeholder-gray-400 focus:ring-primary focus:border-primary bg-white text-gray-900":"dark:border-gray-600 dark:placeholder-gray-500 dark:focus:ring-secondary dark:focus:border-secondary dark:bg-gray-700 dark:text-gray-100"} disabled:bg-gray-100 disabled:dark:bg-gray-800 disabled:text-gray-500 disabled:dark:text-gray-400 disabled:cursor-not-allowed`})]})},pk=({label:e,name:a,options:t,selectedValue:r,onChange:s,required:i=!1,className:o="",inline:l=!1})=>{const{theme:c}=N.useContext(Kt);return n.jsxs("div",{className:`mb-1 ${o}`,children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e,i&&n.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n.jsx("div",{className:`flex ${l?"flex-row space-x-4":"flex-col space-y-1"}`,children:t.map(u=>n.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"radio",name:a,value:u.value,checked:r===u.value,onChange:s,required:i,className:`form-radio h-4 w-4 transition-colors duration-200 ${c==="light"?"text-primary focus:ring-primary":"dark:text-secondary dark:focus:ring-secondary dark:bg-gray-600 dark:border-gray-500"}`}),n.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:u.label})]},u.value))})]})};class x9{buildRfc(a,t,r){return`${(a||"").toUpperCase()}${(t||"").toUpperCase()}${(r||"").toUpperCase()}`.trim()}async buscarClientePorRFC(a){const t=(a||"").toUpperCase();if(!t)return{encontrado:!1,cliente:null};try{const s=await(await fetch(Re(`/catalogo-clientes/${encodeURIComponent(t)}`))).json().catch(()=>null);if(!s)return{encontrado:!1,cliente:null};const i=s!=null&&s.cliente?{rfc:s.cliente.rfc,razonSocial:s.cliente.razonSocial,nombre:s.cliente.nombre,paterno:s.cliente.paterno,materno:s.cliente.materno,correoElectronico:s.cliente.correoElectronico,pais:s.cliente.pais,domicilioFiscal:s.cliente.domicilioFiscal,regimenFiscal:s.cliente.regimenFiscal,registroTributario:s.cliente.registroTributario,usoCfdi:s.cliente.usoCfdi}:void 0;return{encontrado:!!(s!=null&&s.encontrado&&i),cliente:i??null}}catch(r){return console.error("Error consultando cliente catlogo por RFC",r),{encontrado:!1,cliente:null}}}async buscarClientesPorRFCParcial(a,t=10){const r=(a||"").toUpperCase().trim();if(!r||r.length<3)return[];try{const s=await fetch(Re(`/catalogo-clientes/buscar?rfc=${encodeURIComponent(r)}&limit=${t}`));if(s.ok){const i=await s.json();if(i.clientes&&Array.isArray(i.clientes))return i.clientes.map(o=>({rfc:o.rfc||"",razonSocial:o.razonSocial,nombre:o.nombre,paterno:o.paterno,materno:o.materno,correoElectronico:o.correoElectronico,pais:o.pais,domicilioFiscal:o.domicilioFiscal,regimenFiscal:o.regimenFiscal,registroTributario:o.registroTributario,usoCfdi:o.usoCfdi}))}return[]}catch(s){return console.error("Error buscando clientes por RFC parcial",s),[]}}async guardarCliente(a){try{const t=await fetch(Re("/catalogo-clientes"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),r=await t.json();return t.ok&&!r.error?{success:!0,idCliente:r.idCliente}:{success:!1,error:r.error||"Error al guardar cliente"}}catch(t){return console.error("Error guardando cliente",t),{success:!1,error:t instanceof Error?t.message:"Error desconocido"}}}async obtenerTodos(){try{const a=await fetch(Re("/catalogo-clientes"));if(a.ok){const t=await a.json();if(t.clientes&&Array.isArray(t.clientes))return t.clientes.map(r=>({idCliente:r.idCliente,rfc:r.rfc||"",razonSocial:r.razonSocial,nombre:r.nombre,paterno:r.paterno,materno:r.materno,correoElectronico:r.correoElectronico,pais:r.pais,domicilioFiscal:r.domicilioFiscal,regimenFiscal:r.regimenFiscal,registroTributario:r.registroTributario,usoCfdi:r.usoCfdi}))}return[]}catch(a){return console.error("Error obteniendo todos los clientes",a),[]}}async obtenerTodosPaginados(a=0,t=5){try{const r=await fetch(Re(`/catalogo-clientes?page=${a}&size=${t}`));if(r.ok){const s=await r.json();return{clientes:(s.clientes||[]).map(i=>({idCliente:i.idCliente,rfc:i.rfc||"",razonSocial:i.razonSocial,nombre:i.nombre,paterno:i.paterno,materno:i.materno,correoElectronico:i.correoElectronico,pais:i.pais,domicilioFiscal:i.domicilioFiscal,regimenFiscal:i.regimenFiscal,registroTributario:i.registroTributario,usoCfdi:i.usoCfdi})),total:s.total||0,page:s.page||0,size:s.size||5,totalPages:s.totalPages||0,hasNext:s.hasNext||!1,hasPrevious:s.hasPrevious||!1}}return{clientes:[],total:0,page:0,size:5,totalPages:0,hasNext:!1,hasPrevious:!1}}catch(r){return console.error("Error obteniendo clientes paginados",r),{clientes:[],total:0,page:0,size:5,totalPages:0,hasNext:!1,hasPrevious:!1}}}async obtenerPorId(a){try{const t=await fetch(Re(`/catalogo-clientes/id/${a}`));if(t.ok){const r=await t.json();if(r.cliente){const s=r.cliente;return{idCliente:s.idCliente,rfc:s.rfc||"",razonSocial:s.razonSocial,nombre:s.nombre,paterno:s.paterno,materno:s.materno,correoElectronico:s.correoElectronico,pais:s.pais,domicilioFiscal:s.domicilioFiscal,regimenFiscal:s.regimenFiscal,registroTributario:s.registroTributario,usoCfdi:s.usoCfdi}}}return null}catch(t){return console.error("Error obteniendo cliente por ID",t),null}}async actualizarCliente(a,t){try{const r=await fetch(Re(`/catalogo-clientes/${a}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),s=await r.json();return r.ok&&!s.error?{success:!0}:{success:!1,error:s.error||"Error al actualizar cliente"}}catch(r){return console.error("Error actualizando cliente",r),{success:!1,error:r instanceof Error?r.message:"Error desconocido"}}}async eliminarCliente(a){try{const t=await fetch(Re(`/catalogo-clientes/${a}`),{method:"DELETE"}),r=await t.json();return t.ok&&!r.error?{success:!0}:{success:!1,error:r.error||"Error al eliminar cliente"}}catch(t){return console.error("Error eliminando cliente",t),{success:!1,error:t instanceof Error?t.message:"Error desconocido"}}}}const ft=new x9;class h9{constructor(){this.baseUrl=Re("/tiendas")}async crearTienda(a){try{return await(await fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json()}catch(t){return console.error("Error al crear tienda:",t),{success:!1,message:"Error de conexin al crear la tienda",error:t instanceof Error?t.message:"Error desconocido"}}}async actualizarTienda(a,t){try{return await(await fetch(`${this.baseUrl}/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}catch(r){return console.error("Error al actualizar tienda:",r),{success:!1,message:"Error de conexin al actualizar la tienda",error:r instanceof Error?r.message:"Error desconocido"}}}async listarTiendas(a){try{const t=new URLSearchParams;a&&(a.estadoTienda&&t.append("estadoTienda",a.estadoTienda),a.region&&t.append("region",a.region),a.zona&&t.append("zona",a.zona),a.tipoTienda&&t.append("tipoTienda",a.tipoTienda),a.busqueda&&t.append("busqueda",a.busqueda));const r=t.toString()?`${this.baseUrl}?${t.toString()}`:this.baseUrl;return await(await fetch(r)).json()}catch(t){return console.error("Error al listar tiendas:",t),{success:!1,message:"Error de conexin al obtener las tiendas",error:t instanceof Error?t.message:"Error desconocido"}}}async obtenerTiendaPorId(a){try{return await(await fetch(`${this.baseUrl}/${a}`)).json()}catch(t){return console.error("Error al obtener tienda:",t),{success:!1,message:"Error de conexin al obtener la tienda",error:t instanceof Error?t.message:"Error desconocido"}}}async obtenerTiendaPorCodigo(a){try{return await(await fetch(`${this.baseUrl}/codigo/${a}`)).json()}catch(t){return console.error("Error al obtener tienda por cdigo:",t),{success:!1,message:"Error de conexin al obtener la tienda",error:t instanceof Error?t.message:"Error desconocido"}}}async eliminarTienda(a,t){try{const r=t?`${this.baseUrl}/${a}?usuarioModificacion=${encodeURIComponent(t)}`:`${this.baseUrl}/${a}`;return await(await fetch(r,{method:"DELETE"})).json()}catch(r){return console.error("Error al eliminar tienda:",r),{success:!1,message:"Error de conexin al eliminar la tienda",error:r instanceof Error?r.message:"Error desconocido"}}}async eliminarTiendaPermanente(a){try{return await(await fetch(`${this.baseUrl}/${a}/permanente`,{method:"DELETE"})).json()}catch(t){return console.error("Error al eliminar tienda permanentemente:",t),{success:!1,message:"Error de conexin al eliminar la tienda",error:t instanceof Error?t.message:"Error desconocido"}}}async obtenerEstadisticas(){try{return await(await fetch(`${this.baseUrl}/estadisticas`)).json()}catch(a){return console.error("Error al obtener estadsticas:",a),{success:!1,message:"Error de conexin al obtener las estadsticas",error:a instanceof Error?a.message:"Error desconocido"}}}async obtenerTiendasActivas(){try{return await(await fetch(`${this.baseUrl}/activas`)).json()}catch(a){return console.error("Error al obtener tiendas activas:",a),{success:!1,message:"Error de conexin al obtener las tiendas activas",error:a instanceof Error?a.message:"Error desconocido"}}}async healthCheck(){try{return await(await fetch(`${this.baseUrl}/health`)).json()}catch(a){return console.error("Error al verificar salud del servicio de tiendas:",a),{success:!1,message:"Error de conexin al verificar salud del servicio de tiendas",error:a instanceof Error?a.message:"Error desconocido"}}}}const Ji=new h9;function p9(){const[e,a]=N.useState([]),[t,r]=N.useState(!1),[s,i]=N.useState(null),o=N.useCallback(async()=>{r(!0),i(null);try{const l=await Ji.obtenerTiendasActivas();if(l.success&&Array.isArray(l.data)){const u=l.data.map(d=>({value:d.codigoTienda,label:`${d.nombreTienda} (${d.codigoTienda})`}));a(u)}else i(l.message||"No fue posible obtener las tiendas"),a([])}catch(l){i(l instanceof Error?l.message:"Error desconocido"),a([])}finally{r(!1)}},[]);return N.useEffect(()=>{o()},[o]),{options:e,loading:t,error:s,refresh:o}}class g9{constructor(){this.baseUrl=Re("/justificaciones")}async listar(){const t=await(await fetch(this.baseUrl)).json();if(t.success)return t.data||[];throw new Error(t.message||"Error al obtener justificaciones")}}const y9=new g9;function v9(){const[e,a]=N.useState([]),[t,r]=N.useState(!1),[s,i]=N.useState(null),o=N.useCallback(async()=>{r(!0),i(null);try{const c=(await y9.listar()).map(u=>({value:String(u.id),label:u.descripcion}));a(c)}catch(l){i((l==null?void 0:l.message)||"Error al cargar justificaciones")}finally{r(!1)}},[]);return N.useEffect(()=>{o()},[o]),{options:e,loading:t,error:s,refresh:o}}class b9{async agregarConcepto(a){const t=Re("/conceptos"),r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuidFactura:a.uuidFactura,idFactura:a.idFactura,skuClaveSat:a.skuClaveSat,descripcion:a.descripcion,unidadMedida:a.unidadMedida,valorUnitario:a.valorUnitario,cantidad:a.cantidad,descuento:a.descuento,tasaIva:a.tasaIva,iva:a.iva,tasaIeps:a.tasaIeps,ieps:a.ieps,noPedimento:a.noPedimento})});return r.ok?await r.json():{success:!1,message:await r.text()||"Error al agregar concepto"}}}const w9=new b9;var pv,gv,yv;const gk={sku:"",unidadMedida:((pv=pu[0])==null?void 0:pv.value)||"",descripcion:"",valorUnitario:"",descuentoConcepto:"",tasaIva:((gv=gu[0])==null?void 0:gv.value)||"",iva:"",tasaIeps:((yv=Pw[0])==null?void 0:yv.value)||"",ieps:"",tasaIe:"0",ie:"",noPedimento:""};var vv,bv,wv,Ev,kv,Nv,jv,Sv;const E9={rfcIniciales:"",rfcFecha:"",rfcHomoclave:"",correoElectronico:"",razonSocial:"",nombre:"",paterno:"",materno:"",pais:((vv=qr[0])==null?void 0:vv.value)||"",noRegistroIdentidadTributaria:"",domicilioFiscal:"",regimenFiscal:((bv=gt[0])==null?void 0:bv.value)||"",usoCfdi:((wv=yt[0])==null?void 0:wv.value)||"",tiendaBoleta:"",terminalBoleta:"",numeroBoleta:"",justificacion:((Ev=Rw[0])==null?void 0:Ev.value)||"",tipoDocumento:((kv=Dw[0])==null?void 0:kv.value)||"I",uuid:"",emisor:((Nv=Ma[0])==null?void 0:Nv.value)||"E001",fechaEmision:new Date().toISOString().split("T")[0],concepto:gk,medioPago:((jv=ss[0])==null?void 0:jv.value)||"",formaPago:((Sv=ws[0])==null?void 0:Sv.value)||"",descuentoTotal:"",subtotal:"",ivaTotal:"",iepsTotal:"",total:"",ivaDesglosado:!1,iepsDesglosado:!1,comentarios:""},k9=()=>{const[e,a]=N.useState(E9),{options:t,loading:r,error:s}=p9(),{options:i,loading:o,error:l}=v9(),[c,u]=N.useState(null),[d,f]=N.useState(null),[m,x]=N.useState(null),[h,g]=N.useState(null),[p,v]=N.useState(null),[w,b]=N.useState(!1),[y,j]=N.useState(null),A=N.useRef(null);N.useEffect(()=>{!e.tiendaBoleta&&t.length>0&&a(X=>({...X,tiendaBoleta:String(t[0].value)}))},[t]),N.useEffect(()=>{i.length>0&&(i.some(T=>String(T.value)===String(e.justificacion))||a(T=>({...T,justificacion:String(i[0].value)})))},[i]);const E=X=>X.length===12,F=X=>X.length===13;N.useEffect(()=>{const X=ft.buildRfc(e.rfcIniciales,e.rfcFecha,e.rfcHomoclave);let T=null;X&&X.length>=12&&(E(X)?T="moral":F(X)&&(T="fisica")),T!==A.current&&(A.current=T,j(T),T==="moral"?a(L=>({...L,nombre:"",paterno:"",materno:""})):T==="fisica"&&a(L=>({...L,razonSocial:""})))},[e.rfcIniciales,e.rfcFecha,e.rfcHomoclave]);const k=X=>{const{name:T,value:L,type:V}=X.target;if(T.startsWith("concepto.")){const O=T.split(".")[1];a(de=>({...de,concepto:{...de.concepto,[O]:L}}));return}if(V==="checkbox"){const O=X.target;a(de=>({...de,[T]:O.checked}));return}a(O=>({...O,[T]:L}))},P=async()=>{const X=ft.buildRfc(e.rfcIniciales,e.rfcFecha,e.rfcHomoclave);if(!X||X.length<12){alert("RFC incompleto. Verifica Iniciales, Fecha y Homoclave.");return}const T=await ft.buscarClientePorRFC(X);if(!T.encontrado||!T.cliente){alert(`No se encontr cliente para RFC: ${X}`);return}const L=T.cliente;a(V=>({...V,razonSocial:L.razonSocial||V.razonSocial,nombre:L.nombre||V.nombre,paterno:L.paterno||V.paterno,materno:L.materno||V.materno,pais:L.pais||V.pais,domicilioFiscal:L.domicilioFiscal||V.domicilioFiscal,regimenFiscal:L.regimenFiscal||V.regimenFiscal,usoCfdi:L.usoCfdi||V.usoCfdi,correoElectronico:V.correoElectronico})),alert("Datos fiscales del cliente cargados desde catlogo de clientes.")},R=async()=>{ft.buildRfc(e.rfcIniciales,e.rfcFecha,e.rfcHomoclave);try{const X={ok:!1,error:"Funcionalidad no implementada"};if(!X.ok){alert(X.error||"No se pudo agregar boleta");return}a(T=>({...T,serie:X.serie||T.serie,folio:X.folio||T.folio,uuid:X.uuid||T.uuid})),alert("Boleta agregada exitosamente")}catch(X){alert((X==null?void 0:X.message)||"Error al agregar boleta")}},_=async()=>{try{f(null),u(null);const X=(e.uuid||"").trim();if(!X){alert("Ingresa un UUID para consultar.");return}const T=e.tipoDocumento||"I",L=ft.buildRfc(e.rfcIniciales,e.rfcFecha,e.rfcHomoclave),V=await ma.consultarCfdiPorUUID({uuid:X,rfcReceptor:L||void 0,tipo:T});if(!V.exitoso){f(V.mensaje||"No se pudo consultar CFDI");return}u(V);const O=V.basicos||{},de=O.fechaEmision?String(O.fechaEmision):"",me=de?de.includes("T")?de.split("T")[0]:de:"";T==="I"||T==="E"?a(ae=>({...ae,serie:O.serie||ae.serie,folio:O.folio||ae.folio,medioPago:Ay(O.formaPago)||ae.medioPago,formaPago:Ry(O.metodoPago)||ae.formaPago,usoCfdi:Td(O.usoCfdi)||ae.usoCfdi,fechaEmision:me||ae.fechaEmision,descuentoTotal:O.descuento!=null?String(O.descuento):ae.descuentoTotal,subtotal:O.subtotal!=null?String(O.subtotal):ae.subtotal,ivaTotal:O.iva!=null?String(O.iva):ae.ivaTotal,iepsTotal:O.ieps!=null?String(O.ieps):ae.iepsTotal,total:O.total!=null?String(O.total):ae.total,ivaDesglosado:ae.ivaDesglosado||[O.iva16,O.iva8,O.iva0,O.ivaExento].some(ce=>ce!=null),iepsDesglosado:ae.iepsDesglosado||[O.ieps26,O.ieps160,O.ieps8,O.ieps30,O.ieps304,O.ieps7,O.ieps53,O.ieps25,O.ieps6,O.ieps50,O.ieps9,O.ieps3,O.ieps43].some(ce=>ce!=null)})):T==="P"&&a(ae=>({...ae,serie:O.serie||ae.serie,folio:O.folio||ae.folio,medioPago:Ay(O.formaPago)||ae.medioPago,formaPago:Ry(O.metodoPago)||ae.formaPago,usoCfdi:Td(O.usoCfdi)||ae.usoCfdi,fechaEmision:me||ae.fechaEmision}));try{const ae=(V.rfcReceptor||L||"").toUpperCase();if(ae&&(ae.length===12||ae.length===13)){const le=ae.length===12?ae.substring(0,3):ae.substring(0,4),I=ae.substring(ae.length===12?3:4,(ae.length===12?3:4)+6),q=ae.substring(ae.length-3);a(ne=>({...ne,rfcIniciales:ne.rfcIniciales||le,rfcFecha:ne.rfcFecha||I,rfcHomoclave:ne.rfcHomoclave||q}))}const ce=e.tiendaBoleta||"T001",W=await ma.buscarReceptorPorRFC({rfc:ae,idTienda:ce,correoElectronico:e.correoElectronico||""});if(W.encontrado&&W.receptor){const le=W.receptor;a(I=>({...I,razonSocial:le.razonSocial||I.razonSocial,nombre:le.nombre||I.nombre,paterno:le.paterno||I.paterno,materno:le.materno||I.materno,pais:le.pais||I.pais,domicilioFiscal:le.domicilioFiscal||I.domicilioFiscal,regimenFiscal:le.regimenFiscal||I.regimenFiscal,usoCfdi:I.usoCfdi||le.usoCfdi||I.usoCfdi,correoElectronico:I.correoElectronico||e.correoElectronico||I.correoElectronico}))}else{const le=await ft.buscarClientePorRFC(ae);if(le.encontrado&&le.cliente){const I=le.cliente;a(q=>({...q,razonSocial:I.razonSocial||q.razonSocial,nombre:I.nombre||q.nombre,paterno:I.paterno||q.paterno,materno:I.materno||q.materno,pais:I.pais||q.pais,domicilioFiscal:I.domicilioFiscal||q.domicilioFiscal,regimenFiscal:I.regimenFiscal||q.regimenFiscal,usoCfdi:q.usoCfdi||I.usoCfdi||q.usoCfdi,correoElectronico:q.correoElectronico||I.correoElectronico||q.correoElectronico}))}}}catch(ae){console.warn("No se pudo completar datos fiscales desde receptor/catalogo:",ae)}try{const ae=await ma.obtenerFacturaPorUUID(X);if(ae&&Array.isArray(ae.conceptos)&&ae.conceptos.length>0){const ce=ae.conceptos[0];a(W=>{const le={H87:"H87",KGM:"KGM",EA:"EA",ACT:"ACT",E48:"E48",Pieza:"H87",Kilogramo:"KGM","Cada uno":"EA",Actividad:"ACT","Unidad de servicio":"E48"},I=ce!=null&&ce.claveUnidad&&le[String(ce.claveUnidad)]?le[String(ce.claveUnidad)]:ce!=null&&ce.unidad&&le[String(ce.unidad)]?le[String(ce.unidad)]:W.concepto.unidadMedida,q=(ce==null?void 0:ce.precioUnitario)!=null?String(ce.precioUnitario):(ce==null?void 0:ce.valorUnitario)!=null?String(ce.valorUnitario):W.concepto.valorUnitario;return{...W,concepto:{...W.concepto,descripcion:(ce==null?void 0:ce.descripcion)||W.concepto.descripcion,valorUnitario:q,unidadMedida:I}}}),a(W=>({...W,subtotal:W.subtotal||(ae.subtotal!=null?String(ae.subtotal):W.subtotal),ivaTotal:W.ivaTotal||(ae.iva!=null?String(ae.iva):W.ivaTotal),total:W.total||(ae.importe!=null?String(ae.importe):W.total)}))}}catch(ae){console.warn("No se pudo obtener factura completa para prellenar conceptos:",ae)}}catch(X){console.error("Error consultando CFDI por UUID:",X),f((X==null?void 0:X.message)||"Error al consultar UUID")}},Q=async()=>{const X=(e.uuid||"").trim(),T=e.concepto;if(!T.sku||!T.descripcion||!T.unidadMedida||!T.valorUnitario){alert("SKU, Descripcin, Unidad y Valor Unitario son obligatorios.");return}const L=T.tasaIva==="EXENTO"?0:Math.round(parseFloat(T.tasaIva||"0")*100*100)/100,V=T.tasaIeps==="EXENTO"?0:Math.round(parseFloat(T.tasaIeps||"0")*100*100)/100,O=parseFloat(T.valorUnitario||"0"),de=parseFloat(T.descuentoConcepto||"0"),me=parseFloat(T.iva||"0"),ae=parseFloat(T.ieps||"0");try{const ce=await w9.agregarConcepto({uuidFactura:X||void 0,skuClaveSat:T.sku,descripcion:T.descripcion,unidadMedida:T.unidadMedida,valorUnitario:O,cantidad:1,descuento:de,tasaIva:L,iva:me,tasaIeps:V,ieps:ae,noPedimento:T.noPedimento});if(!ce.success){alert(ce.message||"No fue posible agregar el concepto");return}alert("Concepto agregado correctamente"),a(W=>({...W,concepto:{...gk}}))}catch(ce){alert((ce==null?void 0:ce.message)||"Error al agregar concepto")}},C=async X=>{var V;X.preventDefault(),x(null);const L={rfc:(ft.buildRfc(e.rfcIniciales,e.rfcFecha,e.rfcHomoclave)||"").toUpperCase(),correoElectronico:e.correoElectronico||"",razonSocial:e.razonSocial||`${e.nombre} ${e.paterno} ${e.materno}`.trim(),nombre:e.nombre||"",paterno:e.paterno||"",materno:e.materno||"",pais:e.pais||"MEX",noRegistroIdentidadTributaria:e.noRegistroIdentidadTributaria||"",domicilioFiscal:e.domicilioFiscal||"",regimenFiscal:e.regimenFiscal||"",usoCfdi:Td(e.usoCfdi)||"G03",codigoFacturacion:`CAP-LIBRE-${e.numeroBoleta||"SINBOLETA"}`,tienda:e.tiendaBoleta||"",fecha:e.fechaEmision||new Date().toISOString().slice(0,10),terminal:e.terminalBoleta||"",boleta:e.numeroBoleta||"",medioPago:e.medioPago||"PUE",formaPago:e.formaPago||"01",iepsDesglosado:!!e.iepsDesglosado,guardarEnMongo:!0};try{const O=await fetch(Re("/factura/generar/frontend"),{method:"POST",headers:Ca(),body:JSON.stringify(L)}),de=await O.json().catch(()=>null);if(!O.ok){alert((de==null?void 0:de.mensaje)||"Error al generar factura");return}const me=(de==null?void 0:de.uuid)||((V=de==null?void 0:de.datosFactura)==null?void 0:V.folioFiscal);if(a(ce=>({...ce,uuid:me||ce.uuid})),x(`Factura generada correctamente. UUID: ${me||"N/A"}`),me&&(g("4 - EN PROCESO DE EMISION"),S(me)),alert(`Factura exitosa. UUID: ${me||"N/A"}`),window.confirm("Desea enviar el PDF al correo del receptor?")){const ce=(e.correoElectronico||"").trim();if(!ce)alert("No hay correo del receptor. Ingrsalo y vuelve a intentar.");else if(!Pt.validarEmail(ce))alert("El formato del correo electrnico no es vlido.");else try{const W="Factura Captura Libre",le=`Se adjunta el PDF de su factura. UUID: ${me}`,I=await Pt.enviarCorreoConPdfAdjunto({uuidFactura:me,correoReceptor:ce,asunto:W,mensaje:le});I!=null&&I.success?alert(`Factura enviada al correo: ${ce}`):alert((I==null?void 0:I.message)||"No fue posible enviar la factura por correo.")}catch(W){alert((W==null?void 0:W.message)||"Error al enviar la factura por correo")}}}catch(O){alert((O==null?void 0:O.message)||"Error de red al generar factura")}},z=async X=>{try{const T=await fetch(kr(`/pac/stamp/status/${encodeURIComponent(X)}`));if(!T.ok)return null;const L=await T.json().catch(()=>null),V=String((L==null?void 0:L.status)||(L==null?void 0:L.codigo)||""),O=String((L==null?void 0:L.descripcion)||(L==null?void 0:L.statusDescripcion)||"");return V?{codigo:V,descripcion:O}:null}catch{return null}},S=X=>{p&&(window.clearInterval(p),v(null));const T=window.setInterval(async()=>{const L=await z(X);L&&(L.codigo==="0"?(g("0 - EMITIDA"),window.clearInterval(T),v(null)):L.codigo==="4"?g("4 - EN PROCESO DE EMISION"):L.codigo==="2"?(g("2 - CANCELADA EN SAT"),window.clearInterval(T),v(null)):L.codigo==="66"&&g("66 - POR TIMBRAR"))},3e3);v(T)},D=async()=>{var X,T,L,V,O,de,me,ae,ce;try{b(!0);const W=ft.buildRfc(e.rfcIniciales,e.rfcFecha,e.rfcHomoclave);if(!W||W.length<12){alert("RFC completo es requerido (iniciales, fecha y homoclave)");return}if(!((X=e.correoElectronico)!=null&&X.trim())){alert("Correo electrnico es requerido");return}if(!((T=e.razonSocial)!=null&&T.trim())){alert("Razn social es requerida");return}if(!((L=e.domicilioFiscal)!=null&&L.trim())){alert("Domicilio fiscal es requerido");return}const le={rfc:W.toUpperCase(),correoElectronico:e.correoElectronico.trim(),razonSocial:e.razonSocial.trim(),nombre:((V=e.nombre)==null?void 0:V.trim())||null,paterno:((O=e.paterno)==null?void 0:O.trim())||null,materno:((de=e.materno)==null?void 0:de.trim())||null,pais:e.pais||"MEX",noRegistroIdentidadTributaria:((me=e.noRegistroIdentidadTributaria)==null?void 0:me.trim())||null,domicilioFiscal:e.domicilioFiscal.trim(),regimenFiscal:e.regimenFiscal,usoCfdi:Td(e.usoCfdi)||"G03",tienda:e.tiendaBoleta||"",terminal:e.terminalBoleta||"",boleta:e.numeroBoleta||"",justificacion:e.justificacion,tipoDocumento:e.tipoDocumento,uuid:((ae=e.uuid)==null?void 0:ae.trim())||null,emisor:e.emisor,fechaEmision:e.fechaEmision,concepto:{sku:e.concepto.sku,unidadMedida:e.concepto.unidadMedida,descripcion:e.concepto.descripcion,valorUnitario:e.concepto.valorUnitario,descuentoConcepto:e.concepto.descuentoConcepto,tasaIva:e.concepto.tasaIva,iva:e.concepto.iva,tasaIeps:e.concepto.tasaIeps,ieps:e.concepto.ieps,tasaIe:e.concepto.tasaIe,ie:e.concepto.ie,noPedimento:e.concepto.noPedimento},medioPago:e.medioPago,formaPago:e.formaPago,descuentoTotal:e.descuentoTotal,subtotal:e.subtotal,ivaTotal:e.ivaTotal,iepsTotal:e.iepsTotal,total:e.total,ivaDesglosado:e.ivaDesglosado,iepsDesglosado:e.iepsDesglosado,comentarios:((ce=e.comentarios)==null?void 0:ce.trim())||null},I=await fetch(Re("/factura-libre/guardar"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(le)});if(!I.ok){const G=await I.text();throw new Error(`Error ${I.status}: ${G}`)}const q=await I.json();a(G=>({...G,uuid:q.uuid})),alert(`Factura procesada y guardada exitosamente
UUID: ${q.uuid||"N/A"}
Factura guardada en base de datos`),confirm("Desea enviar los archivos al correo del receptor?")&&B(q.uuid)}catch(W){console.error("Error guardando Factura Libre en BD:",W),alert(`Error al guardar en base de datos: ${W instanceof Error?W.message:"Error desconocido"}`)}finally{b(!1)}},H=async()=>{const X=(e.uuid||"").trim();if(!X){alert("Primero genera la factura para obtener el UUID y descargar el PDF.");return}try{await ma.generarYDescargarPDF(X)}catch(T){alert((T==null?void 0:T.message)||"Error al descargar PDF")}},U=async()=>{const X=(e.uuid||"").trim();if(!X){alert("Primero genera la factura para obtener el UUID y descargar el XML.");return}try{await ma.generarYDescargarXML(X)}catch(T){alert((T==null?void 0:T.message)||"Error al descargar XML")}},B=async X=>{if(!e.correoElectronico||!e.correoElectronico.trim()){alert("Por favor ingresa un correo electrnico vlido antes de enviar.");return}if(!Pt.validarEmail(e.correoElectronico)){alert("El formato del correo electrnico no es vlido.");return}const T=X||(e.uuid||"").trim();if(!T){alert("Primero genera la factura para obtener el UUID y poder enviarla por correo.");return}try{const L="Factura Captura Libre",V=`Se adjunta el PDF de su factura. UUID: ${T}`,O=await Pt.enviarCorreoConPdfAdjunto({uuidFactura:T,correoReceptor:e.correoElectronico.trim(),asunto:L,mensaje:V});if(!(O!=null&&O.success)){alert((O==null?void 0:O.message)||"No fue posible enviar la factura por correo.");return}alert(`Factura enviada al correo: ${e.correoElectronico.trim()}`)}catch(L){alert((L==null?void 0:L.message)||"Error al enviar la factura por correo")}};return n.jsxs("form",{onSubmit:C,className:"space-y-6",children:[m&&n.jsx("div",{className:"p-3 rounded bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-100",children:m}),e.uuid&&n.jsxs("div",{className:"p-2 rounded bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-100",children:["Estado de timbrado: ",h||"Desconocido"]}),n.jsx(Di,{formData:e,handleChange:k,onRfcSearchClick:P,mostrarRazonSocial:y==="moral"||y===null,mostrarNombreCompleto:y==="fisica"||y===null}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Boleta"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-x-6 gap-y-2 items-end",children:[n.jsx(Se,{label:"Tienda:",name:"tiendaBoleta",value:e.tiendaBoleta,onChange:k,options:t.length?t:Ia,className:"lg:col-span-1",disabled:r,error:!!s}),n.jsx(J,{label:"Terminal:",name:"terminalBoleta",value:e.terminalBoleta,onChange:k,className:"lg:col-span-1"}),n.jsx(J,{label:"Nmero de Boleta:",name:"numeroBoleta",value:e.numeroBoleta,onChange:k,className:"lg:col-span-1"}),n.jsx(fe,{type:"button",onClick:R,variant:"primary",className:"lg:self-end",children:"Agregar"})]})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Justificacin"}),n.jsx(Se,{label:"Justificacin para utilizar esta funcionalidad:",name:"justificacion",value:e.justificacion,onChange:k,options:i.length?i:Rw,disabled:o,error:!!l})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Tipo documento"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 items-start",children:[n.jsx(pk,{label:"Tipo de Documento:",name:"tipoDocumento",options:Dw,selectedValue:e.tipoDocumento,onChange:k,inline:!0}),n.jsx(J,{label:"UUID:",name:"uuid",value:e.uuid,onChange:k,placeholder:"Ingrese UUID si aplica"})]}),n.jsx("div",{className:"mt-4 flex justify-end",children:n.jsx(fe,{type:"button",onClick:_,variant:"primary",children:"Consultar Factura"})}),d&&n.jsx("div",{className:"mt-3 text-red-600 dark:text-red-400 text-sm",children:d})]}),n.jsx(ve,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 items-start",children:[n.jsx(Se,{label:"Empresa:",name:"emisor",value:e.emisor,onChange:k,options:Ma,required:!0}),n.jsx(J,{label:"Fecha de Emisin:",name:"fechaEmision",type:"date",value:e.fechaEmision,onChange:k})]})}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Conceptos (Es necesario agregar al menos uno)"}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Nota: Actualmente se permite un solo concepto. La funcionalidad para mltiples conceptos ser implementada."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2",children:[n.jsx(J,{label:"SKU o Clave SAT:",name:"concepto.sku",value:e.concepto.sku,onChange:k}),n.jsx(Se,{label:"Unidad de Medida:",name:"concepto.unidadMedida",value:e.concepto.unidadMedida,onChange:k,options:pu}),n.jsx(J,{label:"Descripcin:",name:"concepto.descripcion",value:e.concepto.descripcion,onChange:k}),n.jsx(J,{label:"Valor Unitario:",name:"concepto.valorUnitario",type:"number",value:e.concepto.valorUnitario,onChange:k}),n.jsx(J,{label:"Descuento:",name:"concepto.descuentoConcepto",type:"number",value:e.concepto.descuentoConcepto,onChange:k}),n.jsx(Se,{label:"Tasa IVA:",name:"concepto.tasaIva",value:e.concepto.tasaIva,onChange:k,options:gu}),n.jsx(J,{label:"IVA:",name:"concepto.iva",type:"number",value:e.concepto.iva,onChange:k}),n.jsx(Se,{label:"Tasa IEPS:",name:"concepto.tasaIeps",value:e.concepto.tasaIeps,onChange:k,options:Pw}),n.jsx(J,{label:"IEPS:",name:"concepto.ieps",type:"number",value:e.concepto.ieps,onChange:k}),n.jsx(Se,{label:"Tasa IE:",name:"concepto.tasaIe",value:e.concepto.tasaIe,onChange:k,options:[{value:"0",label:"0%"}]}),n.jsx(J,{label:"IE:",name:"concepto.ie",type:"number",value:e.concepto.ie,onChange:k}),n.jsx(J,{label:"No. Pedimento:",name:"concepto.noPedimento",value:e.concepto.noPedimento,onChange:k})]}),n.jsx("div",{className:"mt-4 flex justify-end",children:n.jsx(fe,{type:"button",onClick:Q,variant:"primary",children:"Agregar Concepto"})})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Totales"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2",children:[n.jsx(Se,{label:"Medio de pago:",name:"medioPago",value:e.medioPago,onChange:k,options:ss}),n.jsx(Se,{label:"Forma de pago:",name:"formaPago",value:e.formaPago,onChange:k,options:ws}),n.jsx(J,{label:"Descuento:",name:"descuentoTotal",type:"number",value:e.descuentoTotal,onChange:k}),n.jsx(J,{label:"Subtotal:",name:"subtotal",type:"number",value:e.subtotal,onChange:k}),n.jsx(J,{label:"IVA:",name:"ivaTotal",type:"number",value:e.ivaTotal,onChange:k}),n.jsx(J,{label:"IEPS:",name:"iepsTotal",type:"number",value:e.iepsTotal,onChange:k}),n.jsx(J,{label:"Total:",name:"total",type:"number",value:e.total,onChange:k})]}),n.jsxs("div",{className:"mt-4 space-y-2",children:[n.jsx(ta,{label:"IVA desglosado",name:"ivaDesglosado",checked:e.ivaDesglosado,onChange:k}),n.jsx(ta,{label:"IEPS desglosado",name:"iepsDesglosado",checked:e.iepsDesglosado,onChange:k}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Si el contribuyente requiere que se desglose el IEPS, deber mostrar su cdula donde indique sea sujeto"})]})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Comentarios"}),n.jsx(ys,{label:"",name:"comentarios",value:e.comentarios,onChange:k,rows:3})]}),n.jsxs("div",{className:"flex justify-end space-x-4 mt-8",children:[n.jsx(fe,{type:"button",onClick:U,variant:"secondary",children:"Descargar XML"}),n.jsx(fe,{type:"button",onClick:H,variant:"secondary",children:"Descargar PDF"}),n.jsx(fe,{type:"button",onClick:()=>B(),variant:"secondary",children:"Enviar por Correo"}),n.jsx(fe,{type:"button",onClick:D,variant:"primary",disabled:w,children:"Guardar"}),n.jsx(fe,{type:"submit",variant:"primary",children:"Facturar"})]})]})};function Td(e){const a=(e||"").trim().toUpperCase();return a?{GO1:"G01",GO2:"G02",GO3:"G03",SO1:"S01",CPO1:"CP01"}[a]||a:""}function Ay(e){const t=(e||"").trim().replace(/\D+/g,"");return t?t.padStart(2,"0"):""}function Ry(e){return(e||"").trim().toUpperCase()}const N9=[{value:"01",label:"Autotransporte"},{value:"04",label:"Transporte ferroviario"}],j9=Array.from({length:32},(e,a)=>({value:`CTR${String(a+1).padStart(3,"0")}`,label:`CTR${String(a+1).padStart(3,"0")}`})),S9=[{value:"01",label:"01 - Estacin de origen"},{value:"02",label:"02 - Estacin intermedia"},{value:"03",label:"03 - Estacin destino"}],bx=()=>new Date().toISOString().slice(0,16),Dy=()=>({rfcIniciales:"",rfcFecha:"",rfcHomoclave:"",correoElectronico:"",razonSocial:"",nombre:"",paterno:"",materno:"",pais:"Mxico",noRegistroIdentidadTributaria:"",domicilioFiscal:"45638",regimenFiscal:"605",usoCfdi:"G01",tipoPersona:null,descripcion:"",fechaInformacion:new Date().toISOString().split("T")[0].replace(/-/g,""),numeroSerie:"",precio:"",personaAutoriza:"",puesto:"",tipoTransporte:"01",complemento:{version:"3.1",transpInternac:"No",totalDistRec:"",ubicaciones:[{tipoUbicacion:"Origen",idUbicacion:"OR000001",rfcRemitenteDestinatario:"CUSC850516316",fechaHoraSalidaLlegada:bx(),tipoEstacion:"01",domicilio:{estado:"Jalisco",pais:"MEX",codigoPostal:"45638"}},{tipoUbicacion:"Destino",idUbicacion:"DE000001",rfcRemitenteDestinatario:"CUSC850516316",fechaHoraSalidaLlegada:bx(),tipoEstacion:"03",domicilio:{estado:"Jalisco",pais:"MEX",codigoPostal:"45638"}}],mercancias:{pesoBrutoTotal:"0.001",unidadPeso:"KGM",numTotalMercancias:"1",mercancias:[{bienesTransp:"78101801",descripcion:"Servicio de transporte",cantidad:"1.000000",claveUnidad:"H87",pesoEnKg:"0.001"}],autotransporte:{permSct:"",numPermisoSct:"",identificacionVehicular:{configVehicular:"VL",pesoBrutoVehicular:"",placaVm:"",anioModeloVm:""},seguros:{aseguraRespCivil:"",polizaRespCivil:""},remolques:[]}},figuraTransporte:{tiposFigura:[{tipoFigura:"01",nombreFigura:"",rfcFigura:"CUSC850516316",domicilio:{estado:"Jalisco",pais:"MEX",codigoPostal:"45638"}}]}}}),C9=()=>{const{empresaInfo:e}=On(),[a,t]=N.useState(Dy),[r,s]=N.useState(!1),[i,o]=N.useState(!1),[l,c]=N.useState(null);N.useEffect(()=>{t(S=>({...S,razonSocial:(e==null?void 0:e.nombre)||S.razonSocial,complemento:{...S.complemento,ubicaciones:S.complemento.ubicaciones.map((D,H)=>H===0?{...D,rfcRemitenteDestinatario:(e==null?void 0:e.rfc)||D.rfcRemitenteDestinatario,nombreRemitenteDestinatario:(e==null?void 0:e.nombre)||D.nombreRemitenteDestinatario}:D)}}))},[e]),N.useEffect(()=>{const S=`${a.rfcIniciales}${a.rfcFecha}${a.rfcHomoclave}`.trim().toUpperCase();let D=null;S.length===12&&(D="moral"),S.length===13&&(D="fisica"),D!==l&&(c(D),t(H=>{const U={...H,tipoPersona:D};return D==="moral"?(U.nombre="",U.paterno="",U.materno=""):D==="fisica"&&(U.razonSocial=""),U}))},[a.rfcIniciales,a.rfcFecha,a.rfcHomoclave,l]);const u=S=>{const{name:D,value:H}=S.target;t(U=>({...U,[D]:H}))},d=(S,D)=>{t(H=>({...H,complemento:{...H.complemento,ubicaciones:H.complemento.ubicaciones.map((U,B)=>B===S?{...U,...D}:U)}}))},f=()=>{t(S=>({...S,complemento:{...S.complemento,ubicaciones:[...S.complemento.ubicaciones,{tipoUbicacion:"Intermedia",idUbicacion:`UBI-${Date.now()}`,rfcRemitenteDestinatario:"",fechaHoraSalidaLlegada:bx(),tipoEstacion:"02",domicilio:null}]}}))},m=S=>{a.complemento.ubicaciones.length<=2||t(D=>({...D,complemento:{...D.complemento,ubicaciones:D.complemento.ubicaciones.filter((H,U)=>U!==S)}}))},x=(S,D)=>{t(H=>({...H,complemento:{...H.complemento,mercancias:{...H.complemento.mercancias,mercancias:H.complemento.mercancias.mercancias.map((U,B)=>B===S?{...U,...D}:U)}}}))},h=()=>{t(S=>({...S,complemento:{...S.complemento,mercancias:{...S.complemento.mercancias,mercancias:[...S.complemento.mercancias.mercancias,{bienesTransp:"",descripcion:"",cantidad:"1",claveUnidad:"H87",pesoEnKg:"0"}]}}}))},g=S=>{a.complemento.mercancias.mercancias.length<=1||t(D=>({...D,complemento:{...D.complemento,mercancias:{...D.complemento.mercancias,mercancias:D.complemento.mercancias.mercancias.filter((H,U)=>U!==S)}}}))},p=S=>{t(D=>({...D,complemento:{...D.complemento,mercancias:{...D.complemento.mercancias,autotransporte:{...D.complemento.mercancias.autotransporte,...S}}}}))},v=S=>{t(D=>({...D,complemento:{...D.complemento,mercancias:{...D.complemento.mercancias,transporteFerroviario:{...D.complemento.mercancias.transporteFerroviario,...S}}}}))},w=(S,D)=>{t(H=>({...H,complemento:{...H.complemento,figuraTransporte:{tiposFigura:H.complemento.figuraTransporte.tiposFigura.map((U,B)=>B===S?{...U,...D}:U)}}}))},b=()=>{t(S=>({...S,complemento:{...S.complemento,figuraTransporte:{tiposFigura:[...S.complemento.figuraTransporte.tiposFigura,{tipoFigura:"01",nombreFigura:"",domicilio:{estado:"Jalisco",pais:"MEX",codigoPostal:"44100"}}]}}}))},y=()=>{a.complemento.mercancias.autotransporte&&t(S=>({...S,complemento:{...S.complemento,mercancias:{...S.complemento.mercancias,autotransporte:{...S.complemento.mercancias.autotransporte,remolques:[...S.complemento.mercancias.autotransporte.remolques,{subTipoRem:"",placa:""}]}}}}))},j=S=>{a.complemento.mercancias.autotransporte&&t(D=>({...D,complemento:{...D.complemento,mercancias:{...D.complemento.mercancias,autotransporte:{...D.complemento.mercancias.autotransporte,remolques:D.complemento.mercancias.autotransporte.remolques.filter((H,U)=>U!==S)}}}}))},A=S=>{a.complemento.figuraTransporte.tiposFigura.length<=1||t(D=>({...D,complemento:{...D.complemento,figuraTransporte:{tiposFigura:D.complemento.figuraTransporte.tiposFigura.filter((H,U)=>U!==S)}}}))},E=S=>{t(D=>{const H={...D,tipoTransporte:S};return S==="01"?(H.complemento.mercancias.autotransporte||(H.complemento.mercancias.autotransporte={permSct:"",numPermisoSct:"",identificacionVehicular:{configVehicular:"VL",pesoBrutoVehicular:"",placaVm:"",anioModeloVm:""},seguros:{aseguraRespCivil:"",polizaRespCivil:""},remolques:[]}),H.complemento.mercancias.transporteFerroviario=void 0):S==="04"&&(H.complemento.mercancias.transporteFerroviario||(H.complemento.mercancias.transporteFerroviario={tipoDeServicio:"TS01",tipoDeTrafico:"TT01",carros:[{tipoCarro:"TC01",matriculaCarro:"",guiaCarro:"",toneladasNetasCarro:""}]})),H})},F=()=>{const S=Dy();S.rfcIniciales="CUSC",S.rfcFecha="850516",S.rfcHomoclave="316",S.correoElectronico="cesar.cruz@ejemplo.com",S.nombre="CESAR OSBALDO",S.paterno="CRUZ",S.materno="SOLORZANO",S.razonSocial="",S.tipoPersona="fisica",S.pais="Mxico",S.noRegistroIdentidadTributaria="",S.domicilioFiscal="45638",S.regimenFiscal="605",S.usoCfdi="G01",S.descripcion="Servicio de transporte terrestre de productos alimenticios",S.fechaInformacion=new Date().toISOString().split("T")[0].replace(/-/g,""),S.numeroSerie="CP"+new Date().getFullYear()+String(Math.floor(Math.random()*1e3)).padStart(3,"0"),S.precio="45000",S.personaAutoriza="CESAR OSBALDO CRUZ SOLORZANO",S.puesto="Coordinador de Logstica",S.tipoTransporte="01",S.complemento.ubicaciones=[{tipoUbicacion:"Origen",idUbicacion:"ORIGEN1",rfcRemitenteDestinatario:"CUSC850516316",nombreRemitenteDestinatario:(e==null?void 0:e.nombre)||"EMPRESA DISTRIBUIDORA SA DE CV",fechaHoraSalidaLlegada:new Date().toISOString().slice(0,16),tipoEstacion:"01",domicilio:{calle:"Avenida Juarez",numeroExterior:"100",estado:"Jalisco",pais:"MEX",codigoPostal:"45638"}},{tipoUbicacion:"Destino",idUbicacion:"DESTINO1",rfcRemitenteDestinatario:"CUSC850516316",nombreRemitenteDestinatario:"CESAR OSBALDO CRUZ SOLORZANO",fechaHoraSalidaLlegada:new Date(Date.now()+6*60*60*1e3).toISOString().slice(0,16),tipoEstacion:"03",distanciaRecorrida:"250.00",domicilio:{calle:"Avenida Insurgentes",numeroExterior:"500",estado:"Jalisco",pais:"MEX",codigoPostal:"45638"}}],S.complemento.totalDistRec="250.00",S.complemento.mercancias={pesoBrutoTotal:"2850.500",unidadPeso:"KGM",numTotalMercancias:"2",mercancias:[{bienesTransp:"78101801",descripcion:"Productos alimenticios envasados",cantidad:"120.500000",claveUnidad:"H87",pesoEnKg:"1450.250",valorMercancia:"25000",moneda:"MXN"},{bienesTransp:"78101801",descripcion:"Bebidas embotelladas",cantidad:"180.250000",claveUnidad:"H87",pesoEnKg:"1400.250",valorMercancia:"20000",moneda:"MXN"}],autotransporte:{permSct:"TPAF01",numPermisoSct:"SCT"+String(Math.floor(Math.random()*1e6)).padStart(6,"0"),identificacionVehicular:{configVehicular:"VL",pesoBrutoVehicular:"38500.00",placaVm:"ABC"+String(Math.floor(Math.random()*1e3)).padStart(3,"0")+"X",anioModeloVm:String(new Date().getFullYear()-2)},seguros:{aseguraRespCivil:"GRUPO NACIONAL PROVINCIAL SA",polizaRespCivil:"GNP"+String(Math.floor(Math.random()*1e7)).padStart(10,"0")},remolques:[]}},S.complemento.figuraTransporte={tiposFigura:[{tipoFigura:"01",nombreFigura:(e==null?void 0:e.nombre)||"TRANSPORTES Y LOGISTICA INTEGRAL SA DE CV",rfcFigura:"CUSC850516316",numLicencia:"LT"+String(Math.floor(Math.random()*1e7)).padStart(10,"0"),domicilio:{calle:"Avenida Lopez Mateos",numeroExterior:"2500",estado:"Jalisco",pais:"MEX",codigoPostal:"45638"}}]},t(S),c("fisica")},k=()=>!a.rfcIniciales||!a.rfcFecha||!a.rfcHomoclave?(alert("RFC es requerido"),!1):a.correoElectronico?l==="moral"&&!a.razonSocial?(alert("Razn social es requerida"),!1):l==="fisica"&&(!a.nombre||!a.paterno)?(alert("Nombre y apellido paterno son requeridos"),!1):!a.domicilioFiscal||!a.regimenFiscal||!a.usoCfdi?(alert("Complete los datos fiscales"),!1):!a.descripcion||!a.numeroSerie||!a.precio?(alert("Complete la informacin general"),!1):a.complemento.ubicaciones.length<2?(alert("Capture al menos una ubicacin de origen y una de destino"),!1):a.complemento.mercancias.mercancias.length===0?(alert("Capture al menos una mercanca"),!1):a.tipoTransporte==="01"&&!a.complemento.mercancias.autotransporte?(alert("Complete la informacin de Autotransporte"),!1):a.tipoTransporte==="04"&&!a.complemento.mercancias.transporteFerroviario?(alert("Complete la informacin de Transporte Ferroviario"),!1):!0:(alert("Correo electrnico es requerido"),!1),[P,R]=N.useState(""),_=async()=>{try{if(!k())return;const{normalizeCartaPortePayload:S}=await No(async()=>{const{normalizeCartaPortePayload:V}=await import("./cartaPorteService-CNBFrT_E.js");return{normalizeCartaPortePayload:V}},[]),D={...a,versionCartaPorte:"3.1"},H=S(D),U={versionComplemento:"3.1",rfcIniciales:H.rfcIniciales,rfcFecha:H.rfcFecha,rfcHomoclave:H.rfcHomoclave,correoElectronico:H.correoElectronico,razonSocial:H.razonSocial,nombre:H.nombre,paterno:H.paterno,materno:H.materno,domicilioFiscal:H.domicilioFiscal,regimenFiscal:H.regimenFiscal,usoCfdi:H.usoCfdi,descripcion:H.descripcion,fechaInformacion:H.fechaInformacion,numeroSerie:H.numeroSerie,precio:H.precio,personaAutoriza:H.personaAutoriza,puesto:H.puesto,tipoTransporte:H.tipoTransporte,tipoPersona:H.tipoPersona,complemento:H.complemento},B=await fetch(Re("/carta-porte/preview-pdf"),{method:"POST",headers:Ca(),body:JSON.stringify(U)});if(!B.ok){const V=await B.text();throw new Error(`Error HTTP ${B.status}: ${V}`)}const X=await B.blob(),T=window.URL.createObjectURL(X),L=document.createElement("a");L.href=T,L.target="_blank",L.rel="noopener noreferrer",document.body.appendChild(L),L.click(),document.body.removeChild(L),window.URL.revokeObjectURL(T)}catch(S){console.error("Error en vista previa:",S);const D=S instanceof Error?S.message:"Error desconocido";alert(`Error al generar vista previa: ${D}`)}},Q=async()=>{if(k())try{o(!0);const{normalizeCartaPortePayload:S}=await No(async()=>{const{normalizeCartaPortePayload:L}=await import("./cartaPorteService-CNBFrT_E.js");return{normalizeCartaPortePayload:L}},[]),D={...a,versionCartaPorte:"3.1"},H=S(D),U={versionCartaPorte:"3.1",rfcIniciales:H.rfcIniciales,rfcFecha:H.rfcFecha,rfcHomoclave:H.rfcHomoclave,correoElectronico:H.correoElectronico,razonSocial:H.razonSocial,nombre:H.nombre,paterno:H.paterno,materno:H.materno,domicilioFiscal:H.domicilioFiscal,regimenFiscal:H.regimenFiscal,usoCfdi:H.usoCfdi,descripcion:H.descripcion,fechaInformacion:H.fechaInformacion,numeroSerie:H.numeroSerie,precio:H.precio,personaAutoriza:H.personaAutoriza,puesto:H.puesto,tipoTransporte:H.tipoTransporte,tipoPersona:H.tipoPersona,complemento:H.complemento},B=await fetch(Re("/carta-porte/guardar"),{method:"POST",headers:Ca(),body:JSON.stringify(U)});if(!B.ok){const L=await B.text();throw new Error(`Error ${B.status}: ${L}`)}const T=(await B.json()).uuid||"";T&&R(T),alert(`Carta Porte timbrada exitosamente
UUID: ${T||"N/A"}`),confirm("Desea enviar los archivos timbrados al correo del receptor?")&&C(T)}catch(S){console.error("Error guardando Carta Porte:",S),alert(`Error: ${S instanceof Error?S.message:"Error desconocido"}`)}finally{o(!1)}},C=async S=>{var D;if(k())try{s(!0);const H=(D=a.correoElectronico)==null?void 0:D.trim();if(!H||!Pt.validarEmail(H)){alert("Capture un correo electrnico vlido");return}const{normalizeCartaPortePayload:U}=await No(async()=>{const{normalizeCartaPortePayload:de}=await import("./cartaPorteService-CNBFrT_E.js");return{normalizeCartaPortePayload:de}},[]),B={...a,versionCartaPorte:"3.1"},X=U(B),T={versionCartaPorte:"3.1",rfcIniciales:X.rfcIniciales,rfcFecha:X.rfcFecha,rfcHomoclave:X.rfcHomoclave,correoElectronico:X.correoElectronico,razonSocial:X.razonSocial,nombre:X.nombre,paterno:X.paterno,materno:X.materno,domicilioFiscal:X.domicilioFiscal,regimenFiscal:X.regimenFiscal,usoCfdi:X.usoCfdi,descripcion:X.descripcion,fechaInformacion:X.fechaInformacion,numeroSerie:X.numeroSerie,precio:X.precio,personaAutoriza:X.personaAutoriza,puesto:X.puesto,tipoTransporte:X.tipoTransporte,tipoPersona:X.tipoPersona,complemento:X.complemento};let L=S||P;if(!L||L.trim()===""){const de=await fetch(Re("/carta-porte/guardar"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!de.ok)throw new Error("Error al timbrar la Carta Porte");const me=await de.json();L=(me==null?void 0:me.uuid)||"",L&&R(L)}const V=`Carta Porte CP-${a.numeroSerie}`;await Pt.enviarCorreoConPdfAdjunto({uuidFactura:L,correoReceptor:H,asunto:V,mensaje:`Estimado(a),

Adjuntamos la Carta Porte generada.

Saludos.`}),alert("Carta Porte enviada por correo exitosamente")}catch(H){console.error("Error enviando correo:",H),alert(`Error: ${H instanceof Error?H.message:"Error desconocido"}`)}finally{s(!1)}},z=async()=>{if(k())try{const S={versionCartaPorte:"3.1",rfcIniciales:a.rfcIniciales,rfcFecha:a.rfcFecha,rfcHomoclave:a.rfcHomoclave,correoElectronico:a.correoElectronico,razonSocial:a.razonSocial,nombre:a.nombre,paterno:a.paterno,materno:a.materno,domicilioFiscal:a.domicilioFiscal,regimenFiscal:a.regimenFiscal,usoCfdi:a.usoCfdi,descripcion:a.descripcion,fechaInformacion:a.fechaInformacion,numeroSerie:a.numeroSerie,precio:a.precio,personaAutoriza:a.personaAutoriza,puesto:a.puesto,tipoTransporte:a.tipoTransporte,tipoPersona:a.tipoPersona,complemento:a.complemento},D=await fetch(Re("/carta-porte/preview-xml"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)});if(!D.ok)throw new Error("Error al generar XML");const H=await D.json(),U=new Blob([H.xml],{type:"application/xml"}),B=URL.createObjectURL(U),X=document.createElement("a");X.href=B,X.download=`CartaPorte_${a.numeroSerie||"CP001"}.xml`,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(B)}catch(S){console.error("Error descargando XML:",S),alert(`Error: ${S instanceof Error?S.message:"Error desconocido"}`)}};return n.jsxs("form",{className:"space-y-6",children:[n.jsx(ve,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(J,{label:"Nmero de Serie",name:"numeroSerie",value:a.numeroSerie,onChange:u,required:!0}),n.jsx(J,{label:"Precio",name:"precio",type:"number",value:a.precio,onChange:u,required:!0}),n.jsx(J,{label:"Fecha (AAAAMMDD)",name:"fechaInformacion",value:a.fechaInformacion,onChange:u,required:!0})]})}),n.jsx(Di,{formData:a,handleChange:u,onRfcSearchClick:()=>{},mostrarRazonSocial:l==="moral"||l===null,mostrarNombreCompleto:l==="fisica"||l===null}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Informacin general"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(ys,{label:"Descripcin",name:"descripcion",rows:3,value:a.descripcion,onChange:u,required:!0}),n.jsx(J,{label:"Persona que autoriza",name:"personaAutoriza",value:a.personaAutoriza,onChange:u,required:!0}),n.jsx(J,{label:"Puesto",name:"puesto",value:a.puesto,onChange:u,required:!0})]})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Ubicaciones"}),n.jsx("div",{className:"space-y-4",children:a.complemento.ubicaciones.map((S,D)=>n.jsxs(ve,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h4",{className:"font-semibold",children:["Ubicacin ",D+1," (",S.tipoUbicacion,")"]}),a.complemento.ubicaciones.length>2&&n.jsx(fe,{type:"button",variant:"neutral",onClick:()=>m(D),children:"Eliminar"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(Se,{label:"Tipo de Ubicacin",name:`ubicacion-tipo-${D}`,value:S.tipoUbicacion,onChange:H=>d(D,{tipoUbicacion:H.target.value}),options:[{value:"Origen",label:"Origen"},{value:"Destino",label:"Destino"},{value:"Intermedia",label:"Intermedia"}]}),n.jsx(J,{label:"ID Ubicacin",name:`ubicacion-id-${D}`,value:S.idUbicacion||"",onChange:H=>d(D,{idUbicacion:H.target.value})}),n.jsx(J,{label:"RFC Remitente/Destinatario",name:`ubicacion-rfc-${D}`,value:S.rfcRemitenteDestinatario,onChange:H=>d(D,{rfcRemitenteDestinatario:H.target.value}),required:!0}),n.jsx(J,{label:"Nombre",name:`ubicacion-nombre-${D}`,value:S.nombreRemitenteDestinatario||"",onChange:H=>d(D,{nombreRemitenteDestinatario:H.target.value})}),n.jsx(J,{label:"Fecha / Hora",type:"datetime-local",name:`ubicacion-fecha-${D}`,value:S.fechaHoraSalidaLlegada,onChange:H=>d(D,{fechaHoraSalidaLlegada:H.target.value}),required:!0}),a.tipoTransporte==="04"&&n.jsx(Se,{label:"Tipo de estacin",name:`ubicacion-tipoEstacion-${D}`,value:S.tipoEstacion||"",onChange:H=>d(D,{tipoEstacion:H.target.value}),options:S9}),n.jsx(J,{label:"Distancia Recorrida",name:`ubicacion-distancia-${D}`,type:"number",value:S.distanciaRecorrida||"",onChange:H=>d(D,{distanciaRecorrida:H.target.value})})]}),S.domicilio&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[n.jsx(J,{label:"Calle",name:`dom-calle-${D}`,value:S.domicilio.calle||"",onChange:H=>d(D,{domicilio:{...S.domicilio,calle:H.target.value}})}),n.jsx(J,{label:"Estado",name:`dom-estado-${D}`,value:S.domicilio.estado,onChange:H=>d(D,{domicilio:{...S.domicilio,estado:H.target.value}}),required:!0}),n.jsx(J,{label:"Cdigo Postal",name:`dom-cp-${D}`,value:S.domicilio.codigoPostal,onChange:H=>d(D,{domicilio:{...S.domicilio,codigoPostal:H.target.value}}),required:!0}),n.jsx(J,{label:"Pas",name:`dom-pais-${D}`,value:S.domicilio.pais,onChange:H=>d(D,{domicilio:{...S.domicilio,pais:H.target.value}}),required:!0})]})]},S.idUbicacion||D))}),n.jsx("div",{className:"mt-4",children:n.jsx(fe,{type:"button",variant:"neutral",onClick:f,children:"Agregar ubicacin intermedia"})})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Mercancas"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[n.jsx(J,{label:"Peso Bruto Total (kg)",name:"pesoBrutoTotal",type:"number",value:a.complemento.mercancias.pesoBrutoTotal,onChange:S=>t(D=>({...D,complemento:{...D.complemento,mercancias:{...D.complemento.mercancias,pesoBrutoTotal:S.target.value}}}))}),n.jsx(J,{label:"Total de Mercancas",name:"numTotalMercancias",type:"number",value:a.complemento.mercancias.numTotalMercancias,onChange:S=>t(D=>({...D,complemento:{...D.complemento,mercancias:{...D.complemento.mercancias,numTotalMercancias:S.target.value}}}))})]}),n.jsx("div",{className:"space-y-4",children:a.complemento.mercancias.mercancias.map((S,D)=>n.jsxs(ve,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h4",{className:"font-semibold",children:["Mercanca ",D+1]}),a.complemento.mercancias.mercancias.length>1&&n.jsx(fe,{type:"button",variant:"neutral",onClick:()=>g(D),children:"Eliminar"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(J,{label:"Clave BienesTransp",name:`mercancia-bienes-${D}`,value:S.bienesTransp,onChange:H=>x(D,{bienesTransp:H.target.value}),required:!0}),n.jsx(J,{label:"Descripcin",name:`mercancia-descripcion-${D}`,value:S.descripcion,onChange:H=>x(D,{descripcion:H.target.value}),required:!0}),n.jsx(J,{label:"Cantidad",type:"number",name:`mercancia-cantidad-${D}`,value:S.cantidad,onChange:H=>x(D,{cantidad:H.target.value}),required:!0}),n.jsx(J,{label:"Clave Unidad",name:`mercancia-clave-${D}`,value:S.claveUnidad,onChange:H=>x(D,{claveUnidad:H.target.value}),required:!0}),n.jsx(J,{label:"Peso En Kg",type:"number",name:`mercancia-peso-${D}`,value:S.pesoEnKg,onChange:H=>x(D,{pesoEnKg:H.target.value}),required:!0}),n.jsx(J,{label:"Valor Mercanca",type:"number",name:`mercancia-valor-${D}`,value:S.valorMercancia||"",onChange:H=>x(D,{valorMercancia:H.target.value})})]})]},`mercancia-${D}`))}),n.jsx("div",{className:"mt-4",children:n.jsx(fe,{type:"button",variant:"neutral",onClick:h,children:"Agregar mercanca"})})]}),n.jsxs(ve,{children:[n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:n.jsx(Se,{label:"Tipo de Transporte",name:"tipoTransporte",value:a.tipoTransporte,onChange:S=>E(S.target.value),options:N9})}),a.tipoTransporte==="01"&&a.complemento.mercancias.autotransporte&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("h4",{className:"font-semibold",children:"Autotransporte"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(J,{label:"Permiso SCT",name:"autotransporte-permiso",value:a.complemento.mercancias.autotransporte.permSct,onChange:S=>p({permSct:S.target.value}),required:!0}),n.jsx(J,{label:"Nmero Permiso SCT",name:"autotransporte-numpermiso",value:a.complemento.mercancias.autotransporte.numPermisoSct,onChange:S=>p({numPermisoSct:S.target.value}),required:!0}),n.jsx(J,{label:"Config. Vehicular",name:"autotransporte-config",value:a.complemento.mercancias.autotransporte.identificacionVehicular.configVehicular,onChange:S=>p({identificacionVehicular:{...a.complemento.mercancias.autotransporte.identificacionVehicular,configVehicular:S.target.value}}),required:!0}),n.jsx(J,{label:"Placa",name:"autotransporte-placa",value:a.complemento.mercancias.autotransporte.identificacionVehicular.placaVm,onChange:S=>p({identificacionVehicular:{...a.complemento.mercancias.autotransporte.identificacionVehicular,placaVm:S.target.value}}),required:!0}),n.jsx(J,{label:"Peso Bruto Vehicular",type:"number",name:"autotransporte-peso",value:a.complemento.mercancias.autotransporte.identificacionVehicular.pesoBrutoVehicular,onChange:S=>p({identificacionVehicular:{...a.complemento.mercancias.autotransporte.identificacionVehicular,pesoBrutoVehicular:S.target.value}}),required:!0}),n.jsx(J,{label:"Ao Modelo",name:"autotransporte-anio",value:a.complemento.mercancias.autotransporte.identificacionVehicular.anioModeloVm,onChange:S=>p({identificacionVehicular:{...a.complemento.mercancias.autotransporte.identificacionVehicular,anioModeloVm:S.target.value}}),required:!0}),n.jsx(J,{label:"Aseguradora RC",name:"autotransporte-aseguradora",value:a.complemento.mercancias.autotransporte.seguros.aseguraRespCivil,onChange:S=>p({seguros:{...a.complemento.mercancias.autotransporte.seguros,aseguraRespCivil:S.target.value}}),required:!0}),n.jsx(J,{label:"Pliza RC",name:"autotransporte-poliza",value:a.complemento.mercancias.autotransporte.seguros.polizaRespCivil,onChange:S=>p({seguros:{...a.complemento.mercancias.autotransporte.seguros,polizaRespCivil:S.target.value}}),required:!0})]}),n.jsxs("div",{className:"mt-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h5",{className:"font-semibold",children:"Remolques"}),n.jsx(fe,{type:"button",variant:"neutral",onClick:y,children:"Agregar remolque"})]}),a.complemento.mercancias.autotransporte.remolques.length===0&&n.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 mb-2",children:"Si su ConfigVehicular requiere remolque (ej: C2, C3), debe agregar al menos un remolque."}),n.jsx("div",{className:"space-y-3",children:a.complemento.mercancias.autotransporte.remolques.map((S,D)=>n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 border p-3 rounded",children:[n.jsx(Se,{label:"Subtipo Remolque",name:`remolque-subtipo-${D}`,value:S.subTipoRem,onChange:H=>p({remolques:a.complemento.mercancias.autotransporte.remolques.map((U,B)=>B===D?{...U,subTipoRem:H.target.value}:U)}),options:j9,required:!0}),n.jsx(J,{label:"Placa",name:`remolque-placa-${D}`,value:S.placa,onChange:H=>p({remolques:a.complemento.mercancias.autotransporte.remolques.map((U,B)=>B===D?{...U,placa:H.target.value}:U)}),required:!0}),n.jsx("div",{className:"flex items-end",children:n.jsx(fe,{type:"button",variant:"neutral",onClick:()=>j(D),className:"w-full",children:"Eliminar"})})]},`remolque-${D}`))})]})]}),a.tipoTransporte==="04"&&a.complemento.mercancias.transporteFerroviario&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("h4",{className:"font-semibold",children:"Transporte ferroviario"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(J,{label:"Tipo de Servicio",name:"ferro-servicio",value:a.complemento.mercancias.transporteFerroviario.tipoDeServicio,onChange:S=>v({tipoDeServicio:S.target.value}),required:!0}),n.jsx(J,{label:"Tipo de Trfico",name:"ferro-trafico",value:a.complemento.mercancias.transporteFerroviario.tipoDeTrafico,onChange:S=>v({tipoDeTrafico:S.target.value}),required:!0})]}),n.jsx("h5",{className:"font-semibold",children:"Carros"}),n.jsx("div",{className:"space-y-3",children:a.complemento.mercancias.transporteFerroviario.carros.map((S,D)=>n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 border p-3 rounded",children:[n.jsx(J,{label:"Tipo Carro",name:`ferro-carro-tipo-${D}`,value:S.tipoCarro,onChange:H=>v({carros:a.complemento.mercancias.transporteFerroviario.carros.map((U,B)=>B===D?{...U,tipoCarro:H.target.value}:U)}),required:!0}),n.jsx(J,{label:"Matrcula",name:`ferro-carro-matricula-${D}`,value:S.matriculaCarro,onChange:H=>v({carros:a.complemento.mercancias.transporteFerroviario.carros.map((U,B)=>B===D?{...U,matriculaCarro:H.target.value}:U)}),required:!0}),n.jsx(J,{label:"Gua",name:`ferro-carro-guia-${D}`,value:S.guiaCarro,onChange:H=>v({carros:a.complemento.mercancias.transporteFerroviario.carros.map((U,B)=>B===D?{...U,guiaCarro:H.target.value}:U)}),required:!0}),n.jsx(J,{label:"Toneladas Netas",type:"number",name:`ferro-carro-toneladas-${D}`,value:S.toneladasNetasCarro,onChange:H=>v({carros:a.complemento.mercancias.transporteFerroviario.carros.map((U,B)=>B===D?{...U,toneladasNetasCarro:H.target.value}:U)}),required:!0})]},`carro-${D}`))})]})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Figuras de transporte"}),n.jsx("div",{className:"space-y-4",children:a.complemento.figuraTransporte.tiposFigura.map((S,D)=>n.jsxs(ve,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h4",{className:"font-semibold",children:["Figura ",D+1]}),a.complemento.figuraTransporte.tiposFigura.length>1&&n.jsx(fe,{type:"button",variant:"neutral",onClick:()=>A(D),children:"Eliminar"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(J,{label:"Tipo Figura",name:`figura-tipo-${D}`,value:S.tipoFigura,onChange:H=>w(D,{tipoFigura:H.target.value}),required:!0}),n.jsx(J,{label:"Nombre",name:`figura-nombre-${D}`,value:S.nombreFigura,onChange:H=>w(D,{nombreFigura:H.target.value}),required:!0}),n.jsx(J,{label:"RFC",name:`figura-rfc-${D}`,value:S.rfcFigura||"",onChange:H=>w(D,{rfcFigura:H.target.value})}),n.jsx(J,{label:"Nmero Licencia",name:`figura-licencia-${D}`,value:S.numLicencia||"",onChange:H=>w(D,{numLicencia:H.target.value})})]}),S.domicilio&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[n.jsx(J,{label:"Calle",name:`figura-calle-${D}`,value:S.domicilio.calle||"",onChange:H=>w(D,{domicilio:{...S.domicilio,calle:H.target.value}})}),n.jsx(J,{label:"Estado",name:`figura-estado-${D}`,value:S.domicilio.estado,onChange:H=>w(D,{domicilio:{...S.domicilio,estado:H.target.value}}),required:!0}),n.jsx(J,{label:"Cdigo Postal",name:`figura-cp-${D}`,value:S.domicilio.codigoPostal,onChange:H=>w(D,{domicilio:{...S.domicilio,codigoPostal:H.target.value}}),required:!0}),n.jsx(J,{label:"Pas",name:`figura-pais-${D}`,value:S.domicilio.pais,onChange:H=>w(D,{domicilio:{...S.domicilio,pais:H.target.value}}),required:!0})]})]},`figura-${D}`))}),n.jsx("div",{className:"mt-4",children:n.jsx(fe,{type:"button",variant:"neutral",onClick:b,children:"Agregar figura"})})]}),n.jsxs("div",{className:"flex flex-col md:flex-row justify-end gap-3",children:[n.jsx(fe,{type:"button",variant:"neutral",onClick:F,disabled:i||r,children:"Cargar ejemplo"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:z,disabled:i||r,children:"Descargar XML"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:_,disabled:i||r,children:"Vista Previa"}),n.jsx(fe,{type:"button",variant:"primary",onClick:Q,disabled:i||r,children:i?"Timbrando...":"Timbrar y guardar"}),n.jsx(fe,{type:"button",variant:"primary",onClick:()=>C(),disabled:r||i,children:r?"Enviando...":"Enviar al correo"})]})]})};var Cv,Tv,Fv,_v,Av,Rv;const T9={rfcIniciales:"",rfcFecha:"",rfcHomoclave:"",correoElectronico:"",razonSocial:"",nombre:"",paterno:"",materno:"",pais:((Cv=qr[0])==null?void 0:Cv.value)||"",noRegistroIdentidadTributaria:"",domicilioFiscal:"",regimenFiscal:((Tv=gt[0])==null?void 0:Tv.value)||"",usoCfdi:((Fv=yt[0])==null?void 0:Fv.value)||"",codigoFacturacion:"",tienda:((_v=Ia[0])==null?void 0:_v.value)||"",fechaBoleta:new Date().toISOString().split("T")[0],terminal:"",boleta:"",medioPago:((Av=ss[0])==null?void 0:Av.value)||"",formaPago:((Rv=ws[0])==null?void 0:Rv.value)||"",iepsDesglosado:!1},F9=()=>{const[e,a]=N.useState(T9),t=o=>{const{name:l,value:c,type:u}=o.target;if(u==="checkbox"){const{checked:d}=o.target;a(f=>({...f,[l]:d}))}else a(d=>({...d,[l]:c}))},r=()=>{alert(`Buscando RFC: ${e.rfcIniciales}${e.rfcFecha}${e.rfcHomoclave}`)},s=()=>{alert(`Boleta agregada (simulado): Cdigo ${e.codigoFacturacion}, Tienda ${e.tienda}, Fecha ${e.fechaBoleta}`)},i=o=>{o.preventDefault(),console.log("Facturar Monederos:",e),alert("Facturando Monederos (simulado). Ver consola para datos.")};return n.jsxs("form",{onSubmit:i,className:"space-y-6",children:[n.jsx(Di,{formData:e,handleChange:t,onRfcSearchClick:r}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Consultar Boleta:"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2 items-end",children:[n.jsx(J,{label:"Cdigo de Facturacin:",name:"codigoFacturacion",value:e.codigoFacturacion,onChange:t}),n.jsx(Se,{label:"Tienda:",name:"tienda",value:e.tienda,onChange:t,options:Ia}),n.jsx(J,{label:"Fecha:",name:"fechaBoleta",type:"date",value:e.fechaBoleta,onChange:t}),n.jsx(J,{label:"Terminal:",name:"terminal",value:e.terminal,onChange:t}),n.jsx(J,{label:"Boleta:",name:"boleta",value:e.boleta,onChange:t}),n.jsx("div",{className:"flex justify-start md:col-start-3 md:justify-end pt-4",children:n.jsx(fe,{type:"button",onClick:s,variant:"primary",children:"Agregar"})})]})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Forma de pago:"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2 items-center",children:[n.jsx(Se,{label:"Medio de pago:",name:"medioPago",value:e.medioPago,onChange:t,options:ss}),n.jsx(Se,{label:"Forma de pago:",name:"formaPago",value:e.formaPago,onChange:t,options:ws})]}),n.jsx("div",{className:"mt-4",children:n.jsx(ta,{label:"IEPS desglosado",name:"iepsDesglosado",checked:e.iepsDesglosado,onChange:t})})]})]})};var Dv,Pv;const _9={motoElectrica:!1,sku:"",cantidad:"1",unidadMedida:((Dv=pu[0])==null?void 0:Dv.value)||"",tipo:"",marca:"",modelo:"",color:"",anio:"",cilindraje:"",numeroSerie:"",motor:"",repuve:"",paisOrigen:"",aduana:"",fechaEntrada:"",pedimento:"",descripcionConcepto:"",valorUnitario:"",descuentoConcepto:"",tasaIva:((Pv=gu[0])==null?void 0:Pv.value)||"",ivaConcepto:""};var Ov,Iv,Mv,Uv,Lv,Bv;const A9={rfcIniciales:"",rfcFecha:"",rfcHomoclave:"",correoElectronico:"",razonSocial:"",nombre:"",paterno:"",materno:"",pais:((Ov=qr[0])==null?void 0:Ov.value)||"",noRegistroIdentidadTributaria:"",domicilioFiscal:"",regimenFiscal:((Iv=gt[0])==null?void 0:Iv.value)||"",usoCfdi:((Mv=yt[0])==null?void 0:Mv.value)||"",tiendaBoleta:((Uv=Ia[0])==null?void 0:Uv.value)||"",terminalBoleta:"",numeroBoleta:"",concepto:_9,medioPago:((Lv=ss[0])==null?void 0:Lv.value)||"",formaPago:((Bv=ws[0])==null?void 0:Bv.value)||"",descuentoTotal:"",subtotal:"",ivaTotal:"",total:"",ivaDesglosadoTotal:!1,comentarios:""},R9=()=>{const[e,a]=N.useState(A9),t=c=>{const{name:u,value:d,type:f}=c.target;if(u.startsWith("concepto.")){const m=u.split(".")[1],{checked:x}=c.target;a(h=>({...h,concepto:{...h.concepto,[m]:f==="checkbox"?x:d}}))}else if(f==="checkbox"){const{checked:m}=c.target;a(x=>({...x,[u]:m}))}else a(m=>({...m,[u]:d}))},r=()=>alert(`Buscando RFC: ${e.rfcIniciales}${e.rfcFecha}${e.rfcHomoclave}`),s=()=>alert("Boleta agregada (simulado)"),i=()=>alert("Concepto de Moto agregado (simulado)."),o=c=>{c.preventDefault(),console.log("Facturar Motos:",e),alert("Facturando Motos (simulado). Ver consola.")},l=async()=>{if(!e.correoElectronico||!e.correoElectronico.trim()){alert("Por favor ingresa un correo electrnico vlido antes de enviar.");return}if(!Pt.validarEmail(e.correoElectronico)){alert("El formato del correo electrnico no es vlido.");return}confirm(`Deseas enviar la factura de motos por correo a: ${e.correoElectronico}?

Nota: Primero debes generar la factura para poder enviarla por correo.`)&&(console.log("Enviar por Correo (Motos):",e),alert(`Para enviar facturas por correo:

1. Primero genera la factura
2. Luego usa el botn "Enviar Correo" en la tabla de facturas
3. O el sistema enviar automticamente si proporcionas un correo al generar la factura`))};return n.jsxs("form",{onSubmit:o,className:"space-y-6",children:[n.jsx(Di,{formData:e,handleChange:t,onRfcSearchClick:r}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Boleta"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-x-6 gap-y-2 items-end",children:[n.jsx(Se,{label:"Tienda:",name:"tiendaBoleta",value:e.tiendaBoleta,onChange:t,options:Ia,className:"lg:col-span-1"}),n.jsx(J,{label:"Terminal:",name:"terminalBoleta",value:e.terminalBoleta,onChange:t,className:"lg:col-span-1"}),n.jsx(J,{label:"Nmero de Boleta:",name:"numeroBoleta",value:e.numeroBoleta,onChange:t,className:"lg:col-span-1"}),n.jsx(fe,{type:"button",onClick:s,variant:"primary",className:"lg:self-end",children:"Agregar"})]})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-primary dark:text-secondary mb-2",children:"Conceptos (Es necesario agregar al menos uno)"}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Nota: Actualmente se permite un solo concepto. La funcionalidad para mltiples conceptos ser implementada."}),n.jsx(ta,{label:"Moto Elctrica",name:"concepto.motoElectrica",checked:e.concepto.motoElectrica,onChange:t,className:"mb-3"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2",children:[n.jsx(J,{label:"SKU o Clave SAT:",name:"concepto.sku",value:e.concepto.sku,onChange:t}),n.jsx(J,{label:"Cantidad:",name:"concepto.cantidad",type:"number",value:e.concepto.cantidad,onChange:t}),n.jsx(Se,{label:"Unidad de Medida:",name:"concepto.unidadMedida",value:e.concepto.unidadMedida,onChange:t,options:pu}),n.jsx(J,{label:"*Tipo:",name:"concepto.tipo",value:e.concepto.tipo,onChange:t,required:!0}),n.jsx(J,{label:"*Marca:",name:"concepto.marca",value:e.concepto.marca,onChange:t,required:!0}),n.jsx(J,{label:"*Modelo:",name:"concepto.modelo",value:e.concepto.modelo,onChange:t,required:!0}),n.jsx(J,{label:"*Color:",name:"concepto.color",value:e.concepto.color,onChange:t,required:!0}),n.jsx(J,{label:"*Ao:",name:"concepto.anio",type:"number",value:e.concepto.anio,onChange:t,required:!0,maxLength:4}),n.jsx(J,{label:"*Cilindraje:",name:"concepto.cilindraje",value:e.concepto.cilindraje,onChange:t,required:!0}),n.jsx(J,{label:"*Nmero de serie:",name:"concepto.numeroSerie",value:e.concepto.numeroSerie,onChange:t,required:!0}),n.jsx(J,{label:"*Motor:",name:"concepto.motor",value:e.concepto.motor,onChange:t,required:!0}),n.jsx(J,{label:"*REPUVE:",name:"concepto.repuve",value:e.concepto.repuve,onChange:t,required:!0}),n.jsx(J,{label:"Pas de Origen:",name:"concepto.paisOrigen",value:e.concepto.paisOrigen,onChange:t}),n.jsx(J,{label:"Aduana:",name:"concepto.aduana",value:e.concepto.aduana,onChange:t}),n.jsx(J,{label:"Fecha de entrada:",name:"concepto.fechaEntrada",type:"date",value:e.concepto.fechaEntrada,onChange:t}),n.jsx(J,{label:"Pedimento:",name:"concepto.pedimento",value:e.concepto.pedimento,onChange:t}),n.jsx(ys,{label:"Descripcin:",name:"concepto.descripcionConcepto",value:e.concepto.descripcionConcepto,onChange:t,rows:3,className:"md:col-span-2 lg:col-span-3"}),n.jsx(J,{label:"Valor Unitario:",name:"concepto.valorUnitario",type:"number",value:e.concepto.valorUnitario,onChange:t}),n.jsx(J,{label:"Descuento:",name:"concepto.descuentoConcepto",type:"number",value:e.concepto.descuentoConcepto,onChange:t}),n.jsx(Se,{label:"Tasa IVA:",name:"concepto.tasaIva",value:e.concepto.tasaIva,onChange:t,options:gu}),n.jsx(J,{label:"IVA:",name:"concepto.ivaConcepto",type:"number",value:e.concepto.ivaConcepto,onChange:t})]}),n.jsx("div",{className:"mt-4 flex justify-end",children:n.jsx(fe,{type:"button",onClick:i,variant:"primary",children:"Agregar Concepto"})})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Totales"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2",children:[n.jsx(Se,{label:"Medio de pago:",name:"medioPago",value:e.medioPago,onChange:t,options:ss}),n.jsx(Se,{label:"Forma de pago:",name:"formaPago",value:e.formaPago,onChange:t,options:ws}),n.jsx(J,{label:"Descuento:",name:"descuentoTotal",type:"number",value:e.descuentoTotal,onChange:t}),n.jsx(J,{label:"Subtotal:",name:"subtotal",type:"number",value:e.subtotal,onChange:t}),n.jsx(J,{label:"IVA:",name:"ivaTotal",type:"number",value:e.ivaTotal,onChange:t}),n.jsx(J,{label:"Total:",name:"total",type:"number",value:e.total,onChange:t})]}),n.jsx("div",{className:"mt-4",children:n.jsx(ta,{label:"IVA desglosado",name:"ivaDesglosadoTotal",checked:e.ivaDesglosadoTotal,onChange:t})})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Comentarios"}),n.jsx(ys,{label:"",name:"comentarios",value:e.comentarios,onChange:t,rows:3})]}),n.jsxs("div",{className:"flex justify-end space-x-4 mt-8",children:[n.jsx(fe,{type:"button",onClick:l,variant:"secondary",children:"Enviar por Correo"}),n.jsx(fe,{type:"submit",variant:"primary",children:"Facturar"})]})]})};async function D9(e,a,t){const r={idEmpleado:a,fechaNomina:t,rfcEmisor:e.rfcEmisor,rfcReceptor:e.rfcReceptor,nombre:e.nombre,curp:e.curp||"",periodoPago:e.periodoPago||"",fechaPago:e.fechaPago,percepciones:e.percepciones||"0",deducciones:e.deducciones||"0",total:e.total||"",tipoNomina:e.tipoNomina,usoCfdi:e.usoCfdi||"CN01",correoElectronico:e.correoElectronico,domicilioFiscalReceptor:e.domicilioFiscalReceptor||"",numSeguridadSocial:e.numSeguridadSocial||"",fechaInicioRelLaboral:e.fechaInicioRelLaboral||"",antiguedad:e.antiguedad||"",riesgoPuesto:e.riesgoPuesto||"",salarioDiarioIntegrado:e.salarioDiarioIntegrado||"",usuarioCreacion:"frontend"};return await(await fetch(Re("/nominas/guardar"),{method:"POST",headers:Ca(),body:JSON.stringify(r)})).json().catch(()=>({ok:!1,message:"Respuesta invlida"}))}async function P9(e){const a=Re(`/nominas/historial?idEmpleado=${encodeURIComponent(e)}`),t=await fetch(a);return t.ok?await t.json().catch(()=>[]):[]}const Gn={async registrarUsuario(e){try{const a=await fetch(`${tn}/usuarios/registro`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return a.ok?await a.json():{success:!1,message:(await a.json()).message||"Error en el registro"}}catch(a){return console.error("Error al registrar usuario:",a),{success:!1,message:"Error de conexin con el servidor"}}},async obtenerPerfiles(){try{const e=await fetch(`${tn}/usuarios/perfiles`,{method:"GET",headers:{"Content-Type":"application/json"}});return e.ok?await e.json():(console.error("Error al obtener perfiles:",e.statusText),[])}catch(e){return console.error("Error al obtener perfiles:",e),[]}},async consultarEmpleados(){try{const e=await fetch(`${tn}/usuarios/empleados`,{method:"GET",headers:{"Content-Type":"application/json"}});return e.ok?await e.json():(console.error("Error al consultar empleados:",e.statusText),[])}catch(e){return console.error("Error al consultar empleados:",e),[]}},async consultarEmpleadosEspecificos(e){try{const a=await fetch(`${tn}/usuarios/empleados?noUsuario=${encodeURIComponent(e)}`,{method:"GET",headers:{"Content-Type":"application/json"}});return a.ok?await a.json():(console.error("Error al consultar empleados especficos:",a.statusText),[])}catch(a){return console.error("Error al consultar empleados especficos:",a),[]}},async actualizarPerfil(e,a,t){try{const r=await fetch(`${tn}/usuarios/actualizar-perfil`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({noUsuario:e,idPerfil:a,usuarioMod:t})}),s=await r.json();return r.ok?s:{success:!1,message:s.message||"Error al actualizar perfil"}}catch(r){return console.error("Error al actualizar perfil:",r),{success:!1,message:"Error de conexin al actualizar perfil"}}},async eliminarUsuario(e,a){try{const t=await fetch(`${tn}/usuarios/eliminar`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({noUsuario:e,usuarioMod:a})}),r=await t.json();return t.ok?r:{success:!1,message:r.message||"Error al eliminar usuario"}}catch(t){return console.error("Error al eliminar usuario:",t),{success:!1,message:"Error de conexin al eliminar usuario"}}}},Vf=[{limInf:0,limSup:123580.8,cuotaFija:0,tasa:.0192},{limInf:123580.81,limSup:249243.12,cuotaFija:2376.28,tasa:.064},{limInf:249243.13,limSup:392840.52,cuotaFija:10997.58,tasa:.1088},{limInf:392840.53,limSup:75e4,cuotaFija:34067.58,tasa:.16},{limInf:750000.01,limSup:1e6,cuotaFija:108067.58,tasa:.1792},{limInf:100000001e-2,limSup:1/0,cuotaFija:166067.58,tasa:.3192}];function O9(e){for(const a of Vf)if(e>=a.limInf&&e<=a.limSup)return a;return Vf[Vf.length-1]}function Py(e){if(!isFinite(e)||e<=0)return 0;const a=O9(e),t=Math.max(0,e-a.limInf),r=a.cuotaFija+t*a.tasa;return Math.max(0,r)}function Oy(e,a="MENSUAL"){if(!isFinite(e)||e<=0)return 0;if(a==="ANUAL")return Py(e);const t=e*12,s=Py(t)/12;return Math.max(0,s)}function Bi(e){return isFinite(e)?Number(e).toFixed(2):"0.00"}function Iy(e){return String(e).padStart(2,"0")}function My(e){return`${Iy(e.getDate())}/${Iy(e.getMonth()+1)}/${e.getFullYear()}`}function Uy(e,a){return new Date(e,a+1,0)}function I9(e,a){const t=a?new Date(`${a}T00:00:00`):new Date,r=t.getFullYear(),s=t.getMonth(),i=t.getDate();let o,l;e==="MENSUAL"?(o=new Date(r,s,1),l=Uy(r,s)):i<=15?(o=new Date(r,s,1),l=new Date(r,s,15)):(o=new Date(r,s,16),l=Uy(r,s));const c=`${My(o)} al ${My(l)}`;return{inicio:o,fin:l,label:c}}function M9(e,a){return I9(e,a).label}const Hf={rfcEmisor:"",rfcReceptor:"",nombre:"",curp:"",periodoPago:"",periodicidad:"QUINCENAL",fechaPago:new Date().toISOString().split("T")[0],total:"",deducciones:"",percepciones:"",tipoNomina:"",usoCfdi:"",correo:"",domicilioFiscalReceptor:"",numSeguridadSocial:"12345678901",fechaInicioRelLaboral:new Date(new Date().setFullYear(new Date().getFullYear()-1)).toISOString().split("T")[0],antiguedad:"P1Y",riesgoPuesto:"1",salarioDiarioIntegrado:"500.00",numDiasPagados:"15"},U9=()=>{const{empresaInfo:e}=On(),[a,t]=N.useState(""),[r,s]=N.useState(""),[i,o]=N.useState(Hf),[l,c]=N.useState([]),[u,d]=N.useState(!1),[f,m]=N.useState(null),[x,h]=N.useState(!1),g=()=>{if(f)try{window.URL.revokeObjectURL(f)}catch{}m(null),d(!1)};N.useEffect(()=>{e.rfc&&o(E=>({...E,rfcEmisor:e.rfc}))},[e]),N.useEffect(()=>{s("EMP123")},[]),N.useEffect(()=>{const E=M9(i.periodicidad||"QUINCENAL",i.fechaPago);o(F=>({...F,periodoPago:E}))},[i.periodicidad,i.fechaPago]);const p=E=>{if(!E)return"";try{const F=new Date(E),k=new Date;let P=k.getFullYear()-F.getFullYear(),R=k.getMonth()-F.getMonth(),_=k.getDate()-F.getDate();if(_<0){R--;const C=new Date(k.getFullYear(),k.getMonth(),0).getDate();_+=C}R<0&&(P--,R+=12);const Q=[];return P>0&&Q.push(`${P}Y`),R>0&&Q.push(`${R}M`),_>0&&Q.push(`${_}D`),Q.length>0?`P${Q.join("")}`:"P0D"}catch{return""}};N.useEffect(()=>{if(i.fechaInicioRelLaboral){const E=p(i.fechaInicioRelLaboral);E&&o(F=>({...F,antiguedad:E}))}},[i.fechaInicioRelLaboral]),N.useEffect(()=>{if(i.percepciones&&i.numDiasPagados){const E=parseFloat(i.percepciones.replace(/,/g,""))||0,F=parseInt(i.numDiasPagados)||15,P=E/F*1.5;o(R=>({...R,salarioDiarioIntegrado:Bi(P)}))}},[i.percepciones,i.numDiasPagados]);const v=async E=>{E.preventDefault();const F=(r||"").trim();if(!F){alert("Ingresa un ID de empleado para buscar.");return}try{const k=await Gn.consultarEmpleadosEspecificos(F);if(k&&k.length>0){const P=k[0],R=P.salarioBase,_=R!=null?Number(R):void 0,Q=_!==void 0?Oy(Number(_)):void 0,C=_!==void 0&&Q!==void 0?Math.max(0,Number(_)-Number(Q)):void 0;o(z=>({...z,nombre:P.nombreEmpleado||z.nombre,correo:P.correo||z.correo,rfcReceptor:P.rfc||z.rfcReceptor,curp:P.curp||z.curp,domicilioFiscalReceptor:P.codigoPostal||P.cp||P.domicilioFiscal||z.domicilioFiscalReceptor||"",percepciones:_!==void 0?Bi(Number(_)):z.percepciones,deducciones:Q!==void 0?Bi(Number(Q)):z.deducciones,total:C!==void 0?Bi(Number(C)):z.total,fechaPago:a||z.fechaPago,tipoNomina:z.tipoNomina||"O",usoCfdi:z.usoCfdi||"CN01",periodicidad:z.periodicidad||"QUINCENAL"})),alert(`Empleado ${P.noUsuario} encontrado. Formulario actualizado.`);try{const z=await P9(F);c(z.map(S=>({id:S.id,fecha:S.fecha,idEmpleado:S.idEmpleado,estado:S.estado,uuid:S.uuid})))}catch(z){console.error("Error consultando historial de nminas:",z),c([])}}else alert(`Empleado con ID "${F}" no encontrado.`),o(Hf),c([])}catch(k){console.error("Error al consultar empleado:",k),alert("Error al consultar empleado. Revisa la conexin con el backend.")}},w=async()=>{try{if(!i.rfcReceptor||!i.rfcReceptor.trim()){alert("Por favor ingrese el RFC del receptor.");return}const E={rfcEmisor:i.rfcEmisor,rfcReceptor:i.rfcReceptor,nombre:i.nombre,curp:i.curp,periodoPago:i.periodoPago,fechaPago:i.fechaPago,percepciones:i.percepciones,deducciones:i.deducciones,total:i.total,tipoNomina:i.tipoNomina,usoCfdi:i.usoCfdi,correoElectronico:i.correo,domicilioFiscalReceptor:i.domicilioFiscalReceptor,numSeguridadSocial:i.numSeguridadSocial,fechaInicioRelLaboral:i.fechaInicioRelLaboral,antiguedad:i.antiguedad,riesgoPuesto:i.riesgoPuesto,salarioDiarioIntegrado:i.salarioDiarioIntegrado},F=await fetch(Re("/nominas/preview-pdf"),{method:"POST",headers:Ca(),body:JSON.stringify(E)});if(!F.ok){const _=await F.text();throw new Error(`Error HTTP ${F.status}: ${_}`)}const k=await F.blob(),P=window.URL.createObjectURL(k),R=document.createElement("a");R.href=P,R.target="_blank",R.rel="noopener noreferrer",document.body.appendChild(R),R.click(),document.body.removeChild(R),window.URL.revokeObjectURL(P)}catch(E){console.error("Error en vista previa:",E);const F=E instanceof Error?E.message:"Error desconocido";alert(`Error al generar vista previa: ${F}`)}},b=async E=>{E.preventDefault();try{const F=a||new Date().toISOString().split("T")[0],k={rfcEmisor:i.rfcEmisor,rfcReceptor:i.rfcReceptor,nombre:i.nombre,curp:i.curp,periodoPago:i.periodoPago,fechaPago:i.fechaPago,percepciones:i.percepciones,deducciones:i.deducciones,total:i.total,tipoNomina:i.tipoNomina,usoCfdi:i.usoCfdi,correoElectronico:i.correo,domicilioFiscalReceptor:i.domicilioFiscalReceptor,numSeguridadSocial:i.numSeguridadSocial,fechaInicioRelLaboral:i.fechaInicioRelLaboral,antiguedad:i.antiguedad,riesgoPuesto:i.riesgoPuesto,salarioDiarioIntegrado:i.salarioDiarioIntegrado},P=await D9(k,r,F);if(P.ok){const R=P.uuidFactura||"";alert(`Nmina timbrada exitosamente
UUID: ${R||"N/A"}`),confirm("Desea enviar el PDF de la nmina al correo del receptor?")&&await A(R)}else{const R=P.message||"Error al guardar nmina";alert(`Error: ${R}`)}}catch(F){alert(`Error inesperado al guardar: ${(F==null?void 0:F.message)||F}`)}},y=()=>{t(""),s(""),o(Hf),c([])},j=E=>{const{name:F,value:k}=E.target;if(F==="percepciones"){const P=Number(k||0),R=Oy(P),_=Math.max(0,P-R);o(Q=>({...Q,percepciones:k,deducciones:Bi(R),total:Bi(_)}));return}if(F==="periodicidad"||F==="fechaPago"){o(P=>({...P,[F]:k}));return}o(P=>({...P,[F]:k}))},A=async E=>{const F=(i.correo||"").trim();if(!E||!E.trim()){alert("No hay UUID disponible para esta nmina.");return}if(!F){alert("No hay correo del receptor. Ingrsalo en el formulario y vuelve a intentar.");return}try{const k=`Recibo de Nmina ${i.periodoPago?"- "+i.periodoPago:""}`.trim(),P=`Estimado(a),

Se adjunta el PDF de su recibo de nmina.
UUID: ${E}`,R=await Pt.enviarCorreoConPdfAdjunto({uuidFactura:E,correoReceptor:F,asunto:k,mensaje:P});R!=null&&R.success?alert(`Correo enviado exitosamente a: ${F}`):alert(`Error al enviar correo: ${(R==null?void 0:R.message)||"Desconocido"}`)}catch(k){alert(`Error al enviar correo: ${(k==null?void 0:k.message)||"Error desconocido"}`)}};return n.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Filtro de Nmina"}),n.jsxs("form",{onSubmit:v,className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end",children:[n.jsxs("div",{className:"flex flex-col space-y-1",children:[n.jsx("label",{className:"font-medium text-primary dark:text-secondary",children:"Fecha de Nmina:"}),n.jsx("input",{type:"date",value:a,onChange:E=>t(E.target.value),className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100"})]}),n.jsxs("div",{className:"flex flex-col space-y-1",children:[n.jsx("label",{className:"font-medium text-primary dark:text-secondary",children:"ID Empleado:"}),n.jsx("input",{type:"text",value:r,onChange:E=>s(E.target.value),placeholder:"Ingrese ID del empleado",className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100"})]}),n.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-4 pt-2",children:[n.jsx("button",{type:"button",className:"px-4 py-2 border border-primary dark:border-secondary text-primary dark:text-secondary rounded-md hover:bg-gray-50 dark:hover:bg-gray-700",onClick:y,children:"Limpiar"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary dark:bg-secondary text-white rounded-md hover:bg-primary-dark dark:hover:bg-secondary-dark",children:"Buscar"})]})]})]}),n.jsx("form",{onSubmit:b,children:n.jsxs(ve,{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Datos de Facturacin de Nmina"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold text-black dark:text-white",children:"Periodicidad:"}),n.jsxs("select",{name:"periodicidad",value:i.periodicidad||"QUINCENAL",onChange:j,className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",children:[n.jsx("option",{value:"QUINCENAL",children:"Quincenal"}),n.jsx("option",{value:"MENSUAL",children:"Mensual"})]})]}),[{label:"RFC Receptor",name:"rfcReceptor",type:"text",required:!0},{label:"Nombre",name:"nombre",type:"text",required:!0},{label:"CURP",name:"curp",type:"text"},{label:"Domicilio Fiscal Receptor (CP)",name:"domicilioFiscalReceptor",type:"text",required:!0,placeholder:"Ej: 58000"},{label:"Periodo de Pago",name:"periodoPago",type:"text",placeholder:"Ej: 01/10/2025 al 30/10/2025"},{label:"Fecha de Pago",name:"fechaPago",type:"date",required:!0},{label:"Percepciones",name:"percepciones",type:"number"},{label:"Deducciones",name:"deducciones",type:"number"},{label:"Total",name:"total",type:"number",required:!0}].map(({label:E,name:F,type:k,required:P,placeholder:R})=>n.jsxs("div",{className:"flex flex-col",children:[n.jsxs("label",{className:"mb-1 font-semibold text-black dark:text-white",children:[E,":"]}),n.jsx("input",{type:k,name:F,value:i[F],onChange:j,required:P,placeholder:R,className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",step:"0.01",readOnly:F==="periodoPago"})]},F)),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold text-black dark:text-white",children:"Tipo de Nmina:"}),n.jsxs("select",{name:"tipoNomina",value:i.tipoNomina,onChange:j,className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",required:!0,children:[n.jsx("option",{value:"",children:"Selecciona..."}),n.jsx("option",{value:"O",children:"Ordinaria"}),n.jsx("option",{value:"E",children:"Extraordinaria"})]})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold text-black dark:text-white",children:"Uso CFDI:"}),n.jsxs("select",{name:"usoCfdi",value:i.usoCfdi,onChange:j,className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",required:!0,children:[n.jsx("option",{value:"",children:"Selecciona..."}),n.jsx("option",{value:"G01",children:"G01 - Adquisicin de mercancas"}),n.jsx("option",{value:"P01",children:"P01 - Por definir"}),n.jsx("option",{value:"CN01",children:"CN01 - Nmina"})]})]}),n.jsxs("div",{className:"flex flex-col md:col-span-2",children:[n.jsx("label",{className:"mb-1 font-semibold text-black dark:text-white",children:"Correo electrnico:"}),n.jsx("input",{type:"email",name:"correo",value:i.correo,onChange:j,className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",required:!0})]}),[{label:"Nmero de Seguridad Social",name:"numSeguridadSocial",type:"text",required:!0,placeholder:"Ej: 12345678901"},{label:"Fecha Inicio Relacin Laboral",name:"fechaInicioRelLaboral",type:"date",required:!0},{label:"Antigedad (PnYnMnDn)",name:"antiguedad",type:"text",required:!0,placeholder:"Ej: P1Y2M15D"},{label:"Riesgo Puesto",name:"riesgoPuesto",type:"text",required:!0,placeholder:"Ej: 1, 2, 3"},{label:"Salario Diario Integrado",name:"salarioDiarioIntegrado",type:"number",required:!0,placeholder:"Ej: 500.00"}].map(({label:E,name:F,type:k,required:P,placeholder:R})=>n.jsxs("div",{className:"flex flex-col",children:[n.jsxs("label",{className:"mb-1 font-semibold text-black dark:text-white",children:[E,":"]}),n.jsx("input",{type:k,name:F,value:i[F],onChange:j,required:P,placeholder:R,className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",step:k==="number"?"0.01":void 0})]},F))]}),n.jsxs("div",{className:"flex justify-end mt-6 gap-2",children:[n.jsx(fe,{type:"button",variant:"secondary",onClick:w,children:"Vista Previa"}),n.jsx(fe,{type:"submit",variant:"primary",children:"Guardar Nmina"})]})]})}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Historial de Facturacin"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Fecha"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"ID Empleado"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Acciones"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:l.length>0?l.map(E=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:E.fecha}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:E.idEmpleado}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"button",className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200",onClick:async()=>{if(!E.uuid||!E.uuid.trim()){alert("No hay UUID disponible para esta nmina.");return}try{h(!0);const F=await fetch(Re(`/factura/descargar-pdf/${E.uuid}`));if(!F.ok){const R=await F.text().catch(()=>"");throw new Error(`Error al obtener PDF (HTTP ${F.status}) ${R}`)}const k=await F.blob(),P=window.URL.createObjectURL(k);m(P),d(!0)}catch(F){alert(`Error al visualizar PDF: ${(F==null?void 0:F.message)||F}`)}finally{h(!1)}},children:"Ver"}),n.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200",onClick:async()=>{if(!E.uuid||!E.uuid.trim()){alert("No hay UUID disponible para esta nmina.");return}try{await ma.generarYDescargarPDF(E.uuid)}catch(F){alert(`Error al descargar PDF: ${(F==null?void 0:F.message)||F}`)}},children:"PDF"}),n.jsx("button",{type:"button",className:"text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-200",onClick:async()=>{if(!E.uuid||!E.uuid.trim()){alert("No hay UUID disponible para esta nmina.");return}try{await ma.generarYDescargarXML(E.uuid)}catch(F){alert(`Error al descargar XML: ${(F==null?void 0:F.message)||F}`)}},children:"XML"}),n.jsx("button",{type:"button",className:"text-orange-600 hover:text-orange-800 dark:text-orange-400 dark:hover:text-orange-200",onClick:async()=>{await A(E.uuid||"")},children:"Correo"})]})})]},E.id)):n.jsx("tr",{children:n.jsx("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"No hay historial para mostrar. Realice una bsqueda."})})})]})})]}),u&&n.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/60",children:n.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg w-[95vw] max-w-5xl overflow-hidden",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 dark:border-gray-700",children:[n.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:"Vista previa PDF"}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{type:"button",className:"px-3 py-1 text-sm rounded bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700",onClick:g,children:"Cerrar"})})]}),n.jsx("div",{className:"p-0",children:x?n.jsx("div",{className:"p-6 text-center text-gray-700 dark:text-gray-200",children:"Cargando PDF"}):n.jsx("iframe",{src:f||"",title:"Visor PDF",className:"w-full h-[80vh]"})})]})})]})};function yk(){try{const e=window.localStorage.getItem("perfil");if(e)try{const r=JSON.parse(e);if((r==null?void 0:r.idUsuario)!=null&&/^\d+$/.test(String(r.idUsuario))){const s=String(r.idUsuario);return window.localStorage.setItem("session.idUsuario",s),s}if((r==null?void 0:r.idDfi)!=null&&/^\d+$/.test(String(r.idDfi))){const s=String(r.idDfi);return window.localStorage.setItem("session.idUsuario",s),s}if((r==null?void 0:r.idPerfil)!=null&&/^\d+$/.test(String(r.idPerfil))){const s=String(r.idPerfil);return window.localStorage.setItem("session.idUsuario",s),s}}catch{}const a=window.localStorage.getItem("session.idUsuario");if(a&&/^\d+$/.test(a))return a;const t=window.localStorage.getItem("username");if(t&&/^\d+$/.test(t))return window.localStorage.setItem("session.idUsuario",t),t}catch{}return"0"}function L9(){var e,a;try{const t=window.localStorage.getItem("perfil");if(!t||t==="undefined"||t==="null")return null;const r=t.trim().startsWith("{")?JSON.parse(t):null;return r?r.idTienda?String(r.idTienda):(e=r.tienda)!=null&&e.idTienda?String(r.tienda.idTienda):r.codigoTienda?String(r.codigoTienda):(a=r.tienda)!=null&&a.codigoTienda?String(r.tienda.codigoTienda):r.tienda?String(r.tienda):null:null}catch{return null}}function wx(){var e,a;try{const t=window.localStorage.getItem("session.idTienda");if(t)return t;const r=window.localStorage.getItem("tiendaSeleccionada"),s=L9(),i=r||((e=Ia[0])==null?void 0:e.value)||"S001",o=s||i;return window.localStorage.setItem("session.idTienda",o),o}catch{const t=((a=Ia[0])==null?void 0:a.value)||"S001";try{window.localStorage.setItem("session.idTienda",t)}catch{}return t}}function B9(){var e,a,t;try{const r=window.localStorage.getItem("session.codigoTienda");if(r)return r;const s=window.localStorage.getItem("perfil");let i=null;if(s)try{const c=JSON.parse(s);i=(c==null?void 0:c.codigoTienda)||((e=c==null?void 0:c.tienda)==null?void 0:e.codigoTienda)||null}catch{}const o=window.localStorage.getItem("tiendaSeleccionada"),l=i||o||((a=Ia[0])==null?void 0:a.value)||"S001";return window.localStorage.setItem("session.codigoTienda",l),l}catch{const r=((t=Ia[0])==null?void 0:t.value)||"S001";try{window.localStorage.setItem("session.codigoTienda",r)}catch{}return r}}function Ly(e){try{if(!e)return;window.localStorage.setItem("session.codigoTienda",e),window.localStorage.setItem("tiendaSeleccionada",e)}catch{}}function z9(){yk(),wx()}function $9(){try{return window.localStorage.getItem("session.periodoIntereses.last")||""}catch{return""}}function By(e){try{e&&window.localStorage.setItem("session.periodoIntereses.last",e)}catch{}}function Fd(e){try{e?window.localStorage.setItem("session.idReceptor",e):window.localStorage.removeItem("session.idReceptor")}catch{}}var zv,$v,Vv;const V9={rfcIniciales:"",rfcFecha:"",rfcHomoclave:"",correoElectronico:"",razonSocial:"",nombre:"",paterno:"",materno:"",pais:((zv=qr[0])==null?void 0:zv.value)||"",noRegistroIdentidadTributaria:"",domicilioFiscal:"",regimenFiscal:(($v=gt[0])==null?void 0:$v.value)||"",usoCfdi:((Vv=yt[0])==null?void 0:Vv.value)||"",cuenta:"",periodo:"",interesFinanciero:"",interesMoratorio:"",ivaInteresFinanciero:"",ivaInteresMoratorio:""},H9=()=>{const[e,a]=N.useState(V9),[t,r]=N.useState(!1),[s,i]=N.useState(""),[o,l]=N.useState(""),[c,u]=N.useState(!1),[d,f]=N.useState(!1),[m,x]=N.useState(null),[h,g]=N.useState({}),[p,v]=N.useState(null),[w,b]=N.useState(!0),[y,j]=N.useState(!0),[A,E]=N.useState(null),[F,k]=N.useState(null);N.useEffect(()=>{z9();const L=$9();L&&a(V=>({...V,periodo:L}))},[]);const P=L=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(L||""),R=L=>/^[A-Z&]{3,4}[0-9]{6}[A-Z0-9]{3}$/.test((L||"").toUpperCase()),_=L=>`${(L.rfcIniciales||"").toUpperCase()}${(L.rfcFecha||"").toUpperCase()}${(L.rfcHomoclave||"").toUpperCase()}`,Q=["razonSocial","domicilioFiscal","regimenFiscal","usoCfdi"],C=L=>Q.filter(V=>!(L[V]||"").toString().trim()),z=L=>{const V=_(L),O=P(L.correoElectronico||"")&&R(V)&&C(L).length===0;return u(O),O},S=L=>{const{name:V,value:O}=L.target,de={...e,[V]:O};a(de),g(me=>{const ae={...me};return(V==="rfcIniciales"||V==="rfcFecha"||V==="rfcHomoclave")&&delete ae.rfc,V in ae&&delete ae[V],ae}),z(de)},D=async()=>{i(""),l(""),g({});const L=`${(e.rfcIniciales||"").toUpperCase()}${(e.rfcFecha||"").toUpperCase()}${(e.rfcHomoclave||"").toUpperCase()}`,V=e.correoElectronico||"",O=/^[A-Z&]{3,4}[0-9]{6}[A-Z0-9]{3}$/,de=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,me={};if(de.test(V)||(me.correoElectronico="Escriba un email vlido para realizar la bsqueda"),O.test(L)||(me.rfc="El RFC debe tener un formato vlido (13 caracteres)"),me.correoElectronico||me.rfc){g(ae=>({...ae,...me})),l("error"),i(me.correoElectronico||me.rfc||"Datos invlidos para bsqueda"),u(!1),f(!1),x(null),Fd(null);return}try{r(!0);const ae=wx(),ce=await ma.buscarReceptorPorRFC({rfc:L,idTienda:ae,correoElectronico:V});if(r(!1),!ce.encontrado){l("error"),i("Receptor no encontrado por RFC"),u(!1),f(!1),x(null),Fd(null);return}const W=ce.receptor,le={...e,rfcIniciales:L.slice(0,4),rfcFecha:L.slice(4,10),rfcHomoclave:L.slice(10),razonSocial:W.razonSocial||e.razonSocial,nombre:W.nombre||e.nombre,paterno:W.paterno||e.paterno,materno:W.materno||e.materno,pais:W.pais||e.pais,domicilioFiscal:W.domicilioFiscal||e.domicilioFiscal,regimenFiscal:W.regimenFiscal||e.regimenFiscal,usoCfdi:W.usoCfdi||e.usoCfdi,correoElectronico:V};if(a(le),ce.completoCFDI40)l("success"),i("Receptor encontrado y validado (CFDI 4.0)"),u(!0),f(!0),x(ce.idReceptor||null),Fd(ce.idReceptor||null);else{l("error"),i("Datos fiscales incompletos"),f(!1),x(ce.idReceptor||null);const I=ce.faltantes||[],q=C(le),ne=Array.from(new Set([...I,...q])),G={};ne.forEach(ie=>{G[ie]="Campo requerido"}),g(G),z(le)?(l("success"),i("Datos completos manualmente. Contina con la consulta.")):u(!1)}}catch(ae){r(!1),l("error"),i((ae==null?void 0:ae.message)||"Error inesperado al buscar receptor"),u(!1),f(!1),x(null),Fd(null)}},H=L=>{const V=/^([0-9]{4})(0[1-9]|1[0-2])$/.exec(L||"");if(!V)return{fechaIni:"",fechaFin:""};const O=parseInt(V[1],10),de=parseInt(V[2],10)-1,me=new Date(Date.UTC(O,de,1)),ae=new Date(Date.UTC(O,de+1,0)),ce=W=>`${W.getUTCFullYear()}-${String(W.getUTCMonth()+1).padStart(2,"0")}-${String(W.getUTCDate()).padStart(2,"0")}`;return{fechaIni:ce(me),fechaFin:ce(ae)}},U=async()=>{if(i(""),l(""),v(null),!(e.cuenta||"").trim()){l("error"),i("Debes capturar la cuenta");return}if(!/^([0-9]{4})(0[1-9]|1[0-2])$/.test(e.periodo||"")){l("error"),i("Periodo invlido. Usa formato yyyyMM (ej. 202501)");return}const{fechaIni:V,fechaFin:O}=H(e.periodo);try{r(!0);const de=await ma.consultarIntereses({cuenta:e.cuenta,fechaIni:V,fechaFin:O});r(!1),de.exitoso?(v({financiero:de.financiero,financieroIva:de.financieroIva,moratorio:de.moratorio,moratorioIva:de.moratorioIva,codigoRespuesta:de.codigoRespuesta,mensaje:de.mensaje}),a(me=>({...me,interesFinanciero:String(de.financiero??0),ivaInteresFinanciero:String(de.financieroIva??0),interesMoratorio:String(de.moratorio??0),ivaInteresMoratorio:String(de.moratorioIva??0)})),l("success"),i(`Consulta exitosa. Cdigo: ${de.codigoRespuesta}`)):(l("error"),i(de.mensaje||"Error en consulta de intereses"))}catch(de){r(!1),l("error"),i((de==null?void 0:de.message)||"Error inesperado al consultar intereses")}},B=async L=>{if(L.preventDefault(),i(""),l(""),!/^([0-9]{4})(0[1-9]|1[0-2])$/.test(e.periodo||"")){alert("Periodo invlido. Usa formato yyyyMM (ej. 202501)");return}if(!p){l("error"),i("Primero consulta los intereses para este periodo");return}const O=w?p.financiero??0:0,de=w?p.financieroIva??0:0,me=y?p.moratorio??0:0,ae=y?p.moratorioIva??0:0,ce=yk(),W=wx(),le=B9(),I=`${e.rfcIniciales}${e.rfcFecha}${e.rfcHomoclave}`,q={idUsuario:ce,idTienda:W,codigoTienda:le,cuenta:e.cuenta,periodo:e.periodo,correoElectronico:e.correoElectronico,razonSocial:e.razonSocial,nombre:e.nombre,paterno:e.paterno,materno:e.materno,pais:e.pais,receptor:{rfc:I,usoCfdi:e.usoCfdi,regimenFiscal:e.regimenFiscal,domicilioFiscal:e.domicilioFiscal},importes:{interesFinanciero:O,interesMoratorio:me,ivaInteresFinanciero:de,ivaInteresMoratorio:ae},tipo:"INTERESES",medioPago:"PUE",formaPago:"01"};try{r(!0);const ne=await ma.emitirFacturaIntereses(q);if(r(!1),By(e.periodo),ne.exitoso){const G=ne.serie&&ne.folio?`${ne.serie}-${ne.folio}`:"",ee=[ne.uuid?`UUID: ${ne.uuid}`:"",G?`Serie-Folio: ${G}`:"",ne.fechaEmision?`Fecha: ${new Date(ne.fechaEmision).toLocaleString()}`:""].filter(Boolean).join(" | ");l("success"),i(`${ne.mensaje}${ee?"  "+ee:""}`),ne.uuid&&(E("4 - EN PROCESO DE EMISION"),T(ne.uuid))}else l("error"),i(ne.mensaje||"Error al emitir intereses")}catch(ne){r(!1),By(e.periodo),l("error"),i((ne==null?void 0:ne.message)||"Error inesperado al emitir")}},X=async L=>{try{const V=await fetch(kr(`/pac/stamp/status/${encodeURIComponent(L)}`));if(!V.ok)return null;const O=await V.json().catch(()=>null),de=String((O==null?void 0:O.status)||(O==null?void 0:O.codigo)||""),me=String((O==null?void 0:O.descripcion)||(O==null?void 0:O.statusDescripcion)||"");return de?{codigo:de,descripcion:me}:null}catch{return null}},T=L=>{F&&(window.clearInterval(F),k(null));const V=window.setInterval(async()=>{const O=await X(L);O&&(O.codigo==="0"?(E("0 - EMITIDA"),window.clearInterval(V),k(null)):O.codigo==="4"?E("4 - EN PROCESO DE EMISION"):O.codigo==="2"?(E("2 - CANCELADA EN SAT"),window.clearInterval(V),k(null)):O.codigo==="66"&&E("66 - POR TIMBRAR"))},3e3);k(V)};return N.useEffect(()=>()=>{F&&window.clearInterval(F)},[F]),n.jsxs("form",{onSubmit:B,className:"space-y-6",children:[A&&n.jsxs("div",{className:"p-2 rounded bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-100",children:["Estado de timbrado: ",A]}),n.jsx(Di,{formData:e,handleChange:S,onRfcSearchClick:D,isRFCRequired:!0,isRazonSocialRequired:!0,isDomicilioFiscalRequired:!0,isRegimenFiscalRequired:!0,isUsoCfdiRequired:!0,isCorreoElectronicoRequired:!0,rfcDisabled:d,isRegimenFiscalDisabled:c,isUsoCfdiDisabled:c,fieldErrors:h}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Consulta Factura:"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2",children:[n.jsx(J,{label:"Cuenta:",name:"cuenta",value:e.cuenta,onChange:S,required:!0}),n.jsx(J,{label:"Periodo (yyyyMM):",name:"periodo",value:e.periodo,onChange:S,required:!0})]})]}),p&&n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-primary dark:text-secondary mb-4",children:"Intereses calculados"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"font-semibold text-black dark:text-white",children:"Inters financiero:"}),n.jsx("span",{className:"text-black dark:text-white",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(p.financiero)})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"font-semibold text-black dark:text-white",children:"IVA inters financiero:"}),n.jsx("span",{className:"text-black dark:text-white",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(p.financieroIva)})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"font-semibold text-black dark:text-white",children:"Inters moratorio:"}),n.jsx("span",{className:"text-black dark:text-white",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(p.moratorio)})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"font-semibold text-black dark:text-white",children:"IVA inters moratorio:"}),n.jsx("span",{className:"text-black dark:text-white",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(p.moratorioIva)})]})]}),n.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("label",{className:"inline-flex items-center",children:[n.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-primary focus:ring-primary",checked:w,onChange:L=>b(L.target.checked)}),n.jsx("span",{className:"ml-2 text-sm text-black dark:text-white",children:"Facturar inters financiero"})]}),n.jsxs("label",{className:"inline-flex items-center",children:[n.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-primary focus:ring-primary",checked:y,onChange:L=>j(L.target.checked)}),n.jsx("span",{className:"ml-2 text-sm text-black dark:text-white",children:"Facturar inters moratorio"})]})]})]}),n.jsxs("div",{className:"flex justify-end mt-6",children:[n.jsx(fe,{type:"button",variant:"primary",disabled:t,onClick:U,children:"Consultar Intereses"}),n.jsx(fe,{type:"submit",variant:"secondary",disabled:t||!p,className:"ml-3",children:"Emitir Factura"})]}),o&&n.jsxs("div",{className:o==="success"?"mt-4 rounded-md border border-green-200 bg-green-50 p-4 text-green-800":"mt-4 rounded-md border border-red-200 bg-red-50 p-4 text-red-800",role:"alert",children:[n.jsx("p",{className:"font-semibold mb-1",children:o==="success"?"Operacin exitosa":"Error en operacin"}),n.jsx("p",{className:"text-sm",children:s})]})]})};async function K0(e){const a=await e.text();if(!a)return{};try{return JSON.parse(a)}catch{throw new Error("Respuesta inesperada del servidor.")}}const G9=async e=>{const a=await fetch(Re(`/pagos/factura/${encodeURIComponent(e)}`));if(!a.ok){const t=await K0(a).catch(()=>({success:!1,message:"No se pudo consultar la factura por UUID."}));throw new Error(t.message||"No se pudo consultar la factura por UUID.")}return K0(a)},X9=async e=>{const a=await fetch(Re("/pagos/complemento"),{method:"POST",headers:Ca(),body:JSON.stringify(e)}),t=await K0(a).catch(()=>({success:!1,message:"No se pudo registrar el complemento de pagos."}));if(!a.ok){const r=t;return{success:!1,message:r.message||"No se pudo registrar el complemento de pagos.",facturaId:r.facturaId,pagosInsertados:r.pagosInsertados,errors:r.errors}}return t},q9=async e=>{const a=await fetch(Re("/pagos/complemento/enviar-correo"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await K0(a).catch(()=>({success:!1,message:"No se pudo enviar el complemento por correo."}));if(!a.ok||!t.success)throw new Error(t.message||"No se pudo enviar el complemento por correo.");return t},_d={buscarFacturaPorUuid:G9,registrarComplemento:X9,enviarComplementoPorCorreo:q9},Y9=[{value:"MXN",label:"MXN - Peso mexicano"},{value:"USD",label:"USD - Dlar estadounidense"},{value:"EUR",label:"EUR - Euro"}],W9=()=>typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const a=Math.random()*16|0;return(e==="x"?a:a&3|8).toString(16)}),zi={id:"",fechaPago:"",formaPago:"",moneda:"MXN",monto:""},K9=()=>{const[e,a]=N.useState({facturaUuid:"",facturaId:"",usuarioRegistro:"",correoReceptor:""}),[t,r]=N.useState(zi),[s,i]=N.useState([]),[o,l]=N.useState(null),[c,u]=N.useState([]),[d,f]=N.useState(null),[m,x]=N.useState(!1),[h,g]=N.useState(!1),[p,v]=N.useState(null),[w,b]=N.useState([]),[y,j]=N.useState(""),[A,E]=N.useState(!1),[F,k]=N.useState(!1),[P,R]=N.useState(!1),[_,Q]=N.useState(null);N.useEffect(()=>{const W=localStorage.getItem("session.idUsuario")||localStorage.getItem("username")||"";W&&a(le=>({...le,usuarioRegistro:W}))},[]);const C=N.useMemo(()=>s.reduce((W,le)=>{const I=(le.moneda||"MXN").toUpperCase(),q=parseFloat(le.monto);return Number.isNaN(q)||(W[I]=(W[I]||0)+q),W},{}),[s]),z=N.useCallback(W=>{const{name:le,value:I}=W.target;a(q=>({...q,[le]:I,...le==="facturaUuid"?{facturaId:""}:{}}))},[]),S=N.useCallback(W=>{const{name:le,value:I}=W.target;r(q=>({...q,[le]:I}))},[]),D=N.useCallback(()=>{u([]),f(null)},[]),H=N.useCallback(async()=>{D();const W=e.facturaUuid.trim();if(!W){u(["Captura el UUID de la factura que deseas relacionar."]);return}try{g(!0);const le=await _d.buscarFacturaPorUuid(W);le.success&&typeof le.facturaId=="number"?(a(I=>({...I,facturaId:String(le.facturaId)})),f(`Factura localizada. ID_FACTURA: ${le.facturaId}.`)):(a(I=>({...I,facturaId:""})),u([le.message||"No se encontr FACTURA_ID para el UUID especificado."]))}catch(le){a(q=>({...q,facturaId:""}));const I=le instanceof Error?le.message:"No se pudo consultar la factura por UUID.";u([I])}finally{g(!1)}},[e.facturaUuid,D]),U=N.useCallback(()=>{const W=[];return e.facturaUuid.trim()||W.push("Captura el UUID de la factura que deseas relacionar."),e.correoReceptor.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.correoReceptor.trim())||W.push("El correo del receptor no tiene un formato vlido."):W.push("Captura el correo del receptor."),s.length===0&&W.push("Agrega al menos un pago a la relacin."),W},[e,s.length]),B=N.useCallback(()=>{const W=[];return t.fechaPago||W.push("Selecciona la fecha de pago."),t.formaPago||W.push("Selecciona la forma de pago."),t.moneda||W.push("Selecciona la moneda del pago."),(!t.monto||Number.isNaN(parseFloat(t.monto)))&&W.push("Captura un monto vlido."),W},[t.fechaPago,t.formaPago,t.moneda,t.monto]),X=N.useCallback(()=>{D();const W=B();if(W.length>0){u(W);return}const le={...t,id:o??W9()};i(I=>[...I.filter(ne=>ne.id!==le.id),le].sort((ne,G)=>ne.fechaPago.localeCompare(G.fechaPago))),r(zi),l(null),f("Pago agregado a la relacin.")},[t,D,o,B]),T=N.useCallback(W=>{const le=s.find(I=>I.id===W);le&&(r(le),l(W),D())},[s,D]),L=N.useCallback(W=>{D(),i(le=>le.filter(I=>I.id!==W)),o===W&&(r(zi),l(null)),f("Pago eliminado.")},[D,o]),V=N.useCallback(()=>{D(),a(W=>({facturaUuid:"",facturaId:"",usuarioRegistro:W.usuarioRegistro,correoReceptor:""})),i([]),r(zi),l(null),v(null),b([]),j(""),Q(null)},[D]),O=N.useCallback(async()=>{var W;try{if(!e.facturaUuid||!e.facturaUuid.trim()){alert("Por favor ingrese el UUID de la factura.");return}if(s.length===0){alert("Por favor agregue al menos un pago antes de ver la vista previa.");return}const le={facturaUuid:e.facturaUuid.trim(),facturaId:e.facturaId&&!Number.isNaN(Number(e.facturaId))?Number(e.facturaId):void 0,usuarioRegistro:((W=e.usuarioRegistro)==null?void 0:W.trim())||void 0,correoReceptor:e.correoReceptor.trim(),pagos:s.map(ee=>({fechaPago:ee.fechaPago,formaPago:ee.formaPago,moneda:ee.moneda,monto:Number(ee.monto)}))},I=await fetch(Re("/pagos/complemento/preview-pdf"),{method:"POST",headers:Ca(),body:JSON.stringify(le)});if(!I.ok){const ee=await I.text();throw new Error(`Error HTTP ${I.status}: ${ee}`)}const q=await I.blob(),ne=window.URL.createObjectURL(q),G=document.createElement("a");G.href=ne,G.target="_blank",G.rel="noopener noreferrer",document.body.appendChild(G),G.click(),document.body.removeChild(G),window.URL.revokeObjectURL(ne)}catch(le){console.error("Error al generar vista previa:",le),alert(`Error al generar vista previa: ${le instanceof Error?le.message:"Error desconocido"}`)}},[e,s]),de=N.useCallback(async()=>{var le,I,q;D();const W=U();if(W.length>0){u(W);return}try{x(!0),Q(null);const ne={facturaUuid:e.facturaUuid.trim(),facturaId:e.facturaId&&!Number.isNaN(Number(e.facturaId))?Number(e.facturaId):void 0,usuarioRegistro:((le=e.usuarioRegistro)==null?void 0:le.trim())||void 0,correoReceptor:e.correoReceptor.trim(),pagos:s.map(ee=>({fechaPago:ee.fechaPago,formaPago:ee.formaPago,moneda:ee.moneda,monto:Number(ee.monto)}))},G=await _d.registrarComplemento(ne);if(G.success){const ee=G.message||"Pagos registrados correctamente.",ie=G.uuidComplemento&&G.uuidComplemento.trim().length>0?`${ee} (UUID complemento: ${G.uuidComplemento})`:ee;f(ie);let we=((I=G.uuidComplemento)==null?void 0:I.trim())||"";if(G.uuidComplemento&&G.uuidComplemento.trim().length>0?window.alert(`Complemento de pago timbrado exitosamente
UUID: ${G.uuidComplemento}`):window.alert("Complemento de pago timbrado exitosamente"),window.confirm("Deseas enviar el PDF del complemento al correo registrado?"))if(!we)window.alert("No se cuenta con UUID del complemento para enviar el PDF.");else try{const Me=ne.pagos.reduce((Ie,We)=>Ie+(Number.isFinite(Number(We.monto))?Number(We.monto):0),0),$e=((q=ne.pagos[0])==null?void 0:q.moneda)??"MXN";await _d.enviarComplementoPorCorreo({uuidComplemento:we,facturaUuid:e.facturaUuid.trim(),correoReceptor:e.correoReceptor.trim(),serieComplemento:G.serieComplemento??void 0,folioComplemento:G.folioComplemento??void 0,fechaTimbrado:G.fechaTimbrado??void 0,rfcReceptor:G.rfcReceptor??void 0,rfcEmisor:G.rfcEmisor??void 0,nombreReceptor:G.rfcReceptor??void 0,nombreEmisor:G.rfcEmisor??void 0,metodoCfdi:"PPD",formaCfdi:"99",totalPagado:G.totalPagado??Me,moneda:$e,pagos:ne.pagos}),window.alert(`Complemento de pago enviado al correo: ${e.correoReceptor.trim()}`)}catch(Me){const $e=Me instanceof Error?Me.message:"No se pudo enviar el correo.";window.alert(`Error al enviar el complemento por correo: ${$e}`)}typeof G.facturaId=="number"&&a(Me=>({...Me,facturaId:String(G.facturaId)})),we&&(v(we),b([...s]),j(e.facturaUuid.trim()),Q(G.xmlTimbrado||null)),i([]),r(zi),l(null)}else{const ee=G.errors&&G.errors.length>0?G.errors:[G.message||"No se pudo registrar el complemento de pagos."];u(ee)}}catch(ne){const G=ne instanceof Error?ne.message:"No se pudo registrar el complemento de pagos.";u([G])}finally{x(!1)}},[e.facturaId,e.facturaUuid,e.usuarioRegistro,e.correoReceptor,s,D,U]),me=N.useCallback(async()=>{if(!p){window.alert("Primero debes preparar el complemento para generar el PDF.");return}try{E(!0),D();const W=await fetch(Re(`/consulta-facturas/descargar-pdf/${p}`));if(!W.ok)throw new Error("No se pudo generar el PDF del complemento.");const le=await W.blob(),I=window.URL.createObjectURL(le),q=document.createElement("a");q.href=I,q.download=`ComplementoPago-${p}.pdf`,document.body.appendChild(q),q.click(),document.body.removeChild(q),window.URL.revokeObjectURL(I),f("PDF generado y descargado correctamente.")}catch(W){const le=W instanceof Error?W.message:"Error al generar el PDF.";u([le]),window.alert(le)}finally{E(!1)}},[p,_,D]),ae=N.useCallback(async()=>{if(!p){window.alert("Primero debes preparar el complemento para generar el XML.");return}try{if(k(!0),D(),_){const ne=new Blob([_],{type:"application/xml;charset=utf-8"}),G=window.URL.createObjectURL(ne),ee=document.createElement("a");ee.href=G,ee.download=`ComplementoPago-${p}.xml`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),window.URL.revokeObjectURL(G),f("XML generado y descargado correctamente.");return}const W=await fetch(Re(`/consulta-facturas/timbrado/status/${p}`));if(!W.ok)throw new Error("No se pudo generar el XML del complemento.");const le=await W.blob(),I=window.URL.createObjectURL(le),q=document.createElement("a");q.href=I,q.download=`ComplementoPago-${p}.xml`,document.body.appendChild(q),q.click(),document.body.removeChild(q),window.URL.revokeObjectURL(I),f("XML generado y descargado correctamente.")}catch(W){const le=W instanceof Error?W.message:"Error al generar el XML.";u([le]),window.alert(le)}finally{k(!1)}},[p,D]),ce=N.useCallback(async()=>{var W;if(!p){window.alert("Primero debes preparar el complemento para enviarlo por correo.");return}if(!e.correoReceptor||!e.correoReceptor.trim()){window.alert('El campo "Correo del receptor" es obligatorio para enviar por correo.');return}if(w.length===0){window.alert("No hay informacin de pagos disponible. Debes preparar el complemento primero.");return}try{R(!0),D();const le=w.reduce((q,ne)=>q+(Number.isFinite(Number(ne.monto))?Number(ne.monto):0),0),I=((W=w[0])==null?void 0:W.moneda)??"MXN";await _d.enviarComplementoPorCorreo({uuidComplemento:p,facturaUuid:y||e.facturaUuid.trim(),correoReceptor:e.correoReceptor.trim(),serieComplemento:void 0,folioComplemento:void 0,fechaTimbrado:void 0,rfcReceptor:void 0,rfcEmisor:void 0,nombreReceptor:void 0,nombreEmisor:void 0,metodoCfdi:"PPD",formaCfdi:"99",totalPagado:le,moneda:I,pagos:w.map(q=>({fechaPago:q.fechaPago,formaPago:q.formaPago,moneda:q.moneda,monto:Number(q.monto)}))}),f(`Correo enviado exitosamente a ${e.correoReceptor.trim()}`),window.alert(`Complemento de pago enviado al correo: ${e.correoReceptor.trim()}`)}catch(le){const I=le instanceof Error?le.message:"Error al enviar por correo.";u([I]),window.alert(I)}finally{R(!1)}},[p,e.correoReceptor,e.facturaUuid,w,y,D]);return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"Complemento de Pagos (REP)"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:"Registra pagos relacionados a CFDI emitidos y prepara la informacin para timbrar un complemento de pago."})]}),(c.length>0||d)&&n.jsxs("div",{children:[c.length>0&&n.jsxs("div",{className:"mb-2 rounded-md border border-red-300 bg-red-50 p-3 text-sm text-red-700 dark:border-red-500 dark:bg-red-900/30 dark:text-red-200",children:[n.jsx("p",{className:"font-semibold",children:"Corrige los siguientes puntos:"}),n.jsx("ul",{className:"list-disc pl-5",children:c.map(W=>n.jsx("li",{children:W},W))})]}),d&&n.jsx("div",{className:"rounded-md border border-green-300 bg-green-50 p-3 text-sm text-green-700 dark:border-green-500 dark:bg-green-900/30 dark:text-green-200",children:d})]}),n.jsxs(ve,{title:"Factura a relacionar",children:[n.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-[2fr_auto]",children:[n.jsx(J,{label:"UUID de factura",name:"facturaUuid",value:e.facturaUuid,onChange:z,placeholder:"Ej. 123e4567-e89b-12d3-a456-426614174000",required:!0}),n.jsx(fe,{className:"self-end",variant:"secondary",type:"button",onClick:H,disabled:h||!e.facturaUuid.trim(),children:h?"Buscando":"Buscar factura"})]}),n.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"Ingresa el UUID del CFDI original. Al buscar, el sistema obtendr el `ID_FACTURA` correspondiente para registrar el pago en la tabla `PAGOS`."}),n.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-300",children:e.facturaId?`ID_FACTURA localizado: ${e.facturaId}`:"ID_FACTURA an no establecido. Realiza la bsqueda para obtenerlo."}),n.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"El UUID del CFDI de pago lo generar el PAC al timbrar el complemento; no es necesario capturarlo en esta etapa."}),n.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:n.jsx(J,{label:"Correo del receptor",name:"correoReceptor",type:"email",value:e.correoReceptor,onChange:z,placeholder:"cliente@correo.com",required:!0})})]}),n.jsxs(ve,{title:"Detalle del pago",children:[n.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[n.jsx(J,{label:"Fecha de pago",name:"fechaPago",type:"date",value:t.fechaPago,onChange:S,required:!0}),n.jsx(Se,{label:"Forma de pago",name:"formaPago",value:t.formaPago,onChange:S,options:ss,required:!0}),n.jsx(Se,{label:"Moneda",name:"moneda",value:t.moneda,onChange:S,options:Y9,required:!0}),n.jsx(J,{label:"Monto pagado",name:"monto",type:"number",value:t.monto,onChange:S,required:!0})]}),n.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[n.jsx(fe,{onClick:X,children:o?"Actualizar pago":"Agregar pago"}),n.jsx(fe,{variant:"neutral",onClick:()=>{r(zi),l(null),D()},children:"Limpiar captura"})]})]}),n.jsxs(ve,{title:"Pagos registrados",children:[s.length===0?n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:'No hay pagos agregados. Captura la informacin y presiona "Agregar pago" para listarlos aqu.'}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900/40",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wide text-gray-600 dark:text-gray-300",children:"Fecha"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wide text-gray-600 dark:text-gray-300",children:"Forma"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wide text-gray-600 dark:text-gray-300",children:"Moneda"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase tracking-wide text-gray-600 dark:text-gray-300",children:"Monto"}),n.jsx("th",{className:"px-3 py-2"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:s.map(W=>n.jsxs("tr",{className:"bg-white dark:bg-gray-800",children:[n.jsx("td",{className:"px-3 py-2 text-sm text-gray-700 dark:text-gray-200",children:W.fechaPago}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-700 dark:text-gray-200",children:W.formaPago}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-700 dark:text-gray-200",children:W.moneda}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-700 dark:text-gray-200",children:Number.parseFloat(W.monto||"0").toLocaleString("es-MX",{style:"currency",currency:W.moneda||"MXN"})}),n.jsx("td",{className:"px-3 py-2 text-sm text-right",children:n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx(fe,{variant:"neutral",size:"sm",onClick:()=>T(W.id),children:"Editar"}),n.jsx(fe,{variant:"danger",size:"sm",onClick:()=>L(W.id),children:"Eliminar"})]})})]},W.id))})]})}),n.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-2",children:[n.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:["Totales por moneda:"," ",Object.keys(C).length===0?"":Object.entries(C).map(([W,le])=>le.toLocaleString("es-MX",{style:"currency",currency:W||"MXN"})).join("  ")]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx(fe,{variant:"neutral",onClick:V,children:"Reiniciar formulario"}),n.jsx(fe,{variant:"secondary",onClick:O,disabled:s.length===0||!e.facturaUuid.trim(),title:s.length===0?"Agregue al menos un pago":e.facturaUuid.trim()?"Vista previa del PDF del complemento":"El UUID de la factura es obligatorio",children:"Vista Previa"}),n.jsx(fe,{onClick:de,disabled:m,children:m?"Preparando":"Preparar complemento"}),n.jsx(fe,{variant:"secondary",onClick:me,disabled:A||!p,title:p?"Generar PDF del complemento":"Primero debes preparar el complemento",children:A?"Generando PDF":"Generar PDF"}),n.jsx(fe,{variant:"secondary",onClick:ae,disabled:F||!p,title:p?"Generar XML del complemento":"Primero debes preparar el complemento",children:F?"Generando XML":"Generar XML"}),n.jsx(fe,{variant:"secondary",onClick:ce,disabled:P||!p||!e.correoReceptor.trim(),title:p?e.correoReceptor.trim()?"Enviar complemento por correo":"El correo del receptor es obligatorio":"Primero debes preparar el complemento",children:P?"Enviando":"Enviar por correo"})]})]})]})]})},Jc=({value:e,onChange:a,onSelect:t,onNotFound:r,disabled:s=!1,required:i=!1})=>{const[o,l]=N.useState([]),[c,u]=N.useState(!1),[d,f]=N.useState(!1),[m,x]=N.useState(-1),h=N.useRef(null),g=N.useRef(null),p=N.useRef(null);N.useEffect(()=>{p.current&&clearTimeout(p.current);const y=e.trim().toUpperCase();if(y.length<3){l([]),u(!1);return}return p.current=window.setTimeout(async()=>{try{const j=await ft.buscarClientesPorRFCParcial(y);if(j&&j.length>0){const A=j.slice(0,10).map(E=>({rfc:E.rfc,razonSocial:E.razonSocial,nombre:E.nombre}));l(A),u(A.length>0)}else l([]),u(!1)}catch(j){console.error("Error al buscar RFCs:",j),l([]),u(!1)}},300),()=>{p.current&&clearTimeout(p.current)}},[e]);const v=async()=>{const y=e.trim().toUpperCase();if(!y||y.length<3){alert("Ingrese al menos 3 caracteres para buscar");return}f(!0);try{let j=await ft.buscarClientePorRFC(y);if(!j.encontrado||!j.cliente){const A=await ft.buscarClientesPorRFCParcial(y,1);if(A&&A.length>0){const E=A.find(F=>F.rfc.toUpperCase()===y);if(E){if(j=await ft.buscarClientePorRFC(E.rfc),!j.encontrado&&E){t(E),u(!1),f(!1);return}}else if(A.length===1){const F=A[0];if((F.rfc.toUpperCase().includes(y)||y.includes(F.rfc.toUpperCase()))&&(j=await ft.buscarClientePorRFC(F.rfc),!j.encontrado&&F)){t(F),u(!1),f(!1);return}}}}j.encontrado&&j.cliente?(t(j.cliente),u(!1)):r()}catch(j){console.error("Error al buscar cliente:",j),r()}finally{f(!1)}},w=async y=>{a(y.rfc),u(!1);try{const j=await ft.buscarClientePorRFC(y.rfc);j.encontrado&&j.cliente&&t(j.cliente)}catch(j){console.error("Error al obtener datos del cliente:",j)}},b=y=>{if(!c||o.length===0){y.key==="Enter"&&v();return}switch(y.key){case"ArrowDown":y.preventDefault(),x(j=>j<o.length-1?j+1:j);break;case"ArrowUp":y.preventDefault(),x(j=>j>0?j-1:-1);break;case"Enter":y.preventDefault(),m>=0&&m<o.length?w(o[m]):v();break;case"Escape":u(!1),x(-1);break}};return N.useEffect(()=>{const y=j=>{h.current&&!h.current.contains(j.target)&&g.current&&!g.current.contains(j.target)&&(u(!1),x(-1))};return document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[]),n.jsx("div",{className:"relative",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsxs("div",{className:"flex-1 relative min-w-0",children:[n.jsx("input",{ref:h,type:"text",value:e,onChange:y=>{a(y.target.value),x(-1)},onKeyDown:b,onFocus:()=>{o.length>0&&u(!0)},disabled:s,required:i,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white",placeholder:"RFC",autoComplete:"off"}),c&&o.length>0&&n.jsx("div",{ref:g,className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto",children:o.map((y,j)=>n.jsxs("div",{onClick:()=>w(y),className:`px-4 py-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 ${j===m?"bg-gray-100 dark:bg-gray-700":""}`,children:[n.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:y.rfc}),(y.razonSocial||y.nombre)&&n.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:y.razonSocial||y.nombre})]},y.rfc))})]}),n.jsxs("button",{type:"button",onClick:v,disabled:s||d||!e.trim(),className:"px-3 sm:px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1 sm:gap-2 text-sm sm:text-base whitespace-nowrap flex-shrink-0",children:[n.jsx(Pn,{className:"w-4 h-4 sm:w-5 sm:h-5"}),n.jsx("span",{className:"hidden sm:inline",children:d?"Buscando...":"Buscar"}),n.jsx("span",{className:"sm:hidden",children:d?"...":"Buscar"})]})]})})};class J9{async validarDatosSat(a){try{return await(await fetch(Re("/sat/validar"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json()}catch(t){return console.error("Error al validar con SAT:",t),{valido:!1,mensaje:"Error de conexin con el servicio de validacin SAT",errores:[t instanceof Error?t.message:"Error desconocido"]}}}async validarRFC(a,t="Validacin RFC",r="00000",s="601"){return this.validarDatosSat({nombre:t,rfc:a.toUpperCase().trim(),codigoPostal:r,regimenFiscal:s})}async obtenerRegimenesFiscales(){try{const a=await fetch(Re("/sat/regimenes"));return a.ok?await a.json():[]}catch(a){return console.error("Error al obtener regmenes fiscales:",a),[]}}}const Z9=new J9;class Q9{async obtenerDatosCP(a){if(!a||a.length!==5)return console.warn("Cdigo postal invlido:",a),null;try{const t=Re(`/codigos-postales/${a}`);console.log("Consultando cdigo postal en:",t);const r=await fetch(t);if(console.log("Respuesta del servidor:",r.status,r.statusText),!r.ok){console.error(`Error HTTP ${r.status}: ${r.statusText}`);const o=await r.text().catch(()=>"");return console.error("Detalles del error:",o),null}const s=await r.json();console.log("Datos recibidos del backend:",s);const i={codigoPostal:s.codigoPostal||a,estado:s.estado||"",municipio:s.municipio||"",colonias:Array.isArray(s.colonias)?s.colonias:[]};return console.log("Datos procesados:",i),i}catch(t){return console.error("Error al obtener datos del cdigo postal:",t),t instanceof Error&&(console.error("Mensaje de error:",t.message),console.error("Stack trace:",t.stack)),null}}}const Ei=new Q9,zy={rfc:"",razonSocial:"",tipoPersona:"moral",esNacional:!0,esExtranjero:!1,esPolitico:!1,codigoPostal:"",pais:"MEX",estado:"",municipio:"",colonia:"",calle:"",numeroExterior:"",numeroInterior:"",nombre:"",apellidoPaterno:"",apellidoMaterno:"",correoElectronico:"",telefono:"",regimenFiscal:gt[0].value,usoCfdi:yt[0].value,declaraIeps:!1},Du=({isOpen:e,onClose:a,onSave:t,rfcInicial:r=""})=>{const[s,i]=N.useState(zy),[o,l]=N.useState([]),[c,u]=N.useState(!1),[d,f]=N.useState(!1),[m,x]=N.useState(null),[h,g]=N.useState(!1);N.useEffect(()=>{e&&r?(i(E=>({...E,rfc:r.toUpperCase()})),p(r)):e||(i(zy),l([]),x(null))},[e,r]);const p=E=>{const F=E.toUpperCase().trim();F.length===12?i(k=>({...k,tipoPersona:"moral"})):F.length===13&&i(k=>({...k,tipoPersona:"fisica"}))},v=E=>{const{name:F,value:k,type:P}=E.target,R=P==="checkbox"?E.target.checked:k;i(_=>({..._,[F]:R})),F==="rfc"&&p(k)},w=(E,F)=>{i(k=>{const P={[E]:F};return E==="esExtranjero"&&F&&(P.esNacional=!1),E==="esNacional"&&F&&(P.esExtranjero=!1),{...k,...P}})},b=async E=>{if(!s.esNacional)return!0;f(!0),x(null);try{const F=s.tipoPersona==="moral"?s.razonSocial:`${s.nombre||""} ${s.apellidoPaterno||""} ${s.apellidoMaterno||""}`.trim(),k=await Z9.validarDatosSat({nombre:F||"Validacin RFC",rfc:E.toUpperCase().trim(),codigoPostal:s.codigoPostal||"00000",regimenFiscal:s.regimenFiscal||"601"});if(k.valido)return k.datosValidados&&i(P=>{var R,_;return{...P,regimenFiscal:((R=k.datosValidados)==null?void 0:R.regimenFiscal)||P.regimenFiscal,codigoPostal:((_=k.datosValidados)==null?void 0:_.codigoPostal)||P.codigoPostal}}),f(!1),!0;{const P=k.errores&&k.errores.length>0?k.errores.join(", "):k.mensaje||"El RFC no es vlido segn el SAT o los datos no coinciden";return x(P),f(!1),!1}}catch(F){return console.error("Error al validar RFC con SAT:",F),x("Error al conectar con el servicio de validacin del SAT"),f(!1),!1}},y=async E=>{if(!E||E.length!==5){l([]),i(F=>({...F,estado:"",municipio:"",colonia:""}));return}u(!0);try{const F=await Ei.obtenerDatosCP(E);F?(i(k=>({...k,estado:F.estado||"",municipio:F.municipio||"",colonia:""})),l(F.colonias||[])):(l([]),i(k=>({...k,estado:"",municipio:"",colonia:""})))}catch(F){console.error("Error al cargar cdigo postal:",F),l([])}finally{u(!1)}},j=E=>{const F=E.target.value.replace(/\D/g,"").slice(0,5);i(k=>({...k,codigoPostal:F})),F.length===5?y(F):(l([]),i(k=>({...k,estado:"",municipio:"",colonia:""})))},A=async E=>{if(E.preventDefault(),!s.rfc.trim()){alert("El RFC es obligatorio");return}if(!s.razonSocial.trim()&&s.tipoPersona==="moral"){alert("La Razn Social es obligatoria para personas morales");return}if(!s.codigoPostal||s.codigoPostal.length!==5){alert("El Cdigo Postal es obligatorio y debe tener 5 dgitos");return}if(!s.correoElectronico.trim()){alert("El Correo Electrnico es obligatorio");return}if(!(s.esNacional&&!await b(s.rfc))){s.esExtranjero&&i(F=>({...F,rfc:"XEXX010101000"})),g(!0);try{await t(s),a()}catch(F){console.error("Error al guardar cliente:",F),alert("Error al guardar el cliente. Intente nuevamente.")}finally{g(!1)}}};return e?n.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:n.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[n.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:a}),n.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Alta de Cliente"}),n.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:n.jsx(Nh,{className:"w-6 h-6"})})]}),n.jsxs("form",{onSubmit:A,className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(J,{name:"rfc",label:"RFC *",value:s.rfc,onChange:E=>{const F=E.target.value.toUpperCase();v({...E,target:{...E.target,value:F}})},required:!0,disabled:s.esExtranjero}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Tipo de Persona *"}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",name:"tipoPersona",value:"fisica",checked:s.tipoPersona==="fisica",onChange:()=>i(E=>({...E,tipoPersona:"fisica"})),className:"mr-2"}),"Fsica"]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",name:"tipoPersona",value:"moral",checked:s.tipoPersona==="moral",onChange:()=>i(E=>({...E,tipoPersona:"moral"})),className:"mr-2"}),"Moral"]})]})]})]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx(ta,{name:"esNacional",label:"Nacional",checked:s.esNacional,onChange:E=>w("esNacional",E.target.checked)}),n.jsx(ta,{name:"esExtranjero",label:"Extranjera",checked:s.esExtranjero,onChange:E=>w("esExtranjero",E.target.checked)}),n.jsx(ta,{name:"esPolitico",label:"P. Poltico",checked:s.esPolitico,onChange:E=>w("esPolitico",E.target.checked)})]}),d&&n.jsx("div",{className:"text-blue-600 dark:text-blue-400 text-sm",children:"Validando RFC con SAT..."}),m&&n.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm",children:m}),s.tipoPersona==="moral"?n.jsx(J,{name:"razonSocial",label:"Razn Social *",value:s.razonSocial,onChange:v,required:!0}):n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(J,{name:"nombre",label:"Nombre",value:s.nombre||"",onChange:v}),n.jsx(J,{name:"apellidoPaterno",label:"Apellido Paterno",value:s.apellidoPaterno||"",onChange:v}),n.jsx(J,{name:"apellidoMaterno",label:"Apellido Materno",value:s.apellidoMaterno||"",onChange:v})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(J,{name:"codigoPostal",label:"Cdigo Postal *",value:s.codigoPostal,onChange:j,required:!0,maxLength:5}),c&&n.jsx("div",{className:"text-sm text-gray-500",children:"Cargando datos..."})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(Se,{name:"pais",label:"Pas",value:s.pais,onChange:v,options:qr}),n.jsx(J,{name:"estado",label:"Estado",value:s.estado,onChange:v,disabled:!0})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(J,{name:"municipio",label:"Municipio/Delegacin",value:s.municipio,onChange:v,disabled:!0}),n.jsx(Se,{name:"colonia",label:"Colonia",value:s.colonia,onChange:v,options:o.map(E=>({value:E,label:E})),disabled:o.length===0})]}),n.jsx(J,{name:"calle",label:"Calle",value:s.calle,onChange:v}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(J,{name:"numeroExterior",label:"Nmero exterior",value:s.numeroExterior,onChange:v,placeholder:"Ej: 123, MZ 5, LT 10"}),n.jsx(J,{name:"numeroInterior",label:"Nmero interior",value:s.numeroInterior,onChange:v,placeholder:"Ej: EDIF A, DEP 101"})]}),n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("h4",{className:"text-md font-medium mb-4 text-gray-900 dark:text-white",children:"Datos de Contacto"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(J,{name:"correoElectronico",label:"Correo Electrnico *",type:"email",value:s.correoElectronico,onChange:v,required:!0}),n.jsx(J,{name:"telefono",label:"Telfono para WhatsApp",value:s.telefono||"",onChange:v})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(Se,{name:"regimenFiscal",label:"Rgimen Fiscal *",value:s.regimenFiscal,onChange:v,options:gt,required:!0}),n.jsx(Se,{name:"usoCfdi",label:"Uso CFDI *",value:s.usoCfdi,onChange:v,options:yt,required:!0})]}),n.jsx(ta,{name:"declaraIeps",label:"Declaro IEPS **",checked:s.declaraIeps,onChange:E=>w("declaraIeps",E.target.checked)}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Los campos marcados con: * son obligatorios, **Aplica slo para vinos y licores."}),n.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[n.jsx(fe,{type:"button",onClick:a,variant:"neutral",children:"Cancelar"}),n.jsx(fe,{type:"submit",variant:"primary",disabled:h,children:h?"Guardando...":"Guardar"})]})]})]})})]})}):null},vk=async e=>{var a;if(!e.ok){const t=await e.text();try{const r=JSON.parse(t);throw new Error(r.message||((a=r.errors)==null?void 0:a.join(", "))||"Error en la solicitud")}catch{throw new Error(t||`Error HTTP: ${e.status}`)}}return e.json()},eM=async e=>{var r;const a=await fetch(Re("/retenciones/registrar"),{method:"POST",headers:Ca(),body:JSON.stringify(e)}),t=await vk(a).catch(()=>({success:!1,message:"No se pudo registrar la retencin."}));if(!a.ok||!t.success){const s=t;throw new Error(s.message||((r=s.errors)==null?void 0:r.join(", "))||"No se pudo registrar la retencin.")}return t},aM=async e=>{var r;const a=await fetch(Re("/retenciones/enviar-correo"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await vk(a).catch(()=>({success:!1,message:"No se pudo enviar la retencin por correo."}));if(!a.ok||!t.success){const s=t;throw new Error(s.message||((r=s.errors)==null?void 0:r.join(", "))||"No se pudo enviar la retencin por correo.")}return t},$y={registrarRetencion:eM,enviarRetencionPorCorreo:aM},tM=[{value:"01",label:"01 - Pagos a residentes en el extranjero"},{value:"02",label:"02 - Dividendos o utilidades distribuidas"},{value:"03",label:"03 - Intereses"},{value:"04",label:"04 - Regalas"},{value:"05",label:"05 - Arrendamiento"},{value:"06",label:"06 - Enajenacin de acciones"},{value:"07",label:"07 - Enajenacin de bienes"},{value:"08",label:"08 - Servicios profesionales"},{value:"09",label:"09 - Sueldos y salarios"},{value:"10",label:"10 - Otros ingresos"},{value:"11",label:"11 - Premios"},{value:"12",label:"12 - Fideicomisos"},{value:"13",label:"13 - Planes de retiro"},{value:"14",label:"14 - IVA - Retencin de IVA (requiere complemento SectorFinanciero)"},{value:"15",label:"15 - Intereses (requiere complemento Intereses)"},{value:"16",label:"16 - Fideicomisos (requiere complemento FideicomisoNoEmpresarial)"},{value:"17",label:"17 - Remanente distribuible"},{value:"18",label:"18 - Planes de retiro (requiere complemento PlanesDeRetiro11)"},{value:"19",label:"19 - Enajenacin de acciones (requiere complemento EnajenacionDeAcciones)"},{value:"20",label:"20 - Otros ingresos"},{value:"21",label:"21 - Otros ingresos"},{value:"22",label:"22 - Otros ingresos"},{value:"23",label:"23 - Arrendamiento (requiere complemento ArrendamientoEnFideicomiso)"},{value:"24",label:"24 - Enajenacin de bienes"},{value:"25",label:"25 - ISR Servicios profesionales (puede requerir PlataformasTecnologicas10)"},{value:"26",label:"26 - ISR Regalas"},{value:"27",label:"27 - Servicios mediante plataformas tecnolgicas (requiere complemento PlataformasTecnologicas10)"},{value:"28",label:"28 - Dividendos o utilidades distribuidas (requiere complemento Dividendos)"}],rM=[{value:"01",label:"01 - Definitivo"},{value:"02",label:"02 - Provisional"},{value:"03",label:"03 - A cuenta de definitivo"},{value:"04",label:"04 - A cuenta de provisional"}],Vy=[{value:"01",label:"01 - Enero"},{value:"02",label:"02 - Febrero"},{value:"03",label:"03 - Marzo"},{value:"04",label:"04 - Abril"},{value:"05",label:"05 - Mayo"},{value:"06",label:"06 - Junio"},{value:"07",label:"07 - Julio"},{value:"08",label:"08 - Agosto"},{value:"09",label:"09 - Septiembre"},{value:"10",label:"10 - Octubre"},{value:"11",label:"11 - Noviembre"},{value:"12",label:"12 - Diciembre"}],sM=Array.from({length:9},(e,a)=>{const t=2019+a;return{value:String(t),label:String(t)}}),nM=[{value:"001",label:"001 - ISR"},{value:"002",label:"002 - IVA"},{value:"003",label:"003 - IEPS"}],iM=()=>{const{empresaInfo:e}=On(),[a,t]=N.useState(null),r=N.useRef(null),[s,i]=N.useState({rfcEmisor:e.rfc||"",nombreEmisor:e.nombre||"",regimenFiscalEmisor:"601",nacionalidadReceptor:"Nacional",rfcReceptor:"",razonSocial:"",nombre:"",paterno:"",materno:"",curpReceptor:"",domicilioFiscalReceptor:"",numRegIdTribReceptor:"",mesIni:"",mesFin:"",ejercicio:String(new Date().getFullYear()),cveRetenc:"",descRetenc:"",folioInt:"",montoTotOperacion:"",montoTotGrav:"",montoTotExent:"0.00",montoTotRet:"",impRetenidos:[{baseRet:"",impuestoRet:"001",montoRet:"",tipoPagoRet:"01"}],fechaPago:new Date().toISOString().split("T")[0],concepto:"",correoReceptor:"",usuarioRegistro:""}),[o,l]=N.useState([]),[c,u]=N.useState(null),[d,f]=N.useState(!1),[m,x]=N.useState(null),[h,g]=N.useState(!1),p=C=>{if(!C)return{codigoPostal:"",calle:"",numeroExterior:"",numeroInterior:"",colonia:"",municipio:"",estado:""};const z={codigoPostal:"",calle:"",numeroExterior:"",numeroInterior:"",colonia:"",municipio:"",estado:""},S=C.match(/(?:C\.?P\.?\s*)?(\d{5})(?:\s|$|,)/i);S&&(z.codigoPostal=S[1]);const D=C.split(",").map(U=>U.trim());if(D.length>0){const U=D[0],B=U.match(/(\d+[A-Za-z]?|MZ\s*\d+|LT\s*\d+|EDIF\s*\w+)/i);if(B){z.numeroExterior=B[1];const T=U.substring(0,B.index).trim();z.calle=T}else z.calle=U;const X=U.match(/Int\.\s*(\S+)/i);X&&(z.numeroInterior=X[1])}let H=!1;for(let U=1;U<D.length&&!H;U++)if(D[U].match(/C\.?P\.?\s*\d{5}/i)){H=!0,U>1&&(z.estado=D[U-1]),U>2&&(z.municipio=D[U-2]),U>3&&(z.colonia=D[U-3]);break}return!H&&D.length>=3&&(z.colonia=D[D.length-3]||"",z.municipio=D[D.length-2]||"",z.estado=D[D.length-1]||""),z},v=async C=>{const z=p(C.domicilioFiscal);i(S=>({...S,rfcReceptor:C.rfc,razonSocial:C.razonSocial||S.razonSocial,nombre:C.nombre||S.nombre,paterno:C.paterno||S.paterno,materno:C.materno||S.materno,correoReceptor:C.correoElectronico||S.correoReceptor,domicilioFiscalReceptor:z.codigoPostal||S.domicilioFiscalReceptor}))},w=()=>{g(!0)},b=async C=>{try{const z={rfc:C.rfc,razon_social:C.razonSocial,nombre:C.nombre,paterno:C.apellidoPaterno,materno:C.apellidoMaterno,correo_electronico:C.correoElectronico,telefono:C.telefono,codigo_postal:C.codigoPostal,estado:C.estado,municipio:C.municipio,colonia:C.colonia,calle:C.calle,numero_exterior:C.numeroExterior,numero_interior:C.numeroInterior,pais:C.pais,regimen_fiscal:C.regimenFiscal,uso_cfdi:C.usoCfdi,registro_tributario:C.esExtranjero?"EXT":null},S=await fetch(Re("/catalogo-clientes"),{method:"POST",headers:Ca(),body:JSON.stringify(z)}),D=await S.json();if(!S.ok||D.error)throw new Error(D.error||"Error al guardar cliente");i(H=>({...H,rfcReceptor:C.rfc,razonSocial:C.razonSocial,nombre:C.nombre||H.nombre,paterno:C.apellidoPaterno||H.paterno,materno:C.apellidoMaterno||H.materno,correoReceptor:C.correoElectronico,domicilioFiscalReceptor:C.codigoPostal})),g(!1)}catch(z){throw console.error("Error al guardar cliente:",z),z}};N.useEffect(()=>{const C=s.rfcReceptor.trim().toUpperCase();let z=null;C&&C.length>=12&&(C.length===12?z="moral":C.length===13&&(z="fisica")),z!==r.current&&(r.current=z,t(z),z==="moral"?i(S=>({...S,nombre:"",paterno:"",materno:""})):z==="fisica"&&i(S=>({...S,razonSocial:""})))},[s.rfcReceptor]),N.useEffect(()=>{e.rfc&&i(C=>({...C,rfcEmisor:e.rfc,nombreEmisor:e.nombre||C.nombreEmisor}))},[e]),N.useEffect(()=>{const C=localStorage.getItem("session.idUsuario")||localStorage.getItem("username")||"";C&&i(z=>({...z,usuarioRegistro:C}))},[]),N.useEffect(()=>{const C=parseFloat(s.montoTotOperacion||"0"),z=parseFloat(s.montoTotExent||"0"),S=Math.max(0,C-z),D=s.impRetenidos.reduce((H,U)=>H+parseFloat(U.montoRet||"0"),0);i(H=>{const U={};return H.montoTotGrav!==S.toFixed(2)&&(U.montoTotGrav=S.toFixed(2)),H.montoTotRet!==D.toFixed(2)&&(U.montoTotRet=D.toFixed(2)),Object.keys(U).length>0?{...H,...U}:H})},[s.montoTotOperacion,s.montoTotExent,s.impRetenidos]);const y=N.useCallback(C=>{const{name:z,value:S}=C.target;i(D=>({...D,[z]:S}))},[]),j=N.useCallback((C,z)=>C==="001"?{"08":.1,25:.1,27:.1,"05":.1,23:.1,"02":.1,28:.1,"03":.2,15:.2,"04":.25,26:.25,"09":0}[z]||.1:C==="002"?.1067:0,[]),A=N.useCallback((C,z,S)=>{i(D=>{const H=[...D.impRetenidos],U=H[C];if(z==="baseRet"||z==="impuestoRet"){const B=parseFloat(z==="baseRet"?S||"0":U.baseRet||"0"),X=z==="impuestoRet"?S:U.impuestoRet;if(B>0&&X){const T=j(X,D.cveRetenc||"08"),L=B*T;H[C]={...U,[z]:S,baseRet:z==="baseRet"?S:U.baseRet,impuestoRet:z==="impuestoRet"?S:U.impuestoRet,montoRet:L.toFixed(2)}}else H[C]={...U,[z]:S}}else H[C]={...U,[z]:S};return{...D,impRetenidos:H}})},[j]),E=N.useCallback(()=>{i(C=>{const z=C.montoTotOperacion||"",S="001",D=j(S,C.cveRetenc||"08"),H=parseFloat(z||"0")*D;return{...C,impRetenidos:[...C.impRetenidos,{baseRet:z,impuestoRet:S,montoRet:H>0?H.toFixed(2):"",tipoPagoRet:"01"}]}})},[j]),F=N.useCallback(C=>{i(z=>({...z,impRetenidos:z.impRetenidos.filter((S,D)=>D!==C)}))},[]),k=N.useCallback(()=>{var U,B,X,T,L,V,O,de,me,ae,ce,W,le,I,q;const C=[];if((U=s.rfcEmisor)!=null&&U.trim()?(s.rfcEmisor.trim().length<12||s.rfcEmisor.trim().length>13)&&C.push("RFC del emisor debe tener 12 o 13 caracteres"):C.push("RFC del emisor es obligatorio"),(B=s.nombreEmisor)!=null&&B.trim()||C.push("Nombre del emisor es obligatorio"),(X=s.regimenFiscalEmisor)!=null&&X.trim()||C.push("Rgimen fiscal del emisor es obligatorio"),(T=s.rfcReceptor)!=null&&T.trim()?(s.rfcReceptor.trim().length<12||s.rfcReceptor.trim().length>13)&&C.push("RFC del receptor debe tener 12 o 13 caracteres"):C.push("RFC del receptor es obligatorio"),s.nacionalidadReceptor==="Nacional"){if(!((L=s.domicilioFiscalReceptor)!=null&&L.trim()))C.push("Cdigo postal del receptor es obligatorio (DomicilioFiscalR)");else{const ne=s.domicilioFiscalReceptor.trim().replace(/\D/g,"");ne.length!==5?C.push("El cdigo postal del receptor debe tener exactamente 5 dgitos"):/^[0-9]{5}$/.test(ne)||C.push("El cdigo postal del receptor debe contener solo nmeros")}a==="moral"?(V=s.razonSocial)!=null&&V.trim()||C.push("Razn social es obligatoria para persona moral"):a==="fisica"?((O=s.nombre)!=null&&O.trim()||C.push("Nombre es obligatorio para persona fsica"),(de=s.paterno)!=null&&de.trim()||C.push("Apellido paterno es obligatorio para persona fsica")):C.push("El RFC del receptor debe tener 12 caracteres (moral) o 13 caracteres (fsica)")}else s.nacionalidadReceptor==="Extranjero"&&((me=s.razonSocial)!=null&&me.trim()||C.push("Nombre o razn social es obligatorio para receptor extranjero"));if((ae=s.mesIni)!=null&&ae.trim()||C.push("Mes inicial del perodo es obligatorio"),(ce=s.mesFin)!=null&&ce.trim()||C.push("Mes final del perodo es obligatorio"),(W=s.ejercicio)!=null&&W.trim()||C.push("Ejercicio (ao) es obligatorio"),!((le=s.cveRetenc)!=null&&le.trim()))C.push("Clave de retencin (CveRetenc) es obligatoria");else{const ne=parseInt(s.cveRetenc);(isNaN(ne)||ne<1||ne>28)&&C.push("La clave de retencin debe estar entre 01 y 28")}const z=parseFloat(s.montoTotOperacion||"0");z<=0&&C.push("El monto total de la operacin debe ser mayor a cero");const S=parseFloat(s.montoTotGrav||"0"),D=parseFloat(s.montoTotExent||"0");return S+D!==z&&C.push("La suma de monto gravado y monto exento debe igualar el monto total de la operacin"),parseFloat(s.montoTotRet||"0")<=0&&C.push("El monto total retenido debe ser mayor a cero"),s.impRetenidos.length===0&&C.push("Debe haber al menos un impuesto retenido"),s.impRetenidos.forEach((ne,G)=>{var ie,we;parseFloat(ne.montoRet||"0")<=0&&C.push(`El monto retenido del impuesto ${G+1} debe ser mayor a cero`),(ie=ne.impuestoRet)!=null&&ie.trim()||C.push(`El tipo de impuesto del impuesto ${G+1} es obligatorio`),(we=ne.tipoPagoRet)!=null&&we.trim()||C.push(`El tipo de pago ret del impuesto ${G+1} es obligatorio`),ne.impuestoRet==="002"&&ne.tipoPagoRet!=="01"&&C.push(`El impuesto ${G+1}: Para IVA (002), el Tipo de Pago Ret debe ser "01" (Definitivo). El IVA siempre es definitivo.`),ne.impuestoRet==="001"&&!["01","02","03","04"].includes(ne.tipoPagoRet)&&C.push(`El impuesto ${G+1}: Para ISR (001), el Tipo de Pago Ret debe ser 01, 02, 03 o 04`)}),(I=s.fechaPago)!=null&&I.trim()||C.push("Fecha de pago es obligatoria"),(q=s.correoReceptor)!=null&&q.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.correoReceptor.trim())||C.push("El correo del receptor no tiene un formato vlido"):C.push("Correo del receptor es obligatorio"),C},[s,a]),P=N.useCallback(()=>{l([]),u(null)},[]),R=N.useCallback(async()=>{P();const C=k();if(C.length>0){l(C),alert(`Por favor corrija los errores antes de ver la vista previa:
`+C.join(`
`));return}try{const z=s.rfcReceptor.trim().length===12?"moral":"fisica";let S=0,D=0;s.impRetenidos.forEach(O=>{const de=parseFloat(O.montoRet||"0");O.impuestoRet==="001"?S+=de:O.impuestoRet==="002"&&(D+=de)});const U={"01":"OTROS","02":"DIVIDENDOS","03":"INTERESES","04":"ISR_REGALIAS","05":"ISR_ARRENDAMIENTO","06":"ENAJENACION_ACCIONES","07":"ISR_ENAJENACION","08":"ISR_SERVICIOS","09":"ISR_SUELDOS",10:"OTROS",11:"OTROS",12:"FIDEICOMISOS",13:"PLANES_RETIRO",14:"IVA",15:"INTERESES",16:"FIDEICOMISOS",17:"REMANENTE",18:"PLANES_RETIRO",19:"ENAJENACION_ACCIONES",20:"OTROS",21:"OTROS",22:"OTROS",23:"ISR_ARRENDAMIENTO",24:"ISR_ENAJENACION",25:"ISR_SERVICIOS",26:"ISR_REGALIAS",27:"ISR_SERVICIOS",28:"DIVIDENDOS"}[s.cveRetenc]||"OTROS",B={rfcEmisor:s.rfcEmisor.trim(),nombreEmisor:s.nombreEmisor.trim(),rfcReceptor:s.rfcReceptor.trim(),razonSocial:z==="moral"?s.razonSocial.trim():void 0,nombre:z==="fisica"?s.nombre.trim():void 0,paterno:z==="fisica"?s.paterno.trim():void 0,materno:z==="fisica"?s.materno.trim():void 0,tipoPersona:z,tipoRetencion:U,cveRetenc:s.cveRetenc.trim(),montoBase:parseFloat(s.montoTotOperacion||"0"),montoTotGravado:parseFloat(s.montoTotGrav||"0"),montoTotExento:parseFloat(s.montoTotExent||"0"),isrRetenido:S,ivaRetenido:D,montoRetenido:parseFloat(s.montoTotRet||"0"),periodoMes:s.mesIni.trim(),periodoAnio:s.ejercicio.trim(),fechaPago:s.fechaPago.trim(),concepto:s.concepto.trim()||s.descRetenc.trim(),correoReceptor:s.correoReceptor.trim(),codigoPostalReceptor:s.domicilioFiscalReceptor.trim(),impRetenidos:s.impRetenidos.map(O=>({baseRet:O.baseRet||"0",impuestoRet:O.impuestoRet||"001",montoRet:O.montoRet||"0",tipoPagoRet:O.tipoPagoRet||"01"}))},X=await fetch(Re("/retenciones/preview-pdf"),{method:"POST",headers:Ca(),body:JSON.stringify(B)});if(!X.ok){const O=await X.text();throw new Error(`Error HTTP ${X.status}: ${O}`)}const T=await X.blob(),L=window.URL.createObjectURL(T),V=document.createElement("a");V.href=L,V.target="_blank",V.rel="noopener noreferrer",document.body.appendChild(V),V.click(),document.body.removeChild(V),window.URL.revokeObjectURL(L)}catch(z){console.error("Error en vista previa:",z);const S=z instanceof Error?z.message:"Error desconocido";l([`Error al generar vista previa: ${S}`]),alert(`Error al generar vista previa: ${S}`)}},[s,k,P]),_=N.useCallback(()=>{P(),i({rfcEmisor:e.rfc||"",nombreEmisor:e.nombre||"",regimenFiscalEmisor:"601",nacionalidadReceptor:"Nacional",rfcReceptor:"",razonSocial:"",nombre:"",paterno:"",materno:"",curpReceptor:"",domicilioFiscalReceptor:"",numRegIdTribReceptor:"",mesIni:"",mesFin:"",ejercicio:String(new Date().getFullYear()),cveRetenc:"",descRetenc:"",folioInt:"",montoTotOperacion:"",montoTotGrav:"",montoTotExent:"0.00",montoTotRet:"",impRetenidos:[{baseRet:"",impuestoRet:"001",montoRet:"",tipoPagoRet:"01"}],fechaPago:new Date().toISOString().split("T")[0],concepto:"",correoReceptor:"",usuarioRegistro:s.usuarioRegistro}),t(null),r.current=null,x(null)},[s.usuarioRegistro,e,P]),Q=N.useCallback(async()=>{var z,S;P();const C=k();if(C.length>0){l(C);return}try{f(!0);const D=s.domicilioFiscalReceptor.trim().replace(/\D/g,"").padStart(5,"0").substring(0,5),U={"01":"OTROS","02":"DIVIDENDOS","03":"INTERESES","04":"ISR_REGALIAS","05":"ISR_ARRENDAMIENTO","06":"ENAJENACION_ACCIONES","07":"ISR_ENAJENACION","08":"ISR_SERVICIOS","09":"ISR_SUELDOS",10:"OTROS",11:"OTROS",12:"FIDEICOMISOS",13:"PLANES_RETIRO",14:"IVA",15:"INTERESES",16:"FIDEICOMISOS",17:"REMANENTE",18:"PLANES_RETIRO",19:"ENAJENACION_ACCIONES",20:"OTROS",21:"OTROS",22:"OTROS",23:"ISR_ARRENDAMIENTO",24:"ISR_ENAJENACION",25:"ISR_SERVICIOS",26:"ISR_REGALIAS",27:"ISR_SUELDOS",28:"DIVIDENDOS"}[s.cveRetenc]||"OTROS";let B=0,X=0;s.impRetenidos.forEach(O=>{const de=parseFloat(O.montoRet||"0");O.impuestoRet==="001"?B+=de:O.impuestoRet==="002"&&(X+=de)});const T=parseFloat(s.montoTotRet||"0"),L={rfcEmisor:s.rfcEmisor.trim(),nombreEmisor:s.nombreEmisor.trim(),rfcReceptor:s.rfcReceptor.trim(),razonSocial:a==="moral"?s.razonSocial.trim():void 0,nombre:a==="fisica"?s.nombre.trim():void 0,paterno:a==="fisica"?s.paterno.trim():void 0,materno:a==="fisica"?s.materno.trim():void 0,tipoPersona:a||"moral",tipoRetencion:U,cveRetenc:s.cveRetenc.trim(),montoBase:parseFloat(s.montoTotOperacion),isrRetenido:B,ivaRetenido:X,montoRetenido:T,periodoMes:s.mesIni.trim(),periodoAnio:s.ejercicio.trim(),fechaPago:s.fechaPago.trim(),concepto:s.concepto.trim()||s.descRetenc.trim(),correoReceptor:s.correoReceptor.trim(),usuarioRegistro:((z=s.usuarioRegistro)==null?void 0:z.trim())||void 0,codigoPostalReceptor:D},V=await $y.registrarRetencion(L);if(V.success){const O=V.message||"Retencin registrada correctamente.",de=V.uuidRetencion&&V.uuidRetencion.trim().length>0?`${O} (UUID: ${V.uuidRetencion})`:O;u(de);const me=((S=V.uuidRetencion)==null?void 0:S.trim())||"";if(x(me||null),me?window.alert(`Retencin de pagos timbrada exitosamente
UUID: ${me}`):window.alert("Retencin de pagos timbrada exitosamente"),window.confirm("Deseas enviar el PDF de la retencin al correo registrado?")&&me)try{await $y.enviarRetencionPorCorreo({uuidRetencion:me,correoReceptor:s.correoReceptor.trim(),rfcReceptor:V.rfcReceptor||s.rfcReceptor.trim(),rfcEmisor:V.rfcEmisor||s.rfcEmisor.trim(),nombreReceptor:a==="moral"?s.razonSocial.trim():`${s.nombre.trim()} ${s.paterno.trim()} ${s.materno.trim()}`.trim(),nombreEmisor:s.nombreEmisor.trim(),serieRetencion:V.serieRetencion||void 0,folioRetencion:V.folioRetencion||void 0,fechaTimbrado:V.fechaTimbrado||void 0,tipoRetencion:U,montoRetenido:V.montoRetenido||T,baseRetencion:V.baseRetencion||parseFloat(s.montoTotOperacion)}),window.alert(`Retencin enviada exitosamente al correo: ${s.correoReceptor.trim()}`),u(`Retencin enviada por correo a ${s.correoReceptor.trim()}`)}catch(ce){const W=ce instanceof Error?ce.message:"Error al enviar por correo.";l([W]),window.alert(W)}}else{const O=V.errors||[],de=V.message||"Error al registrar la retencin.";l([de,...O]),window.alert(`${de}
${O.join(`
`)}`)}}catch(D){const H=D instanceof Error?D.message:"No se pudo registrar la retencin de pagos.";l([H]),window.alert(H)}finally{f(!1)}},[s,a,P,k]);return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"Retencin de Pagos"}),n.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"CFDI de Retenciones e Informacin de Pagos 2.0 segn Anexo 20 del SAT"})]}),o.length>0&&n.jsx("div",{className:"rounded-lg bg-red-50 p-4 dark:bg-red-900/20",children:n.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-red-800 dark:text-red-200",children:o.map((C,z)=>n.jsx("li",{children:C},z))})}),c&&n.jsx("div",{className:"rounded-lg bg-green-50 p-4 dark:bg-green-900/20",children:n.jsx("p",{className:"text-sm text-green-800 dark:text-green-200",children:c})}),n.jsxs(ve,{title:"Datos del Receptor",children:[n.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[n.jsx(Se,{label:"Nacionalidad del Receptor",name:"nacionalidadReceptor",value:s.nacionalidadReceptor,onChange:y,options:[{value:"Nacional",label:"Nacional"},{value:"Extranjero",label:"Extranjero"}],required:!0}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"RFC del Receptor *"}),n.jsx(Jc,{value:s.rfcReceptor,onChange:C=>i(z=>({...z,rfcReceptor:C})),onSelect:v,onNotFound:w,required:!0})]})]}),s.nacionalidadReceptor==="Nacional"&&n.jsxs(n.Fragment,{children:[a==="moral"&&n.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[n.jsx(J,{label:"Razn Social",name:"razonSocial",value:s.razonSocial,onChange:y,placeholder:"Ej. Empresa Ejemplo S.A. de C.V.",required:!0}),n.jsx(J,{label:"CURP (Opcional)",name:"curpReceptor",value:s.curpReceptor,onChange:y,placeholder:"Ej. ABC123456HDFGHI01"})]}),a==="fisica"&&n.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:[n.jsx(J,{label:"Nombre",name:"nombre",value:s.nombre,onChange:y,placeholder:"Ej. Juan",required:!0}),n.jsx(J,{label:"Apellido Paterno",name:"paterno",value:s.paterno,onChange:y,placeholder:"Ej. Prez",required:!0}),n.jsx(J,{label:"Apellido Materno",name:"materno",value:s.materno,onChange:y,placeholder:"Ej. Garca"}),n.jsx(J,{label:"CURP (Opcional)",name:"curpReceptor",value:s.curpReceptor,onChange:y,placeholder:"Ej. ABC123456HDFGHI01"})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx(J,{label:"Cdigo Postal del Receptor (DomicilioFiscalR) *",name:"domicilioFiscalReceptor",value:s.domicilioFiscalReceptor,onChange:y,placeholder:"Ej. 58000 (5 dgitos)",required:!0,maxLength:5}),n.jsx("p",{className:"mt-1 text-xs text-amber-600 dark:text-amber-400",children:"CRTICO: Debe ser un cdigo postal vlido del catlogo c_CodigoPostal del SAT (5 dgitos numricos)"})]})]}),s.nacionalidadReceptor==="Extranjero"&&n.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[n.jsx(J,{label:"Nombre o Razn Social",name:"razonSocial",value:s.razonSocial,onChange:y,placeholder:"Nombre completo o razn social",required:!0}),n.jsx(J,{label:"Nmero de Registro de Identificacin Fiscal",name:"numRegIdTribReceptor",value:s.numRegIdTribReceptor,onChange:y,placeholder:"Opcional"})]}),!a&&s.rfcReceptor.trim().length>0&&n.jsx("p",{className:"mt-2 text-xs text-amber-600 dark:text-amber-400",children:"Ingresa un RFC vlido (12 caracteres para persona moral, 13 para persona fsica)"})]}),n.jsx(ve,{title:"Perodo",children:n.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[n.jsx(Se,{label:"Mes Inicial",name:"mesIni",value:s.mesIni,onChange:y,options:Vy,required:!0}),n.jsx(Se,{label:"Mes Final",name:"mesFin",value:s.mesFin,onChange:y,options:Vy,required:!0}),n.jsx(Se,{label:"Ejercicio (Ao)",name:"ejercicio",value:s.ejercicio,onChange:y,options:sM,required:!0})]})}),n.jsxs(ve,{title:"Informacin de la Retencin",children:[n.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[n.jsx(Se,{label:"Clave de Retencin (CveRetenc)",name:"cveRetenc",value:s.cveRetenc,onChange:y,options:tM,required:!0}),n.jsx(J,{label:"Descripcin de la Retencin (DescRetenc)",name:"descRetenc",value:s.descRetenc,onChange:y,placeholder:"Descripcin opcional de la retencin",maxLength:100})]}),n.jsx("div",{className:"mt-4",children:n.jsx(J,{label:"Folio Interno (Opcional)",name:"folioInt",value:s.folioInt,onChange:y,placeholder:"Folio interno del contribuyente",maxLength:20})}),n.jsx("div",{className:"mt-4",children:n.jsx(J,{label:"Concepto",name:"concepto",value:s.concepto,onChange:y,placeholder:"Descripcin del pago o servicio",required:!0})}),n.jsx("div",{className:"mt-4",children:n.jsx(J,{label:"Fecha de Pago",name:"fechaPago",type:"date",value:s.fechaPago,onChange:y,required:!0})})]}),n.jsxs(ve,{title:"Totales",children:[n.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:[n.jsx(J,{label:"Monto Total de la Operacin *",name:"montoTotOperacion",type:"number",step:"0.01",min:"0",value:s.montoTotOperacion,onChange:y,placeholder:"0.00",required:!0}),n.jsx("div",{className:"flex items-end",children:n.jsxs("div",{className:"w-full rounded-lg bg-gray-50 p-3 dark:bg-gray-800",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300",children:"Monto Total Gravado (Calculado)"}),n.jsxs("p",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-gray-100",children:["$",parseFloat(s.montoTotGrav||"0").toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})}),n.jsx(J,{label:"Monto Total Exento",name:"montoTotExent",type:"number",step:"0.01",min:"0",value:s.montoTotExent,onChange:y,placeholder:"0.00",required:!0}),n.jsx("div",{className:"flex items-end",children:n.jsxs("div",{className:"w-full rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20",children:[n.jsx("label",{className:"block text-xs font-medium text-blue-700 dark:text-blue-300",children:"Monto Total Retenido (Calculado)"}),n.jsxs("p",{className:"mt-1 text-lg font-semibold text-blue-900 dark:text-blue-100",children:["$",parseFloat(s.montoTotRet||"0").toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})]}),n.jsxs("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["* El monto total gravado se calcula automticamente como: Monto Total Operacin - Monto Total Exento",n.jsx("br",{}),"El monto total retenido se calcula automticamente desde la suma de los impuestos retenidos"]})]}),n.jsxs(ve,{title:"Impuestos Retenidos",children:[s.impRetenidos.map((C,z)=>n.jsxs("div",{className:"mb-4 rounded-lg border border-gray-200 p-4 dark:border-gray-700",children:[n.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[n.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Impuesto Retenido ",z+1]}),s.impRetenidos.length>1&&n.jsx(fe,{variant:"neutral",onClick:()=>F(z),className:"text-xs",children:"Eliminar"})]}),n.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:[n.jsx(J,{label:"Base de Retencin *",name:`baseRet_${z}`,type:"number",step:"0.01",min:"0",value:C.baseRet,onChange:S=>A(z,"baseRet",S.target.value),placeholder:"0.00",required:!0}),n.jsx(Se,{label:"Impuesto Retenido *",name:`impuestoRet_${z}`,value:C.impuestoRet,onChange:S=>A(z,"impuestoRet",S.target.value),options:nM,required:!0}),n.jsxs("div",{children:[n.jsx(J,{label:"Monto Retenido (Calculado automticamente)",name:`montoRet_${z}`,type:"number",step:"0.01",min:"0",value:C.montoRet,onChange:S=>A(z,"montoRet",S.target.value),placeholder:"0.00",required:!0}),n.jsx("p",{className:"mt-1 text-xs text-green-600 dark:text-green-400",children:"Se calcula automticamente segn la base y tipo de impuesto"})]}),n.jsx(Se,{label:"Tipo de Pago Ret *",name:`tipoPagoRet_${z}`,value:C.tipoPagoRet,onChange:S=>A(z,"tipoPagoRet",S.target.value),options:rM,required:!0})]}),n.jsxs("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["* El monto retenido se calcula automticamente segn la base de retencin y el tipo de impuesto seleccionado.",n.jsx("br",{}),"Tasas aplicadas: ISR (10-25% segn tipo), IVA (10.67%), IEPS (variable). Puede ajustarse manualmente si es necesario."]})]},z)),n.jsx(fe,{variant:"secondary",onClick:E,className:"mt-2",children:"+ Agregar Impuesto Retenido"})]}),n.jsx(ve,{title:"Informacin Adicional",children:n.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[n.jsx(J,{label:"Correo del Receptor",name:"correoReceptor",type:"email",value:s.correoReceptor,onChange:y,placeholder:"ejemplo@dominio.com",required:!0}),n.jsx(J,{label:"Usuario que Registra",name:"usuarioRegistro",value:s.usuarioRegistro,onChange:y,placeholder:"Usuario del sistema",disabled:!0})]})}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx(fe,{variant:"neutral",onClick:_,children:"Limpiar formulario"}),n.jsx(fe,{variant:"secondary",onClick:R,disabled:d,children:"Vista Previa"}),n.jsx(fe,{onClick:Q,disabled:d,children:d?"Guardando":"Guardar Retencin"}),m&&s.correoReceptor&&n.jsx(fe,{variant:"secondary",onClick:()=>{const C=encodeURIComponent(`Retencin de Pagos - UUID: ${m}`),z=encodeURIComponent(`Se adjunta el CFDI de Retencin de Pagos.

UUID: ${m}
Clave de Retencin: ${s.cveRetenc}
Monto Total Operacin: $${s.montoTotOperacion}
Monto Total Retenido: $${s.montoTotRet}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(s.correoReceptor)}&su=${C}&body=${z}`,"_blank")},children:"Enviar Gmail"})]}),n.jsx(Du,{isOpen:h,onClose:()=>g(!1),onSave:b,rfcInicial:s.rfcReceptor})]})};class oM{constructor(){this.baseUrl=Re("/tickets")}async buscarTickets(a){try{console.log("Buscando tickets con filtros:",a);const t=await fetch(`${this.baseUrl}/buscar`,{method:"POST",headers:Ca(),body:JSON.stringify(a)});if(console.log("Respuesta del servidor - Status:",t.status,t.statusText),!t.ok){const s=await t.text();throw console.error("Error HTTP:",t.status,s),new Error(`HTTP ${t.status}: ${s}`)}const r=await t.json();return console.log("Datos recibidos del backend:",r),Array.isArray(r)?(console.log("Tickets encontrados (array directo):",r.length),r):r!=null&&r.data&&Array.isArray(r.data)?(console.log("Tickets encontrados (data.data):",r.data.length),r.data):r!=null&&r.tickets&&Array.isArray(r.tickets)?(console.log("Tickets encontrados (data.tickets):",r.tickets.length),r.tickets):r!=null&&r.resultados&&Array.isArray(r.resultados)?(console.log("Tickets encontrados (data.resultados):",r.resultados.length),r.resultados):(console.warn("No se encontr array de tickets en la respuesta:",r),[])}catch(t){throw console.error("Error al buscar tickets:",t),t}}async buscarTicketsPorIdFactura(a){try{const t=await fetch(`${this.baseUrl}/por-id-factura/${encodeURIComponent(String(a))}`);if(!t.ok)throw new Error(`HTTP ${t.status}`);const r=await t.json();return Array.isArray(r)?r:r!=null&&r.data&&Array.isArray(r.data)?r.data:r!=null&&r.tickets&&Array.isArray(r.tickets)?r.tickets:[]}catch{return[]}}async buscarTicketsPorIdTicket(a){try{const t=await fetch(`${this.baseUrl}/por-id-ticket/${encodeURIComponent(String(a))}`);if(!t.ok)throw new Error(`HTTP ${t.status}`);const r=await t.json();return Array.isArray(r)?r:r!=null&&r.data&&Array.isArray(r.data)?r.data:r!=null&&r.tickets&&Array.isArray(r.tickets)?r.tickets:[]}catch{return[]}}async buscarDetallesPorIdFactura(a){try{const t=await fetch(`${this.baseUrl}/detalles/por-id-factura/${encodeURIComponent(String(a))}`);if(!t.ok)throw new Error(`HTTP ${t.status}`);const r=await t.json();return Array.isArray(r)?r:r!=null&&r.data&&Array.isArray(r.data)?r.data:r!=null&&r.detalles&&Array.isArray(r.detalles)?r.detalles:[]}catch{return[]}}async buscarDetallesPorIdTicket(a){try{const t=await fetch(`${this.baseUrl}/${encodeURIComponent(String(a))}/detalles`);if(!t.ok)throw new Error(`HTTP ${t.status}`);const r=await t.json();return Array.isArray(r)?r:r!=null&&r.data&&Array.isArray(r.data)?r.data:r!=null&&r.detalles&&Array.isArray(r.detalles)?r.detalles:[]}catch{return[]}}}const ci=new oM;var Hv,Gv,Xv;const lM={rfcReceptor:"",nombreCliente:"",apellidoPaterno:"",apellidoMaterno:"",razonSocial:"",almacen:((Hv=Zm[Zm.length-1])==null?void 0:Hv.value)||"",usuario:"",serie:"",folio:"",uuid:"",fechaInicio:"",fechaFin:"",tienda:((Gv=Ia[0])==null?void 0:Gv.value)||"",te:"",tr:"",fechaTienda:"",codigoFacturacion:"",motivoSustitucion:((Xv=Fh[0])==null?void 0:Xv.value)||""},cM=()=>{const[e,a]=N.useState(lM),[t,r]=N.useState([]),[s,i]=N.useState(!1),[o,l]=N.useState(!1),[c,u]=N.useState(null),[d]=N.useState("OPERADOR"),[f,m]=N.useState(null),[x,h]=N.useState(!1),[g,p]=N.useState(new Set),[v,w]=N.useState(null),[b,y]=N.useState(!1),[j,A]=N.useState(null),[E,F]=N.useState({});N.useEffect(()=>()=>{f&&clearInterval(f)},[f]);const[k,P]=N.useState({open:!1,uuid:null,motivo:"02",loading:!1,uuidSustituto:""}),R=G=>{const ee=new Set(g);ee.has(G)?ee.delete(G):ee.add(G),p(ee)},_=()=>{g.size===t.length?p(new Set):p(new Set(t.map(G=>G.uuid)))},Q=async G=>{try{w(G),await ma.generarYDescargarPDF(G)}catch(ee){console.error("Error descargando PDF:",ee),alert(`Error al descargar PDF: ${ee instanceof Error?ee.message:"Error desconocido"}`)}finally{w(null)}},C=async G=>{try{w(G),await ma.generarYDescargarZIP(G)}catch(ee){console.error("Error descargando ZIP:",ee),alert(`Error al descargar ZIP: ${ee instanceof Error?ee.message:"Error desconocido"}`)}finally{w(null)}},z=async G=>{try{A(G),await ma.generarYDescargarXML(G)}catch(ee){console.error("Error descargando XML:",ee),alert(`Error al descargar XML: ${ee instanceof Error?ee.message:"Error desconocido"}`)}finally{A(null)}},S=async()=>{if(g.size===0){alert("Por favor selecciona al menos una factura");return}try{y(!0);const G=Array.from(g);await ma.generarYDescargarZIPMultiple(G)}catch(G){console.error("Error descargando ZIP mltiple:",G),alert(`Error al descargar ZIP: ${G instanceof Error?G.message:"Error desconocido"}`)}finally{y(!1)}},D=G=>{P({open:!0,uuid:G.uuid,motivo:"02",loading:!1,uuidSustituto:""})},H=()=>{P({open:!1,uuid:null,motivo:"02",loading:!1}),B()},U=async()=>{if(!(!s||!e)){h(!0);try{const G={uuid:e.uuid.trim(),perfilUsuario:d},ie=await(await fetch(Re("/consulta-facturas/buscar"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)})).json();if(ie.exitoso){try{const we=(ie.facturas||[])[0];we&&(console.debug("[ConsultaFacturas] refreshFacturas primer registro:",we),console.debug("[ConsultaFacturas] claves recibidas:",Object.keys(we||{})))}catch{}r(ie.facturas||[])}}catch(G){console.error("Error al refrescar facturas:",G)}finally{h(!1)}}},B=()=>{f&&clearInterval(f);const G=setInterval(U,5e3);m(G),setTimeout(()=>{clearInterval(G),m(null)},3e4)},X=async G=>{try{const ee=await fetch(kr(`/pac/status/${G}`));if(!ee.ok)return null;const ie=await ee.json();return(ie==null?void 0:ie.status)||null}catch{return null}},T=G=>{const ee=setInterval(async()=>{const ie=await X(G);!ie||ie==="EN_PROCESO"||(r(we=>we.map(je=>je.uuid!==G?je:ie==="CANCELADA"?{...je,estatusFacturacion:"2",estatusSat:"Cancelada",permiteCancelacion:!1}:{...je,estatusFacturacion:je.estatusFacturacion,estatusSat:je.estatusSat,permiteCancelacion:!0})),clearInterval(ee))},3e3)},L=async G=>{var ie,we;const ee=G.uuid;F(je=>({...je,[ee]:{...je[ee]||{tickets:0,detalles:0,cartaPorte:!1,notasCredito:0},loading:!0,error:void 0}}));try{let je=0;try{const Ve=await fetch(Re(`/credit-notes/search?uuidFacturaOrigen=${encodeURIComponent(ee)}`)),Ze=await Ve.json().catch(()=>null);if(Ve.ok){const Fe=Array.isArray(Ze)?Ze:Array.isArray(Ze==null?void 0:Ze.data)?Ze.data:Array.isArray(Ze==null?void 0:Ze.resultados)?Ze.resultados:[];je=Array.isArray(Fe)?Fe.length:0}else{const na=await(await fetch(Re(`/credit-notes/search?uuidFactura=${encodeURIComponent(ee)}`))).json().catch(()=>null),oa=Array.isArray(na)?na:Array.isArray(na==null?void 0:na.data)?na.data:Array.isArray(na==null?void 0:na.resultados)?na.resultados:[];je=Array.isArray(oa)?oa.length:0}}catch{je=0}let Me=0,$e=0;try{let Ve;try{const Fe=await(await fetch(Re(`/factura/id-factura/${encodeURIComponent(ee)}`))).json().catch(()=>null),na=(Fe==null?void 0:Fe.idFactura)??((ie=Fe==null?void 0:Fe.data)==null?void 0:ie.idFactura),oa=parseInt(String(na),10);!isNaN(oa)&&oa>0&&(Ve=oa)}catch{}if(Ve&&Ve>0){const Ze=await ci.buscarTicketsPorIdFactura(Ve);Me=Array.isArray(Ze)?Ze.length:0;const Fe=await ci.buscarDetallesPorIdFactura(Ve);$e=Array.isArray(Fe)?Fe.length:0}else{const Fe=await(await fetch(Re(`/factura/oracle/columns/${encodeURIComponent(ee)}`))).json().catch(()=>null);let na=(Fe==null?void 0:Fe.tienda)||(Fe==null?void 0:Fe.tiendaOrigen)||G.tienda,oa,$a;const Xe=(Fe==null?void 0:Fe.terminal)||(Fe==null?void 0:Fe.terminalBol)||(Fe==null?void 0:Fe.tr)||(Fe==null?void 0:Fe.terminalId);if(Xe!=null){const ge=parseInt(String(Xe),10);oa=isNaN(ge)?void 0:ge}const va=(Fe==null?void 0:Fe.boleta)||(Fe==null?void 0:Fe.boletaBol)||(Fe==null?void 0:Fe.folio)||G.folio;if(va!=null){const ge=parseInt(String(va),10);$a=isNaN(ge)?void 0:ge}const Y=(()=>{try{return new Date(G.fechaEmision).toISOString().split("T")[0]}catch{return}})(),oe=await ci.buscarTickets({codigoTienda:na,terminalId:oa,folio:$a,fecha:Y});Me=Array.isArray(oe)?oe.length:0;const ue=(oe||[]).slice(0,3);for(const ge of ue)if(ge!=null&&ge.idTicket)try{const Le=await(await fetch(Re(`/tickets/${encodeURIComponent(String(ge.idTicket))}/detalles`))).json().catch(()=>null),ke=Array.isArray(Le)?Le:Array.isArray(Le==null?void 0:Le.data)?Le.data:Array.isArray(Le==null?void 0:Le.detalles)?Le.detalles:[];$e+=Array.isArray(ke)?ke.length:0}catch{}}}catch{Me=0,$e=0}let Ie=!1;const We=G.tipoFactura;if(We!=null){const Ve=String(We).trim().toUpperCase();Ie=Ve==="3"||Ve==="T"}if(!Ie)try{const Ve=await ma.obtenerFacturaPorUUID(ee),Ze=(Ve==null?void 0:Ve.xmlContent)||"";if(Ze&&typeof Ze=="string")Ie=!!(/CartaPorte/i.test(Ze)||/cartaporte/i.test(Ze)||/cce20:ComplementoCartaPorte/i.test(Ze));else{const Fe=await ma.consultarCfdiPorUUID({uuid:ee,tipo:"I"}),na=(((we=Fe==null?void 0:Fe.relacionados)==null?void 0:we.tipoRelacion)||"").toUpperCase();Ie=na.includes("CARTA")||na.includes("CP")}}catch{Ie=!1}F(Ve=>({...Ve,[ee]:{tickets:Me,detalles:$e,cartaPorte:Ie,notasCredito:je,loading:!1}}))}catch{F(Me=>({...Me,[ee]:{...Me[ee]||{tickets:0,detalles:0,cartaPorte:!1,notasCredito:0},loading:!1,error:"Error cargando relaciones"}}))}};N.useEffect(()=>{if(!s||t.length===0)return;t.map(ee=>ee.uuid).filter(ee=>!E[ee]||E[ee].loading===void 0).forEach(ee=>{const ie=t.find(we=>we.uuid===ee);ie&&L(ie)})},[t,s]);const V=async()=>{if(k.uuid)try{if(P(we=>({...we,loading:!0,error:void 0})),k.motivo==="01"&&!(k.uuidSustituto||"").trim()){P(we=>({...we,error:"Motivo 01 requiere UUID sustituto",loading:!1}));return}const G={uuid:k.uuid,motivo:k.motivo,usuario:e.usuario||"operador",perfilUsuario:d};k.motivo==="01"&&(G.uuidSustituto=(k.uuidSustituto||"").trim());const ee=await fetch(Re("/consulta-facturas/cancelar"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)}),ie=await ee.json();if(ee.ok&&ie.exitoso){const we=k.uuid;await X(we)==="CANCELADA"?(r(Me=>Me.map($e=>$e.uuid===we?{...$e,estatusFacturacion:"Cancelada",estatusSat:"Cancelada",permiteCancelacion:!1}:$e)),H()):(r(Me=>Me.map($e=>$e.uuid===we?{...$e,estatusFacturacion:"1",estatusSat:"En proceso de cancelacin",permiteCancelacion:!1}:$e)),H(),T(we))}else P(we=>({...we,error:ie.mensaje||"No se pudo cancelar",loading:!1}))}catch(G){console.error("Error al cancelar:",G),P(ee=>({...ee,error:"Error de conexin al cancelar",loading:!1}))}},O=G=>{const{name:ee,value:ie}=G.target;a(we=>({...we,[ee]:ie})),c&&u(null)},de=()=>e.uuid.trim()?{valido:!0}:{valido:!1,mensaje:"Ingrese un UUID para realizar la consulta"},me=async G=>{G.preventDefault();const ee=de();if(!ee.valido){u(ee.mensaje||"Error de validacin");return}l(!0),u(null);try{const ie={uuid:e.uuid.trim(),perfilUsuario:d},je=await(await fetch(Re("/consulta-facturas/buscar"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ie)})).json();if(je.exitoso){try{const Me=(je.facturas||[])[0];Me&&(console.debug("[ConsultaFacturas] handleSubmit primer registro:",Me),console.debug("[ConsultaFacturas] claves recibidas:",Object.keys(Me||{})))}catch{}r(je.facturas||[]),i(!0),u(null)}else u(je.mensaje||"Error en la consulta"),r([]),i(!1)}catch(ie){console.error("Error al consultar facturas:",ie),u("Error de conexin con el servidor"),r([]),i(!1)}finally{l(!1)}},ae=G=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(G),ce=G=>{try{return new Date(G).toLocaleDateString("es-MX")}catch{return G}},W={66:"POR TIMBRAR",0:"EMITIDA",1:"EN PROCESO DE CANCELACION",2:"CANCELADA EN SAT",3:"DE PASO",4:"EN PROCESO DE EMISION",99:"FACTURA TEMPORAL",67:"EN ESPERA DE CANCELACION BOLETA QUE SUSTITUYE"},le=G=>(G||"").toString().trim(),I=G=>(G||"").toString().trim().toUpperCase().replace(/[]/g,"A").replace(/[]/g,"E").replace(/[]/g,"I").replace(/[]/g,"O").replace(/[]/g,"U").replace(/[]/g,"N").replace(/[_-]/g," ").replace(/\s+/g," ").trim(),q=(G,ee)=>{const ie=le(G),we=le(ee);if(ie&&W[ie])return`${ie} - ${W[ie]}`;const je=ie.replace(/[^0-9]/g,"");if(je&&W[je])return`${je} - ${W[je]}`;const Me=I(ie),Ie={"POR TIMBRAR":"66",EMITIDA:"0",ACTIVA:"0",VIGENTE:"0","EN PROCESO DE CANCELACION":"1","CANCELADA EN SAT":"2","DE PASO":"3","EN PROCESO DE EMISION":"4","EN PROCESO EMISION":"4","FACTURA TEMPORAL":"99","EN ESPERA DE CANCELACION BOLETA QUE SUSTITUYE":"67"}[Me];if(Ie&&W[Ie])return`${Ie} - ${W[Ie]}`;const We=Object.entries(W).find(([,Ve])=>I(Ve)===Me);if(We){const[Ve,Ze]=We;return`${Ve} - ${Ze}`}return ie&&we?`${ie} - ${we}`:ie||we||"-"},ne=G=>{if(G.permiteCancelacion)return!0;const ee=le(G.estatusFacturacion),ie=le(G.estatusSat),we=I(ee),je=I(ie),Me=ee.replace(/[^0-9]/g,""),$e=ie.replace(/[^0-9]/g,""),Ie=Fe=>{const na=I(Fe);return["EMITIDA","ACTIVA","VIGENTE"].some(oa=>na.includes(oa))},We=Ie(we)||Me==="0",Ve=Ie(je)||$e==="0";return we.includes("EN PROCESO DE CANCELACION")||je.includes("EN PROCESO DE CANCELACION")?!1:We&&Ve};return n.jsxs("form",{onSubmit:me,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"--Ingresa los datos para consulta (por grupo):--"}),c&&n.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:c}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2",children:[n.jsx(J,{label:"RFC Receptor:",name:"rfcReceptor",value:e.rfcReceptor,onChange:O}),n.jsx(J,{label:"Nombre del Cliente:",name:"nombreCliente",value:e.nombreCliente,onChange:O}),n.jsx(J,{label:"Apellido Paterno:",name:"apellidoPaterno",value:e.apellidoPaterno,onChange:O}),n.jsx(J,{label:"Apellido Materno:",name:"apellidoMaterno",value:e.apellidoMaterno,onChange:O}),n.jsx(J,{label:"Razn Social:",name:"razonSocial",value:e.razonSocial,onChange:O}),n.jsx(Se,{label:"Almacn:",name:"almacen",value:e.almacen,onChange:O,options:Zm}),n.jsx(J,{label:"Usuario:",name:"usuario",value:e.usuario,onChange:O}),n.jsx(J,{label:"Serie:",name:"serie",value:e.serie,onChange:O}),n.jsx(J,{label:"Folio:",name:"folio",value:e.folio,onChange:O}),n.jsx(J,{label:"UUID:",name:"uuid",value:e.uuid,onChange:O}),n.jsx(J,{label:"Fecha Inicio:",name:"fechaInicio",type:"date",value:e.fechaInicio,onChange:O}),n.jsx(J,{label:"Fecha Fin:",name:"fechaFin",type:"date",value:e.fechaFin,onChange:O})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-x-6 gap-y-2 mt-4 items-end",children:[n.jsx(Se,{label:"Tienda:",name:"tienda",value:e.tienda,onChange:O,options:Ia,className:"lg:col-span-1"}),n.jsx(J,{label:"TE:",name:"te",value:e.te,onChange:O,className:"lg:col-span-1"}),n.jsx(J,{label:"TR:",name:"tr",value:e.tr,onChange:O,className:"lg:col-span-1"}),n.jsx(J,{label:"Fecha:",name:"fechaTienda",type:"date",value:e.fechaTienda,onChange:O,className:"lg:col-span-1"}),n.jsx(J,{label:"Cdigo de facturacin:",name:"codigoFacturacion",value:e.codigoFacturacion,onChange:O,className:"lg:col-span-1"})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2 mt-4",children:n.jsx(Se,{label:"Motivo Sustitucin:",name:"motivoSustitucion",value:e.motivoSustitucion,onChange:O,options:Fh})}),n.jsx("div",{className:"mt-6 flex justify-start",children:n.jsx(fe,{type:"submit",variant:"primary",disabled:o,children:o?"Buscando...":"Buscar"})})]}),s?n.jsxs(ve,{className:"mt-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Resultados de la bsqueda"}),t.length===0?n.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No se encontraron facturas que coincidan con los criterios de bsqueda."}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"mb-4 flex justify-between items-center",children:n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs(fe,{variant:"primary",onClick:S,disabled:g.size===0||b,className:"flex items-center space-x-2",children:[b?n.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}):n.jsx(hd,{className:"h-4 w-4"}),n.jsx("span",{children:b?"Generando...":`Descargar ZIP (${g.size})`})]}),g.size>0&&n.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[g.size," factura(s) seleccionada(s)"]})]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:n.jsx("input",{type:"checkbox",checked:t.length>0&&g.size===t.length,onChange:_,className:"rounded border-gray-300 text-primary focus:ring-primary"})}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"UUID"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"RFC Emisor"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"RFC Receptor"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Serie"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Folio"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Emisin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Importe"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Estatus Facturacin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Estatus SAT"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tienda"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Almacn"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tickets"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Detalles"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Carta Porte"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Notas Crdito"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Acciones"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t.map((G,ee)=>{var ie,we,je,Me,$e,Ie,We,Ve,Ze;return n.jsxs("tr",{className:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${g.has(G.uuid)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:n.jsx("input",{type:"checkbox",checked:g.has(G.uuid),onChange:()=>R(G.uuid),className:"rounded border-gray-300 text-primary focus:ring-primary"})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200 truncate max-w-xs",title:G.uuid,children:G.uuid}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:G.rfcEmisor}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:G.rfcReceptor}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:G.serie}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:G.folio}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:ce(G.fechaEmision)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:ae(G.importe)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:(()=>{const Fe=G,na=(Fe==null?void 0:Fe.estatusFacturacion)??(Fe==null?void 0:Fe.estatusFactura)??(Fe==null?void 0:Fe.estado)??(Fe==null?void 0:Fe.ESTATUS_FACTURACION)??(Fe==null?void 0:Fe.ESTATUS_FACTURA)??(Fe==null?void 0:Fe.ESTADO)??"",oa=(Fe==null?void 0:Fe.estatusSat)??(Fe==null?void 0:Fe.ESTATUS_SAT)??(Fe==null?void 0:Fe.STATUS_SAT)??"";return q(na,oa)})()}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:le(G.estatusSat)||"-"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:G.tienda}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:G.almacen}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:(ie=E[G.uuid])!=null&&ie.loading?n.jsxs("span",{className:"inline-flex items-center text-blue-600",children:[n.jsx("span",{className:"mr-1 h-3 w-3 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}),"Cargando"]}):((we=E[G.uuid])==null?void 0:we.tickets)??"-"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:(je=E[G.uuid])!=null&&je.loading?n.jsxs("span",{className:"inline-flex items-center text-blue-600",children:[n.jsx("span",{className:"mr-1 h-3 w-3 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}),"Cargando"]}):((Me=E[G.uuid])==null?void 0:Me.detalles)??"-"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:($e=E[G.uuid])!=null&&$e.loading?n.jsxs("span",{className:"inline-flex items-center text-blue-600",children:[n.jsx("span",{className:"mr-1 h-3 w-3 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}),"Cargando"]}):n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${(Ie=E[G.uuid])!=null&&Ie.cartaPorte?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}`,children:(We=E[G.uuid])!=null&&We.cartaPorte?"S":"No"})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:(Ve=E[G.uuid])!=null&&Ve.loading?n.jsxs("span",{className:"inline-flex items-center text-blue-600",children:[n.jsx("span",{className:"mr-1 h-3 w-3 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}),"Cargando"]}):((Ze=E[G.uuid])==null?void 0:Ze.notasCredito)??"-"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>Q(G.uuid),disabled:v===G.uuid,className:"p-1 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 disabled:opacity-50",title:"Descargar PDF",children:v===G.uuid?n.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}):n.jsx(hd,{className:"h-4 w-4"})}),n.jsx("button",{onClick:()=>C(G.uuid),disabled:v===G.uuid,className:"p-1 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 disabled:opacity-50",title:"Descargar ZIP (XML + PDF)",children:v===G.uuid?n.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-green-600 border-t-transparent animate-spin"}):n.jsx(hd,{className:"h-4 w-4"})}),n.jsx("button",{onClick:()=>z(G.uuid),disabled:j===G.uuid,className:"p-1 text-orange-600 hover:text-orange-800 dark:text-orange-400 dark:hover:text-orange-300 disabled:opacity-50",title:"Descargar XML",children:j===G.uuid?n.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-orange-600 border-t-transparent animate-spin"}):n.jsx(hd,{className:"h-4 w-4"})}),ne(G)?n.jsx(fe,{variant:"secondary",size:"sm",onClick:()=>D(G),children:"Cancelar"}):n.jsx("span",{className:"text-xs text-gray-500 cursor-help",title:G.motivoNoCancelacion||"No permite cancelacin",children:"No cancelable"})]})})]},ee)})})]})}),n.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[n.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Mostrando ",t.length," facturas"]}),x&&n.jsxs("div",{className:"flex items-center text-sm text-blue-600 dark:text-blue-400",children:[n.jsx("div",{className:"mr-2 h-4 w-4 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}),"Actualizando datos..."]})]})]})]}):n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px] flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados de la bsqueda de facturas aparecern aqu."}),k.open&&n.jsx("div",{className:"fixed inset-0 bg-black/40 dark:bg-black/60 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-md p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Confirmar cancelacin"}),n.jsxs("div",{className:"mt-4 space-y-3",children:[n.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"UUID:"})," ",k.uuid]})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Motivo"}),n.jsxs("select",{className:"w-full border rounded px-3 py-2 bg-white dark:bg-gray-900 dark:text-gray-100",value:k.motivo,onChange:G=>P(ee=>({...ee,motivo:G.target.value})),children:[n.jsx("option",{value:"01",children:"01 - Comprobante emitido con errores con relacin"}),n.jsx("option",{value:"02",children:"02 - Comprobante emitido con errores sin relacin"}),n.jsx("option",{value:"03",children:"03 - No se llev a cabo la operacin"}),n.jsx("option",{value:"04",children:"04 - Operacin nominativa relacionada en factura global"})]})]}),k.motivo==="01"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"UUID sustituto"}),n.jsx("input",{type:"text",className:"w-full border rounded px-3 py-2 bg-white dark:bg-gray-900 dark:text-gray-100",placeholder:"Ingrese UUID del comprobante sustituto",value:k.uuidSustituto||"",onChange:G=>P(ee=>({...ee,uuidSustituto:G.target.value}))})]}),k.error&&n.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:k.error})]}),n.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[n.jsx(fe,{variant:"neutral",onClick:H,disabled:k.loading,children:"Cerrar"}),n.jsx(fe,{variant:"secondary",onClick:V,disabled:k.loading,children:k.loading?"Cancelando...":"Confirmar cancelacin"})]})]})})]})},Ad=[{id:1,empresa:"CIBERCOM",sector:"S001",nombreSector:"Electrnica",seccion:"Computadoras",divisionNegocio:"Retail",facturableNoFacturable:"Facturable",sku:"COMP-001",claveSat:"43211508",descripcion:'Laptop HP 15.6" Core i5',precio:12999.99,unidadMedida:"PZA"},{id:2,empresa:"CIBERCOM",sector:"S001",nombreSector:"Electrnica",seccion:"Computadoras",divisionNegocio:"Retail",facturableNoFacturable:"Facturable",sku:"COMP-002",claveSat:"43211508",descripcion:'Laptop Dell 14" Core i7',precio:15999.99,unidadMedida:"PZA"},{id:3,empresa:"CIBERCOM",sector:"S002",nombreSector:"Accesorios",seccion:"Perifricos",divisionNegocio:"Retail",facturableNoFacturable:"Facturable",sku:"ACC-001",claveSat:"43211708",descripcion:"Mouse Inalmbrico Logitech",precio:499.99,unidadMedida:"PZA"},{id:4,empresa:"CIBERCOM",sector:"S002",nombreSector:"Accesorios",seccion:"Perifricos",divisionNegocio:"Retail",facturableNoFacturable:"Facturable",sku:"ACC-002",claveSat:"43211708",descripcion:"Teclado Mecnico RGB",precio:899.99,unidadMedida:"PZA"},{id:5,empresa:"CIBERCOM",sector:"S003",nombreSector:"Software",seccion:"Sistemas Operativos",divisionNegocio:"Digital",facturableNoFacturable:"No Facturable",sku:"SOFT-001",claveSat:"43232303",descripcion:"Windows 11 Pro",precio:3499.99,unidadMedida:"LIC"}],dM={empresa:"",sector:"",nombreSector:"",seccion:"",divisionNegocio:"",facturableNoFacturable:"",sku:"",claveSat:""},uM=()=>{const[e,a]=N.useState(dM),[t,r]=N.useState([]),[s,i]=N.useState(!1),o=d=>{const{name:f,value:m}=d.target;a(x=>({...x,[f]:m}))},l=d=>{d.preventDefault(),console.log("Buscando SKU:",e);let f=[...Ad];e.empresa&&(f=f.filter(m=>m.empresa.toLowerCase().includes(e.empresa.toLowerCase()))),e.sector&&(f=f.filter(m=>m.sector.toLowerCase().includes(e.sector.toLowerCase()))),e.nombreSector&&(f=f.filter(m=>m.nombreSector.toLowerCase().includes(e.nombreSector.toLowerCase()))),e.seccion&&(f=f.filter(m=>m.seccion.toLowerCase().includes(e.seccion.toLowerCase()))),e.divisionNegocio&&(f=f.filter(m=>m.divisionNegocio.toLowerCase().includes(e.divisionNegocio.toLowerCase()))),e.facturableNoFacturable&&(f=f.filter(m=>m.facturableNoFacturable.toLowerCase()===e.facturableNoFacturable.toLowerCase())),e.sku&&(f=f.filter(m=>m.sku.toLowerCase().includes(e.sku.toLowerCase()))),e.claveSat&&(f=f.filter(m=>m.claveSat.toLowerCase().includes(e.claveSat.toLowerCase()))),e.sku==="COMP-001"&&(f=Ad.filter(m=>m.sku==="COMP-001")),e.sector==="S001"&&(f=Ad.filter(m=>m.sector==="S001")),e.empresa==="CIBERCOM"&&(f=Ad.filter(m=>m.empresa==="CIBERCOM")),r(f),i(!0)},c=()=>{console.log("Exportando SKU a Excel:",e),alert("Exportacin a Excel de SKU simulada.")},u=d=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(d);return n.jsxs("form",{onSubmit:l,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[n.jsx(J,{label:"EMPRESA:",name:"empresa",value:e.empresa,onChange:o}),n.jsx(J,{label:"DIVISION DEL NEGOCIO:",name:"divisionNegocio",value:e.divisionNegocio,onChange:o}),n.jsx(J,{label:"SECTOR:",name:"sector",value:e.sector,onChange:o}),n.jsx(J,{label:"FACTURABLE/NO FACTURABLE:",name:"facturableNoFacturable",value:e.facturableNoFacturable,onChange:o}),n.jsx(J,{label:"NOMBRE DEL SECTOR:",name:"nombreSector",value:e.nombreSector,onChange:o}),n.jsx(J,{label:"SKU:",name:"sku",value:e.sku,onChange:o}),n.jsx(J,{label:"SECCION:",name:"seccion",value:e.seccion,onChange:o}),n.jsx(J,{label:"CLAVE SAT:",name:"claveSat",value:e.claveSat,onChange:o})]}),n.jsxs("div",{className:"mt-6 flex justify-start space-x-3",children:[n.jsx(fe,{type:"submit",variant:"primary",children:"Buscar"}),n.jsx(fe,{type:"button",onClick:c,variant:"secondary",children:"Excel"})]})]}),s?n.jsxs(ve,{className:"mt-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Resultados de la bsqueda"}),t.length===0?n.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No se encontraron SKUs que coincidan con los criterios de bsqueda."}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"SKU"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Descripcin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Clave SAT"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Empresa"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Sector"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Seccin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Divisin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Facturable"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Precio"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Unidad"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(d=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.sku}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200 truncate max-w-xs",title:d.descripcion,children:d.descripcion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.claveSat}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.empresa}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.sector}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.seccion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.divisionNegocio}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${d.facturableNoFacturable==="Facturable"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:d.facturableNoFacturable})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:u(d.precio)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.unidadMedida})]},d.id))})]})}),n.jsxs("div",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:["Mostrando ",t.length," SKUs"]})]})]}):n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px] flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados de la bsqueda de SKU aparecern aqu."})]})},bk=({label:e,name:a,onChange:t,accept:r=".xlsx, .csv",required:s=!1,className:i="",helpText:o})=>{const[l,c]=N.useState(null),u=N.useRef(null),d=h=>{const g=h.target.files?h.target.files[0]:null;c(g?g.name:null),t(g)},f=()=>{var h;(h=u.current)==null||h.click()},m="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",x="ml-3 text-sm text-gray-600 dark:text-gray-400 truncate";return n.jsxs("div",{className:`mb-1 ${i}`,children:[n.jsxs("label",{htmlFor:`${a}-button`,className:m,children:[e,s&&n.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx(fe,{type:"button",variant:"neutral",onClick:f,id:`${a}-button`,"aria-controls":a,children:"Elegir archivo"}),n.jsx("input",{type:"file",name:a,id:a,ref:u,onChange:d,accept:r,required:s,className:"hidden","aria-labelledby":`${a}-button`,"aria-describedby":o?`${a}-help`:void 0}),l?n.jsx("span",{className:x,title:l,children:l}):n.jsx("span",{className:x,children:"No se eligi ningn archivo"})]}),o&&n.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",id:`${a}-help`,children:o})]})};var qv;const fM={tienda:((qv=Ia[0])==null?void 0:qv.value)||"",fecha:new Date().toISOString().split("T")[0],terminal:"",folio:""},mM=()=>{const[e,a]=N.useState(fM),[t,r]=N.useState(null),[s,i]=N.useState([]),[o,l]=N.useState({}),[c,u]=N.useState(!1),[d,f]=N.useState(!1),[m,x]=N.useState(null),h=y=>{const{name:j,value:A}=y.target;a(E=>({...E,[j]:A}))},g=y=>{r(y)},p=async y=>{y.preventDefault(),x(null),f(!0),u(!1);try{const j=parseInt(e.folio,10);if(isNaN(j)){x("Ingresa un folio de ticket vlido (numrico)."),f(!1);return}const A=e.terminal?parseInt(e.terminal,10):void 0,E={codigoTienda:e.tienda&&e.tienda!=="Todas"?e.tienda:void 0,fecha:e.fecha||void 0,terminalId:A&&!isNaN(A)?A:void 0,folio:j},F=await ci.buscarTickets(E);i(F),u(!0)}catch(j){x((j==null?void 0:j.message)||"Error al consultar tickets")}finally{f(!1)}},v=async y=>{if(y.preventDefault(),t){console.log("Consultando Boletas Masiva, Archivo:",t.name),x(null),f(!0),u(!1);try{x("Funcionalidad de consulta masiva pendiente de implementar")}catch(j){x((j==null?void 0:j.message)||"Error al procesar archivo masivo")}finally{f(!1)}}else alert("Por favor, seleccione un archivo para la consulta masiva.")},w="El archivo debe ser .xlsx o .csv y contener los datos de los tickets a consultar.",b=y=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(y);return n.jsxs("div",{className:"space-y-8",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"--Ingresa los datos para consulta de tickets--"}),n.jsxs("form",{onSubmit:p,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-x-6 gap-y-2 items-end",children:[n.jsx(Se,{label:"Tienda:",name:"tienda",value:e.tienda,onChange:h,options:Ia,className:"lg:col-span-1"}),n.jsx(J,{label:"Fecha:",name:"fecha",type:"date",value:e.fecha,onChange:h,className:"lg:col-span-1"}),n.jsx(J,{label:"Terminal (ID opcional):",name:"terminal",value:e.terminal,onChange:h,className:"lg:col-span-1"}),n.jsx(J,{label:"Folio de ticket:",name:"folio",value:e.folio,onChange:h,className:"lg:col-span-1"}),n.jsx("div",{})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-x-6 gap-y-2 items-end",children:[n.jsx("div",{className:"lg:col-span-4"}),n.jsx("div",{className:"flex justify-start lg:justify-end pt-1",children:n.jsx(fe,{type:"submit",variant:"primary",children:d?"Consultando...":"Consultar"})})]}),m&&n.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mt-2",children:m})]})]}),n.jsx(ve,{children:n.jsxs("form",{onSubmit:v,className:"space-y-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Consulta Masiva"}),n.jsx(bk,{label:"Archivo para Consulta Masiva:",name:"consultaMasivaFile",onChange:g,accept:".xlsx, .csv",helpText:w}),n.jsx("div",{className:"mt-4 flex justify-start",children:n.jsx(fe,{type:"submit",variant:"primary",children:"Consulta Masiva"})})]})}),c?n.jsxs(ve,{className:"mt-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Resultados de la bsqueda"}),s.length===0?n.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No se encontraron tickets que coincidan con los criterios de bsqueda."}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tienda"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Terminal"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Folio"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Cliente"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Subtotal"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"IVA"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Total"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Estatus"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Acciones"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map(y=>{var j;return n.jsxs(or.Fragment,{children:[n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:y.codigoTienda||""}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:y.fecha||""}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:y.terminalId??""}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:y.folio??""}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200 truncate max-w-xs",title:y.nombreCliente||y.rfcCliente||"",children:y.nombreCliente||y.rfcCliente||""}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:b(y.subtotal??0)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:b(y.iva??0)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:b(y.total??0)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${y.status===1?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":y.status===0?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"}`,children:y.status===1?"Activo":y.status===0?"Cancelado":"Desconocido"})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx(fe,{type:"button",variant:"secondary",onClick:async()=>{if(!y.idTicket)return;const A=await ci.buscarDetallesPorIdTicket(y.idTicket);l(E=>({...E,[y.idTicket]:A}))},children:"Ver detalles"})})]}),y.idTicket&&Array.isArray(o[y.idTicket])&&((j=o[y.idTicket])==null?void 0:j.length)>0&&n.jsx("tr",{children:n.jsx("td",{colSpan:10,className:"px-4 py-3",children:n.jsx("div",{className:"table-wrap",children:n.jsxs("table",{className:"min-w-full border",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[n.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Descripcin"}),n.jsx("th",{className:"px-2 py-1 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Cantidad"}),n.jsx("th",{className:"px-2 py-1 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Unidad"}),n.jsx("th",{className:"px-2 py-1 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Precio"}),n.jsx("th",{className:"px-2 py-1 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Subtotal"}),n.jsx("th",{className:"px-2 py-1 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"IVA"}),n.jsx("th",{className:"px-2 py-1 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Total"})]})}),n.jsx("tbody",{children:o[y.idTicket].map(A=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1",children:A.descripcion??""}),n.jsx("td",{className:"px-2 py-1 text-center",children:A.cantidad??""}),n.jsx("td",{className:"px-2 py-1 text-center",children:A.unidad??""}),n.jsx("td",{className:"px-2 py-1 text-right",children:b(A.precioUnitario??0)}),n.jsx("td",{className:"px-2 py-1 text-right",children:b(A.subtotal??0)}),n.jsx("td",{className:"px-2 py-1 text-right",children:b(A.ivaImporte??0)}),n.jsx("td",{className:"px-2 py-1 text-right",children:b(A.total??0)})]},A.idDetalle))})]})})})})]},y.idTicket??`${y.codigoTienda}-${y.folio}`)})})]})}),n.jsxs("div",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:["Mostrando ",s.length," tickets"]})]})]}):n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px] flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados de la consulta de tickets aparecern aqu."})]})},vl=[{id:1,nombre:"REPORTE DE CONSULTA MONEDEROS",fechaGeneracion:"2023-10-15",usuario:"admin",tipoReporte:"Monederos",formato:"PDF",tamao:"1.2 MB",estatus:"Disponible",descargas:5},{id:2,nombre:"REPORTE DE VENTAS MQUINA CORPORATIVAS SERELY POLU",fechaGeneracion:"2023-10-16",usuario:"supervisor",tipoReporte:"Ventas",formato:"Excel",tamao:"3.5 MB",estatus:"Disponible",descargas:12},{id:3,nombre:"RGIMEN DE FACTURACIN NO MISMA BOLETA",fechaGeneracion:"2023-10-17",usuario:"admin",tipoReporte:"Facturacin",formato:"PDF",tamao:"0.8 MB",estatus:"Disponible",descargas:3},{id:4,nombre:"DOBLE FACTURACIN PENDIENTE POR DEFENCIA",fechaGeneracion:"2023-10-18",usuario:"supervisor",tipoReporte:"Facturacin",formato:"Excel",tamao:"2.1 MB",estatus:"En proceso",descargas:0},{id:5,nombre:"SUSTITUCIN EN PROCESO",fechaGeneracion:"2023-10-19",usuario:"admin",tipoReporte:"Sustitucin",formato:"PDF",tamao:"1.5 MB",estatus:"Disponible",descargas:7}],xM=({setActivePage:e})=>{const[a,t]=N.useState(""),[r,s]=N.useState([]),[i,o]=N.useState(!1),l=f=>{console.log(`Generando reporte: "${f}"`),t(f);let m=vl.filter(x=>x.nombre===f);m.length===0&&(m=vl.filter(x=>x.nombre.includes(f))),f==="REPORTE DE CONSULTA MONEDEROS"?m=vl.filter(x=>x.tipoReporte==="Monederos"):f==="REPORTE DE VENTAS MQUINA CORPORATIVAS SERELY POLU"?m=vl.filter(x=>x.tipoReporte==="Ventas"):f==="RGIMEN DE FACTURACIN NO MISMA BOLETA"&&(m=vl.filter(x=>x.tipoReporte==="Facturacin")),s(m),o(!0)},c=f=>{alert(`Descargando reporte ID: ${f} (simulado).`)},u=Math.min(s1.length,4),d=()=>{e&&e("facturas-sustituidas")};return n.jsxs(ve,{children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Seleccione un reporte:"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(fe,{type:"button",variant:"primary",onClick:d,className:"flex items-center gap-2",children:[n.jsx(pr,{className:"w-4 h-4"}),"Facturas Sustituidas"]}),n.jsxs(fe,{type:"button",variant:"primary",onClick:()=>e&&e("facturas-por-usuario"),className:"flex items-center gap-2",children:[n.jsx(xi,{className:"w-4 h-4"}),"Facturas por Usuario"]})]})]}),n.jsx("div",{className:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-${u} gap-3`,children:s1.map(f=>n.jsx(fe,{type:"button",variant:f===a?"primary":"neutral",onClick:()=>l(f),className:"w-full h-full text-xs text-center break-words whitespace-normal py-3 px-2 justify-center",children:f},f))}),i?n.jsxs(ve,{className:"mt-8",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:["Reporte: ",a]}),r.length===0?n.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No se encontraron reportes disponibles para esta seleccin."}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Nombre"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Usuario"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tipo"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Formato"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tamao"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Estatus"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Descargas"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Accin"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:r.map(f=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200 truncate max-w-xs",title:f.nombre,children:f.nombre}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:f.fechaGeneracion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:f.usuario}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:f.tipoReporte}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:f.formato}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:f.tamao}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.estatus==="Disponible"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":f.estatus==="En proceso"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:f.estatus})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:f.descargas}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:n.jsx(fe,{type:"button",variant:"secondary",onClick:()=>c(f.id),disabled:f.estatus!=="Disponible",className:"text-xs py-1 px-2",children:"Descargar"})})]},f.id))})]})}),n.jsxs("div",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:["Mostrando ",r.length," reportes"]})]})]}):n.jsx("div",{className:"mt-8 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px] flex items-center justify-center text-gray-400 dark:text-gray-500",children:"El reporte seleccionado se mostrar o descargar aqu."})]})},Rd=[{id:1,uuid:"a1b2c3d4-e5f6-7890-abcd-ef1234567890",fechaOperacion:"2023-10-15",fechaFacturacion:"2023-10-16",empresa:"E001",tienda:"T001",estatus:"Sustituido",montoTotal:1250.5,montoImpuestos:200.08,usuario:"usuario1",fechaSustitucion:"2023-10-20",motivoSustitucion:"01"},{id:2,uuid:"b2c3d4e5-f6a7-8901-bcde-f23456789012",fechaOperacion:"2023-10-16",fechaFacturacion:"2023-10-17",empresa:"E001",tienda:"T001",estatus:"Sustituido",montoTotal:3450.75,montoImpuestos:552.12,usuario:"usuario1",fechaSustitucion:"2023-10-21",motivoSustitucion:"02"},{id:3,uuid:"c3d4e5f6-a7b8-9012-cdef-345678901234",fechaOperacion:"2023-10-17",fechaFacturacion:"2023-10-18",empresa:"E002",tienda:"T002",estatus:"En proceso",montoTotal:5678.9,montoImpuestos:908.62,usuario:"usuario2",fechaSustitucion:"2023-10-22",motivoSustitucion:"03"},{id:4,uuid:"d4e5f6a7-b8c9-0123-defg-456789012345",fechaOperacion:"2023-10-18",fechaFacturacion:"2023-10-19",empresa:"E002",tienda:"T002",estatus:"Cancelado",montoTotal:1234.56,montoImpuestos:197.53,usuario:"usuario2",fechaSustitucion:"2023-10-23",motivoSustitucion:"04"},{id:5,uuid:"e5f6a7b8-c9d0-1234-efgh-567890123456",fechaOperacion:"2023-10-19",fechaFacturacion:"2023-10-20",empresa:"E001",tienda:"T003",estatus:"Sustituido",montoTotal:9876.54,montoImpuestos:1580.25,usuario:"usuario3",fechaSustitucion:"2023-10-24",motivoSustitucion:"menu"}];var Yv,Wv,Kv;const hM={mes:((Yv=it[it.length-1])==null?void 0:Yv.value)||"",porOperacion:!1,anio:new Date().getFullYear().toString(),empresa:((Wv=Ma[Ma.length-1])==null?void 0:Wv.value)||"",fechaOperacion:"",prioridadFechaOperacion:"prioridad 3",fechaFacturacion:"",prioridadFechaFacturacion:"prioridad 3",tienda:((Kv=Ia[0])==null?void 0:Kv.value)||"",todasTiendas:!1,uuidReps:"",prioridadUuid:"prioridad 5"},pM=()=>{const[e,a]=N.useState(hM),[t,r]=N.useState([]),[s,i]=N.useState(!1),o=d=>{const{name:f,value:m,type:x}=d.target;if(x==="checkbox"){const{checked:h}=d.target;a(g=>({...g,[f]:h}))}else a(h=>({...h,[f]:m}))},l=d=>{d.preventDefault(),console.log("Buscando REPs Sustituidos:",e);let f=[...Rd];if(e.mes&&e.mes!=="todos"&&(f=f.filter(m=>m.fechaOperacion.split("-")[1]===e.mes)),e.anio&&(f=f.filter(m=>m.fechaOperacion.split("-")[0]===e.anio)),e.empresa&&e.empresa!=="todas"&&(f=f.filter(m=>m.empresa===e.empresa)),e.fechaOperacion&&(f=f.filter(m=>m.fechaOperacion===e.fechaOperacion)),e.fechaFacturacion&&(f=f.filter(m=>m.fechaFacturacion===e.fechaFacturacion)),e.tienda&&e.tienda!=="todas"&&!e.todasTiendas&&(f=f.filter(m=>m.tienda===e.tienda)),e.uuidReps){const m=e.uuidReps.split(`
`).map(x=>x.trim()).filter(x=>x!=="");m.length>0&&(f=f.filter(x=>m.some(h=>x.uuid.includes(h))))}e.empresa==="E001"&&(f=Rd.filter(m=>m.empresa==="E001")),e.tienda==="T001"&&(f=Rd.filter(m=>m.tienda==="T001")),e.porOperacion&&(f=Rd.filter(m=>m.motivoSustitucion==="01")),r(f),i(!0)},c=()=>{console.log("Exportando REPs Sustituidos a Excel:",e),alert("Exportacin a Excel de REPs Sustituidos simulada.")},u=d=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(d);return n.jsxs("form",{onSubmit:l,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Reporte de CFDI enviados para Timbrar (REPS Sustituidos)"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"--Ingresa los datos para consulta:--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4",children:[n.jsxs("div",{className:"flex items-end space-x-2",children:[n.jsx(Se,{label:"Mes:",name:"mes",value:e.mes,onChange:o,options:it,className:"flex-grow"}),n.jsx(ta,{label:"por Operacion",name:"porOperacion",checked:e.porOperacion,onChange:o,className:"pb-1"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(J,{label:"Fecha Operacin:",name:"fechaOperacion",type:"date",value:e.fechaOperacion,onChange:o,className:"flex-grow"}),n.jsx(J,{label:"",name:"prioridadFechaOperacion",value:e.prioridadFechaOperacion,onChange:o,disabled:!0,className:"w-24 text-xs mt-6"})]}),n.jsx(Se,{label:"Tienda:",name:"tienda",value:e.tienda,onChange:o,options:Ia})," ",n.jsx(J,{label:"Ao:",name:"anio",value:e.anio,onChange:o,placeholder:"AAAA",maxLength:4}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(J,{label:"Fecha Facturacin:",name:"fechaFacturacion",type:"date",value:e.fechaFacturacion,onChange:o,className:"flex-grow"}),n.jsx(J,{label:"",name:"prioridadFechaFacturacion",value:e.prioridadFechaFacturacion,onChange:o,disabled:!0,className:"w-24 text-xs mt-6"})]}),n.jsx(ta,{label:"Todas",name:"todasTiendas",checked:e.todasTiendas,onChange:o,className:"mt-7"})," ",n.jsx(Se,{label:"*Empresa:",name:"empresa",value:e.empresa,onChange:o,options:Ma,required:!0}),n.jsx("div",{})," ",n.jsx("div",{})," ",n.jsxs("div",{className:"lg:col-span-3 flex items-start space-x-2",children:[n.jsx(ys,{label:"UUID REPs:",name:"uuidReps",value:e.uuidReps,onChange:o,rows:3,className:"flex-grow"}),n.jsx(J,{label:"",name:"prioridadUuid",value:e.prioridadUuid,onChange:o,disabled:!0,className:"w-24 text-xs mt-6"})]})]}),n.jsxs("div",{className:"mt-6 flex justify-start space-x-3",children:[n.jsx(fe,{type:"submit",variant:"primary",children:"Buscar"}),n.jsx(fe,{type:"button",onClick:c,variant:"secondary",children:"Excel"})]})]}),s?n.jsxs(ve,{className:"mt-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Resultados de la bsqueda"}),t.length===0?n.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No se encontraron REPs sustituidos que coincidan con los criterios de bsqueda."}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"UUID"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Operacin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Facturacin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Empresa"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tienda"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Estatus"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Monto Total"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Impuestos"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Sustitucin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Motivo"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(d=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200 truncate max-w-xs",title:d.uuid,children:d.uuid}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.fechaOperacion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.fechaFacturacion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.empresa}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.tienda}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${d.estatus==="Sustituido"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":d.estatus==="En proceso"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:d.estatus})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:u(d.montoTotal)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:u(d.montoImpuestos)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.fechaSustitucion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:d.motivoSustitucion})]},d.id))})]})}),n.jsxs("div",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:["Mostrando ",t.length," REPs sustituidos"]})]})]}):n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px] flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados del reporte de REPs Sustituidos aparecern aqu."})]})},wk=({isOpen:e,onClose:a,onSelect:t})=>{const[r,s]=N.useState([]),[i,o]=N.useState(!1),[l,c]=N.useState(""),[u,d]=N.useState(null);N.useEffect(()=>{e?f():(c(""),d(null))},[e]);const f=async()=>{o(!0),d(null);try{const g=await fetch(Re("/catalogos/productos-servicios"),{headers:Ca()});if(g.ok){const p=await g.json();if(p.exitoso&&p.resultados){const v=p.resultados.map(w=>({id:w.id,claveProdServ:w.claveProdServ||"",cantidad:parseFloat(w.cantidad)||1,unidad:w.unidad||"Servicio",claveUnidad:w.claveUnidad||"E48",descripcion:w.descripcion||"",objetoImpuesto:w.objetoImpuesto||"02",valorUnitario:parseFloat(w.valorUnitario)||0,importe:parseFloat(w.importe)||0,tasaIVA:parseFloat(w.tasaIVA)||0}));s(v)}else d(p.error||"No se pudo cargar el catlogo")}else{const p=await g.json().catch(()=>({}));d(p.error||`Error al cargar catlogo (${g.status})`)}}catch(g){console.error("Error al cargar catlogo:",g),d("Error de conexin al cargar el catlogo")}finally{o(!1)}},m=r.filter(g=>{if(!l.trim())return!0;const p=l.toLowerCase();return g.claveProdServ.toLowerCase().includes(p)||g.descripcion.toLowerCase().includes(p)}),x=g=>{t(g),a()},h=g=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(g);return e?n.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:n.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[n.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:a}),n.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-6xl sm:w-full",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Seleccionar Producto o Servicio"}),n.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:n.jsx(Nh,{className:"w-6 h-6"})})]}),n.jsx("div",{className:"mb-4",children:n.jsx("input",{type:"text",placeholder:"Buscar por clave o descripcin...",value:l,onChange:g=>c(g.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),u&&n.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 rounded-md",children:u}),i?n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),n.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Cargando catlogo..."})]}):m.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[n.jsx("p",{className:"mb-2",children:l?"No se encontraron productos que coincidan con la bsqueda":"No hay productos en tu catlogo"}),!l&&n.jsx("p",{className:"text-sm",children:"Ve a la seccin de Catlogos para agregar productos o servicios"})]}):n.jsx("div",{className:"overflow-x-auto max-h-96",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 sticky top-0",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Clave"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Descripcin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Unidad"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Cantidad"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Valor Unitario"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"IVA"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Importe"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Accin"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:m.map(g=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:g.claveProdServ}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200",children:g.descripcion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:g.unidad}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:g.cantidad.toFixed(6)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:h(g.valorUnitario)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:g.tasaIVA>0?`${g.tasaIVA}%`:"Exento"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-semibold text-gray-900 dark:text-gray-100",children:h(g.importe)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx(fe,{type:"button",onClick:()=>x(g),variant:"primary",className:"text-xs px-3 py-1",children:"Seleccionar"})})]},g.id))})]})}),n.jsx("div",{className:"mt-6 flex justify-end",children:n.jsx(fe,{type:"button",onClick:a,variant:"neutral",children:"Cancelar"})})]})})]})}):null},Hy={rfc:"",correoElectronico:"",razonSocial:"",nombre:"",paterno:"",materno:"",pais:qr[0].value,codigoPostal:"",estado:"",municipio:"",colonia:"",calle:"",numeroExterior:"",numeroInterior:"",noRegistroIdentidadTributaria:"",domicilioFiscal:"",regimenFiscal:gt[0].value,usoCfdi:yt[0].value,codigoFacturacion:"",tienda:Ia[0].value,fecha:new Date().toISOString().split("T")[0],terminal:"",boleta:"",medioPago:ss[0].value,formaPago:ws[0].value,iepsDesglosado:!1,declaraIeps:!1,telefono:"",uuid:"",modoDetalle:"manual",uuidCfdiRelacionado:"",tipoRelacion:""},gM=()=>{var va;const[e,a]=N.useState(Hy),[t,r]=N.useState([]),[s,i]=N.useState(null),[o,l]=N.useState(null),[c,u]=N.useState(!1),[d,f]=N.useState([]),[m,x]=N.useState(!1),[h,g]=N.useState(!1),[p,v]=N.useState(null),[w,b]=N.useState(1),[y]=N.useState(5),[j,A]=N.useState({isOpen:!1,facturaUuid:"",facturaInfo:"",correoInicial:"",rfcReceptor:""}),{empresaInfo:E}=On(),[F,k]=N.useState(null),P=N.useRef(null),[R,_]=N.useState(!1),[Q,C]=N.useState([]),[z,S]=N.useState(!1),[D,H]=N.useState(!1),[U,B]=N.useState([]),X=Y=>Y.length===12,T=Y=>Y.length===13;N.useEffect(()=>{const Y=(e.rfc||"").trim().toUpperCase();let oe=null;Y&&Y.length>=12&&(X(Y)?oe="moral":T(Y)&&(oe="fisica")),oe!==P.current&&(P.current=oe,k(oe),oe==="moral"?a(ue=>({...ue,nombre:"",paterno:"",materno:""})):oe==="fisica"&&a(ue=>({...ue,razonSocial:""})))},[e.rfc]);const L=Y=>{if(!Y)return{codigoPostal:"",calle:"",numeroExterior:"",numeroInterior:"",colonia:"",municipio:"",estado:""};const oe={codigoPostal:"",calle:"",numeroExterior:"",numeroInterior:"",colonia:"",municipio:"",estado:""},ue=Y.match(/(?:C\.?P\.?\s*)?(\d{5})(?:\s|$|,)/i);ue&&(oe.codigoPostal=ue[1]);const ge=Y.split(",").map(Le=>Le.trim());if(ge.length>0){const Le=ge[0],ke=Le.match(/(\d+[A-Za-z]?|MZ\s*\d+|LT\s*\d+|EDIF\s*\w+)/i);if(ke){oe.numeroExterior=ke[1];const ka=Le.substring(0,ke.index).trim();oe.calle=ka}else oe.calle=Le;const He=Le.match(/Int\.\s*(\S+)/i);He&&(oe.numeroInterior=He[1])}let _e=!1;for(let Le=1;Le<ge.length&&!_e;Le++)if(ge[Le].match(/C\.?P\.?\s*\d{5}/i)){_e=!0,Le>1&&(oe.estado=ge[Le-1]),Le>2&&(oe.municipio=ge[Le-2]),Le>3&&(oe.colonia=ge[Le-3]);break}return!_e&&ge.length>=3&&(oe.colonia=ge[ge.length-3]||"",oe.municipio=ge[ge.length-2]||"",oe.estado=ge[ge.length-1]||""),oe},V=async Y=>{const oe=L(Y.domicilioFiscal);if(a(ue=>({...ue,rfc:Y.rfc,razonSocial:Y.razonSocial||ue.razonSocial,nombre:Y.nombre||ue.nombre,paterno:Y.paterno||ue.paterno,materno:Y.materno||ue.materno,correoElectronico:Y.correoElectronico||ue.correoElectronico,pais:Y.pais||ue.pais,domicilioFiscal:Y.domicilioFiscal||ue.domicilioFiscal,regimenFiscal:Y.regimenFiscal||ue.regimenFiscal,usoCfdi:Y.usoCfdi||ue.usoCfdi,codigoPostal:oe.codigoPostal||ue.codigoPostal,calle:oe.calle||ue.calle,numeroExterior:oe.numeroExterior||ue.numeroExterior,numeroInterior:oe.numeroInterior||ue.numeroInterior,colonia:oe.colonia||ue.colonia,municipio:oe.municipio||ue.municipio,estado:oe.estado||ue.estado})),oe.codigoPostal&&oe.codigoPostal.length===5&&(await me(oe.codigoPostal),!oe.estado||!oe.municipio)){const ue=await Ei.obtenerDatosCP(oe.codigoPostal);ue&&(a(ge=>({...ge,estado:ge.estado||ue.estado,municipio:ge.municipio||ue.municipio,colonia:ge.colonia||ue.colonias[0]||""})),C(ue.colonias||[]))}},O=()=>{_(!0)},de=async Y=>{try{const oe={rfc:Y.rfc,razon_social:Y.razonSocial,nombre:Y.nombre,paterno:Y.apellidoPaterno,materno:Y.apellidoMaterno,correo_electronico:Y.correoElectronico,telefono:Y.telefono,codigo_postal:Y.codigoPostal,estado:Y.estado,municipio:Y.municipio,colonia:Y.colonia,calle:Y.calle,numero_exterior:Y.numeroExterior,numero_interior:Y.numeroInterior,pais:Y.pais,regimen_fiscal:Y.regimenFiscal,uso_cfdi:Y.usoCfdi,registro_tributario:Y.esExtranjero?"EXT":null},ue=await fetch(Re("/catalogo-clientes"),{method:"POST",headers:Ca(),body:JSON.stringify(oe)}),ge=await ue.json();if(!ue.ok||ge.error)throw new Error(ge.error||"Error al guardar cliente");a(_e=>({..._e,rfc:Y.rfc,razonSocial:Y.razonSocial,nombre:Y.nombre||_e.nombre,paterno:Y.apellidoPaterno||_e.paterno,materno:Y.apellidoMaterno||_e.materno,correoElectronico:Y.correoElectronico,telefono:Y.telefono||_e.telefono,codigoPostal:Y.codigoPostal,estado:Y.estado,municipio:Y.municipio,colonia:Y.colonia,calle:Y.calle,numeroExterior:Y.numeroExterior,numeroInterior:Y.numeroInterior,pais:Y.pais,regimenFiscal:Y.regimenFiscal,usoCfdi:Y.usoCfdi,declaraIeps:Y.declaraIeps})),_(!1)}catch(oe){throw console.error("Error al guardar cliente:",oe),oe}},me=async Y=>{var oe;if(!Y||Y.length!==5){C([]),a(ue=>({...ue,estado:"",municipio:"",colonia:""}));return}S(!0);try{console.log("Buscando datos para cdigo postal:",Y);const ue=await Ei.obtenerDatosCP(Y);console.log("Datos recibidos del servicio:",ue),ue?(a(ge=>{const _e={...ge,estado:ue.estado||ge.estado||"",municipio:ue.municipio||ge.municipio||"",colonia:ge.colonia||""};return console.log("Actualizando formulario con:",{estado:_e.estado,municipio:_e.municipio}),_e}),C(ue.colonias||[]),console.log("Colonias cargadas:",((oe=ue.colonias)==null?void 0:oe.length)||0)):(console.warn("No se recibieron datos del cdigo postal"),C([]),a(ge=>({...ge,estado:"",municipio:"",colonia:""})))}catch(ue){console.error("Error al cargar cdigo postal:",ue),C([]),a(ge=>({...ge,estado:"",municipio:"",colonia:""}))}finally{S(!1)}},ae=Y=>{const oe=Y.target.value.replace(/\D/g,"").slice(0,5);a(ue=>({...ue,codigoPostal:oe})),oe.length===5?me(oe):(C([]),a(ue=>({...ue,estado:"",municipio:"",colonia:""})))},ce=Y=>{if(!Y)return"N/A";try{const oe=new Date(Y);if(isNaN(oe.getTime()))return"N/A";let ue="000";if(Y.includes(".")){const _e=Y.split(".")[1];_e&&_e.length>=3&&(ue=_e.substring(0,3))}else ue=oe.getMilliseconds().toString().padStart(3,"0");return`${oe.toLocaleString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}.${ue}`}catch(oe){return console.error("Error al formatear fecha:",oe),"N/A"}},W=N.useCallback(async()=>{u(!0);try{const oe=await(await fetch(Re("/factura/consultar-por-empresa"))).json();if(oe.exitoso&&oe.facturas){const ue=oe.facturas.map(ke=>({...ke,fechaFactura:ce(ke.fechaFactura||ke.fechaGeneracion||ke.fechaTimbrado||ke.fechaEmision),fechaGeneracion:ce(ke.fechaGeneracion),fechaTimbrado:ce(ke.fechaTimbrado),codigoFacturacion:ke.codigoFacturacion||`${ke.serie||""}${ke.folio||""}`.trim()||ke.uuid,total:typeof ke.total=="number"?ke.total:typeof ke.importe=="number"?ke.importe:0,estado:ke.estado||ke.estatusFacturacion||"DESCONOCIDO",rfc:ke.rfc||ke.rfcReceptor||ke.rfcEmisor||"",razonSocial:ke.razonSocial||ke.nombreCliente||"",fechaOriginal:ke.fechaFactura||ke.fechaGeneracion||ke.fechaTimbrado||ke.fechaEmision})),ge=ue.map(ke=>ke.uuid),_e=[...new Set(ge)];let Le=ue;ge.length!==_e.length&&(Le=ue.filter((ke,He,ka)=>He===ka.findIndex(Qe=>Qe.uuid===ke.uuid))),Le.sort((ke,He)=>{const ka=ke.fechaOriginal,Qe=He.fechaOriginal;if(!ka&&!Qe)return 0;if(!ka)return 1;if(!Qe)return-1;const sl=new Date(ka);return new Date(Qe).getTime()-sl.getTime()}),r(Le),g(!0),b(1)}else console.error("Error al cargar facturas:",oe.error),r([])}catch(Y){console.error("Error al cargar facturas:",Y),r([])}finally{u(!1)}},[]),le=Y=>{const{name:oe,value:ue,type:ge}=Y.target,_e=ge==="checkbox"?Y.target.checked:ue;a(Le=>({...Le,[oe]:_e}))},I=async Y=>{var oe,ue;if(Y.preventDefault(),e.modoDetalle==="manual"&&U.length===0){alert("Por favor agregue al menos un producto o servicio antes de generar la factura.");return}try{const _e=[e.calle,e.numeroExterior,e.numeroInterior,e.colonia,e.municipio,e.estado,e.codigoPostal,e.pais].filter(Boolean).join(", ")||e.domicilioFiscal,Le={rfc:e.rfc,correoElectronico:e.correoElectronico,razonSocial:e.razonSocial,nombre:e.nombre,paterno:e.paterno,materno:e.materno,pais:e.pais,noRegistroIdentidadTributaria:e.noRegistroIdentidadTributaria,domicilioFiscal:_e,regimenFiscal:e.regimenFiscal,usoCfdi:e.usoCfdi,codigoFacturacion:e.codigoFacturacion,tienda:e.tienda,fecha:e.fecha,terminal:e.terminal,boleta:e.boleta,medioPago:e.medioPago,formaPago:e.formaPago,iepsDesglosado:e.iepsDesglosado,guardarEnMongo:!1,uuidCfdiRelacionado:e.uuidCfdiRelacionado||null,tipoRelacion:e.tipoRelacion||null,tipoDocumento:"Refactura"};e.modoDetalle==="manual"&&U.length>0&&(Le.conceptos=U.map(Qe=>({descripcion:Qe.descripcion,cantidad:Qe.cantidad,unidad:Qe.unidad,precioUnitario:Qe.valorUnitario,importe:Qe.importe,claveProdServ:Qe.claveProdServ,claveUnidad:Qe.claveUnidad||Qe.unidad,objetoImp:Qe.objetoImpuesto||"02",tasaIva:Qe.tasaIVA/100})));const ke=await fetch(Re("/factura/generar/frontend"),{method:"POST",headers:Ca(),body:JSON.stringify(Le)});if(!ke.ok){const Qe=await ke.text();throw new Error(`Error HTTP ${ke.status}: ${Qe}`)}const He=await ke.json(),ka=He.uuid||((oe=He.datos)==null?void 0:oe.folioFiscal)||((ue=He.datosFactura)==null?void 0:ue.uuid);He.exitoso?(alert(`${He.mensaje}
UUID: ${ka}
Factura guardada en base de datos`),a(Qe=>({...Qe,uuid:ka||Qe.uuid})),ka&&(i("4 - EN PROCESO DE EMISION"),ne(ka)),e.correoElectronico&&e.correoElectronico.trim()&&window.confirm("Desea enviar los archivos al correo del receptor?")&&await Me(ka),W()):alert(`${He.mensaje}
Errores: ${He.errores||He.error}`)}catch(ge){console.error("Error en el envo:",ge),alert(`Hubo un error al enviar el formulario: ${ge instanceof Error?ge.message:"Error desconocido"}`)}},q=async Y=>{try{const oe=await fetch(kr(`/pac/stamp/status/${encodeURIComponent(Y)}`));if(!oe.ok)return null;const ue=await oe.json().catch(()=>null),ge=String((ue==null?void 0:ue.status)||(ue==null?void 0:ue.codigo)||""),_e=String((ue==null?void 0:ue.descripcion)||(ue==null?void 0:ue.statusDescripcion)||"");return ge?{codigo:ge,descripcion:_e}:null}catch{return null}},ne=Y=>{o&&(window.clearInterval(o),l(null));const oe=window.setInterval(async()=>{const ue=await q(Y);ue&&(ue.codigo==="0"?(i("0 - EMITIDA"),window.clearInterval(oe),l(null)):ue.codigo==="4"?i("4 - EN PROCESO DE EMISION"):ue.codigo==="2"?(i("2 - CANCELADA EN SAT"),window.clearInterval(oe),l(null)):ue.codigo==="66"&&i("66 - POR TIMBRAR"))},3e3);l(oe)};N.useEffect(()=>()=>{o&&window.clearInterval(o)},[o]);const G=()=>{a(Hy),alert("Formulario reiniciado")},ee=async()=>{var Y;try{x(!0);const oe=(Y=e.codigoFacturacion)==null?void 0:Y.trim();if(!oe){alert("Por favor ingrese un folio para buscar.");return}const ue=Number(oe);if(isNaN(ue)||ue<=0){alert("El folio debe ser un nmero vlido.");return}console.log("Buscando ticket con folio:",ue);const ge={folio:ue};console.log("Filtros enviados al backend:",ge);const _e=await ci.buscarTickets(ge);console.log("Resultados recibidos:",_e),f(_e),g(_e&&_e.length>1),!_e||_e.length===0?(alert(`No se encontraron tickets con el folio ${ue}. Verifica que el folio exista en la base de datos.`),v(null)):_e.length===1?(v(_e[0]),ie(_e[0])):v(null)}catch(oe){console.error("Error al consultar tickets:",oe);const ue=oe instanceof Error?oe.message:"Error desconocido";alert(`Error al consultar tickets: ${ue}. Revisa la consola para ms detalles.`)}finally{x(!1)}},ie=Y=>{a(oe=>({...oe,tienda:Y.codigoTienda??oe.tienda,fecha:Y.fecha??oe.fecha,terminal:Y.terminalId!=null?String(Y.terminalId):oe.terminal,boleta:Y.folio!=null?String(Y.folio):oe.boleta,medioPago:Y.formaPago??oe.medioPago,formaPago:oe.formaPago||"PUE"}))},we=async(Y,oe)=>{try{await ma.generarYDescargarXML(Y)}catch(ue){console.error("Error al descargar XML:",ue),alert("Error al descargar el XML. Intenta nuevamente.")}},je=async Y=>{try{await ma.generarYDescargarPDF(Y)}catch(oe){console.error("Error al descargar PDF:",oe),alert(`Error al descargar PDF: ${oe instanceof Error?oe.message:"Error desconocido"}`)}},Me=async Y=>{const oe=(e.correoElectronico||"").trim();if(!oe||!Pt.validarEmail(oe)){alert("Ingresa un correo electrnico vlido en el formulario.");return}let ue="",ge="";try{const ke=await ma.obtenerFacturaPorUUID(Y);ue=ke.serie||"",ge=ke.folio||""}catch{}const _e=`Factura ${ue||"A"}${ge||"1"} - ${(E==null?void 0:E.nombre)||"Empresa"}`,Le=`Estimado(a) cliente,

Se ha generado su factura electrnica.

Gracias por su preferencia.`;try{const ke=await Pt.enviarCorreoConPdfAdjunto({uuidFactura:Y,correoReceptor:oe,asunto:_e,mensaje:Le});ke.success?alert(`Correo enviado exitosamente a: ${oe}`):alert(`Error al enviar correo: ${ke.message||"Desconocido"}`)}catch(ke){console.error("Error al enviar correo:",ke),alert(`Error al enviar correo: ${ke instanceof Error?ke.message:"Error desconocido"}`)}},$e=async()=>{const Y=(e.uuid||"").trim();if(!Y){alert("Primero guarda o consulta una factura para obtener el UUID.");return}await we(Y,e.codigoFacturacion||"Factura")},Ie=async()=>{const Y=(e.uuid||"").trim();if(!Y){alert("Primero guarda o consulta una factura para obtener el UUID.");return}await je(Y)},We=async()=>{const Y=(e.uuid||"").trim();if(!Y){alert("Primero guarda o consulta una factura para obtener el UUID.");return}await Me(Y)},Ve=async()=>{try{if(!e.rfc||!e.rfc.trim()){alert("Por favor ingrese el RFC del receptor.");return}const oe=[e.calle,e.numeroExterior,e.numeroInterior,e.colonia,e.municipio,e.estado,e.codigoPostal,e.pais].filter(Boolean).join(", ")||e.domicilioFiscal,ue={rfc:e.rfc,correoElectronico:e.correoElectronico,razonSocial:e.razonSocial,nombre:e.nombre,paterno:e.paterno,materno:e.materno,pais:e.pais,noRegistroIdentidadTributaria:e.noRegistroIdentidadTributaria,domicilioFiscal:oe,regimenFiscal:e.regimenFiscal,usoCfdi:e.usoCfdi,codigoFacturacion:e.codigoFacturacion,tienda:e.tienda,fecha:e.fecha,terminal:e.terminal,boleta:e.boleta,medioPago:e.medioPago,formaPago:e.formaPago,iepsDesglosado:e.iepsDesglosado,tipoDocumento:"Refactura",uuidCfdiRelacionado:e.uuidCfdiRelacionado||null,tipoRelacion:e.tipoRelacion||null};e.modoDetalle==="manual"&&U.length>0&&(ue.conceptos=U.map(He=>({descripcion:He.descripcion,cantidad:He.cantidad,unidad:He.unidad,precioUnitario:He.valorUnitario,importe:He.importe,claveProdServ:He.claveProdServ,claveUnidad:He.claveUnidad||He.unidad,objetoImp:He.objetoImpuesto||"02",tasaIva:He.tasaIVA/100})));const ge=await fetch(Re("/factura/preview-pdf"),{method:"POST",headers:Ca(),body:JSON.stringify(ue)});if(!ge.ok){const He=await ge.text();throw new Error(`Error HTTP ${ge.status}: ${He}`)}const _e=await ge.blob(),Le=window.URL.createObjectURL(_e),ke=document.createElement("a");ke.href=Le,ke.target="_blank",ke.rel="noopener noreferrer",document.body.appendChild(ke),ke.click(),document.body.removeChild(ke),window.URL.revokeObjectURL(Le)}catch(Y){console.error("Error al generar vista previa:",Y),alert(`Error al generar vista previa: ${Y instanceof Error?Y.message:"Error desconocido"}`)}},Ze=()=>{A({isOpen:!1,facturaUuid:"",facturaInfo:"",correoInicial:"",rfcReceptor:""})};Math.ceil(t.length/y);const Fe=(w-1)*y,na=Fe+y;t.slice(Fe,na),console.log(` Paginacin - Total facturas: ${t.length}, Pgina actual: ${w}, Elementos por pgina: ${y}`);const oa=Y=>{B(oe=>[...oe,{...Y}])},$a=Y=>{B(oe=>oe.filter((ue,ge)=>ge!==Y))},Xe=()=>{const Y=U.reduce((ge,_e)=>ge+_e.importe,0),oe=U.reduce((ge,_e)=>_e.tasaIVA>0?ge+_e.importe*_e.tasaIVA/100:ge,0),ue=Y+oe;return{subtotal:Y,iva:oe,total:ue}};return n.jsxs("div",{className:"space-y-8",children:[n.jsxs("form",{onSubmit:I,className:"space-y-8",children:[e.uuid&&n.jsxs("div",{className:"p-2 rounded bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-100",children:["Estado de timbrado: ",s||"Desconocido"]}),n.jsx(ve,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"RFC *"}),n.jsx(Jc,{value:e.rfc,onChange:Y=>a(oe=>({...oe,rfc:Y})),onSelect:V,onNotFound:O,required:!0})]}),n.jsx("div",{className:"md:col-span-2 lg:col-span-3",children:n.jsx(ta,{name:"declaraIeps",label:"Declaro IEPS **",checked:e.declaraIeps,onChange:le})}),(F==="moral"||F===null)&&n.jsx(J,{name:"razonSocial",label:"Razn Social *",value:e.razonSocial,onChange:le,required:F==="moral"}),n.jsx(J,{name:"codigoPostal",label:"Cdigo Postal *",value:e.codigoPostal,onChange:ae,required:!0,maxLength:5}),z&&n.jsx("div",{className:"text-sm text-gray-500 flex items-center",children:"Cargando datos..."}),n.jsx(Se,{name:"pais",label:"Pas",value:e.pais,onChange:le,options:qr}),n.jsx(J,{name:"estado",label:"Estado",value:e.estado,onChange:le}),n.jsx(J,{name:"municipio",label:"Municipio/Delegacin",value:e.municipio,onChange:le}),n.jsx(Se,{name:"colonia",label:"Colonia",value:e.colonia,onChange:le,options:Q.map(Y=>({value:Y,label:Y})),disabled:Q.length===0}),n.jsx(J,{name:"calle",label:"Calle",value:e.calle,onChange:le}),n.jsx(J,{name:"numeroExterior",label:"Nmero exterior",value:e.numeroExterior,onChange:le,placeholder:"Ej: 123, MZ 5, LT 10"}),n.jsx(J,{name:"numeroInterior",label:"Nmero interior",value:e.numeroInterior,onChange:le,placeholder:"Ej: EDIF A, DEP 101"}),n.jsx(Se,{name:"regimenFiscal",label:"Rgimen Fiscal *",value:e.regimenFiscal,onChange:le,options:gt,required:!0}),n.jsx(Se,{name:"usoCfdi",label:"Uso CFDI *",value:e.usoCfdi,onChange:le,options:yt,required:!0}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 md:col-span-2 lg:col-span-3",children:"Los campos marcados con: * son obligatorios, **Aplica slo para vinos y licores."})]})}),n.jsx(ve,{title:"Datos de Contacto",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsx(J,{name:"nombre",label:"Nombre",value:e.nombre,onChange:le}),n.jsx(J,{name:"paterno",label:"Apellido Paterno",value:e.paterno,onChange:le}),n.jsx(J,{name:"materno",label:"Apellido Materno",value:e.materno,onChange:le}),n.jsx(J,{name:"correoElectronico",label:"Correo Electrnico *",type:"email",value:e.correoElectronico,onChange:le,required:!0}),n.jsx(J,{name:"telefono",label:"Telfono para WhatsApp",value:e.telefono,onChange:le})]})}),h&&d.length>1&&n.jsx(ve,{title:"Tickets encontrados",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tienda"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Terminal"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Folio"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subtotal"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IVA"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Forma Pago"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"RFC"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estatus"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID Factura"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(Y=>{var oe,ue,ge;return n.jsxs("tr",{className:"cursor-pointer hover:bg-gray-50",onClick:()=>{v(Y),ie(Y)},children:[n.jsx("td",{className:"px-4 py-2",children:Y.codigoTienda}),n.jsx("td",{className:"px-4 py-2",children:new Date(Y.fecha).toLocaleDateString()}),n.jsx("td",{className:"px-4 py-2",children:Y.terminalId??"-"}),n.jsx("td",{className:"px-4 py-2",children:Y.folio}),n.jsx("td",{className:"px-4 py-2",children:(oe=Y.subtotal)==null?void 0:oe.toFixed(2)}),n.jsx("td",{className:"px-4 py-2",children:(ue=Y.iva)==null?void 0:ue.toFixed(2)}),n.jsx("td",{className:"px-4 py-2",children:(ge=Y.total)==null?void 0:ge.toFixed(2)}),n.jsx("td",{className:"px-4 py-2",children:Y.formaPago??"-"}),n.jsx("td",{className:"px-4 py-2",children:Y.nombreCliente??"-"}),n.jsx("td",{className:"px-4 py-2",children:Y.rfcCliente??"-"}),n.jsx("td",{className:"px-4 py-2",children:Y.status===1?"Activo":"Cancelado"}),n.jsx("td",{className:"px-4 py-2",children:Y.idFactura??"-"})]},Y.idTicket)})})]})})}),n.jsxs(ve,{title:"Detalle de la Factura",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Modo de Captura"}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",name:"modoDetalle",value:"automatico",checked:e.modoDetalle==="automatico",onChange:()=>a(Y=>({...Y,modoDetalle:"automatico"})),className:"mr-2"}),"Automtico"]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",name:"modoDetalle",value:"manual",checked:e.modoDetalle==="manual",onChange:()=>a(Y=>({...Y,modoDetalle:"manual"})),className:"mr-2"}),"Manual"]})]})]}),e.modoDetalle==="automatico"?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_auto] gap-2 sm:gap-4",children:[n.jsx(J,{name:"codigoFacturacion",label:"Cdigo de Facturacin o Prefactura",value:e.codigoFacturacion,onChange:le,placeholder:"Ingrese cdigo de facturacin o prefactura"}),n.jsx("div",{className:"flex items-end",children:n.jsx(fe,{type:"button",onClick:ee,variant:"secondary",disabled:m,className:"w-full sm:w-auto whitespace-nowrap",children:m?"Buscando":"Buscar"})})]}),p&&n.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-md",children:n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Ticket encontrado: Tienda ",p.codigoTienda,", Folio ",p.folio,", Total: $",(va=p.total)==null?void 0:va.toFixed(2)]})}),n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Los botones de agregar y eliminar estn bloqueados en modo automtico."})]}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 sm:gap-4",children:[n.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white",children:"Productos y Servicios"}),n.jsx(fe,{type:"button",onClick:()=>H(!0),variant:"primary",className:"text-sm w-full sm:w-auto whitespace-nowrap",children:"+ Agregar Producto/Servicio"})]}),n.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[n.jsx("p",{children:"Catlogo de artculos: nombre, descripcin"}),n.jsx("p",{children:"Acceso al catlogo de Clave de Producto o Servicio (Ej: Catlogo del SAT)"})]}),U.length>0&&n.jsx("div",{className:"border-t pt-4 mt-4",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Clave"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Descripcin"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Unidad"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Cantidad"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Valor Unitario"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"IVA"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Importe"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Accin"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:U.map((Y,oe)=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:Y.claveProdServ}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:Y.descripcion}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:Y.unidad}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:Y.cantidad.toFixed(6)}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Y.valorUnitario)}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:Y.tasaIVA>0?`${Y.tasaIVA}%`:"Exento"}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-semibold text-gray-900 dark:text-gray-100",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Y.importe)}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:n.jsx(fe,{type:"button",onClick:()=>$a(oe),variant:"secondary",className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white",children:"Eliminar"})})]},oe))}),n.jsxs("tfoot",{className:"bg-gray-50 dark:bg-gray-700 font-semibold",children:[n.jsxs("tr",{children:[n.jsx("td",{colSpan:6,className:"px-4 py-2 text-right text-sm text-gray-700 dark:text-gray-300",children:"Subtotal:"}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Xe().subtotal)}),n.jsx("td",{})]}),n.jsxs("tr",{children:[n.jsx("td",{colSpan:6,className:"px-4 py-2 text-right text-sm text-gray-700 dark:text-gray-300",children:"IVA:"}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Xe().iva)}),n.jsx("td",{})]}),n.jsxs("tr",{children:[n.jsx("td",{colSpan:6,className:"px-4 py-2 text-right text-sm text-gray-700 dark:text-gray-300",children:"Total:"}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-lg text-gray-900 dark:text-gray-100",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Xe().total)}),n.jsx("td",{})]})]})]})})}),U.length===0&&n.jsx("div",{className:"border-t pt-4 mt-4",children:n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:'No hay productos agregados. Haz clic en "Agregar Producto/Servicio" para comenzar.'})})]})]}),e.modoDetalle==="automatico"&&p&&n.jsx(ve,{title:"Informacin del Ticket",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tienda"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Terminal"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Folio"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subtotal"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IVA"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Forma Pago"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"RFC"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estatus"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID Factura"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.codigoTienda)??"-"}),n.jsx("td",{className:"px-4 py-2",children:p?new Date(p.fecha).toLocaleDateString():"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.terminalId)??"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.folio)??"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.subtotal)!=null?p.subtotal.toFixed(2):"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.iva)!=null?p.iva.toFixed(2):"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.total)!=null?p.total.toFixed(2):"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.formaPago)??"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.nombreCliente)??"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.rfcCliente)??"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.status)===1?"Activo":"Cancelado"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.idFactura)??"-"})]})})]})})}),n.jsxs(ve,{title:"Forma de Pago",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsx(Se,{name:"medioPago",label:"Medio de pago",value:e.medioPago,onChange:le,options:ss}),n.jsx(Se,{name:"formaPago",label:"Forma de pago",value:e.formaPago,onChange:le,options:ws})]}),n.jsx("div",{className:"mt-4",children:n.jsx(ta,{name:"iepsDesglosado",label:"IEPS desglosado",checked:e.iepsDesglosado,onChange:le})})]}),n.jsx(ve,{title:"Relacin con CFDI (refactura)",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Si esta factura refactura a otra, captura el UUID del CFDI original y el tipo de relacin."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsx(J,{name:"uuidCfdiRelacionado",label:"UUID del CFDI a refacturar",value:e.uuidCfdiRelacionado,onChange:le,placeholder:"Ej: A055BE36-AA6D-5F3C-99FE-6A8AD176AD16"}),n.jsx(Se,{name:"tipoRelacion",label:"Tipo de relacin",value:e.tipoRelacion,onChange:le,options:cC})]}),e.uuidCfdiRelacionado&&!e.tipoRelacion&&n.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded",children:"Si capturaste un UUID de CFDI relacionado, debes seleccionar el tipo de relacin."})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-4 mt-8",children:[n.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 w-full sm:w-auto",children:n.jsx(fe,{type:"button",onClick:G,variant:"neutral",className:"w-full sm:w-auto",children:"Cancelar"})}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 w-full sm:w-auto",children:[n.jsx(fe,{type:"button",onClick:$e,variant:"secondary",className:"w-full sm:w-auto whitespace-nowrap",children:"Descargar XML"}),n.jsx(fe,{type:"button",onClick:Ie,variant:"secondary",className:"w-full sm:w-auto whitespace-nowrap",children:"Descargar PDF"}),n.jsx(fe,{type:"button",onClick:We,variant:"secondary",className:"w-full sm:w-auto whitespace-nowrap",children:"Enviar por Correo"})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 w-full sm:w-auto",children:[n.jsx(fe,{type:"button",onClick:Ve,className:"w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded",children:"Vista Previa"}),n.jsx(fe,{type:"submit",variant:"primary",className:"w-full sm:w-auto",children:"Generar"})]})]})]}),!1,n.jsx(Ep,{isOpen:j.isOpen,onClose:Ze,facturaUuid:j.facturaUuid,facturaInfo:j.facturaInfo,correoInicial:j.correoInicial,rfcReceptor:j.rfcReceptor}),n.jsx(Du,{isOpen:R,onClose:()=>_(!1),onSave:de,rfcInicial:e.rfc}),n.jsx(wk,{isOpen:D,onClose:()=>H(!1),onSelect:oa})]})},yM=()=>{const[e,a]=N.useState([]),[t,r]=N.useState(!1),[s,i]=N.useState("hoy"),[o,l]=N.useState(""),[c,u]=N.useState(""),[d,f]=N.useState(new Set),[m,x]=N.useState(null);N.useEffect(()=>{g()},[]);const h=k=>{const P=new Date;let R,_=new Date(P);switch(k){case"hoy":R=new Date(P),R.setHours(0,0,0,0),_.setHours(23,59,59,999);break;case"mes":R=new Date(P.getFullYear(),P.getMonth(),1),R.setHours(0,0,0,0),_=new Date(P.getFullYear(),P.getMonth()+1,0),_.setHours(23,59,59,999);break;case"personalizado":return{inicio:o||"",fin:c||""};default:R=new Date(P),R.setHours(0,0,0,0),_.setHours(23,59,59,999)}return{inicio:R.toISOString().split("T")[0],fin:_.toISOString().split("T")[0]}},g=async()=>{r(!0);try{const k=h(s),P=await _h.consultarFacturasSustituidas(k.inicio||void 0,k.fin||void 0);P.exitoso?a(P.facturas):(console.error("Error cargando facturas sustituidas:",P.mensaje),a([]))}catch(k){console.error("Error obteniendo facturas sustituidas:",k),a([])}finally{r(!1)}},p=k=>{i(k)},v=()=>{f(new Set),g()},w=k=>{const P=new Set(d);P.has(k)?P.delete(k):P.add(k),f(P)},b=()=>{d.size===e.length?f(new Set):f(new Set(e.map(k=>k.uuid).filter(Boolean)))},y=async k=>{if(k){x(k);try{await ma.generarYDescargarPDF(k)}catch(P){console.error("Error descargando PDF:",P),alert("Error al descargar el PDF: "+(P instanceof Error?P.message:"Error desconocido"))}finally{x(null)}}},j=async k=>{if(k){x(k);try{await ma.generarYDescargarXML(k)}catch(P){console.error("Error descargando XML:",P),alert("Error al descargar el XML: "+(P instanceof Error?P.message:"Error desconocido"))}finally{x(null)}}},A=async k=>{const P=Array.from(d).filter(Boolean);if(P.length===0){alert("Por favor seleccione al menos una factura");return}x("masivo");try{if(k==="zip")await ma.generarYDescargarZIPMultiple(P);else if(k==="pdf")for(const R of P)try{await ma.generarYDescargarPDF(R),await new Promise(_=>setTimeout(_,500))}catch(_){console.error(`Error descargando PDF de ${R}:`,_)}else if(k==="xml")for(const R of P)try{await ma.generarYDescargarXML(R),await new Promise(_=>setTimeout(_,500))}catch(_){console.error(`Error descargando XML de ${R}:`,_)}}catch(R){console.error("Error descargando seleccionados:",R),alert("Error al descargar los documentos: "+(R instanceof Error?R.message:"Error desconocido"))}finally{x(null)}},E=k=>k==null?"$0.00":new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(k),F=k=>{if(!k)return"";try{return new Date(k).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return k}};return n.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[n.jsxs(ve,{children:[n.jsxs("div",{className:"flex items-center mb-4",children:[n.jsx(pr,{className:"w-6 h-6 mr-2 text-primary dark:text-secondary"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100",children:"Facturas Sustituidas"})]}),n.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[n.jsx(fe,{type:"button",variant:s==="hoy"?"primary":"neutral",onClick:()=>p("hoy"),className:"w-full",children:"Da Actual"}),n.jsx(fe,{type:"button",variant:s==="mes"?"primary":"neutral",onClick:()=>p("mes"),className:"w-full",children:"Mes Actual"}),n.jsx(fe,{type:"button",variant:s==="personalizado"?"primary":"neutral",onClick:()=>p("personalizado"),className:"w-full",children:"Personalizado"}),n.jsx(fe,{type:"button",variant:"primary",onClick:v,disabled:t,className:"w-full",children:t?"Buscando...":"Buscar"})]}),s==="personalizado"&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Fecha Inicio"}),n.jsx("input",{type:"date",value:o,onChange:k=>l(k.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Fecha Fin"}),n.jsx("input",{type:"date",value:c,onChange:k=>u(k.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]})]})]}),t?n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Cargando facturas sustituidas..."}):e.length===0?n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No se encontraron facturas sustituidas para el periodo seleccionado."}):n.jsxs(n.Fragment,{children:[d.size>0&&n.jsxs("div",{className:"mb-4 p-4 bg-blue-50 dark:bg-blue-900 rounded-lg flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:[d.size," documento(s) seleccionado(s)"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(fe,{type:"button",variant:"secondary",onClick:()=>A("pdf"),disabled:m==="masivo",className:"text-xs",children:m==="masivo"?"Descargando...":"Descargar PDFs"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:()=>A("xml"),disabled:m==="masivo",className:"text-xs",children:m==="masivo"?"Descargando...":"Descargar XMLs"}),n.jsx(fe,{type:"button",variant:"primary",onClick:()=>A("zip"),disabled:m==="masivo",className:"text-xs",children:m==="masivo"?"Generando...":"Descargar ZIP"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase w-12",children:n.jsx("input",{type:"checkbox",checked:d.size===e.length&&e.length>0,onChange:b,className:"rounded border-gray-300 text-primary focus:ring-primary"})}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"UUID"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Serie-Folio"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"UUID Original"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Serie-Folio Original"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Receptor"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"RFC"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Total"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Acciones"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:e.map((k,P)=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"checkbox",checked:k.uuid?d.has(k.uuid):!1,onChange:()=>k.uuid&&w(k.uuid),className:"rounded border-gray-300 text-primary focus:ring-primary"})}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200 font-mono text-xs break-all max-w-xs",children:n.jsx("span",{title:k.uuid||"",children:k.uuid||"-"})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:k.serie&&k.folio?`${k.serie}-${k.folio}`:"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200 font-mono text-xs break-all max-w-xs",children:n.jsx("span",{title:k.uuidOrig||"",children:k.uuidOrig||"-"})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:k.serieOrig&&k.folioOrig?`${k.serieOrig}-${k.folioOrig}`:"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200",children:k.receptorRazonSocial||"-"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:k.receptorRfc||"-"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-700 dark:text-gray-200",children:E(k.total)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:F(k.fechaFactura)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx(fe,{type:"button",variant:"secondary",onClick:()=>k.uuid&&y(k.uuid),disabled:!k.uuid||m===k.uuid,className:"text-xs py-1 px-2",title:"Descargar PDF",children:m===k.uuid?"...":"PDF"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:()=>k.uuid&&j(k.uuid),disabled:!k.uuid||m===k.uuid,className:"text-xs py-1 px-2",title:"Descargar XML",children:m===k.uuid?"...":"XML"})]})})]},k.uuid||P))})]})})]}),e.length>0&&n.jsxs("div",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:["Mostrando ",e.length," factura(s) sustituida(s)"]})]}),n.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out forwards;
        }
      `})]})},vM=()=>{const[e,a]=N.useState([]),[t,r]=N.useState(!1),[s,i]=N.useState("mes"),[o,l]=N.useState(""),[c,u]=N.useState(""),[d,f]=N.useState(""),[m,x]=N.useState(null);N.useEffect(()=>{g()},[]);const h=j=>{const A=new Date;let E,F=new Date(A);switch(j){case"hoy":E=new Date(A),E.setHours(0,0,0,0),F.setHours(23,59,59,999);break;case"mes":E=new Date(A.getFullYear(),A.getMonth(),1),E.setHours(0,0,0,0),F=new Date(A.getFullYear(),A.getMonth()+1,0),F.setHours(23,59,59,999);break;case"personalizado":return{inicio:o||"",fin:c||""};default:E=new Date(A.getFullYear(),A.getMonth(),1),E.setHours(0,0,0,0),F=new Date(A.getFullYear(),A.getMonth()+1,0),F.setHours(23,59,59,999)}return{inicio:E.toISOString().split("T")[0],fin:F.toISOString().split("T")[0]}},g=async()=>{r(!0);try{const j=h(s),A=await _h.consultarFacturasPorUsuario(d||void 0,j.inicio||void 0,j.fin||void 0);A.exitoso?a(A.usuarios):(console.error("Error cargando facturas por usuario:",A.mensaje),a([]))}catch(j){console.error("Error obteniendo facturas por usuario:",j),a([])}finally{r(!1)}},p=j=>{i(j)},v=()=>{g()},w=j=>{x(m===j?null:j)},b=j=>j==null?"$0.00":new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(j),y=j=>{if(!j)return"";try{return new Date(j).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return j}};return n.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[n.jsxs(ve,{children:[n.jsxs("div",{className:"flex items-center mb-4",children:[n.jsx(xi,{className:"w-6 h-6 mr-2 text-primary dark:text-secondary"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100",children:"Facturas por Usuario"})]}),n.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Buscar por Usuario"}),n.jsx("input",{type:"text",value:d,onChange:j=>f(j.target.value),placeholder:"Ingrese nombre de usuario...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),n.jsx(fe,{type:"button",variant:s==="hoy"?"primary":"neutral",onClick:()=>p("hoy"),className:"w-full",children:"Da Actual"}),n.jsx(fe,{type:"button",variant:s==="mes"?"primary":"neutral",onClick:()=>p("mes"),className:"w-full",children:"Mes Actual"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(fe,{type:"button",variant:s==="personalizado"?"primary":"neutral",onClick:()=>p("personalizado"),className:"w-full",children:"Personalizado"}),s==="personalizado"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Fecha Inicio"}),n.jsx("input",{type:"date",value:o,onChange:j=>l(j.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Fecha Fin"}),n.jsx("input",{type:"date",value:c,onChange:j=>u(j.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]})]}),n.jsx(fe,{type:"button",variant:"primary",onClick:v,disabled:t,className:"w-full md:col-span-1",children:t?"Buscando...":"Buscar"})]})]}),t?n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Cargando facturas por usuario..."}):e.length===0?n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No se encontraron facturas para los criterios seleccionados."}):n.jsx("div",{className:"space-y-4",children:e.map(j=>n.jsxs(ve,{className:"overflow-hidden",children:[n.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",onClick:()=>w(j.usuario),children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx(xi,{className:"w-5 h-5 mr-2 text-primary dark:text-secondary"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:j.nombreUsuario||j.usuario}),n.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Usuario: ",j.usuario]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[j.totalFacturas," Factura(s) | ",j.totalNotasCredito," Nota(s) de Crdito"]}),n.jsxs("div",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:["Total: ",b(j.totalImporte)]})]})]})}),m===j.usuario&&n.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tipo"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Serie-Folio"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Receptor"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"RFC"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Total"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Estatus"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:j.documentos.map((A,E)=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${A.tipo==="FACTURA"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"}`,children:A.tipo==="FACTURA"?"Factura":"Nota de Crdito"})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:A.serie&&A.folio?`${A.serie}-${A.folio}`:"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200",children:A.receptorRazonSocial||"-"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:A.receptorRfc||"-"}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-700 dark:text-gray-200",children:b(A.total)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:y(A.fechaFactura)}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${A.estatusFacturacion==="TIMBRADA"||A.estatusSat==="VIGENTE"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}`,children:A.estatusFacturacion||A.estatusSat||"N/A"})})]},A.uuid||E))})]})})})]},j.usuario))}),e.length>0&&n.jsxs("div",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:["Mostrando ",e.length," usuario(s) con facturas"]})]}),n.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out forwards;
        }
      `})]})},bM={usuario:"j.perez"},Gy={noUsuario:"",nombreEmpleado:"",password:"",idPerfil:"",idDfi:"",idEstacionamiento:""},Xy={noUsuario:"",nombreEmpleado:"",idPerfil:"",nombrePerfil:""},wM=()=>{const[e,a]=N.useState(bM),[t,r]=N.useState(Gy),[s,i]=N.useState(Xy),[o,l]=N.useState(!1),[c,u]=N.useState(!1),[d,f]=N.useState(!1),[m,x]=N.useState(""),[h,g]=N.useState([]),[p,v]=N.useState([]),[w,b]=N.useState(!1),y=new File([`jperez
mgomez
asanchez`],"usuarios_a_eliminar.csv",{type:"text/csv"}),[j,A]=N.useState(y);N.useEffect(()=>{(o||c)&&(async()=>{try{const L=await Gn.obtenerPerfiles();g(L)}catch(L){console.error("Error al cargar perfiles:",L)}})()},[o,c]);const E=h.filter(T=>T&&T.idPerfil&&T.nombrePerfil).map(T=>({value:T.idPerfil.toString(),label:T.nombrePerfil})),F=T=>{a({...e,[T.target.name]:T.target.value})},k=async T=>{b(!0);try{const L=await Gn.consultarEmpleadosEspecificos(T);v(L),L.length===0&&e.usuario===T&&alert(`No se encontraron empleados que coincidan con "${T}"`)}catch(L){console.error("Error al buscar empleados:",L),alert("Error al buscar empleados. Por favor intenta nuevamente.")}finally{b(!1)}},P=T=>{if(T.preventDefault(),!e.usuario||e.usuario.trim()===""){alert("Por favor ingresa un cdigo de usuario especfico para buscar (ej: admin, jcredito01)");return}k(e.usuario.trim())},R=()=>{l(!0)},_=T=>{if(!T){console.error("Empleado no definido");return}const L=E.find(V=>V.label===T.nombrePerfil);i({noUsuario:T.noUsuario||"",nombreEmpleado:T.nombreEmpleado||"",idPerfil:L?L.value:"",nombrePerfil:T.nombrePerfil||""}),u(!0)},Q=async T=>{if(window.confirm(`Ests seguro de que deseas eliminar el usuario "${T}"?

Esta accin cambiar el estatus del usuario a INACTIVO.`))try{const V=localStorage.getItem("username")||"admin",O=await Gn.eliminarUsuario(T,V);O.success?(alert(`Usuario ${T} eliminado correctamente`),e.usuario&&e.usuario.trim()!==""&&k(e.usuario.trim())):alert(`Error al eliminar usuario: ${O.message}`)}catch(V){console.error("Error al eliminar usuario:",V),alert("Error al eliminar usuario. Por favor intenta nuevamente.")}},C=T=>{r({...t,[T.target.name]:T.target.value})},z=T=>{i({...s,[T.target.name]:T.target.value})},S=()=>{l(!1),r(Gy)},D=()=>{u(!1),i(Xy),x("")},H=async T=>{T.preventDefault(),f(!0),x("");try{const L={noUsuario:t.noUsuario,nombreEmpleado:t.nombreEmpleado,password:t.password,estatusUsuario:"ACTIVO",idPerfil:parseInt(t.idPerfil),idDfi:t.idDfi?parseInt(t.idDfi):void 0,idEstacionamiento:t.idEstacionamiento?parseInt(t.idEstacionamiento):void 0,modificaUbicacion:"N"},V=await Gn.registrarUsuario(L);if(V.success){alert(`Usuario ${t.noUsuario} creado exitosamente`),S(),a({usuario:t.noUsuario});const O=async(de=1)=>{const me=await Gn.consultarEmpleadosEspecificos(t.noUsuario);me.length>0?v(me):de<3?setTimeout(()=>{O(de+1)},500*de):alert(`Usuario creado exitosamente. Si no aparece en la tabla, por favor busca manualmente con el cdigo: ${t.noUsuario}`)};setTimeout(()=>{O(1)},500)}else x(V.message||"Error al crear usuario")}catch(L){console.error("Error al crear usuario:",L),x("Error al crear usuario. Por favor intenta nuevamente.")}finally{f(!1)}},U=async T=>{T.preventDefault(),f(!0),x("");try{const L=localStorage.getItem("username")||"admin",V=await Gn.actualizarPerfil(s.noUsuario,parseInt(s.idPerfil),L);V.success?(alert(`Perfil del usuario ${s.noUsuario} actualizado correctamente`),D(),e.usuario&&e.usuario.trim()!==""&&k(e.usuario.trim())):x(V.message||"Error al actualizar perfil")}catch(L){console.error("Error al actualizar perfil:",L),x("Error al actualizar perfil. Por favor intenta nuevamente.")}finally{f(!1)}},B=T=>{T.preventDefault(),alert(j?`Procesando eliminacin masiva con archivo: ${j.name} (simulado)`:"Por favor, seleccione un archivo para la eliminacin masiva.")};return n.jsxs("div",{className:"space-y-8",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 sr-only",children:"ADMINISTRACIN DE EMPLEADOS"}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"BUSCAR DATOS DE USUARIO"}),n.jsx("form",{onSubmit:P,className:"space-y-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 items-end gap-4",children:[n.jsx(J,{label:"Cdigo de Usuario:",name:"usuario",value:e.usuario,onChange:F,placeholder:"Ej: admin, jcredito01, supervisor01...",className:"md:col-span-2"}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx(fe,{type:"submit",variant:"primary",className:"w-full md:w-auto",children:"Consultar"}),n.jsx(fe,{type:"button",onClick:R,variant:"secondary",className:"w-full md:w-auto",children:"Alta"})]})]})})]}),n.jsxs(ve,{children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"DATOS CONSULTADOS"}),n.jsx(fe,{type:"button",onClick:()=>{if(!e.usuario||e.usuario.trim()===""){alert("Primero debes hacer una bsqueda especfica de un usuario");return}k(e.usuario.trim())},variant:"secondary",disabled:w,children:w?"Cargando...":"Actualizar"})]}),w?n.jsx("div",{className:"flex justify-center items-center py-8",children:n.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Cargando empleados..."})}):p.length===0?n.jsx("div",{className:"flex justify-center items-center py-8",children:n.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:'Ingresa un cdigo de usuario especfico (ej: admin, jcredito01) y haz clic en "Consultar" para ver los resultados'})}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider border-b border-gray-200 dark:border-gray-600",children:"Usuario"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider border-b border-gray-200 dark:border-gray-600",children:"Nombre Empleado"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider border-b border-gray-200 dark:border-gray-600",children:"Perfil"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider border-b border-gray-200 dark:border-gray-600",children:"DFI"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider border-b border-gray-200 dark:border-gray-600",children:"Estatus"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider border-b border-gray-200 dark:border-gray-600",children:"Fecha Modificacin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider border-b border-gray-200 dark:border-gray-600",children:"Acciones"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:p.map((T,L)=>n.jsxs("tr",{className:L%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-750",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600",children:T.noUsuario}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600",children:T.nombreEmpleado}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600",children:T.nombrePerfil}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600",children:T.idDfi}),n.jsx("td",{className:"px-4 py-3 text-sm border-b border-gray-200 dark:border-gray-600",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${T.estatusUsuario==="ACTIVO"?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100":"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100"}`,children:T.estatusUsuario})}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600",children:T.fechaMod}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-600",children:n.jsxs("div",{className:"flex space-x-2",children:[n.jsx(fe,{variant:"secondary",className:"text-xs px-2 py-1 flex items-center",onClick:()=>_(T),title:"Editar perfil",children:n.jsx(yu,{className:"w-4 h-4"})}),T.noUsuario.toLowerCase()!=="admin"&&n.jsx(fe,{variant:"danger",className:"text-xs px-2 py-1 flex items-center",onClick:()=>Q(T.noUsuario),title:"Eliminar usuario",children:n.jsx(Xs,{className:"w-4 h-4"})})]})})]},T.noUsuario))})]})})]}),n.jsxs(ve,{className:"bg-accent/10 dark:bg-accent-dark/10 border-accent dark:border-accent-dark",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Dar de baja usuarios"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Ingresa los datos para eliminar permisos de usuario:"}),n.jsxs("form",{onSubmit:B,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Archivo de Eliminacin Masiva:"}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("span",{className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md text-sm font-medium",children:"Elegir archivo"}),n.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:j?j.name:"No se eligi ningn archivo"})]}),n.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"El archivo debe contener los identificadores de los usuarios a eliminar, uno por lnea."})]}),n.jsx("div",{className:"flex justify-start",children:n.jsx(fe,{type:"submit",variant:"primary",children:"Eliminacin Masiva"})})]})]}),o&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Registro de Nuevo Usuario"}),n.jsx("button",{onClick:S,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 text-2xl font-bold",children:""})]}),n.jsxs("form",{onSubmit:H,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(J,{label:"Usuario:",name:"noUsuario",value:t.noUsuario,onChange:C,required:!0,maxLength:50,placeholder:"Ej: j.perez"}),n.jsx(J,{label:"Nombre del Empleado:",name:"nombreEmpleado",value:t.nombreEmpleado,onChange:C,required:!0,maxLength:100,placeholder:"Nombre completo del empleado"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(J,{label:"Contrasea:",name:"password",type:"password",value:t.password,onChange:C,required:!0,maxLength:100,placeholder:"Contrasea del usuario"}),n.jsx(Se,{label:"Perfil:",name:"idPerfil",value:t.idPerfil,onChange:C,options:E,required:!0})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(J,{label:"DFI:",name:"idDfi",type:"number",value:t.idDfi,onChange:C,required:!0,placeholder:"ID del DFI"}),n.jsx(J,{label:"Tienda (opcional):",name:"idEstacionamiento",type:"number",value:t.idEstacionamiento,onChange:C,placeholder:"ID de la tienda (opcional)"})]}),m&&n.jsx("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:m}),n.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-600",children:[n.jsx(fe,{type:"button",variant:"secondary",onClick:S,disabled:d,children:"Cancelar"}),n.jsx(fe,{type:"submit",variant:"primary",disabled:d,children:d?"Creando...":"Crear Usuario"})]})]})]})})}),c&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4",children:n.jsxs("div",{className:"p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Editar Perfil de Usuario"}),m&&n.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:m}),n.jsxs("form",{onSubmit:U,children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx(J,{label:"Usuario",name:"noUsuario",value:s.noUsuario,onChange:z,disabled:!0,className:"bg-gray-100 dark:bg-gray-700"}),n.jsx(J,{label:"Nombre del Empleado",name:"nombreEmpleado",value:s.nombreEmpleado,onChange:z,disabled:!0,className:"bg-gray-100 dark:bg-gray-700"}),n.jsx(Se,{label:"Perfil",name:"idPerfil",value:s.idPerfil,onChange:z,options:E,required:!0})]}),n.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-600",children:[n.jsx(fe,{type:"button",variant:"secondary",onClick:D,disabled:d,children:"Cancelar"}),n.jsx(fe,{type:"submit",variant:"primary",disabled:d,children:d?"Actualizando...":"Actualizar Perfil"})]})]})]})})})]})},EM=()=>{var D,H,U;const[e,a]=N.useState([]),[t,r]=N.useState(null),[s,i]=N.useState(!1),[o,l]=N.useState(null),[c,u]=N.useState(null),[d,f]=N.useState(!1),[m,x]=N.useState(null),[h,g]=N.useState("create"),[p,v]=N.useState({}),[w,b]=N.useState(!1),[y,j]=N.useState({codigoTienda:"",nombreTienda:"",direccion:"",ciudad:"",estado:"",codigoPostal:"",telefono:"",email:"",gerente:"",region:"",zona:"",tipoTienda:"Sucursal",estadoTienda:"ACTIVO",fechaApertura:"",observaciones:""});N.useEffect(()=>{A(),E()},[]);const A=async()=>{i(!0);try{const B=await Ji.listarTiendas(p);B.success&&Array.isArray(B.data)?(a(B.data),l(null)):l(B.message||"Error al cargar las tiendas")}catch{l("Error de conexin al cargar las tiendas")}finally{i(!1)}},E=async()=>{try{const B=await Ji.obtenerEstadisticas();B.success&&B.data&&r(B.data)}catch(B){console.error("Error al cargar estadsticas:",B)}},F=async B=>{B.preventDefault(),i(!0),l(null),u(null);try{let X;h==="edit"&&(m!=null&&m.idTienda)?X=await Ji.actualizarTienda(m.idTienda,{...y,usuarioModificacion:"admin"}):X=await Ji.crearTienda({...y,usuarioCreacion:"admin"}),X.success?(u(X.message),f(!1),_(),A(),E()):l(X.message||"Error al procesar la solicitud")}catch{l("Error de conexin al procesar la solicitud")}finally{i(!1)}},k=B=>{x(B),j({...B,fechaApertura:B.fechaApertura?B.fechaApertura.split("T")[0]:""}),g("edit"),f(!0)},P=B=>{x(B),j({...B,fechaApertura:B.fechaApertura?B.fechaApertura.split("T")[0]:""}),g("view"),f(!0)},R=async B=>{if(B.idTienda&&window.confirm(`Est seguro de que desea eliminar la tienda "${B.nombreTienda}"?`)){i(!0);try{const X=await Ji.eliminarTienda(B.idTienda,"admin");X.success?(u(X.message),A(),E()):l(X.message||"Error al eliminar la tienda")}catch{l("Error de conexin al eliminar la tienda")}finally{i(!1)}}},_=()=>{j({codigoTienda:"",nombreTienda:"",direccion:"",ciudad:"",estado:"",codigoPostal:"",telefono:"",email:"",gerente:"",region:"",zona:"",tipoTienda:"Sucursal",estadoTienda:"ACTIVO",fechaApertura:"",observaciones:""}),x(null),g("create")},Q=(B,X)=>{v(T=>({...T,[B]:X||void 0}))},C=()=>{A()},z=()=>{v({}),setTimeout(()=>A(),100)},S=B=>{switch(B){case"ACTIVO":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"INACTIVO":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";case"SUSPENDIDO":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Administracin de Tiendas"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Gestiona las tiendas del sistema"})]}),n.jsx(fe,{onClick:()=>{_(),f(!0)},className:"bg-blue-600 hover:bg-blue-700",children:"+ Nueva Tienda"})]}),o&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg dark:bg-red-900 dark:border-red-700 dark:text-red-300",children:o}),c&&n.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg dark:bg-green-900 dark:border-green-700 dark:text-green-300",children:c}),t&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsx(ve,{className:"p-4",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:t.totalTiendas}),n.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Tiendas"})]})}),n.jsx(ve,{className:"p-4",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:t.tiendasActivas}),n.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Activas"})]})}),n.jsx(ve,{className:"p-4",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:t.tiendasInactivas}),n.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Inactivas"})]})}),n.jsx(ve,{className:"p-4",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:t.tiendasSuspendidas}),n.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Suspendidas"})]})})]}),n.jsxs(ve,{className:"p-4",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Filtros"}),n.jsxs(fe,{onClick:()=>b(!w),variant:"outline",size:"sm",children:[w?"Ocultar":"Mostrar"," Filtros"]})]}),w&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[n.jsx(Se,{label:"Estado",value:p.estadoTienda||"",onChange:B=>Q("estadoTienda",String(B)),options:[{value:"",label:"Todos"},{value:"ACTIVO",label:"Activo"},{value:"INACTIVO",label:"Inactivo"},{value:"SUSPENDIDO",label:"Suspendido"}]}),n.jsx(Se,{label:"Regin",value:p.region||"",onChange:B=>Q("region",String(B)),options:[{value:"",label:"Todas"},...((D=t==null?void 0:t.regiones)==null?void 0:D.map(B=>({value:B,label:B})))||[]]}),n.jsx(Se,{label:"Zona",value:p.zona||"",onChange:B=>Q("zona",String(B)),options:[{value:"",label:"Todas"},...((H=t==null?void 0:t.zonas)==null?void 0:H.map(B=>({value:B,label:B})))||[]]}),n.jsx(Se,{label:"Tipo",value:p.tipoTienda||"",onChange:B=>Q("tipoTienda",String(B)),options:[{value:"",label:"Todos"},...((U=t==null?void 0:t.tiposTienda)==null?void 0:U.map(B=>({value:B,label:B})))||[]]}),n.jsx(J,{label:"Bsqueda",type:"text",value:p.busqueda||"",onChange:B=>Q("busqueda",B.target.value),placeholder:"Buscar por nombre, cdigo, ciudad..."})]}),w&&n.jsxs("div",{className:"flex gap-2 mt-4",children:[n.jsx(fe,{onClick:C,size:"sm",children:"Aplicar Filtros"}),n.jsx(fe,{onClick:z,variant:"outline",size:"sm",children:"Limpiar"})]})]}),n.jsx(ve,{children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Cdigo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nombre"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Ciudad"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Regin/Zona"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tipo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Estado"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Acciones"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:s?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Cargando tiendas..."})}):e.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"No se encontraron tiendas"})}):e.map(B=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:B.codigoTienda}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:B.nombreTienda}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:B.ciudad}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[B.region," / ",B.zona]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:B.tipoTienda}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${S(B.estadoTienda||"ACTIVO")}`,children:B.estadoTienda})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[n.jsx(fe,{onClick:()=>P(B),variant:"outline",size:"sm",children:"Ver"}),n.jsx(fe,{onClick:()=>k(B),variant:"outline",size:"sm",className:"text-blue-600 border-blue-600 hover:bg-blue-50",children:"Editar"}),n.jsx(fe,{onClick:()=>R(B),variant:"outline",size:"sm",className:"text-red-600 border-red-600 hover:bg-red-50",children:"Eliminar"})]})]},B.idTienda))})]})})}),d&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:h==="create"?"Nueva Tienda":h==="edit"?"Editar Tienda":"Ver Tienda"}),n.jsx(fe,{onClick:()=>f(!1),variant:"outline",size:"sm",children:""})]}),n.jsxs("form",{onSubmit:F,className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsx(J,{label:"Cdigo de Tienda *",type:"text",value:y.codigoTienda,onChange:B=>j(X=>({...X,codigoTienda:B.target.value})),required:!0,disabled:h==="view",placeholder:"Ej: T001"}),n.jsx(J,{label:"Nombre de Tienda *",type:"text",value:y.nombreTienda,onChange:B=>j(X=>({...X,nombreTienda:B.target.value})),required:!0,disabled:h==="view",placeholder:"Nombre de la tienda"}),n.jsx(J,{label:"Direccin",type:"text",value:y.direccion||"",onChange:B=>j(X=>({...X,direccion:B.target.value})),disabled:h==="view",placeholder:"Direccin completa"}),n.jsx(J,{label:"Ciudad",type:"text",value:y.ciudad||"",onChange:B=>j(X=>({...X,ciudad:B.target.value})),disabled:h==="view",placeholder:"Ciudad"}),n.jsx(J,{label:"Estado",type:"text",value:y.estado||"",onChange:B=>j(X=>({...X,estado:B.target.value})),disabled:h==="view",placeholder:"Estado o provincia"}),n.jsx(J,{label:"Cdigo Postal",type:"text",value:y.codigoPostal||"",onChange:B=>j(X=>({...X,codigoPostal:B.target.value})),disabled:h==="view",placeholder:"Cdigo postal"}),n.jsx(J,{label:"Telfono",type:"tel",value:y.telefono||"",onChange:B=>j(X=>({...X,telefono:B.target.value})),disabled:h==="view",placeholder:"Nmero de telfono"}),n.jsx(J,{label:"Email",type:"email",value:y.email||"",onChange:B=>j(X=>({...X,email:B.target.value})),disabled:h==="view",placeholder:"correo@ejemplo.com"}),n.jsx(J,{label:"Gerente",type:"text",value:y.gerente||"",onChange:B=>j(X=>({...X,gerente:B.target.value})),disabled:h==="view",placeholder:"Nombre del gerente"}),n.jsx(J,{label:"Regin",type:"text",value:y.region||"",onChange:B=>j(X=>({...X,region:B.target.value})),disabled:h==="view",placeholder:"Regin"}),n.jsx(J,{label:"Zona",type:"text",value:y.zona||"",onChange:B=>j(X=>({...X,zona:B.target.value})),disabled:h==="view",placeholder:"Zona"}),n.jsx(Se,{label:"Tipo de Tienda",value:y.tipoTienda||"Sucursal",onChange:B=>j(X=>({...X,tipoTienda:String(B)})),disabled:h==="view",options:[{value:"Sucursal",label:"Sucursal"},{value:"Franquicia",label:"Franquicia"},{value:"Corporativo",label:"Corporativo"},{value:"Outlet",label:"Outlet"}]}),n.jsx(Se,{label:"Estado de Tienda",value:y.estadoTienda||"ACTIVO",onChange:B=>j(X=>({...X,estadoTienda:String(B)})),disabled:h==="view",options:[{value:"ACTIVO",label:"Activo"},{value:"INACTIVO",label:"Inactivo"},{value:"SUSPENDIDO",label:"Suspendido"}]}),n.jsx(J,{label:"Fecha de Apertura",type:"date",value:y.fechaApertura||"",onChange:B=>j(X=>({...X,fechaApertura:B.target.value})),disabled:h==="view"})]}),n.jsx(ys,{label:"Observaciones",value:y.observaciones||"",onChange:B=>j(X=>({...X,observaciones:B.target.value})),disabled:h==="view",placeholder:"Observaciones adicionales...",rows:3}),h!=="view"&&n.jsxs("div",{className:"flex justify-end space-x-4",children:[n.jsx(fe,{type:"button",onClick:()=>f(!1),variant:"outline",children:"Cancelar"}),n.jsx(fe,{type:"submit",disabled:s,className:"bg-blue-600 hover:bg-blue-700",children:s?"Procesando...":h==="edit"?"Actualizar":"Crear"})]})]})]})})})]})};var Jv,Zv;const qy={perfil:((Jv=Qm[0])==null?void 0:Jv.value)||"",tipoRegla:"emision",fechaInicio:"",fechaFin:"",menu:((Zv=A0[A0.length-1])==null?void 0:Zv.value)||""},kM=[{id:"1",tipoRegla:"cancelacion",perfil:"jefe_credito",menu:"facturacion",fechaInicio:"2023-01-01",fechaFin:"2023-12-31"},{id:"2",tipoRegla:"emision",perfil:"operador_credito",menu:"consultas",fechaInicio:"2024-01-01",fechaFin:"2024-06-30"}],NM=()=>{const[e,a]=N.useState(qy),[t,r]=N.useState(kM),s=c=>{const{name:u,value:d}=c.target;a(f=>({...f,[u]:d}))},i=c=>{c.preventDefault();const u={...e,id:Date.now().toString()};r(d=>[...d,u]),a(qy),alert("Regla agregada (simulado).")},o=c=>{r(u=>u.filter(d=>d.id!==c)),alert(`Regla con ID ${c} eliminada (simulado).`)},l=[{value:"emision",label:"Emisin"},{value:"cancelacion",label:"Cancelacin"}];return n.jsxs("div",{className:"space-y-6",children:[n.jsx(ve,{children:n.jsxs("form",{onSubmit:i,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4 items-end",children:[n.jsx(Se,{label:"Perfil:",name:"perfil",value:e.perfil,onChange:s,options:Qm,required:!0}),n.jsx(pk,{label:"Tipo Regla:",name:"tipoRegla",options:l,selectedValue:e.tipoRegla,onChange:s,inline:!0}),n.jsx("div",{})," ",n.jsx(J,{label:"Fecha Inicio:",name:"fechaInicio",type:"date",value:e.fechaInicio,onChange:s,required:!0}),n.jsx(J,{label:"Fecha Final:",name:"fechaFin",type:"date",value:e.fechaFin,onChange:s,required:!0}),n.jsx(Se,{label:"Men:",name:"menu",value:e.menu,onChange:s,options:A0,required:!0})]}),n.jsx("div",{className:"flex justify-start mt-4",children:n.jsx(fe,{type:"submit",variant:"primary",children:"Agregar Regla"})})]})}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Lista de Reglas de periodos de cancelacin y emisin"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tipo Regla"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Perfil"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Men"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Inicio"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Fin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Eliminar"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(c=>{var u,d;return n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm capitalize text-gray-700 dark:text-gray-200",children:c.tipoRegla}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:((u=Qm.find(f=>f.value===c.perfil))==null?void 0:u.label)||c.perfil}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:((d=A0.find(f=>f.value===c.menu))==null?void 0:d.label)||c.menu}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:c.fechaInicio}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:c.fechaFin}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx("button",{onClick:()=>o(c.id),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-500 p-1","aria-label":`Eliminar regla para ${c.perfil}`,children:n.jsx(Xs,{className:"w-5 h-5"})})})]},c.id)})})]})}),t.length===0&&n.jsx("p",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"No hay reglas definidas."})]})]})};var Qv;const Yy={plataforma:((Qv=R0[R0.length-1])==null?void 0:Qv.value)||"",fechaInicio:"",fechaFin:""},jM=[{id:"1",tipoRegla:"emision",plataforma:"kiosko",fechaInicio:"2023-01-01",fechaFin:"2023-12-31"},{id:"2",tipoRegla:"emision",plataforma:"internet",fechaInicio:"2024-01-01",fechaFin:"2024-06-30"}],SM=()=>{const[e,a]=N.useState(Yy),[t,r]=N.useState(jM),s=l=>{const{name:c,value:u}=l.target;a(d=>({...d,[c]:u}))},i=l=>{l.preventDefault();const c={...e,tipoRegla:"emision",id:Date.now().toString()};r(u=>[...u,c]),a(Yy),alert("Regla de plataforma agregada (simulado).")},o=l=>{r(c=>c.filter(u=>u.id!==l)),alert(`Regla de plataforma con ID ${l} eliminada (simulado).`)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(ve,{children:n.jsxs("form",{onSubmit:i,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4 items-end",children:[n.jsx(Se,{label:"Plataforma:",name:"plataforma",value:e.plataforma,onChange:s,options:R0,required:!0}),n.jsx(J,{label:"Tipo Regla:",name:"tipoReglaDisplay",value:"Emisin",onChange:()=>{},disabled:!0}),n.jsx("div",{})," ",n.jsx(J,{label:"Fecha Inicio:",name:"fechaInicio",type:"date",value:e.fechaInicio,onChange:s,required:!0}),n.jsx(J,{label:"Fecha Final:",name:"fechaFin",type:"date",value:e.fechaFin,onChange:s,required:!0})]}),n.jsx("div",{className:"flex justify-start mt-4",children:n.jsx(fe,{type:"submit",variant:"primary",children:"Agregar Regla"})})]})}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Lista de Reglas de periodos de emisin"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tipo Regla"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Plataforma"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Inicio"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Fin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Eliminar"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(l=>{var c;return n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm capitalize text-gray-700 dark:text-gray-200",children:l.tipoRegla}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:((c=R0.find(u=>u.value===l.plataforma))==null?void 0:c.label)||l.plataforma}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:l.fechaInicio}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:l.fechaFin}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx("button",{onClick:()=>o(l.id),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-500 p-1","aria-label":`Eliminar regla para ${l.plataforma}`,children:n.jsx(Xs,{className:"w-5 h-5"})})})]},l.id)})})]})}),t.length===0&&n.jsx("p",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"No hay reglas de plataforma definidas."})]})]})},Dd=10,CM=[{id:"K001",tienda:"S001",terminal:"1001",codigoPostal:"55001",ubicacion:"Zona Norte"},{id:"K002",tienda:"S002",terminal:"1002",codigoPostal:"55002",ubicacion:"Zona Centro"},{id:"K003",tienda:"S003",terminal:"1003",codigoPostal:"55003",ubicacion:"Zona Sur"}];var e2;const Gf={tienda:((e2=Ia[0])==null?void 0:e2.value)||"",terminal:"",codigoPostal:"",ubicacion:""},TM=()=>{const[e,a]=N.useState(CM),[t,r]=N.useState(!1),[s,i]=N.useState(Gf),[o,l]=N.useState(null),[c,u]=N.useState(1),[d,f]=N.useState(""),[m,x]=N.useState(""),h=N.useMemo(()=>e.filter(k=>{const P=k.ubicacion.toLowerCase().includes(d.toLowerCase())||k.terminal.toLowerCase().includes(d.toLowerCase())||k.codigoPostal.toLowerCase().includes(d.toLowerCase()),R=!m||k.tienda===m;return P&&R}),[e,d,m]),g=Math.ceil(h.length/Dd),p=(c-1)*Dd,v=h.slice(p,p+Dd),w=k=>{const{name:P,value:R}=k.target;P==="tienda"&&Ly(R),o?l(_=>_?{..._,[P]:R}:null):i(_=>({..._,[P]:R}))},b=k=>{if(k.preventDefault(),o)a(e.map(P=>P.id===o.id?o:P)),alert(`Kiosco ${o.id} actualizado (simulado).`),l(null);else{const P={...s,id:`K${Date.now()}`};a(R=>[...R,P]),alert(`Kiosco ${P.ubicacion} agregado (simulado).`)}i(Gf),r(!1)},y=k=>{l(k),i(k),r(!0)},j=()=>{l(null),i(Gf),r(!t)},A=k=>{u(k)},E=()=>{f(""),x(""),u(1)},F=()=>n.jsxs(ve,{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:o?"Modificar Kiosco":"Agregar Nuevo Kiosco"}),n.jsxs("form",{onSubmit:b,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(Se,{label:"Tienda:",name:"tienda",value:(o==null?void 0:o.tienda)||s.tienda,onChange:w,options:Ia.filter(k=>k.value!=="Todas"),required:!0}),n.jsx(J,{label:"Terminal:",name:"terminal",value:(o==null?void 0:o.terminal)||s.terminal,onChange:w,required:!0}),n.jsx(J,{label:"Cdigo Postal:",name:"codigoPostal",value:(o==null?void 0:o.codigoPostal)||s.codigoPostal,onChange:w,required:!0}),n.jsx(J,{label:"Ubicacin:",name:"ubicacion",value:(o==null?void 0:o.ubicacion)||s.ubicacion,onChange:w,required:!0})]}),n.jsxs("div",{className:"flex justify-end space-x-3 mt-4",children:[n.jsx(fe,{type:"button",variant:"neutral",onClick:j,children:"Cancelar"}),n.jsx(fe,{type:"submit",variant:"primary",children:o?"Guardar Cambios":"Agregar Kiosco"})]})]})]});return n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 sr-only",children:"ADMINISTRACIN DE KIOSCOS"}),n.jsx("div",{})," ",!t&&n.jsxs(fe,{onClick:j,variant:"primary",className:"flex items-center",children:[n.jsx(EC,{className:"w-5 h-5 mr-2"}),"Agregar"]})]}),t&&F(),n.jsxs(ve,{children:[n.jsx("div",{className:"mb-6 space-y-4",children:n.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[n.jsx("div",{className:"flex-1",children:n.jsx(J,{label:"Buscar:",type:"text",value:d,onChange:k=>{f(k.target.value),u(1)},placeholder:"Buscar por ubicacin, terminal o cdigo postal...",leftIcon:n.jsx(Pn,{className:"w-5 h-5 text-gray-400"})})}),n.jsx("div",{className:"w-full md:w-48",children:n.jsx(Se,{label:"Filtrar por tienda:",value:m,onChange:k=>{x(k.target.value),Ly(k.target.value),u(1)},options:[{value:"",label:"Todas las tiendas"},...Ia]})}),(d||m)&&n.jsx(fe,{type:"button",variant:"neutral",onClick:E,className:"mb-2",children:"Limpiar filtros"})]})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Lista de Kiosco"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tienda"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Terminal"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Cdigo Postal"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Ubicacin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Modificar"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:v.map(k=>{var P;return n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:((P=Ia.find(R=>R.value===k.tienda))==null?void 0:P.label)||k.tienda}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:k.terminal}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:k.codigoPostal}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:k.ubicacion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx("button",{onClick:()=>y(k),className:"text-primary dark:text-secondary hover:underline p-1","aria-label":`Modificar kiosco ${k.ubicacion}`,children:n.jsx(yu,{className:"w-5 h-5"})})})]},k.id)})})]})}),h.length===0&&n.jsx("p",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:d||m?"No se encontraron resultados para la bsqueda":"No hay kioscos registrados."}),h.length>0&&n.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-between items-center gap-3",children:[n.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Mostrando ",p+1," a ",Math.min(p+Dd,h.length)," de ",h.length," resultados"]}),n.jsxs("div",{className:"flex justify-center space-x-2",children:[n.jsx(fe,{variant:"neutral",onClick:()=>A(c-1),disabled:c===1,children:"Anterior"}),Array.from({length:g},(k,P)=>P+1).map(k=>n.jsx(fe,{variant:c===k?"primary":"neutral",onClick:()=>A(k),children:k},k)),n.jsx(fe,{variant:"neutral",onClick:()=>A(c+1),disabled:c===g,children:"Siguiente"})]})]})]})]})};var a2,t2,r2,s2;const Wy={origen:((a2=ri[0])==null?void 0:a2.value)||"",leyenda:((t2=D0[D0.length-1])==null?void 0:t2.value)||"",seccion:((r2=Bo[0])==null?void 0:r2.value)||"",formasPago:((s2=ex[0])==null?void 0:s2.value)||""},FM=[{id:"1",origen:"web",pos:"web",leyenda:"Pagado en una sola exhibicin",seccion:"RESTAURANTE",formasPago:"-1 (CUALQUIERA)"},{id:"2",origen:"internet",pos:"internet",leyenda:"Pagado en una sola exhibicin",seccion:"RESTAURANTE",formasPago:"0 - Cheque"},{id:"3",origen:"kiosco",pos:"kiosco",leyenda:"Pagado en una sola exhibicin",seccion:"SNACK BAR",formasPago:"1 - Cupn"}],_M=()=>{const[e,a]=N.useState(Wy),[t,r]=N.useState(FM),s=l=>{const{name:c,value:u}=l.target;a(d=>({...d,[c]:u}))},i=l=>{l.preventDefault();const c={...e,pos:e.origen,id:Date.now().toString()};r(u=>[...u,c]),a(Wy),alert("Excepcin agregada (simulado).")},o=l=>{r(c=>c.filter(u=>u.id!==l)),alert(`Excepcin con ID ${l} eliminada (simulado).`)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(ve,{children:n.jsxs("form",{onSubmit:i,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-start",children:[n.jsx(Se,{label:"Origen:",name:"origen",value:e.origen,onChange:s,options:ri,required:!0}),n.jsx(Se,{label:"Secciones:",name:"seccion",value:e.seccion,onChange:s,options:Bo,required:!0}),n.jsx(Se,{label:"Forma de Pago:",name:"formasPago",value:e.formasPago,onChange:s,options:ex,required:!0})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end mt-4",children:[n.jsx(Se,{label:"Leyenda:",name:"leyenda",value:e.leyenda,onChange:s,options:D0,required:!0}),n.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-3 self-end",children:[n.jsx(fe,{type:"button",variant:"secondary",onClick:()=>alert("Nueva Seccin (simulado)"),children:"Nueva Seccin"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:()=>alert("Nueva Forma Pago (simulado)"),children:"Nueva Forma Pago"}),n.jsx(fe,{type:"submit",variant:"primary",children:"Agregar Excepcin"})]})]})]})}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Lista de secciones no facturables (Excepciones)"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Origen"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"POS"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Leyenda"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Seccin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Formas de Pago"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Eliminar"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(l=>{var c,u,d,f;return n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:((c=ri.find(m=>m.value===l.origen))==null?void 0:c.label)||l.origen}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:l.pos}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:((u=D0.find(m=>m.value===l.leyenda))==null?void 0:u.label)||l.leyenda}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:((d=Bo.find(m=>m.value===l.seccion))==null?void 0:d.label)||l.seccion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:((f=ex.find(m=>m.value===l.formasPago))==null?void 0:f.label)||l.formasPago}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx("button",{onClick:()=>o(l.id),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-500 p-1","aria-label":`Eliminar excepcin ${l.id}`,children:n.jsx(Xs,{className:"w-5 h-5"})})})]},l.id)})})]})}),t.length===0&&n.jsx("p",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"No hay excepciones definidas."})]})]})};var n2,i2;const Ky={origen:((n2=ri[0])==null?void 0:n2.value)||"",noSeccionViajero:((i2=Bo[0])==null?void 0:i2.value)||""},AM=[{id:"1",origen:"web",noSeccionViajero:"700",nombreSeccionViajero:"CONFIRMAR 16 20 NOVIEMBRE"},{id:"2",origen:"web",noSeccionViajero:"104",nombreSeccionViajero:"KRISPY KREME"},{id:"3",origen:"web",noSeccionViajero:"207",nombreSeccionViajero:"MOTOS"}],Pd=10,RM=()=>{const[e,a]=N.useState(Ky),[t,r]=N.useState(AM),[s,i]=N.useState(1),[o,l]=N.useState(""),[c,u]=N.useState(""),d=N.useMemo(()=>t.filter(b=>{const y=b.nombreSeccionViajero.toLowerCase().includes(o.toLowerCase())||b.noSeccionViajero.toLowerCase().includes(o.toLowerCase()),j=!c||b.origen===c;return y&&j}),[t,o,c]),f=Math.ceil(d.length/Pd),m=(s-1)*Pd,x=d.slice(m,m+Pd),h=b=>{const{name:y,value:j}=b.target;a(A=>({...A,[y]:j}))},g=b=>{var A;b.preventDefault();const y=((A=Bo.find(E=>E.value===e.noSeccionViajero))==null?void 0:A.label)||e.noSeccionViajero,j={...e,nombreSeccionViajero:y,id:Date.now().toString()};r(E=>[...E,j]),a(Ky),alert("Seccin no facturable agregada (simulado).")},p=b=>{r(y=>y.filter(j=>j.id!==b)),alert(`Seccin con ID ${b} eliminada (simulado).`)},v=b=>{i(b)},w=()=>{l(""),u(""),i(1)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(ve,{children:n.jsxs("form",{onSubmit:g,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-start",children:[n.jsx(Se,{label:"Origen:",name:"origen",value:e.origen,onChange:h,options:ri,required:!0}),n.jsx(Se,{label:"Secciones:",name:"noSeccionViajero",value:e.noSeccionViajero,onChange:h,options:Bo,required:!0})]}),n.jsxs("div",{className:"flex justify-end space-x-3 mt-4",children:[n.jsx(fe,{type:"button",variant:"secondary",onClick:()=>alert("Nueva Seccin (simulado)"),children:"Nueva Seccin"}),n.jsx(fe,{type:"submit",variant:"primary",children:"Agregar Seccin"})]})]})}),n.jsxs(ve,{children:[n.jsx("div",{className:"mb-6 space-y-4",children:n.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[n.jsx("div",{className:"flex-1",children:n.jsx(J,{label:"Buscar:",type:"text",value:o,onChange:b=>{l(b.target.value),i(1)},placeholder:"Buscar por nmero o nombre de seccin...",leftIcon:n.jsx(Pn,{className:"w-5 h-5 text-gray-400"})})}),n.jsx("div",{className:"w-full md:w-48",children:n.jsx(Se,{label:"Filtrar por origen:",value:c,onChange:b=>{u(b.target.value),i(1)},options:[{value:"",label:"Todos los orgenes"},...ri]})}),(o||c)&&n.jsx(fe,{type:"button",variant:"neutral",onClick:w,className:"mb-2",children:"Limpiar filtros"})]})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Lista de secciones no facturables"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Origen"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"No. Seccin viajero"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Nombre Seccin viajero"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Eliminar"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:x.map(b=>{var y;return n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:((y=ri.find(j=>j.value===b.origen))==null?void 0:y.label)||b.origen}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:b.noSeccionViajero}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:b.nombreSeccionViajero}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx("button",{onClick:()=>p(b.id),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-500 p-1","aria-label":`Eliminar seccin ${b.nombreSeccionViajero}`,children:n.jsx(Xs,{className:"w-5 h-5"})})})]},b.id)})})]})}),d.length===0&&n.jsx("p",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:o||c?"No se encontraron resultados para la bsqueda":"No hay secciones no facturables definidas."}),d.length>0&&n.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-between items-center gap-3",children:[n.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Mostrando ",m+1," a ",Math.min(m+Pd,d.length)," de ",d.length," resultados"]}),n.jsxs("div",{className:"flex justify-center space-x-2",children:[n.jsx(fe,{variant:"neutral",onClick:()=>v(s-1),disabled:s===1,children:"Anterior"}),Array.from({length:f},(b,y)=>y+1).map(b=>n.jsx(fe,{variant:s===b?"primary":"neutral",onClick:()=>v(b),children:b},b)),n.jsx(fe,{variant:"neutral",onClick:()=>v(s+1),disabled:s===f,children:"Siguiente"})]})]})]})]})};var o2;const DM={fecha:new Date().toISOString().split("T")[0],tienda:((o2=Ia[0])==null?void 0:o2.value)||""},PM=()=>{const[e,a]=N.useState(DM),[t,r]=N.useState([]),s=[{folio:"BNA-001",fecha:"2024-06-01",tienda:"Tienda 1",monto:1500},{folio:"BNA-002",fecha:"2024-06-01",tienda:"Tienda 2",monto:2300.5},{folio:"BNA-003",fecha:"2024-06-01",tienda:"Tienda 3",monto:980}],i=u=>{const{name:d,value:f}=u.target;a(m=>({...m,[d]:f}))},o=u=>{u.preventDefault(),r(s),console.log("Buscar Boletas No Auditadas:",e)},l=()=>{alert('Funcionalidad "Agregar Tda" no implementada.')},c=()=>{if(t.length===0){alert("No hay datos para exportar.");return}const u=ba.json_to_sheet(t),d=ba.book_new();ba.book_append_sheet(d,u,"BoletasNoAuditadas"),gs(d,"boletas_no_auditadas.xlsx")};return n.jsxs("form",{onSubmit:o,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"--Especificar bsqueda--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-4 items-end",children:[n.jsx(J,{label:"Fecha:",name:"fecha",type:"date",value:e.fecha,onChange:i}),n.jsx(Se,{label:"Tienda:",name:"tienda",value:e.tienda,onChange:i,options:Ia}),n.jsx("div",{}),n.jsx("div",{})]}),n.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[n.jsx(fe,{type:"button",onClick:l,variant:"neutral",children:"Agregar Tienda"}),n.jsx(fe,{type:"submit",variant:"primary",children:"Buscar"}),n.jsx(fe,{type:"button",onClick:c,variant:"secondary",children:"XLS"})]})]}),n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px]",children:t.length===0?n.jsx("div",{className:"flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados del reporte de Boletas No Auditadas aparecern aqu."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-sm text-left",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Folio"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tienda"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Monto"})]})}),n.jsx("tbody",{children:t.map((u,d)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.folio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.fecha}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.tienda}),n.jsxs("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:["$",u.monto.toFixed(2)]})]},d))})]})})})]})};var l2,c2;const OM={mes:((l2=it[it.length-1])==null?void 0:l2.value)||"",almacen:"",fecha:"",empresa:((c2=Ma[Ma.length-1])==null?void 0:c2.value)||""},IM=()=>{const[e,a]=N.useState(OM),[t,r]=N.useState([]),s=[{folio:"IF-001",mes:"Junio",almacen:"Sucursal 1",fecha:"2024-06-01",empresa:"Empresa A",monto:12e3},{folio:"IF-002",mes:"Junio",almacen:"Sucursal 2",fecha:"2024-06-01",empresa:"Empresa B",monto:8500.5},{folio:"IF-003",mes:"Junio",almacen:"Sucursal 3",fecha:"2024-06-01",empresa:"Empresa C",monto:4300}],i=c=>{const{name:u,value:d}=c.target;a(f=>({...f,[u]:d}))},o=c=>{c.preventDefault(),r(s),console.log("Buscar Desglose Facturacin de Ingresos:",e)},l=()=>{if(t.length===0){alert("No hay datos para exportar.");return}const c=ba.json_to_sheet(t),u=ba.book_new();ba.book_append_sheet(u,c,"IngresoFacturacion"),gs(u,"ingreso_facturacion.xlsx")};return n.jsxs("form",{onSubmit:o,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Desglose Facturacin de Ingresos (Rep. 1)"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"--Ingresa los datos para consulta:--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-4",children:[n.jsx(Se,{label:"Mes:",name:"mes",value:e.mes,onChange:i,options:it}),n.jsx(J,{label:"Alm:",name:"almacen",value:e.almacen,onChange:i,placeholder:"Almacn"}),n.jsx(J,{label:"Fecha:",name:"fecha",type:"date",value:e.fecha,onChange:i}),n.jsx(Se,{label:"*Empresa:",name:"empresa",value:e.empresa,onChange:i,options:Ma,required:!0})]}),n.jsxs("div",{className:"mt-6 flex justify-start space-x-3",children:[n.jsx(fe,{type:"submit",variant:"primary",children:"Buscar"}),n.jsx(fe,{type:"button",onClick:l,variant:"secondary",children:"Excel"})]})]}),n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px]",children:t.length===0?n.jsx("div",{className:"flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados del reporte aparecern aqu."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-sm text-left",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Folio"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Mes"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Almacn"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Empresa"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Monto"})]})}),n.jsx("tbody",{children:t.map((c,u)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:c.folio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:c.mes}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:c.almacen}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:c.fecha}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:c.empresa}),n.jsxs("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:["$",c.monto.toFixed(2)]})]},u))})]})})})]})};var d2;const MM={fecha:"",tiendas:[],todasTiendas:!1,tiposFacturaGlobal:[],todosTiposFactura:!1,empresa:((d2=Ma[Ma.length-1])==null?void 0:d2.value)||""},UM=()=>{const[e,a]=N.useState(MM),[t,r]=N.useState([]),s=[{folio:"IFG-001",fecha:"2024-06-01",tienda:"Sucursal 1",tipoFactura:"CON",empresa:"Empresa A",monto:5e3},{folio:"IFG-002",fecha:"2024-06-01",tienda:"Sucursal 2",tipoFactura:"DEV",empresa:"Empresa B",monto:3200.5},{folio:"IFG-003",fecha:"2024-06-01",tienda:"Sucursal 3",tipoFactura:"CRE",empresa:"Empresa C",monto:2100}],i=(d,f,m)=>{a(x=>{const h=x[d],g=m?[...h,f]:h.filter(p=>p!==f);return{...x,[d]:g}})},o=(d,f,m,x)=>{a(h=>({...h,[f]:x,[d]:x?m.map(g=>g.value):[]}))},l=d=>{const{name:f,value:m}=d.target;a(x=>({...x,[f]:m}))},c=d=>{d.preventDefault(),r(s),console.log("Buscar Integracin Factura Global (Rep. 2):",e)},u=()=>{if(t.length===0){alert("No hay datos para exportar.");return}const d=ba.json_to_sheet(t),f=ba.book_new();ba.book_append_sheet(f,d,"IntegracionFacturaGlobal"),gs(f,"integracion_factura_global.xlsx")};return n.jsxs("form",{onSubmit:c,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Integracin Factura Global (Rep. 2)"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"--Ingresa los datos para consulta:--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4",children:[n.jsx(J,{label:"*Fecha:",name:"fecha",type:"date",value:e.fecha,onChange:l,required:!0}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tienda:"}),n.jsx("div",{className:"border border-gray-300 dark:border-gray-600 rounded-md p-2 h-32 overflow-y-auto",children:Sn.map(d=>n.jsx(ta,{label:d.label,name:`tienda-${d.value}`,checked:e.tiendas.includes(d.value),onChange:f=>i("tiendas",d.value,f.target.checked)},d.value))}),n.jsx(ta,{label:"Todas",name:"todasTiendas",checked:e.todasTiendas,onChange:d=>o("tiendas","todasTiendas",Sn,d.target.checked),className:"mt-1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tipo Factura Global:"}),n.jsx("div",{className:"border border-gray-300 dark:border-gray-600 rounded-md p-2 h-32 overflow-y-auto",children:Cn.map(d=>n.jsx(ta,{label:d.label,name:`tipoFacturaGlobal-${d.value}`,checked:e.tiposFacturaGlobal.includes(d.value),onChange:f=>i("tiposFacturaGlobal",d.value,f.target.checked)},d.value))}),n.jsx(ta,{label:"Todos",name:"todosTiposFactura",checked:e.todosTiposFactura,onChange:d=>o("tiposFacturaGlobal","todosTiposFactura",Cn,d.target.checked),className:"mt-1"})]}),n.jsx(Se,{label:"*Empresa:",name:"empresa",value:e.empresa,onChange:l,options:Ma,required:!0,className:"self-start"})]}),n.jsxs("div",{className:"mt-6 flex justify-start space-x-3",children:[n.jsx(fe,{type:"submit",variant:"primary",children:"Buscar"}),n.jsx(fe,{type:"button",onClick:u,variant:"secondary",children:"Excel"})]})]}),n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px]",children:t.length===0?n.jsx("div",{className:"flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados del reporte aparecern aqu."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-sm text-left",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Folio"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tienda"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tipo Factura"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Empresa"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Monto"})]})}),n.jsx("tbody",{children:t.map((d,f)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:d.folio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:d.fecha}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:d.tienda}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:d.tipoFactura}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:d.empresa}),n.jsxs("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:["$",d.monto.toFixed(2)]})]},f))})]})})})]})};var u2,f2;const LM={mes:((u2=it[it.length-1])==null?void 0:u2.value)||"",porOperacion:!1,anio:new Date().getFullYear().toString(),tiposFacturaGlobal:[],todasTiposFacturaGlobal:!1,tiposCfdi:[],todosTiposCfdi:!1,empresa:((f2=Ma[Ma.length-1])==null?void 0:f2.value)||"",fechaOperacion:"",fechaFacturacion:"",tiendas:[],todasTiendas:!1},BM=()=>{const[e,a]=N.useState(LM),[t,r]=N.useState([]),s=[{folio:"IC-001",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 1",tipoFactura:"CON",tipoCfdi:"I",empresa:"Empresa A",monto:7e3},{folio:"IC-002",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 2",tipoFactura:"DEV",tipoCfdi:"E",empresa:"Empresa B",monto:4200.5},{folio:"IC-003",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 3",tipoFactura:"CRE",tipoCfdi:"I",empresa:"Empresa C",monto:3100}],i=f=>{const{name:m,value:x,type:h}=f.target;if(!(h==="checkbox"&&m!=="porOperacion"&&!m.startsWith("todas")))if(h==="checkbox"){const{checked:g}=f.target;a(p=>({...p,[m]:g}))}else a(g=>({...g,[m]:x}))},o=(f,m,x)=>{a(h=>{const g=h[f],p=x?[...g,m]:g.filter(v=>v!==m);return{...h,[f]:p}})},l=(f,m,x,h)=>{a(g=>({...g,[m]:h,[f]:h?x.map(p=>p.value):[]}))},c=f=>{f.preventDefault(),r(s),console.log("Buscar Integracin Clientes (Rep. 3):",e)},u=()=>{if(t.length===0){alert("No hay datos para exportar.");return}const f=ba.json_to_sheet(t),m=ba.book_new();ba.book_append_sheet(m,f,"IntegracionClientes"),gs(m,"integracion_clientes.xlsx")},d="border border-gray-300 dark:border-gray-600 rounded-md p-2 h-24 overflow-y-auto text-sm";return n.jsxs("form",{onSubmit:c,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Integracin Clientes (Rep. 3)"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"--Ingresa los datos para consulta:--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4",children:[n.jsxs("div",{className:"flex items-end space-x-2",children:[n.jsx(Se,{label:"Mes:",name:"mes",value:e.mes,onChange:i,options:it,className:"flex-grow"}),n.jsx(ta,{label:"por Operacion",name:"porOperacion",checked:e.porOperacion,onChange:i,className:"pb-1"})]}),n.jsx(J,{label:"Fecha Operacin:",name:"fechaOperacion",type:"date",value:e.fechaOperacion,onChange:i}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tienda:"}),n.jsx("div",{className:d,children:Sn.map(f=>n.jsx(ta,{label:f.label,name:`tienda-${f.value}`,checked:e.tiendas.includes(f.value),onChange:m=>o("tiendas",f.value,m.target.checked)},f.value))}),n.jsx(ta,{label:"Todas",name:"todasTiendas",checked:e.todasTiendas,onChange:f=>l("tiendas","todasTiendas",Sn,f.target.checked),className:"mt-1"})]}),n.jsx(J,{label:"Ao:",name:"anio",value:e.anio,onChange:i,placeholder:"AAAA",maxLength:4}),n.jsx(J,{label:"Fecha Facturacin:",name:"fechaFacturacion",type:"date",value:e.fechaFacturacion,onChange:i}),n.jsx("div",{}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tipo Factura Global:"}),n.jsx("div",{className:d,children:Cn.map(f=>n.jsx(ta,{label:f.label,name:`tipoFacturaGlobal-${f.value}`,checked:e.tiposFacturaGlobal.includes(f.value),onChange:m=>o("tiposFacturaGlobal",f.value,m.target.checked)},f.value))}),n.jsx(ta,{label:"Todos",name:"todasTiposFacturaGlobal",checked:e.todasTiposFacturaGlobal,onChange:f=>l("tiposFacturaGlobal","todasTiposFacturaGlobal",Cn,f.target.checked),className:"mt-1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tipo CFDI:"}),n.jsx("div",{className:d,children:P0.map(f=>n.jsx(ta,{label:f.label,name:`tipoCfdi-${f.value}`,checked:e.tiposCfdi.includes(f.value),onChange:m=>o("tiposCfdi",f.value,m.target.checked)},f.value))}),n.jsx(ta,{label:"Todos",name:"todosTiposCfdi",checked:e.todosTiposCfdi,onChange:f=>l("tiposCfdi","todosTiposCfdi",P0,f.target.checked),className:"mt-1"})]}),n.jsx(Se,{label:"*Empresa:",name:"empresa",value:e.empresa,onChange:i,options:Ma,required:!0,className:"self-start"})]}),n.jsxs("div",{className:"mt-6 flex justify-start space-x-3",children:[n.jsx(fe,{type:"submit",variant:"primary",children:"Buscar"}),n.jsx(fe,{type:"button",onClick:u,variant:"secondary",children:"Excel"})]})]}),n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px]",children:t.length===0?n.jsx("div",{className:"flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados del reporte aparecern aqu."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-sm text-left",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Folio"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha Operacin"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha Facturacin"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tienda"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tipo Factura"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tipo CFDI"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Empresa"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Monto"})]})}),n.jsx("tbody",{children:t.map((f,m)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.folio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.fechaOperacion}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.fechaFacturacion}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.tienda}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.tipoFactura}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.tipoCfdi}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.empresa}),n.jsxs("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:["$",f.monto.toFixed(2)]})]},m))})]})})})]})};var m2,x2;const zM={mes:((m2=it[it.length-1])==null?void 0:m2.value)||"",porOperacion:!1,anio:new Date().getFullYear().toString(),empresa:((x2=Ma[Ma.length-1])==null?void 0:x2.value)||"",tiposFacturaGlobal:[],todasTiposFacturaGlobal:!1,fechaOperacion:"",fechaFacturacion:"",tiendas:[],todasTiendas:!1},$M=()=>{const[e,a]=N.useState(zM),[t,r]=N.useState([]),s=[{folio:"FCG-001",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 1",tipoFactura:"CON",empresa:"Empresa A",monto:9e3},{folio:"FCG-002",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 2",tipoFactura:"DEV",empresa:"Empresa B",monto:6100.5},{folio:"FCG-003",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 3",tipoFactura:"EMON",empresa:"Empresa C",monto:4100}],i=f=>{const{name:m,value:x,type:h}=f.target;if(!(h==="checkbox"&&m!=="porOperacion"&&!m.startsWith("todas")))if(h==="checkbox"){const{checked:g}=f.target;a(p=>({...p,[m]:g}))}else a(g=>({...g,[m]:x}))},o=(f,m,x)=>{a(h=>{const g=h[f],p=x?[...g,m]:g.filter(v=>v!==m);return{...h,[f]:p}})},l=(f,m,x,h)=>{a(g=>({...g,[m]:h,[f]:h?x.map(p=>p.value):[]}))},c=f=>{f.preventDefault(),r(s),console.log("Buscar Facturacin Clientes Posterior a Global (Rep. 4 y 5):",e)},u=()=>{if(t.length===0){alert("No hay datos para exportar.");return}const f=ba.json_to_sheet(t),m=ba.book_new();ba.book_append_sheet(m,f,"FacturacionClientesGlobal"),gs(m,"facturacion_clientes_global.xlsx")},d="border border-gray-300 dark:border-gray-600 rounded-md p-2 h-24 overflow-y-auto text-sm";return n.jsxs("form",{onSubmit:c,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Integracin Factura Clientes posterior a Global (Rep. 4 y 5)"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"--Ingresa los datos para consulta:--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4",children:[n.jsxs("div",{className:"flex items-end space-x-2",children:[n.jsx(Se,{label:"Mes:",name:"mes",value:e.mes,onChange:i,options:it,className:"flex-grow"}),n.jsx(ta,{label:"por Operacion",name:"porOperacion",checked:e.porOperacion,onChange:i,className:"pb-1"})]}),n.jsx(J,{label:"Fecha Operacin:",name:"fechaOperacion",type:"date",value:e.fechaOperacion,onChange:i}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tienda:"}),n.jsx("div",{className:d,children:Sn.map(f=>n.jsx(ta,{label:f.label,name:`tienda-${f.value}`,checked:e.tiendas.includes(f.value),onChange:m=>o("tiendas",f.value,m.target.checked)},f.value))}),n.jsx(ta,{label:"Todas",name:"todasTiendas",checked:e.todasTiendas,onChange:f=>l("tiendas","todasTiendas",Sn,f.target.checked),className:"mt-1"})]}),n.jsx(J,{label:"Ao:",name:"anio",value:e.anio,onChange:i,placeholder:"AAAA",maxLength:4}),n.jsx(J,{label:"Fecha Facturacin:",name:"fechaFacturacion",type:"date",value:e.fechaFacturacion,onChange:i}),n.jsx("div",{})," ",n.jsx(Se,{label:"*Empresa:",name:"empresa",value:e.empresa,onChange:i,options:Ma,required:!0,className:"self-start"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tipo Factura Global:"}),n.jsx("div",{className:d,children:Cn.map(f=>n.jsx(ta,{label:f.label,name:`tipoFacturaGlobal-${f.value}`,checked:e.tiposFacturaGlobal.includes(f.value),onChange:m=>o("tiposFacturaGlobal",f.value,m.target.checked)},f.value))}),n.jsx(ta,{label:"Todos",name:"todasTiposFacturaGlobal",checked:e.todasTiposFacturaGlobal,onChange:f=>l("tiposFacturaGlobal","todasTiposFacturaGlobal",Cn,f.target.checked),className:"mt-1"})]})]}),n.jsxs("div",{className:"mt-6 flex justify-start space-x-3",children:[n.jsx(fe,{type:"submit",variant:"primary",children:"Buscar"}),n.jsx(fe,{type:"button",onClick:u,variant:"secondary",children:"Excel"})]})]}),n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px]",children:t.length===0?n.jsx("div",{className:"flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados del reporte aparecern aqu."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-sm text-left",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Folio"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha Operacin"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha Facturacin"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tienda"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tipo Factura"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Empresa"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Monto"})]})}),n.jsx("tbody",{children:t.map((f,m)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.folio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.fechaOperacion}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.fechaFacturacion}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.tienda}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.tipoFactura}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.empresa}),n.jsxs("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:["$",f.monto.toFixed(2)]})]},m))})]})})})]})};var h2,p2;const VM={mes:((h2=it[it.length-1])==null?void 0:h2.value)||"",porOperacion:!1,anio:new Date().getFullYear().toString(),empresa:((p2=Ma[Ma.length-1])==null?void 0:p2.value)||"",tiposFacturaGlobal:[],todasTiposFacturaGlobal:!1,tiposCfdi:[],todosTiposCfdi:!1,uuid:"",fechaOperacion:"",fechaFacturacion:"",tiendas:[],todasTiendas:!1},HM=()=>{const[e,a]=N.useState(VM),[t,r]=N.useState([]),s=[{folio:"ISC-001",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 1",tipoFactura:"CON",tipoCfdi:"I",uuid:"UUID-001",empresa:"Empresa A",monto:8e3},{folio:"ISC-002",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 2",tipoFactura:"DEV",tipoCfdi:"E",uuid:"UUID-002",empresa:"Empresa B",monto:5200.5},{folio:"ISC-003",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 3",tipoFactura:"EMON",tipoCfdi:"I",uuid:"UUID-003",empresa:"Empresa C",monto:3100}],i=f=>{const{name:m,value:x,type:h}=f.target;if(!(h==="checkbox"&&m!=="porOperacion"&&!m.startsWith("todas")))if(h==="checkbox"){const{checked:g}=f.target;a(p=>({...p,[m]:g}))}else a(g=>({...g,[m]:x}))},o=(f,m,x)=>{a(h=>{const g=h[f],p=x?[...g,m]:g.filter(v=>v!==m);return{...h,[f]:p}})},l=(f,m,x,h)=>{a(g=>({...g,[m]:h,[f]:h?x.map(p=>p.value):[]}))},c=f=>{f.preventDefault(),r(s),console.log("Buscar Integracin Sustitucin CFDI (Rep. 6,7,8):",e)},u=()=>{if(t.length===0){alert("No hay datos para exportar.");return}const f=ba.json_to_sheet(t),m=ba.book_new();ba.book_append_sheet(m,f,"IntegracionSustitucionCFDI"),gs(m,"integracion_sustitucion_cfdi.xlsx")},d="border border-gray-300 dark:border-gray-600 rounded-md p-2 h-24 overflow-y-auto text-sm";return n.jsxs("form",{onSubmit:c,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Integracin Sustitucin CFDI por periodos (Rep. 6, 7 y 8)"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"--Ingresa los datos para consulta:--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4",children:[n.jsxs("div",{className:"flex items-end space-x-2",children:[n.jsx(Se,{label:"Mes:",name:"mes",value:e.mes,onChange:i,options:it,className:"flex-grow"}),n.jsx(ta,{label:"por Operacion",name:"porOperacion",checked:e.porOperacion,onChange:i,className:"pb-1"})]}),n.jsx(J,{label:"Fecha Operacin:",name:"fechaOperacion",type:"date",value:e.fechaOperacion,onChange:i}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tienda:"}),n.jsx("div",{className:d,children:Sn.map(f=>n.jsx(ta,{label:f.label,name:`tienda-${f.value}`,checked:e.tiendas.includes(f.value),onChange:m=>o("tiendas",f.value,m.target.checked)},f.value))}),n.jsx(ta,{label:"Todas",name:"todasTiendas",checked:e.todasTiendas,onChange:f=>l("tiendas","todasTiendas",Sn,f.target.checked),className:"mt-1"})]}),n.jsx(J,{label:"Ao:",name:"anio",value:e.anio,onChange:i,placeholder:"AAAA",maxLength:4}),n.jsx(J,{label:"Fecha Facturacin:",name:"fechaFacturacion",type:"date",value:e.fechaFacturacion,onChange:i}),n.jsx("div",{})," ",n.jsx(Se,{label:"*Empresa:",name:"empresa",value:e.empresa,onChange:i,options:Ma,required:!0,className:"self-start"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tipo Factura Global:"}),n.jsx("div",{className:d,children:Cn.map(f=>n.jsx(ta,{label:f.label,name:`tipoFacturaGlobal-${f.value}`,checked:e.tiposFacturaGlobal.includes(f.value),onChange:m=>o("tiposFacturaGlobal",f.value,m.target.checked)},f.value))}),n.jsx(ta,{label:"Todos",name:"todasTiposFacturaGlobal",checked:e.todasTiposFacturaGlobal,onChange:f=>l("tiposFacturaGlobal","todasTiposFacturaGlobal",Cn,f.target.checked),className:"mt-1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tipo CFDI:"}),n.jsx("div",{className:d,children:P0.map(f=>n.jsx(ta,{label:f.label,name:`tipoCfdi-${f.value}`,checked:e.tiposCfdi.includes(f.value),onChange:m=>o("tiposCfdi",f.value,m.target.checked)},f.value))}),n.jsx(ta,{label:"Todos",name:"todosTiposCfdi",checked:e.todosTiposCfdi,onChange:f=>l("tiposCfdi","todosTiposCfdi",P0,f.target.checked),className:"mt-1"})]}),n.jsx(ys,{label:"UUID:",name:"uuid",value:e.uuid,onChange:i,rows:2,placeholder:"Ingrese UUID(s)",className:"lg:col-span-2"})]}),n.jsxs("div",{className:"mt-6 flex justify-start space-x-3",children:[n.jsx(fe,{type:"submit",variant:"primary",children:"Buscar"}),n.jsx(fe,{type:"button",onClick:u,variant:"secondary",children:"Excel"})]})]}),n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px]",children:t.length===0?n.jsx("div",{className:"flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados del reporte aparecern aqu."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-sm text-left",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Folio"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha Operacin"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha Facturacin"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tienda"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tipo Factura"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tipo CFDI"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"UUID"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Empresa"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Monto"})]})}),n.jsx("tbody",{children:t.map((f,m)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.folio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.fechaOperacion}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.fechaFacturacion}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.tienda}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.tipoFactura}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.tipoCfdi}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.uuid}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:f.empresa}),n.jsxs("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:["$",f.monto.toFixed(2)]})]},m))})]})})})]})};var g2,y2;const GM={mes:((g2=it[it.length-1])==null?void 0:g2.value)||"",anio:new Date().getFullYear().toString(),empresa:((y2=Ma[Ma.length-1])==null?void 0:y2.value)||""},XM=()=>{const[e,a]=N.useState(GM),[t,r]=N.useState([]),s=[{folio:"REP-001",mes:"Junio",anio:"2024",empresa:"Empresa A",total:5},{folio:"REP-002",mes:"Junio",anio:"2024",empresa:"Empresa B",total:3},{folio:"REP-003",mes:"Junio",anio:"2024",empresa:"Empresa C",total:7}],i=l=>{const{name:c,value:u}=l.target;a(d=>({...d,[c]:u}))},o=l=>{l.preventDefault(),r(s),console.log("Buscar Control de Emisin de REP:",e)};return n.jsxs("form",{onSubmit:o,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Reporte control de emisin de Recibo Electrnico de Pago (REP)"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"--Ingresa los datos para consulta:--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4",children:[n.jsx(Se,{label:"Mes:",name:"mes",value:e.mes,onChange:i,options:it}),n.jsx(J,{label:"Ao:",name:"anio",value:e.anio,onChange:i,placeholder:"AAAA",maxLength:4}),n.jsx(Se,{label:"*Empresa:",name:"empresa",value:e.empresa,onChange:i,options:Ma,required:!0})]}),n.jsx("div",{className:"mt-6 flex justify-start",children:n.jsx(fe,{type:"submit",variant:"primary",children:"Buscar"})})]}),n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px]",children:t.length===0?n.jsx("div",{className:"flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados del reporte aparecern aqu."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-sm text-left",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Folio"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Mes"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Ao"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Empresa"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Total REP"})]})}),n.jsx("tbody",{children:t.map((l,c)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:l.folio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:l.mes}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:l.anio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:l.empresa}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:l.total})]},c))})]})})})]})},qM={fechaSolicitud:new Date().toISOString().split("T")[0]},YM=()=>{const[e,a]=N.useState(qM),[t,r]=N.useState([]),s=[{folio:"GCP-001",fechaSolicitud:"2024-06-01",estatus:"Procesado",monto:1e3},{folio:"GCP-002",fechaSolicitud:"2024-06-01",estatus:"Pendiente",monto:2e3},{folio:"GCP-003",fechaSolicitud:"2024-06-01",estatus:"Procesado",monto:1500}],i=c=>{a({...e,[c.target.name]:c.target.value})},o=c=>{c.preventDefault(),r(s),console.log("Guardar Fecha REPgcp:",e)},l=()=>{if(t.length===0){alert("No hay datos para exportar.");return}const c=ba.json_to_sheet(t),u=ba.book_new();ba.book_append_sheet(u,c,"REPgcp"),gs(u,"repgcp.xlsx")};return n.jsxs("form",{onSubmit:o,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"--Especificar Fecha--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 items-end",children:[n.jsx(J,{label:"Fecha de Solicitud:",name:"fechaSolicitud",type:"date",value:e.fechaSolicitud,onChange:i}),n.jsx("div",{className:"flex justify-start",children:n.jsx(fe,{type:"submit",variant:"primary",children:"Guardar Fecha"})})]})]}),n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px]",children:t.length===0?n.jsx("div",{className:"flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados o confirmaciones aparecern aqu."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-sm text-left",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Folio"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha Solicitud"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Estatus"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Monto"})]})}),n.jsx("tbody",{children:t.map((c,u)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:c.folio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:c.fechaSolicitud}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:c.estatus}),n.jsxs("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:["$",c.monto.toFixed(2)]})]},u))})]})})}),n.jsx("div",{className:"mt-4 flex justify-end",children:n.jsx(fe,{type:"button",onClick:l,variant:"secondary",children:"Excel"})})]})},Jy={versionSistemaFacturacion:"",descripcionNuevaVersion:"",versionBroker:"",fechaVersion:new Date().toISOString().split("T")[0]},Od=10,WM=()=>{const[e,a]=N.useState(Jy),[t,r]=N.useState(dC),[s,i]=N.useState(1),[o,l]=N.useState(""),[c,u]=N.useState(""),d=y=>{a({...e,[y.target.name]:y.target.value})},f=N.useMemo(()=>t.filter(y=>{const j=y.versionSistema.toLowerCase().includes(o.toLowerCase())||y.versionBroker.toLowerCase().includes(o.toLowerCase())||y.descripcion.toLowerCase().includes(o.toLowerCase()),A=!c||y.versionSistema===c;return j&&A}),[t,o,c]),m=Math.ceil(f.length/Od),x=(s-1)*Od,h=f.slice(x,x+Od),g=y=>{y.preventDefault();const j={id:`v${t.length+1}-${Date.now()}`,versionSistema:e.versionSistemaFacturacion,versionBroker:e.versionBroker,descripcion:e.descripcionNuevaVersion,fechaVersion:new Date(e.fechaVersion).toLocaleString("sv-SE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})+".0"};r([j,...t]),a(Jy),alert("Nueva versin creada (simulado).")},p=y=>{r(t.filter(j=>j.id!==y)),alert(`Versin ${y} eliminada (simulado).`)},v=y=>{i(y)},w=()=>{l(""),u(""),i(1)},b=N.useMemo(()=>{const y=new Set(t.map(j=>j.versionSistema));return Array.from(y)},[t]);return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"--Crear nueva versin--"}),n.jsxs("form",{onSubmit:g,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx(J,{label:"Versin del sistema de facturacin:",name:"versionSistemaFacturacion",value:e.versionSistemaFacturacion,onChange:d,required:!0}),n.jsx(J,{label:"Versin del broker:",name:"versionBroker",value:e.versionBroker,onChange:d,required:!0,className:"mt-4"}),n.jsx(J,{label:"Fecha de la versin:",name:"fechaVersion",type:"date",value:e.fechaVersion,onChange:d,required:!0,className:"mt-4"})]}),n.jsx(ys,{label:"Descripcin de la nueva versin:",name:"descripcionNuevaVersion",value:e.descripcionNuevaVersion,onChange:d,rows:6,required:!0})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx(fe,{type:"submit",variant:"primary",children:"Crear"})})]})]}),n.jsxs(ve,{children:[n.jsx("div",{className:"mb-6 space-y-4",children:n.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[n.jsx("div",{className:"flex-1",children:n.jsx(J,{label:"Buscar:",type:"text",value:o,onChange:y=>{l(y.target.value),i(1)},placeholder:"Buscar por versin, broker o descripcin...",leftIcon:n.jsx(Pn,{className:"w-5 h-5 text-gray-400"})})}),n.jsx("div",{className:"w-full md:w-48",children:n.jsxs(J,{label:"Filtrar por versin:",type:"select",value:c,onChange:y=>{u(y.target.value),i(1)},children:[n.jsx("option",{value:"",children:"Todas las versiones"}),b.map(y=>n.jsx("option",{value:y,children:y},y))]})}),(o||c)&&n.jsx(fe,{type:"button",variant:"neutral",onClick:w,className:"mb-2",children:"Limpiar filtros"})]})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Historial de Cambios"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Identificador"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Versin Sistema Facturacin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Versin Broker"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Descripcin de cambios"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Versin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Eliminar"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:h.map(y=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:y.id}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:y.versionSistema}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:y.versionBroker}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200 max-w-xs truncate hover:whitespace-normal",title:y.descripcion,children:y.descripcion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:y.fechaVersion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx("button",{onClick:()=>p(y.id),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-500 p-1","aria-label":`Eliminar versin ${y.id}`,children:n.jsx(Xs,{className:"w-5 h-5"})})})]},y.id))})]})}),f.length===0&&n.jsx("p",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:o||c?"No se encontraron resultados para la bsqueda":"No hay versiones registradas."}),f.length>0&&n.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-between items-center gap-3",children:[n.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Mostrando ",x+1," a ",Math.min(x+Od,f.length)," de ",f.length," resultados"]}),n.jsxs("div",{className:"flex justify-center space-x-2",children:[n.jsx(fe,{variant:"neutral",onClick:()=>v(s-1),disabled:s===1,children:"Anterior"}),Array.from({length:m},(y,j)=>j+1).map(y=>n.jsx(fe,{variant:s===y?"primary":"neutral",onClick:()=>v(y),children:y},y)),n.jsx(fe,{variant:"neutral",onClick:()=>v(s+1),disabled:s===m,children:"Siguiente"})]})]})]})]})};var v2;const Zy={tipoDocumento:((v2=ax[0])==null?void 0:v2.value)||"",fechaDocumento:new Date().toISOString().split("T")[0],archivo:null},KM=()=>{const[e,a]=N.useState(Zy),[t,r]=N.useState(uC),[s,i]=N.useState(""),[o,l]=N.useState(""),[c,u]=N.useState(""),[d,f]=N.useState(1),m=10,x=N.useMemo(()=>t.filter(F=>{const k=s===""||F.identificador.toLowerCase().includes(s.toLowerCase())||F.nombre.toLowerCase().includes(s.toLowerCase())||F.usuario.toLowerCase().includes(s.toLowerCase()),P=o===""||F.tipo===o,R=c===""||F.estatus===c;return k&&P&&R}),[t,s,o,c]),h=Math.ceil(x.length/m),g=N.useMemo(()=>{const F=(d-1)*m;return x.slice(F,F+m)},[x,d]),p=N.useMemo(()=>Array.from(new Set(t.map(k=>k.tipo))).map(k=>({value:k,label:k})),[t]),v=N.useMemo(()=>Array.from(new Set(t.map(k=>k.estatus))).map(k=>({value:k,label:k})),[t]),w=F=>{a({...e,[F.target.name]:F.target.value})},b=F=>{a({...e,archivo:F})},y=F=>{var P;if(F.preventDefault(),!e.archivo){alert("Por favor, seleccione un archivo.");return}const k={id:`doc${Date.now()}`,identificador:`ID-${Math.random().toString(36).substring(2,7).toUpperCase()}`,tipo:((P=ax.find(R=>R.value===e.tipoDocumento))==null?void 0:P.label)||e.tipoDocumento,nombre:e.archivo.name,fechaArchivo:e.fechaDocumento,usuario:"currentUser",estatus:"Pendiente",fechaCarga:new Date().toISOString().split("T")[0],fechaValidacion:""};r([k,...t]),a(Zy),alert("Documento cargado para conciliacin (simulado).")},j=F=>{r(t.filter(k=>k.id!==F)),alert(`Documento ${F} eliminado (simulado).`)},A=()=>{i(""),l(""),u(""),f(1)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Favor de no subir archivos mayores a 9.5 Megas, si su archivo supera esa cantidad favor de dividirlos, recuerde incluir el encabezado en cada uno de los archivos."}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"--Cargar nuevo documento--"}),n.jsx("form",{onSubmit:y,className:"space-y-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-end",children:[n.jsx(Se,{label:"Tipo de documento:",name:"tipoDocumento",value:e.tipoDocumento,onChange:w,options:ax,required:!0}),n.jsx(J,{label:"Fecha del documento:",name:"fechaDocumento",type:"date",value:e.fechaDocumento,onChange:w,required:!0}),n.jsx("div",{}),n.jsx(bk,{label:"Archivo:",name:"archivo",onChange:b,accept:".xml,.txt,.csv,.xlsx",helpText:"Seleccione el archivo XML, TXT, etc.",className:"md:col-span-2"}),n.jsx(fe,{type:"submit",variant:"primary",className:"self-end",children:"Cargar archivo"})]})})]}),n.jsxs(ve,{children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Documentos Cargados"}),n.jsxs("div",{className:"flex flex-col md:flex-row gap-4 w-full md:w-auto",children:[n.jsxs("div",{className:"relative flex-grow md:flex-grow-0",children:[n.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre o usuario...",value:s,onChange:F=>i(F.target.value),className:"pl-10 pr-4 py-2 w-full border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),n.jsx(Pn,{className:"absolute left-3 top-2.5 w-5 h-5 text-gray-400"})]}),n.jsx(Se,{label:"",placeholder:"Filtrar por tipo",value:o,onChange:F=>l(F.target.value),options:[{value:"",label:"Todos los tipos"},...p],className:"w-full md:w-48"}),n.jsx(Se,{label:"",placeholder:"Filtrar por estatus",value:c,onChange:F=>u(F.target.value),options:[{value:"",label:"Todos los estatus"},...v],className:"w-full md:w-48"}),n.jsx(fe,{variant:"secondary",onClick:A,className:"w-full md:w-auto",children:"Limpiar filtros"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Identificador"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tipo"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Nombre"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Archivo"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Usuario"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Estatus"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Carga"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Fecha Validacin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Eliminar"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:g.map(F=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:F.identificador}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:F.tipo}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200 truncate max-w-xs",title:F.nombre,children:F.nombre}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:F.fechaArchivo}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:F.usuario}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:F.estatus}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:F.fechaCarga}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:F.fechaValidacion}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:n.jsx("button",{onClick:()=>j(F.id),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-500 p-1","aria-label":`Eliminar documento ${F.nombre}`,children:n.jsx(Xs,{className:"w-5 h-5"})})})]},F.id))})]})}),x.length===0&&n.jsx("p",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"No se encontraron documentos que coincidan con los criterios de bsqueda."}),x.length>0&&n.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-between items-center gap-4",children:[n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Mostrando ",(d-1)*m+1," a ",Math.min(d*m,x.length)," de ",x.length," documentos"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(fe,{variant:"secondary",onClick:()=>f(F=>Math.max(F-1,1)),disabled:d===1,children:"Anterior"}),Array.from({length:h},(F,k)=>k+1).map(F=>n.jsx(fe,{variant:F===d?"primary":"secondary",onClick:()=>f(F),children:F},F)),n.jsx(fe,{variant:"secondary",onClick:()=>f(F=>Math.min(F+1,h)),disabled:d===h,children:"Siguiente"})]})]})]})]})};var b2,w2,E2;const JM={mes:((b2=it[it.length-1])==null?void 0:b2.value)||"",porOperacion:!1,anio:new Date().getFullYear().toString(),empresa:((w2=Ma[Ma.length-1])==null?void 0:w2.value)||"",fechaOperacion:"",fechaFacturacion:"",tienda:((E2=Ia[0])==null?void 0:E2.value)||"",todasTiendas:!1,uuidReps:""},ZM=()=>{const[e,a]=N.useState(JM),[t,r]=N.useState([]),s=[{folio:"FRS-001",mes:"Junio",anio:"2024",empresa:"Empresa A",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 1",uuid:"UUID-001",monto:6e3},{folio:"FRS-002",mes:"Junio",anio:"2024",empresa:"Empresa B",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 2",uuid:"UUID-002",monto:3500.5},{folio:"FRS-003",mes:"Junio",anio:"2024",empresa:"Empresa C",fechaOperacion:"2024-06-01",fechaFacturacion:"2024-06-02",tienda:"Sucursal 3",uuid:"UUID-003",monto:2100}],i=u=>{const{name:d,value:f,type:m}=u.target;if(m==="checkbox"){const{checked:x}=u.target;a(h=>({...h,[d]:x}))}else a(x=>({...x,[d]:f}))},o=u=>{u.preventDefault(),r(s),console.log("Buscar REPs Sustituidos (Fiscal):",e)},l=()=>{if(t.length===0){alert("No hay datos para exportar.");return}const u=ba.json_to_sheet(t),d=ba.book_new();ba.book_append_sheet(d,u,"FiscalesRepsSustituidos"),gs(d,"fiscales_reps_sustituidos.xlsx")},c="w-24 text-xs mt-6 text-gray-500 dark:text-gray-400 self-end pb-1 px-1";return n.jsxs("form",{onSubmit:o,className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Reporte de CFDI enviados para Timbrar (REPS Sustituidos)"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"--Ingresa los datos para consulta:--"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4",children:[n.jsxs("div",{className:"flex items-end space-x-2",children:[n.jsx(Se,{label:"Mes:",name:"mes",value:e.mes,onChange:i,options:it,className:"flex-grow"}),n.jsx(ta,{label:"por Operacion",name:"porOperacion",checked:e.porOperacion,onChange:i,className:"pb-1"})]}),n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(J,{label:"Fecha Operacin:",name:"fechaOperacion",type:"date",value:e.fechaOperacion,onChange:i,className:"flex-grow"}),n.jsx("span",{className:c,children:"*prioridad 3"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tienda:"}),n.jsx(Se,{label:"",name:"tienda",value:e.tienda,onChange:i,options:Ia})]}),n.jsx(J,{label:"Ao:",name:"anio",value:e.anio,onChange:i,placeholder:"AAAA",maxLength:4}),n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(J,{label:"Fecha Facturacin:",name:"fechaFacturacion",type:"date",value:e.fechaFacturacion,onChange:i,className:"flex-grow"}),n.jsx("span",{className:c,children:"*prioridad 3"})]}),n.jsx(ta,{label:"Todas",name:"todasTiendas",checked:e.todasTiendas,onChange:i,className:"mt-7"})," ",n.jsx(Se,{label:"*Empresa:",name:"empresa",value:e.empresa,onChange:i,options:Ma,required:!0}),n.jsx("div",{})," ",n.jsx("div",{})," ",n.jsxs("div",{className:"lg:col-span-2 flex items-start space-x-1",children:[n.jsx(ys,{label:"UUID REPs:",name:"uuidReps",value:e.uuidReps,onChange:i,rows:3,className:"flex-grow",placeholder:"Ingrese UUID(s)"}),n.jsx("span",{className:c,children:"*prioridad 5"})]})]}),n.jsxs("div",{className:"mt-6 flex justify-start space-x-3",children:[n.jsx(fe,{type:"submit",variant:"primary",children:"Buscar"}),n.jsx(fe,{type:"button",onClick:l,variant:"secondary",children:"Excel"})]})]}),n.jsx("div",{className:"mt-6 p-4 border border-dashed border-gray-300 dark:border-gray-600 rounded-md min-h-[200px]",children:t.length===0?n.jsx("div",{className:"flex items-center justify-center text-gray-400 dark:text-gray-500",children:"Los resultados del reporte de REPs Sustituidos (Fiscal) aparecern aqu."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full text-sm text-left",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Folio"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Mes"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Ao"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Empresa"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha Operacin"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Fecha Facturacin"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Tienda"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"UUID"}),n.jsx("th",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:"Monto"})]})}),n.jsx("tbody",{children:t.map((u,d)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.folio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.mes}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.anio}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.empresa}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.fechaOperacion}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.fechaFacturacion}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.tienda}),n.jsx("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:u.uuid}),n.jsxs("td",{className:"px-2 py-1 text-gray-700 dark:text-gray-100",children:["$",u.monto.toFixed(2)]})]},d))})]})})})]})},Xf=(e,a,t)=>Array.from({length:e},()=>Math.floor(Math.random()*(t-a+1))+a),QM=({datos:e,etiquetas:a,color:t})=>{const r=Math.max(...e);return n.jsx("div",{className:"flex items-end justify-between h-full w-full",children:e.map((s,i)=>{const o=s/r*100;return n.jsxs("div",{className:"flex flex-col items-center",style:{width:`${100/e.length}%`},children:[n.jsx("div",{className:`w-3/4 ${t}`,style:{height:`${o}%`},title:`${a[i]}: ${s}`}),n.jsx("span",{className:"text-xs mt-2 text-gray-600 dark:text-gray-300 truncate w-full text-center",children:a[i]})]},i)})})},eU=({datos:e,etiquetas:a,colores:t})=>{const r=e.reduce((i,o)=>i+o,0);let s=0;return n.jsxs("div",{className:"flex items-center justify-center h-full w-full",children:[n.jsxs("div",{className:"relative w-32 h-32",children:[n.jsx("svg",{viewBox:"0 0 100 100",className:"w-full h-full",children:e.map((i,o)=>{const l=i/r*100,c=s/r*360;s+=i;const u=s/r*360,d=50+40*Math.cos((c-90)*Math.PI/180),f=50+40*Math.sin((c-90)*Math.PI/180),m=50+40*Math.cos((u-90)*Math.PI/180),x=50+40*Math.sin((u-90)*Math.PI/180),h=l>50?1:0;return n.jsx("path",{d:`M 50 50 L ${d} ${f} A 40 40 0 ${h} 1 ${m} ${x} Z`,fill:t[o%t.length],stroke:"#fff",strokeWidth:"0.5"},o)})}),n.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm font-semibold",children:r})]}),n.jsx("div",{className:"ml-4 space-y-1",children:a.map((i,o)=>n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-3 h-3 mr-2",style:{backgroundColor:t[o%t.length]}}),n.jsxs("span",{className:"text-xs",children:[i,": ",e[o]]})]},o))})]})},aU=({datos:e,etiquetas:a,color:t})=>{const r=Math.max(...e),s=e.map((i,o)=>{const l=o/(e.length-1)*100,c=100-i/r*100;return`${l},${c}`}).join(" ");return n.jsxs("div",{className:"h-full w-full relative",children:[n.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full",preserveAspectRatio:"none",children:[n.jsx("polyline",{points:s,fill:"none",stroke:t,strokeWidth:"2"}),e.map((i,o)=>{const l=o/(e.length-1)*100,c=100-i/r*100;return n.jsxs("g",{children:[n.jsx("circle",{cx:l,cy:c,r:"2",fill:"white",stroke:t,strokeWidth:"1"}),n.jsx("text",{x:l,y:c-5,textAnchor:"middle",fontSize:"3",fill:"#333",opacity:"0",className:"hover:opacity-100 transition-opacity duration-200",children:`${a[o]}: ${i}`})]},o)})]}),n.jsx("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-2",children:a.map((i,o)=>n.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:i},o))})]})},tU=()=>{const[e,a]=N.useState(""),[t,r]=N.useState("5"),[s,i]=N.useState({generados:{datos:[],etiquetas:[]},cancelados:{datos:[],etiquetas:[]},sustituidos:{datos:[],etiquetas:[]}}),o=()=>{const c=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],u=["Lun","Mar","Mi","Jue","Vie","Sb","Dom"],d=["Facturas","Boletas","REPs","Notas"];i({generados:{datos:Xf(12,50,200),etiquetas:c},cancelados:{datos:Xf(4,10,50),etiquetas:d},sustituidos:{datos:Xf(7,5,30),etiquetas:u}})};N.useEffect(()=>{o();const c=setInterval(()=>{o()},parseInt(t)*1e3);return()=>clearInterval(c)},[t]);const l=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#6366F1","#14B8A6"];return n.jsxs("div",{className:"space-y-6",children:[n.jsx(ve,{children:n.jsxs("form",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm font-semibold text-primary dark:text-secondary whitespace-nowrap mb-0",children:"Fecha de Grficas:"}),n.jsx("input",{type:"date",value:e,onChange:c=>a(c.target.value),className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm font-semibold text-primary dark:text-secondary whitespace-nowrap mb-0",children:"Tiempo de refresco:"}),n.jsxs("select",{value:t,onChange:c=>r(c.target.value),className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100 w-24",children:[n.jsx("option",{value:"5",children:"5"}),n.jsx("option",{value:"10",children:"10"}),n.jsx("option",{value:"15",children:"15"}),n.jsx("option",{value:"30",children:"30"})]})]})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx(fe,{type:"button",variant:"primary",onClick:o,children:"Actualizar"})})]})}),n.jsxs(ve,{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Grfica de Bitcoras Generados"}),n.jsx("div",{className:"h-64 w-full bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-300 dark:border-gray-700",children:s.generados.datos.length>0?n.jsx(QM,{datos:s.generados.datos,etiquetas:s.generados.etiquetas,color:"bg-blue-500"}):n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Cargando datos..."})})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs(ve,{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Grfica de Bitcoras Cancelados"}),n.jsx("div",{className:"h-48 w-full bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-300 dark:border-gray-700",children:s.cancelados.datos.length>0&&n.jsx(eU,{datos:s.cancelados.datos,etiquetas:s.cancelados.etiquetas,colores:l})})]}),n.jsxs(ve,{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Grfica de Bitcoras Sustituidos"}),n.jsx("div",{className:"h-48 w-full bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-300 dark:border-gray-700",children:s.sustituidos.datos.length>0&&n.jsx(aU,{datos:s.sustituidos.datos,etiquetas:s.sustituidos.etiquetas,color:"#F59E0B"})})]})]})]})},Ex=({value:e,onChange:a,options:t,className:r})=>n.jsx("select",{value:e,onChange:s=>a(s.target.value),className:`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary ${r}`,children:t.map(s=>n.jsx("option",{value:s.value,children:s.label},s.value))}),Qy=[{id:"BIT001",nombre:"Actualizacin de factura",modulo:"Facturacin",fecha:"2023-10-15T14:30:00",operacion:"Actualizar",estatus:"Completado",usuario:"admin@cibercom.com",detalles:"Se actualiz el RFC del cliente en la factura F001-2023."},{id:"BIT002",nombre:"Creacin de usuario",modulo:"Administracin",fecha:"2023-10-14T09:15:00",operacion:"Crear",estatus:"Completado",usuario:"supervisor@cibercom.com",detalles:"Se cre el usuario para el nuevo empleado en el departamento de ventas."},{id:"BIT003",nombre:"Eliminacin de boleta",modulo:"Boletas",fecha:"2023-10-13T16:45:00",operacion:"Eliminar",estatus:"Completado",usuario:"operador@cibercom.com",detalles:"Se elimin la boleta B002-2023 por duplicidad."},{id:"BIT004",nombre:"Generacin de reporte",modulo:"Reportes",fecha:"2023-10-12T11:20:00",operacion:"Crear",estatus:"Completado",usuario:"analista@cibercom.com",detalles:"Se gener el reporte mensual de facturacin para septiembre 2023."},{id:"BIT005",nombre:"Actualizacin de configuracin",modulo:"Configuracin",fecha:"2023-10-11T10:05:00",operacion:"Actualizar",estatus:"Completado",usuario:"admin@cibercom.com",detalles:"Se actualizaron los parmetros de conexin al servicio de timbrado."}],rU=()=>{const[e,a]=N.useState({uuid:"",fechaFinal:"",fechaInicial:"",modulo:"",operacion:"",folio:""}),[t,r]=N.useState([]),[s,i]=N.useState(!1),[o,l]=N.useState({}),c=()=>{let d=[...Qy];e.uuid&&(e.uuid==="BIT001"?d=Qy.filter(f=>f.id==="BIT001"):d=d.filter(f=>f.id.toLowerCase().includes(e.uuid.toLowerCase()))),e.modulo&&(e.modulo.toLowerCase()==="facturacin"?d=d.filter(f=>f.modulo==="Facturacin"):d=d.filter(f=>f.modulo.toLowerCase().includes(e.modulo.toLowerCase()))),e.operacion&&(d=d.filter(f=>f.operacion.toLowerCase()===e.operacion.toLowerCase())),e.folio&&(d=d.filter(f=>f.nombre.toLowerCase().includes(e.folio.toLowerCase()))),e.fechaInicial&&(d=d.filter(f=>new Date(f.fecha)>=new Date(e.fechaInicial))),e.fechaFinal&&(d=d.filter(f=>new Date(f.fecha)<=new Date(e.fechaFinal))),r(d),i(!0)},u=d=>{l(f=>({...f,[d]:!f[d]}))};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(ve,{children:n.jsxs("form",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-semibold text-primary dark:text-secondary",children:"UUID:"}),n.jsx("input",{type:"text",className:"w-full rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:e.uuid,onChange:d=>a({...e,uuid:d.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-semibold text-primary dark:text-secondary",children:"Fecha Final:"}),n.jsx("input",{type:"datetime-local",className:"w-full rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:e.fechaFinal,onChange:d=>a({...e,fechaFinal:d.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-semibold text-primary dark:text-secondary",children:"Fecha Inicial:"}),n.jsx("input",{type:"datetime-local",className:"w-full rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:e.fechaInicial,onChange:d=>a({...e,fechaInicial:d.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-semibold text-primary dark:text-secondary",children:"Mdulo:"}),n.jsx("input",{type:"text",className:"w-full rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:e.modulo,onChange:d=>a({...e,modulo:d.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-semibold text-primary dark:text-secondary",children:"Operacin:"}),n.jsx(Ex,{value:e.operacion,onChange:d=>a({...e,operacion:d}),options:[{value:"",label:"Seleccionar operacin"},{value:"crear",label:"Crear"},{value:"actualizar",label:"Actualizar"},{value:"eliminar",label:"Eliminar"}]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-semibold text-primary dark:text-secondary",children:"Folio:"}),n.jsx("input",{type:"text",className:"w-full rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:e.folio,onChange:d=>a({...e,folio:d.target.value})})]})]}),n.jsx("div",{className:"flex justify-end mt-6",children:n.jsx(fe,{type:"button",variant:"primary",onClick:c,children:"Buscar"})})]})}),s&&n.jsxs(ve,{children:[n.jsx("div",{className:"flex justify-between items-center mb-4",children:n.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Elementos: ",t.length]})}),t.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-primary dark:bg-secondary",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Ms"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Nombre"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Mdulo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Fecha"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Operacin"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Estatus"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(d=>n.jsxs(or.Fragment,{children:[n.jsxs("tr",{className:"hover:bg-gray-100 dark:hover:bg-gray-700",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("button",{onClick:()=>u(d.id),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:o[d.id]?"":""})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.nombre}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.modulo}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:new Date(d.fecha).toLocaleString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${d.operacion==="Crear"?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100":d.operacion==="Actualizar"?"bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100":"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100"}`,children:d.operacion})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100",children:d.estatus})})]}),o[d.id]&&n.jsx("tr",{className:"bg-gray-50 dark:bg-gray-900",children:n.jsx("td",{colSpan:6,className:"px-6 py-4",children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Usuario:"})," ",d.usuario]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Detalles:"})," ",d.detalles]})]})})})]},d.id))})]})}):n.jsx("div",{className:"text-center py-4",children:n.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No se encontraron registros que coincidan con los criterios de bsqueda."})})]})]})},sU=[{value:"GET",label:"GET"},{value:"POST",label:"POST"},{value:"PUT",label:"PUT"},{value:"DELETE",label:"DELETE"}],nU=()=>{const[e,a]=N.useState(""),[t,r]=N.useState("GET"),[s,i]=N.useState(""),[o,l]=N.useState([]),[c,u]=N.useState({key:"",value:""}),d=()=>{},f=(h,g,p)=>{},m=h=>{},x=h=>{};return n.jsx("div",{className:"flex justify-center items-start min-h-[60vh] p-4",children:n.jsxs(ve,{className:"w-full max-w-3xl mx-auto p-8",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Monitorear URL adicional"}),n.jsxs("form",{onSubmit:x,className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold",children:"Ttulo:"}),n.jsx("input",{type:"text",placeholder:"Titulo",className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:e,onChange:h=>a(h.target.value)})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold",children:"Mtodo:"}),n.jsx("select",{className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100 font-bold",value:t,onChange:h=>r(h.target.value),children:sU.map(h=>n.jsx("option",{value:h.value,children:h.label},h.value))})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold",children:"URL:"}),n.jsx("input",{type:"text",placeholder:"URL",className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:s,onChange:h=>i(h.target.value)})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold",children:"Header Key:"}),n.jsx("input",{type:"text",placeholder:"Header Key",className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:c.key,onChange:h=>u({...c,key:h.target.value})})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold",children:"Header Value:"}),n.jsx("input",{type:"text",placeholder:"Header Value",className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:c.value,onChange:h=>u({...c,value:h.target.value})})]}),n.jsx("div",{className:"flex items-end justify-end md:col-span-1",children:n.jsx("button",{type:"button",className:"text-white px-4 py-2 rounded-lg font-semibold",style:{backgroundColor:"var(--color-primary)"},onClick:d,children:"Nuevo Header"})}),o.length>0&&n.jsxs("div",{className:"md:col-span-2 space-y-2",children:[n.jsx("h4",{className:"font-semibold",children:"Headers aadidos:"}),n.jsx("ul",{className:"space-y-2",children:o.map((h,g)=>n.jsxs("li",{className:"flex flex-col md:flex-row gap-2 items-center p-2 border rounded-md",children:[n.jsx("input",{type:"text",value:h.key,onChange:p=>f(g,"key",p.target.value),className:"p-1 rounded border border-gray-300 dark:bg-gray-700 dark:text-gray-100 flex-1"}),n.jsx("span",{className:"mx-1",children:":"}),n.jsx("input",{type:"text",value:h.value,onChange:p=>f(g,"value",p.target.value),className:"p-1 rounded border border-gray-300 dark:bg-gray-700 dark:text-gray-100 flex-1"}),n.jsx("button",{type:"button",className:"text-red-500 font-bold",onClick:()=>m(),children:"X"})]},g))})]})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",className:"text-white px-8 py-3 rounded font-semibold text-lg",style:{backgroundColor:"var(--color-primary)"},children:"Generar"})})]})]})})};function iU({isOpen:e,onClose:a,file:t,lines:r=200,baseDir:s}){const i="http://localhost:8080",[o,l]=N.useState(!1),[c,u]=N.useState(null),[d,f]=N.useState([]),[m,x]=N.useState(0),[h,g]=N.useState(!1);return N.useEffect(()=>{if(!e)return;(async()=>{l(!0),u(null);try{const v=s&&s!=="<null>"&&s.trim()!==""?`&baseDir=${encodeURIComponent(s)}`:"",w=m*r,b=await fetch(`${i}/api/logs/previewPage?file=${encodeURIComponent(t)}&lines=${r}&skip=${w}${v}`,{headers:{Accept:"application/json"}});if(!b.ok)throw new Error(await b.text());const y=await b.json();f(Array.isArray(y.lines)?y.lines:[]),g(!!y.hasMore)}catch(v){u((v==null?void 0:v.message)||"Error al cargar vista previa")}finally{l(!1)}})()},[e,t,r,s,m]),N.useEffect(()=>{x(0)},[t,e]),e?n.jsx("div",{style:Ft.backdrop,children:n.jsxs("div",{style:Ft.modal,children:[n.jsxs("div",{style:Ft.header,children:[n.jsxs("strong",{children:["Vista previa: ",t]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("button",{onClick:async()=>{try{const p=s&&s!=="<null>"&&s.trim()!==""?`&baseDir=${encodeURIComponent(s)}`:"",v=await fetch(`${i}/api/logs/download?file=${encodeURIComponent(t)}${p}`);if(!v.ok)throw new Error(`HTTP ${v.status}`);const w=await v.blob(),y=(v.headers.get("content-disposition")||"").match(/filename\*=UTF-8''([^;]+)|filename="?([^";]+)"?/i),j=decodeURIComponent((y==null?void 0:y[1])||(y==null?void 0:y[2])||t),A=URL.createObjectURL(w),E=document.createElement("a");E.href=A,E.download=j,document.body.appendChild(E),E.click(),E.remove(),URL.revokeObjectURL(A)}catch{alert("No se pudo descargar el archivo")}},style:Ft.actionBtn,children:"Descargar"}),n.jsx("button",{onClick:a,style:Ft.closeBtn,"aria-label":"Cerrar",children:""})]})]}),n.jsxs("div",{style:Ft.toolbarTop,children:[n.jsx("button",{disabled:m===0,onClick:()=>x(p=>Math.max(0,p-1)),style:Ft.pagerBtn,children:"<"}),n.jsxs("span",{style:Ft.pagerText,children:["Pgina ",m+1]}),n.jsx("button",{disabled:!h,onClick:()=>x(p=>p+1),style:Ft.pagerBtn,children:">"})]}),n.jsxs("div",{style:Ft.body,children:[o&&n.jsx("div",{children:"Cargando"}),c&&n.jsx("div",{style:{color:"#b00020"},children:c}),!o&&!c&&n.jsx("ul",{style:Ft.ul,children:d.map((p,v)=>n.jsx("li",{style:Ft.li,children:n.jsx("code",{children:p})},v))})]})]})}):null}const Ft={backdrop:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modal:{width:"80%",height:"70%",background:"#fff",borderRadius:8,boxShadow:"0 10px 30px rgba(0,0,0,0.2)",display:"flex",flexDirection:"column",overflow:"hidden"},header:{padding:"10px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},body:{flex:1,overflow:"auto",background:"#0b1020"},closeBtn:{background:"transparent",border:"none",fontSize:22,cursor:"pointer",lineHeight:1},actionBtn:{background:"#4f46e5",color:"#fff",borderRadius:6,padding:"6px 10px",textDecoration:"none",fontSize:13}};Ft.ul={margin:0,padding:16,listStyle:"none",color:"#e5e7eb",fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'};Ft.li={padding:"2px 0"};Ft.toolbarTop={padding:"8px 16px",borderBottom:"1px solid #1f2937",background:"#0b1020",display:"flex",alignItems:"center",gap:8,color:"#9ca3af"};Ft.pagerBtn={background:"#1f2937",color:"#e5e7eb",borderRadius:6,padding:"4px 8px",fontSize:13,border:"1px solid #374151",cursor:"pointer"};Ft.pagerText={fontSize:12};function oU({isOpen:e,onClose:a,initialBaseDir:t,onSelect:r}){const s="",[i,o]=N.useState(t),[l,c]=N.useState([]),[u,d]=N.useState(!1),[f,m]=N.useState(null);N.useEffect(()=>{e&&x()},[e,i]);const x=async()=>{if(i){d(!0),m(null);try{const p=await fetch(`${s}/api/logs/browse?baseDir=${encodeURIComponent(i)}`);if(!p.ok)throw new Error(await p.text());const v=await p.json();c(v.directories||[])}catch(p){m(p.message||"Error al cargar directorios")}finally{d(!1)}}},h=p=>{o(p.relative)},g=()=>{r(i)};return e?n.jsx("div",{style:Ut.backdrop,children:n.jsxs("div",{style:Ut.modal,children:[n.jsxs("div",{style:Ut.header,children:[n.jsx("strong",{children:"Seleccionar directorio de logs"}),n.jsx("button",{onClick:a,style:Ut.closeBtn,"aria-label":"Cerrar",children:""})]}),n.jsxs("div",{style:Ut.body,children:[n.jsxs("div",{style:Ut.pathInfo,children:[n.jsx("label",{style:Ut.label,children:"Ruta actual:"}),n.jsx("div",{style:Ut.pathDisplay,children:i||"No seleccionado"})]}),u&&n.jsx("div",{style:Ut.loading,children:"Cargando directorios..."}),f&&n.jsx("div",{style:Ut.error,children:f}),!u&&!f&&n.jsxs("div",{style:Ut.directoryList,children:[l.map(p=>n.jsxs("div",{style:Ut.directoryItem,onClick:()=>h(p),children:[" ",p.name]},p.relative)),l.length===0&&n.jsx("div",{style:Ut.emptyMessage,children:"No hay subdirectorios"})]})]}),n.jsxs("div",{style:Ut.footer,children:[n.jsx("button",{onClick:a,style:Ut.cancelBtn,children:"Cancelar"}),n.jsx("button",{onClick:g,style:Ut.selectBtn,children:"Seleccionar"})]})]})}):null}const Ut={backdrop:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modal:{width:"60%",height:"60%",background:"#fff",borderRadius:8,boxShadow:"0 10px 30px rgba(0,0,0,0.2)",display:"flex",flexDirection:"column",overflow:"hidden"},header:{padding:"16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},body:{flex:1,overflow:"auto",padding:"16px"},footer:{padding:"16px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:"8px"},pathInfo:{marginBottom:"16px"},label:{fontSize:14,fontWeight:"bold",color:"#374151",marginBottom:"4px",display:"block"},pathDisplay:{padding:"8px",background:"#f9fafb",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",fontFamily:"monospace",wordBreak:"break-all"},directoryList:{display:"flex",flexDirection:"column",gap:"4px"},directoryItem:{padding:"8px 12px",background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:"4px",cursor:"pointer",fontSize:"14px",transition:"background-color 0.2s"},emptyMessage:{padding:"16px",textAlign:"center",color:"#6b7280",fontSize:"14px"},loading:{padding:"16px",textAlign:"center",color:"#6b7280",fontSize:"14px"},error:{padding:"16px",textAlign:"center",color:"#dc2626",fontSize:"14px"},closeBtn:{background:"transparent",border:"none",fontSize:22,cursor:"pointer",lineHeight:1},cancelBtn:{background:"#6b7280",color:"#fff",borderRadius:6,padding:"8px 16px",border:"none",cursor:"pointer",fontSize:14},selectBtn:{background:"#4f46e5",color:"#fff",borderRadius:6,padding:"8px 16px",border:"none",cursor:"pointer",fontSize:14}},lU={BASE_URL:"/facturacion-backend/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"http://localhost:8080/api",VITE_PAC_BASE_URL:"http://localhost:8085/api"},cU=({className:e})=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),dU=({className:e})=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:e||"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"}),n.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),uU=[{value:"server_logs",label:"Logs del servidor"}],fU=[{value:"all",label:"Todas"},{value:"100",label:"ltimas 100"}],mU=[{value:"15",label:"15"},{value:"25",label:"25"},{value:"50",label:"50"}],xU=()=>{const[e,a]=N.useState({directory:"server_logs",lines:"all",itemsPerPage:"15"}),[t,r]=N.useState(1),[s,i]=N.useState(!1),[o,l]=N.useState(""),[c,u]=N.useState(()=>{const _=localStorage.getItem("logsBaseDir");return _==="<null>"?(localStorage.removeItem("logsBaseDir"),""):_&&_.trim()!==""?_:""}),[d,f]=N.useState(!1),[m,x]=N.useState([]),[h,g]=N.useState(!1),[p,v]=N.useState(null),b=(typeof import.meta<"u"&&lU&&"http://localhost:8080/api"||"").replace(/\/api\/?$/,""),y=_=>{const{name:Q,value:C}=_.target;a(z=>({...z,[Q]:C})),Q==="itemsPerPage"&&r(1)},j=N.useMemo(()=>{const _=t*parseInt(e.itemsPerPage),Q=_-parseInt(e.itemsPerPage);return m.slice(Q,_)},[t,e.itemsPerPage,m]),A=Math.max(1,Math.ceil(m.length/parseInt(e.itemsPerPage))),E=_=>{const Q=c&&c!=="<null>"&&c.trim()!==""?`&baseDir=${encodeURIComponent(c)}`:"",C=`${b}/api/logs/download?file=${encodeURIComponent(_)}${Q}`;window.open(C,"_blank")},F=_=>{l(_),i(!0)},k=_=>{_>=1&&_<=A&&r(_)},P=()=>{if(!c||c==="<null>"||c.trim()===""){x([]),v("No se ha configurado el directorio base de logs. Por favor, selecciona una ruta.");return}g(!0),v(null),fetch(`${b}/api/logs/list?baseDir=${encodeURIComponent(c)}`).then(async _=>{if(!_.ok)throw new Error(await _.text());return _.json()}).then(_=>{x(_.files||[]),r(1)}).catch(_=>v(_.message||"No se pudieron cargar los logs")).finally(()=>g(!1))};N.useEffect(()=>{P()},[c]),N.useEffect(()=>{c||fetch(`${b}/api/logs/config`).then(_=>_.text()).then(_=>{var z;const Q=_.match(/effective=(.*)/),C=(z=Q==null?void 0:Q[1])==null?void 0:z.trim();C&&C!=="<null>"&&C.length>0&&(u(C),localStorage.setItem("logsBaseDir",C))}).catch(()=>{})},[]);const R=()=>{localStorage.setItem("logsBaseDir",c),alert("Directorio de logs establecido")};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 items-end gap-x-6 gap-y-4",children:[n.jsx(Se,{label:"Directorio:",name:"directory",value:e.directory,onChange:y,options:uU}),n.jsxs("p",{className:"text-sm text-primary dark:text-secondary self-center pt-6",children:[n.jsx("span",{className:"font-semibold",children:"Servidor:"})," Intranet_Apps_Server1"]}),n.jsx(Se,{label:"Lneas a descargar:",name:"lines",value:e.lines,onChange:y,options:fU}),n.jsx(Se,{label:"Elementos:",name:"itemsPerPage",value:e.itemsPerPage,onChange:y,options:mU}),n.jsxs("div",{className:"col-span-1 md:col-span-2 lg:col-span-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ruta base de logs (servidor)"}),n.jsxs("div",{className:"flex gap-3 items-center",children:[n.jsx("input",{type:"text",value:c,readOnly:!0,placeholder:"C:/cibercom/logs",className:"flex-1 rounded-md border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 px-3 py-2 text-sm text-gray-900 dark:text-gray-100"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:async()=>{try{const _=c&&c!=="<null>"&&c.trim()!==""?c:"",Q=await fetch(`${b}/api/logs/pick-dir?start=${encodeURIComponent(_)}`);if(Q.status===204)return;if(!Q.ok)throw new Error(await Q.text());const C=await Q.json();C.path&&u(C.path)}catch{f(!0)}},children:"Elegir ruta"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:async()=>{if(!c||c==="<null>"||c.trim()===""){alert("Selecciona una ruta primero");return}try{const _=await fetch(`${b}/api/logs/set-log-dir?baseDir=${encodeURIComponent(c)}&fileName=${encodeURIComponent("server.log")}`,{method:"POST"}),Q=await _.text();if(!_.ok)throw new Error(Q);alert("El backend guardar logs en: "+(JSON.parse(Q).path||c))}catch(_){alert("No se pudo reconfigurar logging: "+((_==null?void 0:_.message)||""))}},children:"Usar para escribir logs"}),n.jsx(fe,{type:"button",variant:"primary",onClick:R,children:"Guardar"})]}),n.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Usa el selector para navegar carpetas en el servidor y establecer la ruta."})]})]}),n.jsx("div",{className:"mt-6 flex justify-end",children:n.jsx(fe,{type:"button",variant:"primary",onClick:P,children:"Mostrar Descargas"})})]}),n.jsxs(ve,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-primary dark:bg-secondary",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Nombre"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-white uppercase tracking-wider",children:"Acciones"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-800",children:[h&&n.jsx("tr",{children:n.jsx("td",{className:"px-6 py-4",colSpan:2,children:"Cargando"})}),p&&!h&&n.jsx("tr",{children:n.jsx("td",{className:"px-6 py-4 text-red-600",colSpan:2,children:p})}),!h&&!p&&j.map((_,Q)=>n.jsxs("tr",{className:Q%2!==0?"bg-pink-50 dark:bg-purple-900/20":"",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:_.name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:n.jsxs("div",{className:"inline-flex items-center gap-3",children:[n.jsx("button",{onClick:()=>F(_.relative),className:"text-gray-600 hover:text-purple-700 dark:text-gray-400 dark:hover:text-white transition-colors",title:"Vista previa","aria-label":`Vista previa de ${_.name}`,children:n.jsx(dU,{})}),n.jsx("button",{onClick:()=>E(_.relative),className:"text-gray-600 hover:text-purple-700 dark:text-gray-400 dark:hover:text-white transition-colors",title:"Descargar","aria-label":`Descargar ${_.name}`,children:n.jsx(cU,{})})]})})]},_.relative)),!h&&!p&&m.length===0&&n.jsx("tr",{children:n.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",colSpan:2,children:"No hay archivos en la ruta seleccionada"})})]})]})}),n.jsx("div",{className:"flex items-center justify-center py-4",children:n.jsxs("nav",{className:"flex items-center space-x-2",children:[n.jsx(fe,{variant:"secondary",onClick:()=>k(t-1),disabled:t===1,children:"<"}),n.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Pgina ",t," de ",A]}),n.jsx(fe,{variant:"secondary",onClick:()=>k(t+1),disabled:t===A,children:">"})]})})]}),n.jsx(iU,{isOpen:s,onClose:()=>i(!1),file:o,lines:200,baseDir:c&&c!=="<null>"&&c.trim()!==""?c:void 0}),n.jsx(oU,{isOpen:d,onClose:()=>f(!1),initialBaseDir:c,onSelect:_=>{u(_),f(!1)}})]})},hU=()=>{const[e,a]=N.useState("encriptado"),[t,r]=N.useState(""),[s,i]=N.useState(""),[o,l]=N.useState(""),[c,u]=N.useState(""),d=f=>{f.preventDefault(),alert(`Modo: ${e}
Boleta: ${t}
Tienda: ${s}
Terminal: ${o}
Fecha: ${c}`)};return n.jsx("div",{className:"flex justify-center items-start min-h-[60vh] p-4",children:n.jsxs(ve,{className:"w-full max-w-3xl mx-auto p-8",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Decodificador de Facturas"}),n.jsx("form",{onSubmit:d,className:"space-y-6",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[n.jsxs("div",{className:"md:col-span-2 flex gap-8 justify-center mb-2",children:[n.jsxs("label",{className:"flex items-center gap-2 font-medium",children:[n.jsx("input",{type:"radio",id:"encriptado",name:"modo",checked:e==="encriptado",onChange:()=>a("encriptado"),className:"accent-primary"}),"Encriptado"]}),n.jsxs("label",{className:"flex items-center gap-2 font-medium",children:[n.jsx("input",{type:"radio",id:"desencriptado",name:"modo",checked:e==="desencriptado",onChange:()=>a("desencriptado"),className:"accent-primary"}),"Desencriptado"]})]}),e==="encriptado"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold",children:"Boleta:"}),n.jsx("input",{type:"text",className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:t,onChange:f=>r(f.target.value),autoFocus:!0})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold",children:"Tienda:"}),n.jsx("input",{type:"text",className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:s,onChange:f=>i(f.target.value)})]})]}),e==="desencriptado"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold",children:"Terminal:"}),n.jsx("input",{type:"text",className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:o,onChange:f=>l(f.target.value),autoFocus:!0})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"mb-1 font-semibold",children:"Fecha:"}),n.jsx("input",{type:"text",className:"rounded-lg p-2 border border-gray-300 dark:bg-gray-700 dark:text-gray-100",value:c,onChange:f=>u(f.target.value)})]})]}),n.jsx("div",{className:"md:col-span-2 flex justify-end",children:n.jsx(fe,{type:"submit",variant:"primary",children:"Codificar"})})]})})]})})},pU=()=>{const[e,a]=N.useState(""),[t,r]=N.useState({}),s=[{value:"administrador",label:"Administrador"},{value:"usuario_cancelado",label:"Usuario Cancelado"},{value:"jefe_credito",label:"Jefe de Crdito"},{value:"operador_credito",label:"Operador de Crdito"},{value:"usuario_consulta",label:"Usuario de Consulta"},{value:"jefe_credito_avanzado",label:"Jefe de Crdito Avanzado"},{value:"operador_credito_avanzado",label:"Operador de Crdito Avanzado"},{value:"produccion",label:"Produccin"},{value:"soporte_operativo",label:"Soporte Operativo Crdito"},{value:"usuario_consulta_ci",label:"Usuario de Consulta CI"},{value:"ventas_institucionales",label:"Ventas Institucionales"}],i=[{id:"graficas",label:"Permiso de Grficas"},{id:"bitacoras",label:"Permiso de Bitcoras"},{id:"permisos",label:"Permiso de Permisos"},{id:"disponibilidad",label:"Permiso de Disponibilidad"},{id:"logs",label:"Permiso de Logs"},{id:"decodificador",label:"Permiso del decodificador de facturas"}],o=(c,u)=>{r(d=>({...d,[c]:u}))},l=()=>{console.log("Updating permissions:",{profile:e,permissions:t})};return n.jsx("div",{className:"space-y-6",children:n.jsxs(ve,{children:[n.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Lista de Permisos"}),n.jsxs("form",{className:"space-y-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Perfil:"}),n.jsx(Ex,{value:e,onChange:c=>a(c),options:[{value:"",label:"Seleccionar perfil"},...s],className:"w-64"})]}),n.jsxs("div",{className:"rounded-lg overflow-hidden border border-gray-300 dark:border-gray-700",children:[n.jsxs("div",{className:"bg-primary dark:bg-secondary text-white p-3 grid grid-cols-2 rounded-t-lg",children:[n.jsx("div",{children:"Permiso"}),n.jsx("div",{className:"text-right",children:"Valor"})]}),i.map(c=>n.jsxs("div",{className:"grid grid-cols-2 p-3 items-center border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[n.jsx("div",{className:"text-primary dark:text-secondary",children:c.label}),n.jsx("div",{className:"text-right",children:n.jsx(Ex,{value:t[c.id]||"",onChange:u=>o(c.id,u),options:[{value:"permitido",label:"Permitido"},{value:"denegado",label:"Denegado"}],className:"w-32 ml-auto"})})]},c.id))]}),n.jsx("div",{className:"flex justify-end mt-6",children:n.jsx(fe,{type:"button",variant:"primary",onClick:l,children:"Actualizar Permisos"})})]})]})})},ev={online:"bg-green-500 border-green-600",offline:"bg-red-500 border-red-600"},gU=()=>{const[e,a]=N.useState([]),[t,r]=N.useState(new Date),[s,i]=N.useState(!1),[o,l]=N.useState(null),c="http://localhost:8080",u=N.useMemo(()=>{const f=e.filter(m=>m.online).length;return{online:f,offline:e.length-f,total:e.length}},[e]),d=async()=>{i(!0),l(null);try{const f=await fetch(`${c}/api/logs/stores/status?simulate=true`,{headers:{Accept:"application/json"}}),m=await f.text();if(!f.ok)throw new Error(m||"Respuesta no exitosa del backend");let x;try{x=JSON.parse(m)}catch{throw new Error("El backend no devolvi JSON. Revisa VITE_API_URL o que el endpoint est arriba. Respuesta: "+m.slice(0,200))}const h=[...x.online||[],...x.offline||[]];a(h),r(new Date)}catch(f){l((f==null?void 0:f.message)||"No se pudo obtener el estado de las tiendas")}finally{i(!1)}};return N.useEffect(()=>{d();const f=setInterval(d,3e4);return()=>clearInterval(f)},[]),n.jsx("div",{className:"space-y-6",children:n.jsx(ve,{children:n.jsxs("div",{className:"flex flex-col gap-4",children:[n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Monitor de Conexiones"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Semforo de 5 tiendas. Verde = conectada, Rojo = sin conexin."})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2 bg-green-50 dark:bg-green-900/20 px-3 py-2 rounded-md border border-green-200 dark:border-green-700",children:[n.jsx("span",{className:"inline-block h-3 w-3 rounded-full bg-green-500"}),n.jsxs("span",{className:"text-sm font-semibold text-green-700 dark:text-green-200",children:["Online ",u.online]})]}),n.jsxs("div",{className:"flex items-center gap-2 bg-red-50 dark:bg-red-900/20 px-3 py-2 rounded-md border border-red-200 dark:border-red-700",children:[n.jsx("span",{className:"inline-block h-3 w-3 rounded-full bg-red-500"}),n.jsxs("span",{className:"text-sm font-semibold text-red-700 dark:text-red-200",children:["Offline ",u.offline]})]}),n.jsx(fe,{variant:"primary",onClick:d,disabled:s,children:s?"Actualizando...":"Actualizar semforo"})]})]}),o&&n.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:o}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4",children:[e.map(f=>{const m=f.online,x=f.lastSeen?new Date(f.lastSeen).toLocaleString():null;return n.jsxs("div",{className:`flex items-center justify-between rounded-lg border p-4 transition-colors ${m?"bg-green-50 dark:bg-green-900/10 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/10 border-red-200 dark:border-red-800"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:`h-4 w-4 rounded-full border ${m?ev.online:ev.offline}`,"aria-label":m?"En lnea":"Desconectada"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:f.name}),n.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:f.id}),x&&n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:["ltimo visto: ",x]})]})]}),n.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${m?"bg-green-100 text-green-800 dark:bg-green-800/40 dark:text-green-100":"bg-red-100 text-red-800 dark:bg-red-800/40 dark:text-red-100"}`,children:m?"Conectada":"Sin conexin"})]},f.id)}),!s&&e.length===0&&n.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Sin datos de tiendas para mostrar."})]}),n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ltima actualizacin: ",t.toLocaleString()]})]})})})},yU=()=>{const[e,a]=N.useState(!1),[t,r]=N.useState(""),{customColors:s,logoUrl:i}=N.useContext(Kt),o=async()=>{a(!0),r("Generando PDF de prueba...");try{const u=await ma.obtenerConfiguracionLogos();if(!u.exitoso)throw new Error("No se pudo obtener la configuracin de logos");const d={uuid:"TEST-UUID-"+Date.now(),serie:"TEST",folio:"001",nombreEmisor:"Empresa de Prueba",nombreReceptor:"Cliente de Prueba",rfcEmisor:"TEST123456789",rfcReceptor:"XEXX010101000",fechaEmision:new Date().toISOString(),importe:1e3,subtotal:862.07,iva:137.93,conceptos:[{descripcion:"Producto de prueba",cantidad:1,unidad:"PZA",precioUnitario:1e3,importe:1e3}],metodoPago:"PUE",formaPago:"01",usoCFDI:"G01"},f={logoUrl:i||u.logoUrl,logoBase64:u.logoBase64,customColors:s||u.customColors},m=await fetch(Re("/factura/generar-pdf"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({facturaData:d,logoConfig:f})});if(!m.ok)throw new Error("Error al generar PDF en el servidor");const x=await m.blob(),h=window.URL.createObjectURL(x),g=document.createElement("a");g.href=h,g.download=`Factura_${d.serie}-${d.folio}.pdf`,document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(h),document.body.removeChild(g),r("PDF generado y descargado correctamente.")}catch(u){r(`Error: ${u instanceof Error?u.message:"Error desconocido"}`)}finally{a(!1)}},l=async()=>{a(!0),r("Generando PDF para abrir en nueva pestaa...");try{const u=await ma.obtenerConfiguracionLogos();if(!u.exitoso)throw new Error("No se pudo obtener la configuracin de logos");const d={uuid:"TEST-UUID-"+Date.now(),serie:"TEST",folio:"001",nombreEmisor:"Empresa de Prueba",nombreReceptor:"Cliente de Prueba",rfcEmisor:"TEST123456789",rfcReceptor:"XEXX010101000",fechaEmision:new Date().toISOString(),importe:1e3,subtotal:862.07,iva:137.93,conceptos:[{descripcion:"Producto de prueba",cantidad:1,unidad:"PZA",precioUnitario:1e3,importe:1e3}],metodoPago:"PUE",formaPago:"01",usoCFDI:"G01"},f={logoUrl:i||u.logoUrl,logoBase64:u.logoBase64,customColors:s||u.customColors},m=await fetch(Re("/factura/generar-pdf"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({facturaData:d,logoConfig:f})});if(!m.ok)throw new Error("Error al generar PDF en el servidor");const x=await m.blob(),h=window.URL.createObjectURL(x);window.open(h,"_blank"),r("PDF generado y abierto en nueva pestaa.")}catch(u){r(`Error: ${u instanceof Error?u.message:"Error desconocido"}`)}finally{a(!1)}},c=async()=>{var u;a(!0),r("Probando endpoint de logo...");try{const d=await ma.obtenerConfiguracionLogos();d.exitoso?r(`Logo obtenido: ${((u=d.logoBase64)==null?void 0:u.length)||0} caracteres, URL: ${d.logoUrl}`):r(`Error obteniendo logo: ${d.error}`)}catch(d){r(`Error: ${d instanceof Error?d.message:"Error desconocido"}`)}finally{a(!1)}};return n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{className:"space-x-2",children:[n.jsx("button",{onClick:o,disabled:e,className:"px-4 py-2 bg-primary text-white rounded hover:bg-primary-dark",children:"Generar y descargar PDF"}),n.jsx("button",{onClick:l,disabled:e,className:"px-4 py-2 bg-secondary text-white rounded hover:bg-secondary-dark",children:"Abrir PDF en nueva pestaa"}),n.jsx("button",{onClick:c,disabled:e,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Probar endpoint de logo"})]}),t&&n.jsx("div",{className:"mt-2 text-sm text-gray-700",children:t})]})};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vU=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),bU=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,t,r)=>r?r.toUpperCase():t.toLowerCase()),av=e=>{const a=bU(e);return a.charAt(0).toUpperCase()+a.slice(1)},Ek=(...e)=>e.filter((a,t,r)=>!!a&&a.trim()!==""&&r.indexOf(a)===t).join(" ").trim(),wU=e=>{for(const a in e)if(a.startsWith("aria-")||a==="role"||a==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var EU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kU=N.forwardRef(({color:e="currentColor",size:a=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...l},c)=>N.createElement("svg",{ref:c,...EU,width:a,height:a,stroke:e,strokeWidth:r?Number(t)*24/Number(a):t,className:Ek("lucide",s),...!i&&!wU(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,d])=>N.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=(e,a)=>{const t=N.forwardRef(({className:r,...s},i)=>N.createElement(kU,{ref:i,iconNode:a,className:Ek(`lucide-${vU(av(e))}`,`lucide-${e}`,r),...s}));return t.displayName=av(e),t};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],tv=Pu("circle-alert",NU);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jU=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],qf=Pu("circle-check-big",jU);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SU=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],CU=Pu("download",SU);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TU=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],rv=Pu("file-text",TU),FU=()=>{const[e,a]=N.useState(!1),[t,r]=N.useState(null),[s,i]=N.useState(null),o="http://localhost:8080/api/itext",l=async()=>{try{a(!0);const f=await(await fetch(`${o}/test-logo`)).json();i({success:f.exitoso,message:f.mensaje,details:f})}catch(d){i({success:!1,message:`Error al probar logo: ${d instanceof Error?d.message:"Error desconocido"}`})}finally{a(!1)}},c=async()=>{try{a(!0),r(null);const d=await fetch(`${o}/generar-pdf-prueba`,{method:"GET"});if(!d.ok)throw new Error(`Error HTTP: ${d.status}`);const f=await d.blob(),m=window.URL.createObjectURL(f),x=document.createElement("a");x.style.display="none",x.href=m,x.download="factura-itext-prueba.pdf",document.body.appendChild(x),x.click(),window.URL.revokeObjectURL(m),document.body.removeChild(x),r({success:!0,message:`PDF generado exitosamente con iText. Tamao: ${(f.size/1024).toFixed(2)} KB`})}catch(d){r({success:!1,message:`Error al generar PDF: ${d instanceof Error?d.message:"Error desconocido"}`})}finally{a(!1)}},u=async()=>{try{a(!0),r(null);const d=Lt.obtenerLogo(),f={facturaData:{uuid:`CUSTOM-${Date.now()}`,serie:"CUST",folio:"001",nombreEmisor:"Cibercom Soluciones",nombreReceptor:"Cliente Personalizado",rfcEmisor:"CIBE123456789",rfcReceptor:"CLIE987654321",fechaEmision:new Date().toISOString(),importe:2500,subtotal:2155.17,iva:344.83,metodoPago:"PUE",formaPago:"03",usoCFDI:"G03"},logoConfig:{...d?{logoBase64:d}:{logoUrl:"/images/Logo Cibercom.png"},customColors:{primary:"#1d4ed8",primaryDark:"#1e40af",secondary:"#3b82f6",background:"#ffffff",text:"#1f2937"}}},m=await fetch(`${o}/generar-pdf`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(!m.ok)throw new Error(`Error HTTP: ${m.status}`);const x=await m.blob(),h=window.URL.createObjectURL(x),g=document.createElement("a");g.style.display="none",g.href=h,g.download="factura-itext-personalizada.pdf",document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(h),document.body.removeChild(g),r({success:!0,message:`PDF personalizado generado exitosamente. Tamao: ${(x.size/1024).toFixed(2)} KB`})}catch(d){r({success:!1,message:`Error al generar PDF personalizado: ${d instanceof Error?d.message:"Error desconocido"}`})}finally{a(!1)}};return n.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[n.jsxs("div",{className:"mb-6",children:[n.jsxs("h1",{className:"text-3xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx(rv,{className:"text-blue-600"}),"Prueba de PDF con iText"]}),n.jsx("p",{className:"text-gray-600",children:"Nueva implementacin de generacin de PDFs usando iText con mejor manejo de logos"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[n.jsxs("button",{onClick:l,disabled:e,className:"flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[n.jsx(qf,{size:20}),"Probar Logo"]}),n.jsxs("button",{onClick:c,disabled:e,className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[n.jsx(CU,{size:20}),"PDF de Prueba"]}),n.jsxs("button",{onClick:u,disabled:e,className:"flex items-center justify-center gap-2 px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[n.jsx(rv,{size:20}),"PDF Personalizado"]})]}),e&&n.jsx("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),n.jsx("span",{className:"text-blue-700",children:"Procesando..."})]})}),s&&n.jsx("div",{className:`mb-4 p-4 rounded-lg border ${s.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:n.jsxs("div",{className:"flex items-start gap-2",children:[s.success?n.jsx(qf,{className:"text-green-600 mt-0.5",size:20}):n.jsx(tv,{className:"text-red-600 mt-0.5",size:20}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:`font-semibold ${s.success?"text-green-800":"text-red-800"}`,children:"Resultado de Prueba de Logo"}),n.jsx("p",{className:s.success?"text-green-700":"text-red-700",children:s.message}),s.details&&n.jsxs("details",{className:"mt-2",children:[n.jsx("summary",{className:"cursor-pointer text-sm font-medium",children:"Ver detalles"}),n.jsx("pre",{className:"mt-2 text-xs bg-gray-100 p-2 rounded overflow-auto",children:JSON.stringify(s.details,null,2)})]})]})]})}),t&&n.jsx("div",{className:`mb-4 p-4 rounded-lg border ${t.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:n.jsxs("div",{className:"flex items-start gap-2",children:[t.success?n.jsx(qf,{className:"text-green-600 mt-0.5",size:20}):n.jsx(tv,{className:"text-red-600 mt-0.5",size:20}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:`font-semibold ${t.success?"text-green-800":"text-red-800"}`,children:"Resultado de Generacin de PDF"}),n.jsx("p",{className:t.success?"text-green-700":"text-red-700",children:t.message})]})]})}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Informacin Tcnica"}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Backend:"})," Spring Boot con iText 7"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Endpoint base:"})," ",o]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Funcionalidades:"})," Generacin de PDF con logos, colores personalizados"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Formato:"})," PDF/A compatible con facturacin electrnica"]})]})]})]})},_U=()=>{const{customColors:e}=N.useContext(Kt),[a,t]=N.useState([]),[r,s]=N.useState(""),[i,o]=N.useState([]),[l,c]=N.useState(null),[u,d]=N.useState([]),[f,m]=N.useState(!1);N.useEffect(()=>{x()},[]);const x=async()=>{try{const y=await fetch(Re("/regimenes-fiscales"));if(!y.ok)throw new Error("Error al obtener los regmenes fiscales");const A=(await y.json()).map(E=>{const[F,k]=E.split(" - ");return{clave:F,descripcion:k}});d(A)}catch(y){console.error("Error al obtener los regmenes fiscales:",y)}},h=y=>{if(y.target.files){const j=Array.from(y.target.files);t(j),s(j.map(A=>A.name).join(", "))}},g=y=>{y.editing=!y.editing,o([...i])},p=y=>{c(y)},v=()=>{c(null)},w=async()=>{if(i.length===0){alert("No hay datos para procesar. Primero carga y extrae los datos de los PDFs.");return}console.log("========================================");try{const y=[];let j=0,A=0;for(let R=0;R<i.length;R++){const _=i[R];j++;const Q={rfc:_.rfc,nombre:_.nombre,primerApellido:_.primerApellido,segundoApellido:_.segundoApellido,curp:_.curp,calle:_.calle,numExt:_.numExt,numInt:_.numInt,colonia:_.colonia,localidad:_.localidad,municipio:_.municipio,entidadFederativa:_.entidadFederativa,entreCalle:_.entreCalle,yCalle:_.yCalle,cp:_.cp,email:"cliente@ejemplo.com",regimenesFiscales:_.regimenesFiscales};try{const C=await fetch(kr("/cdp/procesar-factura"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});if(!C.ok){let S=`Error ${C.status}: ${C.statusText}`,D="";try{const H=await C.text();if(console.error("Cuerpo de error:",H),H)try{const U=JSON.parse(H);D=JSON.stringify(U,null,2),S=U.message||U.error||S}catch{D=H}}catch(H){console.error("No se pudo leer el cuerpo de error:",H)}console.error(`Error al procesar cliente ${_.rfc}:`,{status:C.status,statusText:C.statusText,url:kr("/cdp/procesar-factura"),details:D}),A++,y.push({exitoso:!1,rfc:_.rfc,error:S,detalles:D});continue}const z=await C.json();y.push(z)}catch(C){console.error(`Error de red al procesar cliente ${_.rfc}:`,C),A++,y.push({exitoso:!1,rfc:_.rfc,error:C instanceof Error?C.message:"Error de conexin desconocido",tipo:"NETWORK_ERROR"})}}const E=y.filter(R=>R.exitoso).length,F=y.filter(R=>R.clienteExistente).length,k=E-F,P=y.filter(R=>!R.exitoso).length;if(P>0){const R=y.filter(_=>!_.exitoso).map(_=>`   ${_.rfc}: ${_.error||"Error desconocido"}`).join(`
`);alert(`Procesamiento completado con errores

Resumen:
 Total procesados: ${y.length}
 Exitosos: ${E}
 Fallidos: ${P}
 Clientes nuevos: ${k}
 Clientes actualizados: ${F}

Errores:
${R}

Revisa la consola para ms detalles.`)}else alert(`Procesamiento completado exitosamente!

Resumen:
 Total procesados: ${y.length}
 Clientes nuevos: ${k}
 Clientes existentes actualizados: ${F}

Los datos han sido guardados en el banco de clientes.`)}catch(y){console.error("ERROR CRTICO EN PROCESAMIENTO"),console.error("Tipo de error:",y instanceof Error?y.constructor.name:typeof y),console.error("Mensaje:",y instanceof Error?y.message:String(y)),console.error("Stack:",y instanceof Error?y.stack:"N/A"),alert(`Error crtico al procesar los datos

Mensaje: ${y instanceof Error?y.message:"Error desconocido"}

Revisa la consola del navegador (F12) para ms detalles.`)}},b=async()=>{if(a.length===0){alert("Por favor, selecciona al menos un archivo.");return}m(!0);const y=new FormData;a.forEach(j=>{y.append("archivos",j)});try{const j=await fetch(Re("/factura/procesar-pdfs"),{method:"POST",body:y});if(!j.ok){let F="Error al subir los archivos";try{const k=await j.text();k&&(F=k)}catch{F=`Error ${j.status}: ${j.statusText}`}throw new Error(F)}const A=await j.json();if(!Array.isArray(A))throw new Error("El servidor no devolvi un formato vlido");const E=A.map(F=>({...F,editing:!1}));o(E),console.log("Facturas procesadas:",E),E.length>0?alert(`Se procesaron ${E.length} archivo(s) correctamente.`):alert("Se procesaron los archivos pero no se encontraron datos vlidos.")}catch(j){console.error("Error durante la carga:",j);const A=j instanceof Error?j.message:"Error desconocido al subir los archivos";alert(`Hubo un error al subir los archivos:

${A}

Por favor, verifica que:
- Los archivos sean PDFs vlidos
- El backend est corriendo
- Los archivos contengan constancias fiscales vlidas`)}finally{m(!1)}};return n.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Registro de Constancias CFDI"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Cargue constancias de situacin fiscal para extraer los datos automticamente"})]}),n.jsx(ve,{title:"Carga de Archivos PDF",className:"mb-8",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-gray-400 dark:hover:border-gray-500 transition-colors",children:[n.jsx(YS,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("label",{htmlFor:"pdfFile",className:"cursor-pointer",children:[n.jsx("span",{className:"mt-2 block text-sm font-medium text-gray-900 dark:text-gray-100",children:"Seleccionar archivos PDF"}),n.jsx("span",{className:"mt-1 block text-sm text-gray-500 dark:text-gray-400",children:"Arrastra y suelta archivos aqu, o haz clic para seleccionar"})]}),n.jsx("input",{type:"file",id:"pdfFile",onChange:h,className:"hidden",multiple:!0,accept:".pdf"})]})]}),r&&n.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:"Archivos seleccionados:"}),n.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:r})]}),n.jsx("button",{onClick:b,disabled:f,className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white transition-colors ${f?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,style:{backgroundColor:f?void 0:e.primary},children:f?n.jsxs(n.Fragment,{children:[n.jsx(Km,{className:"animate-spin -ml-1 mr-2 h-4 w-4"}),"Procesando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(eC,{className:"-ml-1 mr-2 h-4 w-4"}),"Extraer Datos"]})})]})})]})}),i.length>0&&n.jsx(ve,{title:"Datos Extrados",className:"mb-8",children:n.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:n.jsx("div",{className:"inline-block min-w-full align-middle",children:n.jsx("div",{className:"overflow-hidden",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"RFC"}),n.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Nombre"}),n.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hidden md:table-cell",children:"Apellidos"}),n.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hidden lg:table-cell",children:"Domicilio"}),n.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hidden lg:table-cell",children:"Regmenes Fiscales"}),n.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Acciones"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:i.map((y,j)=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[n.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm font-medium text-gray-900 dark:text-gray-100",children:n.jsx("div",{className:"break-words",children:y.rfc})}),n.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900 dark:text-gray-100",children:y.editing?n.jsx("input",{type:"text",value:y.nombre,onChange:A=>{y.nombre=A.target.value,o([...i])},className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}):y.nombre}),n.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900 dark:text-gray-100 hidden md:table-cell",children:y.editing?n.jsxs("div",{className:"space-y-1",children:[n.jsx("input",{type:"text",placeholder:"Primer Apellido",value:y.primerApellido||"",onChange:A=>{y.primerApellido=A.target.value,o([...i])},className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}),n.jsx("input",{type:"text",placeholder:"Segundo Apellido",value:y.segundoApellido||"",onChange:A=>{y.segundoApellido=A.target.value,o([...i])},className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}):n.jsxs("div",{children:[y.primerApellido&&n.jsx("div",{children:y.primerApellido}),y.segundoApellido&&n.jsx("div",{children:y.segundoApellido}),!y.primerApellido&&!y.segundoApellido&&n.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"-"})]})}),n.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900 dark:text-gray-100 hidden lg:table-cell",children:y.editing?n.jsxs("div",{className:"space-y-1",children:[n.jsx("input",{type:"text",placeholder:"Calle",value:y.calle,onChange:A=>{y.calle=A.target.value,o([...i])},className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}),n.jsxs("div",{className:"flex space-x-1",children:[n.jsx("input",{type:"text",placeholder:"Nm. Ext.",value:y.numExt,onChange:A=>{y.numExt=A.target.value,o([...i])},className:"flex-1 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}),n.jsx("input",{type:"text",placeholder:"Nm. Int.",value:y.numInt||"",onChange:A=>{y.numInt=A.target.value,o([...i])},className:"flex-1 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),n.jsx("input",{type:"text",placeholder:"Colonia",value:y.colonia,onChange:A=>{y.colonia=A.target.value,o([...i])},className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}),n.jsxs("div",{className:"flex space-x-1",children:[n.jsx("input",{type:"text",placeholder:"Municipio",value:y.municipio,onChange:A=>{y.municipio=A.target.value,o([...i])},className:"flex-1 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}),n.jsx("input",{type:"text",placeholder:"CP",value:y.cp,onChange:A=>{y.cp=A.target.value,o([...i])},className:"w-20 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),n.jsx("input",{type:"text",placeholder:"Entidad Federativa",value:y.entidadFederativa,onChange:A=>{y.entidadFederativa=A.target.value,o([...i])},className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}):n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{children:[y.calle," ",y.numExt,y.numInt?` Int. ${y.numInt}`:""]}),n.jsx("div",{children:y.colonia}),n.jsxs("div",{children:[y.municipio,", ",y.entidadFederativa," ",y.cp]})]})}),n.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900 dark:text-gray-100 hidden lg:table-cell",children:y.editing?n.jsx("select",{multiple:!0,value:y.regimenesFiscales,onChange:A=>{const E=Array.from(A.target.selectedOptions,F=>F.value);y.regimenesFiscales=E,o([...i])},className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",size:3,children:u.map((A,E)=>n.jsxs("option",{value:A.clave+" - "+A.descripcion,children:[A.clave," - ",A.descripcion]},E))}):n.jsx("div",{children:y.regimenesFiscales.length>0?n.jsx("div",{className:"space-y-1",children:y.regimenesFiscales.map((A,E)=>n.jsx("div",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded break-words",children:A},E))}):n.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"-"})})}),n.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm font-medium",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:[n.jsxs("button",{onClick:()=>g(y),className:`inline-flex items-center justify-center px-2 sm:px-3 py-1 border border-transparent text-xs font-medium rounded transition-colors ${y.editing?"text-green-600 hover:text-green-500":"text-blue-600 hover:text-blue-500"}`,children:[y.editing?n.jsx(ZS,{className:"mr-1"}):n.jsx(XS,{className:"mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:y.editing?"Guardar":"Editar"})]}),n.jsxs("button",{onClick:()=>p(y),className:"inline-flex items-center justify-center px-2 sm:px-3 py-1 border border-transparent text-xs font-medium rounded text-gray-600 hover:text-gray-500",children:[n.jsx(_w,{className:"mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:"Ver"})]})]})})]},j))})]})})})})}),l&&n.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 p-4",children:n.jsx("div",{className:"relative top-4 sm:top-20 mx-auto p-4 sm:p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white dark:bg-gray-800",children:n.jsxs("div",{className:"mt-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Detalles de la Constancia"}),n.jsx("button",{onClick:v,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:n.jsx(Aw,{className:"h-6 w-6"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"RFC"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.rfc})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nombre"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.nombre})]}),l.primerApellido&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Primer Apellido"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.primerApellido})]}),l.segundoApellido&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Segundo Apellido"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.segundoApellido})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Calle"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.calle})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nmero Exterior"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.numExt})]}),l.numInt&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nmero Interior"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.numInt})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Colonia"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.colonia})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Municipio"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.municipio})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Entidad Federativa"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.entidadFederativa})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"CP"}),n.jsx("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:l.cp})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Regmenes Fiscales"}),n.jsx("div",{className:"mt-1",children:l.regimenesFiscales.length>0?n.jsx("div",{className:"space-y-1",children:l.regimenesFiscales.map((y,j)=>n.jsx("div",{className:"text-sm bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded",children:y},j))}):n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No especificados"})})]})]})]})})}),i.length>0&&n.jsx("div",{className:"flex justify-center",children:n.jsx("button",{onClick:w,className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors",style:{backgroundColor:e.primary,"--tw-ring-color":e.primary},children:"Procesar Datos"})})]})})},Yf={claveProdServ:"",cantidad:1,unidad:"Servicio",claveUnidad:"E48",descripcion:"",objetoImpuesto:"02",valorUnitario:0,importe:0,tasaIVA:0},sv=[{value:"H87",label:"H87-Pieza"},{value:"EA",label:"EA-Elemento"},{value:"E48",label:"E48-Unidad de Servicio"},{value:"ACT",label:"ACT-Actividad"},{value:"KGM",label:"KGM-Kilogramo"},{value:"E51",label:"E51-Trabajo"},{value:"A9",label:"A9-Tarifa"},{value:"MTR",label:"MTR-Metro"},{value:"AB",label:"AB-Paquete a granel"},{value:"BB",label:"BB-Caja base"},{value:"KT",label:"KT-Kit"},{value:"SET",label:"SET-Conjunto"},{value:"LTR",label:"LTR-Litro"},{value:"XBX",label:"XBX-Caja"},{value:"MON",label:"MON-Mes"},{value:"HUR",label:"HUR-Hora"},{value:"MTK",label:"MTK-Metro cuadrado"},{value:"11",label:"11-Equipos"},{value:"MGM",label:"MGM-Miligramo"},{value:"XPK",label:"XPK-Paquete"},{value:"XKI",label:"XKI-Kit (Conjunto de piezas)"},{value:"AS",label:"AS-Variedad"},{value:"GRM",label:"GRM-Gramo"},{value:"PR",label:"PR-Par"},{value:"DPC",label:"DPC-Docenas de piezas"},{value:"xun",label:"xun-Unidad"},{value:"DAY",label:"DAY-Da"},{value:"XLT",label:"XLT-Lote"},{value:"10",label:"10-Grupos"},{value:"MLT",label:"MLT-Mililitro"},{value:"E54",label:"E54-Viaje"}],nv=[{value:"01",label:"01-No objeto de impuesto"},{value:"02",label:"02-S objeto de impuesto"},{value:"03",label:"03-S objeto del impuesto y no obligado al desglose"}],AU=()=>{const[e,a]=N.useState([]),[t,r]=N.useState(Yf),[s,i]=N.useState(!1),[o,l]=N.useState(""),[c,u]=N.useState([]),[d,f]=N.useState(!1),[m,x]=N.useState(!1),[h,g]=N.useState([]),[p,v]=N.useState(!1),[w,b]=N.useState(!1),y=N.useRef(null),j=N.useRef(null);N.useEffect(()=>{A()},[]);const A=async()=>{b(!0);try{const C=await fetch(Re("/catalogos/productos-servicios"),{headers:Ca()});if(C.ok){const z=await C.json();if(z.exitoso&&z.resultados){const S=z.resultados.map(D=>({id:D.id,claveProdServ:D.claveProdServ||"",cantidad:parseFloat(D.cantidad)||1,unidad:D.unidad||"Servicio",claveUnidad:D.claveUnidad||"E48",descripcion:D.descripcion||"",objetoImpuesto:D.objetoImpuesto||"02",valorUnitario:parseFloat(D.valorUnitario)||0,importe:parseFloat(D.importe)||0,tasaIVA:parseFloat(D.tasaIVA)||0}));a(S)}}else console.warn("No se pudo cargar el catlogo del usuario")}catch(C){console.error("Error al cargar catlogo:",C)}finally{b(!1)}};N.useEffect(()=>{const C=t.claveProdServ.trim();if(C.length<2){u([]),f(!1);return}const z=setTimeout(async()=>{x(!0);try{const S=Re(`/catalogos/sat/productos-servicios?busqueda=${encodeURIComponent(C)}&limite=10`);console.log("Buscando en catlogo SAT:",S);const D=await fetch(S);if(D.ok){const H=await D.json();u(H.resultados||[]),f(!0)}else{try{const H=await D.json();console.error("Error del servidor:",H),H.error&&console.error("Mensaje de error:",H.error)}catch{console.error(`Error HTTP ${D.status}: ${D.statusText}`)}u([])}}catch(S){console.error("Error al buscar en catlogo:",S),u([])}finally{x(!1)}},300);return()=>clearTimeout(z)},[t.claveProdServ]),N.useEffect(()=>{const C=z=>{j.current&&!j.current.contains(z.target)&&y.current&&!y.current.contains(z.target)&&f(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);const E=C=>{const{name:z,value:S}=C.target,D=["cantidad","valorUnitario","importe","tasaIVA"].includes(z)?parseFloat(S)||0:S;r(H=>{const U={...H,[z]:D};if((z==="cantidad"||z==="valorUnitario")&&(U.importe=U.cantidad*U.valorUnitario),z==="unidad"&&!U.claveUnidad){const B=S.split("-")[0].trim();U.claveUnidad=B}return U})},F=C=>{r(z=>({...z,claveProdServ:C.clave,descripcion:C.descripcion||z.descripcion,unidad:C.unidad||z.unidad})),f(!1),u([])},k=async()=>{if(!t.claveProdServ||!t.descripcion){alert("Por favor complete los campos obligatorios: Clave de Producto/Servicio y Descripcin");return}b(!0);try{const C={id:s?t.id:void 0,claveProdServ:t.claveProdServ,cantidad:t.cantidad,unidad:t.unidad,claveUnidad:t.claveUnidad||"E48",descripcion:t.descripcion,objetoImpuesto:t.objetoImpuesto,valorUnitario:t.valorUnitario,importe:t.importe,tasaIVA:t.tasaIVA||0},z=s&&t.id?Re(`/catalogos/productos-servicios/${t.id}`):Re("/catalogos/productos-servicios"),S=s&&t.id?"PUT":"POST",D=await fetch(z,{method:S,headers:Ca({"Content-Type":"application/json"}),body:JSON.stringify(C)});if(D.ok){const H=await D.json();H.exitoso?(await A(),r(Yf),i(!1),alert(s?"Producto/servicio actualizado exitosamente":"Producto/servicio guardado exitosamente")):alert("Error: "+(H.error||"No se pudo guardar el producto/servicio"))}else{const H=await D.json().catch(()=>({error:"Error al guardar"}));alert("Error al guardar: "+(H.error||D.statusText))}}catch(C){console.error("Error al guardar producto/servicio:",C),alert("Error al guardar el producto/servicio. Por favor intenta nuevamente.")}finally{b(!1)}},P=C=>{C.id&&(r({...C,id:C.id}),i(!0),setTimeout(()=>{const z=document.querySelector("[data-form-card]");z&&z.scrollIntoView({behavior:"smooth",block:"start"})},100))},R=async C=>{if(confirm("Est seguro de eliminar este producto/servicio?")){b(!0);try{const z=await fetch(Re(`/catalogos/productos-servicios/${C}`),{method:"DELETE",headers:Ca()});if(z.ok){const S=await z.json();S.exitoso?(await A(),alert("Producto/servicio eliminado exitosamente")):alert("Error: "+(S.error||"No se pudo eliminar el producto/servicio"))}else{const S=await z.json().catch(()=>({error:"Error al eliminar"}));alert("Error al eliminar: "+(S.error||z.statusText))}}catch(z){console.error("Error al eliminar producto/servicio:",z),alert("Error al eliminar el producto/servicio. Por favor intenta nuevamente.")}finally{b(!1)}}},_=async()=>{if(!o.trim()){alert("Por favor ingrese un trmino de bsqueda");return}x(!0);try{const C=await fetch(Re(`/catalogos/sat/productos-servicios?busqueda=${encodeURIComponent(o)}&limite=50`));if(C.ok){const S=(await C.json()).resultados||[];g(S),v(!0),S.length===0&&alert("No se encontraron productos/servicios que coincidan con la bsqueda")}else alert("Error al buscar en el catlogo SAT")}catch(C){console.error("Error al buscar en catlogo:",C),alert("Error al buscar en el catlogo SAT")}finally{x(!1)}},Q=o?e.filter(C=>C.claveProdServ.toLowerCase().includes(o.toLowerCase())||C.descripcion.toLowerCase().includes(o.toLowerCase())):e;return n.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[n.jsxs(ve,{title:"Buscar Productos o Servicios",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsx(J,{name:"filtroBusqueda",label:"Buscar",value:o,onChange:C=>{l(C.target.value),v(!1)},onKeyPress:C=>{C.key==="Enter"&&_()},placeholder:"Buscar por clave o descripcin...",className:"flex-1"}),n.jsx(fe,{type:"button",onClick:_,variant:"secondary",disabled:m,className:"w-full sm:w-auto mt-6 sm:mt-0 flex items-center justify-center gap-2",children:m?n.jsxs(n.Fragment,{children:[n.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n.jsx("span",{children:"Buscando..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(Pn,{className:"w-5 h-5"}),n.jsx("span",{children:"Buscar"})]})})]}),p&&h.length>0&&n.jsxs("div",{className:"mt-4 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:[n.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 px-4 py-2 border-b border-gray-200 dark:border-gray-600",children:n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:["Resultados de bsqueda (",h.length,")"]})}),n.jsx("div",{className:"max-h-96 overflow-y-auto",children:h.map((C,z)=>n.jsx("div",{onClick:()=>{r(S=>({...S,claveProdServ:C.clave,descripcion:C.descripcion||S.descripcion,unidad:C.unidad||S.unidad})),v(!1),l(""),setTimeout(()=>{const S=document.querySelector("[data-form-card]");S&&S.scrollIntoView({behavior:"smooth",block:"start"})},100)},className:"px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer border-b border-gray-200 dark:border-gray-600 last:border-b-0",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:C.clave}),n.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:C.descripcion})]}),C.unidad&&n.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:C.unidad})]})},z))})]})]}),n.jsxs(ve,{title:"Agregar/Modificar Producto o Servicio","data-form-card":!0,children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[n.jsx("div",{className:"md:col-span-2 lg:col-span-3",children:n.jsxs("div",{className:"relative",children:[n.jsx(J,{ref:y,name:"claveProdServ",label:"Producto o servicio (Clave SAT) *",value:t.claveProdServ,onChange:E,onFocus:()=>{c.length>0&&f(!0)},required:!0,placeholder:"Escriba la clave o descripcin para buscar..."}),m&&n.jsx("div",{className:"absolute right-3 top-9 text-gray-400",children:n.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),d&&c.length>0&&n.jsx("div",{ref:j,className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:c.map((C,z)=>n.jsx("div",{onClick:()=>F(C),className:"px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:C.clave}),n.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:C.descripcion})]}),C.unidad&&n.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:C.unidad})]})},z))})]})}),n.jsx(J,{name:"cantidad",label:"Cantidad *",type:"number",value:t.cantidad.toString(),onChange:E,required:!0,step:"0.000001"}),n.jsx(Se,{name:"unidad",label:"Unidad (Descriptivo) *",value:t.unidad,onChange:E,options:sv,required:!0}),n.jsx(Se,{name:"claveUnidad",label:"Clave Unidad (Cdigo SAT) *",value:t.claveUnidad||"E48",onChange:E,options:sv,required:!0}),n.jsx("div",{className:"md:col-span-2 lg:col-span-3",children:n.jsx(J,{name:"descripcion",label:"Descripcin *",value:t.descripcion,onChange:E,required:!0,placeholder:"Descripcin del producto o servicio"})}),n.jsx(Se,{name:"objetoImpuesto",label:"Objeto de impuesto *",value:t.objetoImpuesto,onChange:E,options:nv,required:!0}),n.jsx(J,{name:"valorUnitario",label:"Valor unitario *",type:"number",value:t.valorUnitario.toString(),onChange:E,required:!0,step:"0.01"}),n.jsx(J,{name:"importe",label:"Importe",type:"number",value:t.importe.toFixed(2),onChange:E,disabled:!0})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 mt-6",children:[n.jsx(fe,{type:"button",onClick:k,variant:"primary",disabled:w,className:"w-full sm:w-auto",children:w?"Guardando...":s?"Modificar":"Agregar"}),s&&n.jsx(fe,{type:"button",onClick:()=>{r(Yf),i(!1)},variant:"neutral",className:"w-full sm:w-auto",children:"Cancelar"})]})]}),n.jsx(ve,{title:"Productos o Servicios Registrados",children:w&&e.length===0?n.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"Cargando catlogo..."}):Q.length===0?n.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"No hay productos o servicios registrados. Agregue uno para comenzar."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Producto o servicio"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Cantidad"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Unidad"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Descripcin"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Objeto de impuesto"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Valor unitario"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Importe"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Acciones"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:Q.map(C=>{var z;return n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:C.claveProdServ}),n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:C.cantidad.toFixed(6).replace(/\.?0+$/,"")}),n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:C.unidad}),n.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-white",children:C.descripcion}),n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:C.objetoImpuesto==="02"?`02-S objeto de impuesto. Tasa IVA: ${(C.tasaIVA||0).toFixed(6)}`:`${C.objetoImpuesto}-${((z=nv.find(S=>S.value===C.objetoImpuesto))==null?void 0:z.label.split("-")[1])||""}`}),n.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:["$",C.valorUnitario.toFixed(2)]}),n.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:["$",C.importe.toFixed(2)]}),n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>P(C),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",title:"Editar",children:n.jsx(yu,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>R(C.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:"Eliminar",children:n.jsx(Xs,{className:"w-5 h-5"})})]})})]},C.id)})})]})})})]})},Wf={rfc:"",razonSocial:"",nombre:"",apellidoPaterno:"",apellidoMaterno:"",tipoPersona:"moral",esExtranjero:!1,esPolitico:!1,codigoPostal:"",pais:"MEX",estado:"",municipio:"",colonia:"",calle:"",numeroExterior:"",numeroInterior:"",correoElectronico:"",telefono:"",regimenFiscal:gt[0].value,usoCfdi:yt[0].value},RU=()=>{const[e,a]=N.useState([]),[t,r]=N.useState(Wf),[s,i]=N.useState(!1),[o,l]=N.useState([]),[c,u]=N.useState(!1),[d,f]=N.useState(""),[m,x]=N.useState(!1),[h,g]=N.useState(0),[p,v]=N.useState(0),[w,b]=N.useState(0),[y,j]=N.useState(!1),A=5;N.useEffect(()=>{E()},[h]);const E=async()=>{j(!0);try{const B=await ft.obtenerTodosPaginados(h,A),X=B.clientes.map(T=>{var V;let L="";if(T.domicilioFiscal){const O=T.domicilioFiscal.match(/C\.P\.\s*(\d{5})/i)||T.domicilioFiscal.match(/\b(\d{5})\b/);O&&(L=O[1])}return{id:T.idCliente,rfc:T.rfc||"",razonSocial:T.razonSocial||"",nombre:T.nombre,apellidoPaterno:T.paterno,apellidoMaterno:T.materno,tipoPersona:(((V=T.rfc)==null?void 0:V.length)||0)===12?"moral":"fisica",esExtranjero:!1,esPolitico:!1,codigoPostal:L,pais:T.pais||"MEX",estado:"",municipio:"",colonia:"",calle:"",numeroExterior:"",numeroInterior:"",correoElectronico:T.correoElectronico||"",telefono:"",regimenFiscal:T.regimenFiscal||gt[0].value,usoCfdi:T.usoCfdi||yt[0].value}});a(X),v(B.totalPages),b(B.total)}catch(B){console.error("Error al cargar clientes:",B)}finally{j(!1)}},F=B=>{B>=0&&B<p&&g(B)},k=B=>{const{name:X,value:T,type:L}=B.target,V=L==="checkbox"?B.target.checked:T;r(O=>({...O,[X]:V})),X==="rfc"&&R(T)},P=(B,X)=>{r(T=>({...T,[B]:X}))},R=B=>{const X=B.toUpperCase().trim();X.length===12?r(T=>({...T,tipoPersona:"moral"})):X.length===13&&r(T=>({...T,tipoPersona:"fisica"}))},_=B=>{let X="";if(B.domicilioFiscal){const T=B.domicilioFiscal.match(/C\.P\.\s*(\d{5})/i)||B.domicilioFiscal.match(/\b(\d{5})\b/);T&&(X=T[1])}r(T=>({...T,rfc:B.rfc,razonSocial:B.razonSocial||T.razonSocial,nombre:B.nombre||T.nombre,apellidoPaterno:B.paterno||T.apellidoPaterno,apellidoMaterno:B.materno||T.apellidoMaterno,correoElectronico:B.correoElectronico||T.correoElectronico,pais:B.pais||T.pais||"MEX",regimenFiscal:B.regimenFiscal||T.regimenFiscal,usoCfdi:B.usoCfdi||T.usoCfdi,codigoPostal:X||T.codigoPostal})),X&&X.length===5&&C(X)},Q=()=>{},C=async B=>{if(!B||B.length!==5){l([]),r(X=>({...X,estado:"",municipio:"",colonia:""}));return}u(!0);try{const X=await Ei.obtenerDatosCP(B);X?(r(T=>({...T,estado:X.estado||"",municipio:X.municipio||"",colonia:""})),l(X.colonias||[])):(l([]),r(T=>({...T,estado:"",municipio:"",colonia:""})))}catch(X){console.error("Error al cargar cdigo postal:",X),l([])}finally{u(!1)}},z=B=>{const X=B.target.value.replace(/\D/g,"").slice(0,5);r(T=>({...T,codigoPostal:X})),X.length===5?C(X):(l([]),r(T=>({...T,estado:"",municipio:"",colonia:""})))},S=async()=>{if(!t.rfc||!t.razonSocial||!t.codigoPostal||!t.correoElectronico){alert("Por favor complete los campos obligatorios marcados con *");return}try{const B={rfc:t.rfc,razon_social:t.razonSocial,nombre:t.nombre,paterno:t.apellidoPaterno,materno:t.apellidoMaterno,correo_electronico:t.correoElectronico,regimen_fiscal:t.regimenFiscal,uso_cfdi:t.usoCfdi,pais:t.pais||"MEX",calle:t.calle,numero_exterior:t.numeroExterior,numero_interior:t.numeroInterior,colonia:t.colonia,municipio:t.municipio,estado:t.estado,codigo_postal:t.codigoPostal};if(s&&t.id){const X=await ft.actualizarCliente(t.id,B);if(X.success)alert("Cliente actualizado exitosamente"),g(0),await E(),i(!1);else{alert(`Error al actualizar cliente: ${X.error}`);return}}else{const X=await ft.guardarCliente(B);if(X.success)alert("Cliente guardado exitosamente"),g(0),await E();else{alert(`Error al guardar cliente: ${X.error}`);return}}r(Wf),l([])}catch(B){console.error("Error al guardar cliente:",B),alert("Error al guardar cliente. Por favor intente nuevamente.")}},D=async B=>{var X;if(!B.id){alert("No se puede editar un cliente sin ID");return}try{const T=await ft.obtenerPorId(B.id);if(!T){alert("No se pudo cargar los datos del cliente");return}let L="";if(T.domicilioFiscal){const le=T.domicilioFiscal.match(/C\.P\.\s*(\d{5})/i)||T.domicilioFiscal.match(/\b(\d{5})\b/);le&&(L=le[1])}let V="",O="",de="",me="";if(T.domicilioFiscal){const le=T.domicilioFiscal,I=/C\.P\.\s*(\d{5})/i,q=le.match(I);let ne=le;q&&(ne=le.replace(I,"").trim()),ne=ne.replace(/\b\d{5}\b(?=\s*$)/g,"").trim();const G=ne.match(/Int\.\s*([^,]+)/i);G&&(de=G[1].trim(),ne=ne.replace(/Int\.\s*[^,]+/i,"").trim());const ee=ne.match(/\s+(\d{1,4}[A-Z]?)(?:\s|,|$)/);ee&&(O=ee[1],ne=ne.replace(/\s+\d{1,4}[A-Z]?(?:\s|,|$)/,"").trim());const ie=ne.split(",").map(we=>we.trim()).filter(we=>we.length>0);if(ie.length>0&&(V=ie[0],ie.length>1))for(let we=1;we<ie.length;we++){const je=ie[we];if(je.match(/^(Veracruz|Coatepec|MEX|Mxico|Ciudad de Mxico)/i))break;if(je.length>2&&!je.match(/^\d+$/)){me=je;break}}}let ae="",ce="",W=[];if(L&&L.length===5)try{const le=await Ei.obtenerDatosCP(L);le&&(ae=le.estado||"",ce=le.municipio||"",W=le.colonias||[])}catch(le){console.error("Error al cargar datos del cdigo postal:",le)}r({id:T.idCliente,rfc:T.rfc||"",razonSocial:T.razonSocial||"",nombre:T.nombre,apellidoPaterno:T.paterno,apellidoMaterno:T.materno,tipoPersona:(((X=T.rfc)==null?void 0:X.length)||0)===12?"moral":"fisica",esExtranjero:!1,esPolitico:!1,codigoPostal:L,pais:T.pais||"MEX",estado:ae,municipio:ce,colonia:me,calle:V,numeroExterior:O,numeroInterior:de,correoElectronico:T.correoElectronico||"",telefono:"",regimenFiscal:T.regimenFiscal||gt[0].value,usoCfdi:T.usoCfdi||yt[0].value}),W.length>0&&l(W),i(!0)}catch(T){console.error("Error al cargar cliente para editar:",T),alert("Error al cargar los datos del cliente")}},H=async B=>{if(confirm("Est seguro de eliminar este cliente?"))try{const X=await ft.eliminarCliente(B);X.success?(alert("Cliente eliminado exitosamente"),e.length===1&&h>0?g(h-1):await E()):alert(`Error al eliminar cliente: ${X.error}`)}catch(X){console.error("Error al eliminar cliente:",X),alert("Error al eliminar cliente. Por favor intente nuevamente.")}},U=async()=>{if(!d.trim()){alert("Ingrese un RFC o razn social para buscar");return}x(!0);try{const B=d.trim().toUpperCase(),X=await ft.buscarClientePorRFC(B);if(X.encontrado&&X.cliente){const T={id:Date.now(),rfc:X.cliente.rfc,razonSocial:X.cliente.razonSocial||"",nombre:X.cliente.nombre,apellidoPaterno:X.cliente.paterno,apellidoMaterno:X.cliente.materno,tipoPersona:X.cliente.rfc.length===12?"moral":"fisica",esExtranjero:!1,esPolitico:!1,codigoPostal:"",pais:X.cliente.pais||"MEX",estado:"",municipio:"",colonia:"",calle:"",numeroExterior:"",numeroInterior:"",correoElectronico:X.cliente.correoElectronico||"",telefono:"",regimenFiscal:X.cliente.regimenFiscal||gt[0].value,usoCfdi:X.cliente.usoCfdi||yt[0].value};a([T])}else alert("No se encontr ningn cliente con ese RFC")}catch(B){console.error("Error al buscar cliente:",B),alert("Error al buscar cliente. Por favor intente nuevamente.")}finally{x(!1)}};return n.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[n.jsxs(ve,{title:"Datos Fiscales",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"RFC *"}),n.jsx(Jc,{value:t.rfc,onChange:B=>{r(X=>({...X,rfc:B})),R(B)},onSelect:_,onNotFound:Q,required:!0})]}),n.jsxs("div",{className:"md:col-span-2 lg:col-span-3 flex flex-wrap gap-4",children:[n.jsx(ta,{name:"esExtranjero",label:"Extranjero",checked:t.esExtranjero,onChange:B=>P("esExtranjero",B.target.checked)}),n.jsx(ta,{name:"esPolitico",label:"P. Poltico",checked:t.esPolitico,onChange:B=>P("esPolitico",B.target.checked)})]}),t.tipoPersona==="moral"?n.jsx("div",{className:"md:col-span-2 lg:col-span-3",children:n.jsx(J,{name:"razonSocial",label:"Razn Social *",value:t.razonSocial,onChange:k,required:!0})}):n.jsxs(n.Fragment,{children:[n.jsx(J,{name:"nombre",label:"Nombre *",value:t.nombre||"",onChange:k,required:t.tipoPersona==="fisica"}),n.jsx(J,{name:"apellidoPaterno",label:"Apellido Paterno *",value:t.apellidoPaterno||"",onChange:k,required:t.tipoPersona==="fisica"}),n.jsx(J,{name:"apellidoMaterno",label:"Apellido Materno",value:t.apellidoMaterno||"",onChange:k})]}),n.jsx(J,{name:"codigoPostal",label:"Cdigo Postal *",value:t.codigoPostal,onChange:z,required:!0,maxLength:5,disabled:c}),n.jsx(J,{name:"pais",label:"Pas",value:t.pais,onChange:k,disabled:!1}),n.jsx(J,{name:"estado",label:"Estado",value:t.estado,onChange:k,disabled:!1}),n.jsx(J,{name:"municipio",label:"Municipio/Delegacin",value:t.municipio,onChange:k,disabled:!1}),n.jsx(Se,{name:"colonia",label:"Colonia *",value:t.colonia,onChange:k,options:o.map(B=>({value:B,label:B})),required:!0,disabled:o.length===0||c}),n.jsx(J,{name:"calle",label:"Calle *",value:t.calle,onChange:k,required:!0}),n.jsx(J,{name:"numeroExterior",label:"Nmero exterior",value:t.numeroExterior,onChange:k,placeholder:"Ej: 123, MZ 5, LT 10"}),n.jsx(J,{name:"numeroInterior",label:"Nmero interior",value:t.numeroInterior,onChange:k,placeholder:"Ej: EDIF A, DEP 101"}),n.jsx("div",{className:"md:col-span-2 lg:col-span-3",children:n.jsx(J,{name:"correoElectronico",label:"Correo Electrnico *",type:"email",value:t.correoElectronico,onChange:k,required:!0})}),n.jsx(Se,{name:"regimenFiscal",label:"Rgimen Fiscal *",value:t.regimenFiscal,onChange:k,options:gt,required:!0}),n.jsx(Se,{name:"usoCfdi",label:"Uso Factura *",value:t.usoCfdi,onChange:k,options:yt,required:!0})]}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-4",children:"Los campos marcados con: * son obligatorios"}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 mt-6",children:[n.jsx(fe,{type:"button",onClick:S,variant:"primary",className:"w-full sm:w-auto",children:s?"Modificar":"Agregar"}),s&&n.jsx(fe,{type:"button",onClick:()=>{r(Wf),i(!1),l([])},variant:"neutral",className:"w-full sm:w-auto",children:"Cancelar"})]})]}),n.jsx(ve,{title:"Datos de Contacto",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[n.jsx(J,{name:"nombre",label:"Nombre",value:t.nombre||"",onChange:k}),n.jsx(J,{name:"apellidoPaterno",label:"Apellido Paterno",value:t.apellidoPaterno||"",onChange:k}),n.jsx(J,{name:"apellidoMaterno",label:"Apellido Materno",value:t.apellidoMaterno||"",onChange:k}),n.jsx(J,{name:"telefono",label:"Telfono",type:"tel",value:t.telefono||"",onChange:k})]})}),n.jsx(ve,{title:"Buscar Clientes",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsx(J,{name:"filtroBusqueda",label:"Buscar",value:d,onChange:B=>f(B.target.value),placeholder:"Buscar por RFC o razn social...",className:"flex-1"}),n.jsxs(fe,{type:"button",onClick:U,variant:"secondary",disabled:m,className:"w-full sm:w-auto mt-6 sm:mt-0 flex items-center justify-center gap-2",children:[n.jsx(Pn,{className:"w-5 h-5"}),n.jsx("span",{children:m?"Buscando...":"Buscar"})]})]})}),(e.length>0||y)&&n.jsx(ve,{title:`Clientes Registrados (${w} total)`,children:y?n.jsx("div",{className:"text-center py-8",children:n.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Cargando clientes..."})}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"RFC"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Razn Social / Nombre"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Correo"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Acciones"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:e.map(B=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:B.rfc}),n.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-white",children:B.tipoPersona==="moral"?B.razonSocial:`${B.nombre||""} ${B.apellidoPaterno||""} ${B.apellidoMaterno||""}`.trim()}),n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:B.correoElectronico}),n.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>D(B),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",title:"Editar",children:n.jsx(yu,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>H(B.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:"Eliminar",children:n.jsx(Xs,{className:"w-5 h-5"})})]})})]},B.id))})]})}),p>1&&n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 dark:border-gray-700 sm:px-6",children:[n.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[n.jsx("button",{onClick:()=>F(h-1),disabled:h===0,className:"relative inline-flex items-center rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),n.jsx("button",{onClick:()=>F(h+1),disabled:h>=p-1,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Siguiente"})]}),n.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[n.jsx("div",{children:n.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Mostrando ",n.jsx("span",{className:"font-medium",children:h*A+1})," a"," ",n.jsx("span",{className:"font-medium",children:Math.min((h+1)*A,w)})," ","de ",n.jsx("span",{className:"font-medium",children:w})," clientes"]})}),n.jsx("div",{children:n.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[n.jsxs("button",{onClick:()=>F(h-1),disabled:h===0,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 dark:ring-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx("span",{className:"sr-only",children:"Anterior"}),n.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:n.jsx("path",{fillRule:"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z",clipRule:"evenodd"})})]}),Array.from({length:p},(B,X)=>X).map(B=>B===0||B===p-1||B>=h-1&&B<=h+1?n.jsx("button",{onClick:()=>F(B),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${B===h?"z-10 bg-primary text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary":"text-gray-900 dark:text-gray-100 ring-1 ring-inset ring-gray-300 dark:ring-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 focus:z-20 focus:outline-offset-0"}`,children:B+1},B):B===h-2||B===h+2?n.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 dark:text-gray-300 ring-1 ring-inset ring-gray-300 dark:ring-gray-600",children:"..."},B):null),n.jsxs("button",{onClick:()=>F(h+1),disabled:h>=p-1,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 dark:ring-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx("span",{className:"sr-only",children:"Siguiente"}),n.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:n.jsx("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z",clipRule:"evenodd"})})]})]})})]})]})]})})]})},$i=({fieldId:e,label:a,description:t,color:r,onChange:s})=>n.jsx("div",{className:"mb-4 p-3 border rounded-md border-gray-200 dark:border-gray-700",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("label",{htmlFor:e,className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:[a,":"]}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"color",id:e,value:r,onChange:i=>s(i.target.value),className:"w-10 h-10 p-0 border-none rounded cursor-pointer mr-2","aria-label":`Select color for ${a}`}),n.jsx("input",{type:"text",value:r,onChange:i=>s(i.target.value),className:"w-28 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-primary dark:focus:ring-secondary focus:border-primary dark:focus:border-secondary",pattern:"^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",title:"Ingrese un cdigo de color hexadecimal vlido, ej: #RRGGBB","aria-label":`Cdigo hexadecimal para ${a}`})]})]})}),DU=()=>{const{customColors:e,setCustomColors:a,logoUrl:t,setLogoUrl:r}=N.useContext(Kt),[s,i]=N.useState(e),[o,l]=N.useState(t),[c,u]=N.useState(null);N.useEffect(()=>{i(e)},[e]),N.useEffect(()=>{l(t)},[t]);const d=(h,g)=>{(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(g)||g==="")&&i(p=>({...p,[h]:g}))},f=h=>{var p;const g=(p=h.target.files)==null?void 0:p[0];if(g){u(g);const v=new FileReader;v.onload=w=>{var y;const b=(y=w.target)==null?void 0:y.result;l(b)},v.readAsDataURL(g)}},m=()=>{a(s),c&&o?(r(o),localStorage.setItem("logoUrl",o)):c||r(o),alert("Configuracin de tema aplicada.")},x=()=>{const h=Th();i(_0),a(_0),l(h),r(h),u(null),alert("Configuracin de tema restaurada a los valores predeterminados.")};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(ve,{title:"Personalizacin de Colores del Tema",children:[n.jsx($i,{fieldId:"color-primary",label:"Principal",description:"Botones principales, Pestaas activas, Elementos destacados.",color:s.primary,onChange:h=>d("primary",h)}),n.jsx($i,{fieldId:"color-primary-dark",label:"Principal Interactivo",description:"Estado 'hover' o 'activo' de elementos principales.",color:s.primaryDark,onChange:h=>d("primaryDark",h)}),n.jsx($i,{fieldId:"color-secondary",label:"Secundario",description:"Iconos, Sub-elementos activos, Indicadores visuales.",color:s.secondary,onChange:h=>d("secondary",h)}),n.jsx($i,{fieldId:"color-secondary-dark",label:"Secundario Interactivo",description:"Estado 'hover' o 'activo' de elementos secundarios.",color:s.secondaryDark,onChange:h=>d("secondaryDark",h)}),n.jsx($i,{fieldId:"color-accent",label:"Acento",description:"Fondos especiales, nfasis visual, Notificaciones.",color:s.accent,onChange:h=>d("accent",h)}),n.jsx($i,{fieldId:"color-accent-dark",label:"Acento Interactivo",description:"Estado 'hover' o 'activo' de elementos de acento.",color:s.accentDark,onChange:h=>d("accentDark",h)})]}),n.jsxs(ve,{title:"Personalizacin del Logo",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Logo de la Empresa:"}),n.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary dark:focus:ring-secondary sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 mb-2"}),o&&n.jsxs("div",{className:"mt-3 p-2 border dark:border-gray-600 rounded bg-gray-50 dark:bg-gray-700 inline-block",children:[n.jsx("img",{src:o,alt:"Previsualizacin del Logo",className:"h-10 max-w-xs object-contain",onError:h=>{const g=h.currentTarget;g.style.display="none";const p=g.nextElementSibling;p&&(p.style.display="block")}}),n.jsx("p",{style:{display:"none"},className:"text-xs text-red-500",children:"No se pudo cargar la imagen."})]})]}),n.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[n.jsx(fe,{type:"button",onClick:x,variant:"neutral",children:"Restaurar Predeterminados"}),n.jsx(fe,{type:"button",onClick:m,variant:"primary",children:"Aplicar Cambios"})]})]})},PU=/^[A-Z&]{3,4}\d{6}[A-V1-9][A-Z1-9][0-9A]$/i,OU=()=>{const{empresaInfo:e,setEmpresaInfo:a}=On(),[t,r]=N.useState({nombre:e.nombre,rfc:e.rfc}),[s,i]=N.useState(!1),[o,l]=N.useState(!1),c=PU.test(t.rfc),u=f=>{const{id:m,value:x}=f.target;r(h=>({...h,[m]:x})),m==="rfc"&&i(!0),l(!1)},d=f=>{f.preventDefault(),c&&(a({...t}),l(!0))};return n.jsxs("div",{className:"animate-fadeIn p-6",children:[n.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-gray-200 mb-6",children:"Configuracin de la Empresa"}),n.jsx(ve,{className:"max-w-2xl",children:n.jsxs("form",{onSubmit:d,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"nombre",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre de la Empresa"}),n.jsx("input",{type:"text",id:"nombre",value:t.nombre,onChange:u,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring-primary focus:border-primary dark:bg-gray-700 dark:text-white ",style:{borderColor:"#d1d5db"},required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"rfc",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"RFC"}),n.jsx("input",{type:"text",id:"rfc",value:t.rfc,onChange:u,onBlur:()=>i(!0),className:`w-full px-3 py-2 border rounded-md shadow-sm focus:ring-primary focus:border-primary dark:bg-gray-700 dark:text-white ${s&&!c?"border-red-500 focus:border-red-500":"border-gray-300 dark:border-gray-600"}`,pattern:"^[A-Z&]{3,4}\\d{6}[A-V1-9][A-Z1-9][0-9A]$",title:"Ingrese un RFC vlido",required:!0}),s&&!c&&n.jsx("p",{className:"text-red-500 text-xs mt-1",children:"RFC invlido. Ejemplo: ABCD123456EF1"})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:bg-primary-dark dark:hover:bg-primary",disabled:!c,children:"Guardar Cambios"})}),o&&n.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm text-right",children:"Cambios guardados correctamente!"})]})})]})},IU=({value:e,onChange:a,placeholder:t="Contenido del mensaje que se enviar con las facturas",rows:r=12,className:s="",required:i=!1,isProtected:o=!1,compact:l=!1})=>{const[c,u]=N.useState(""),[d,f]=N.useState(""),[m,x]=N.useState(""),[h,g]=N.useState(""),[p,v]=N.useState({fontFamily:"Arial",fontSize:14,isItalic:!1,isUnderlined:!1}),w=[{value:"Arial",label:"Arial"},{value:"Times New Roman",label:"Times New Roman"},{value:"Calibri",label:"Calibri"}],b=[12,14,16,18,20,24],y=N.useRef(null);N.useEffect(()=>{(async()=>{try{const C=await W0.obtenerConfiguracionActiva();C.exitoso&&C.configuracion&&v({fontFamily:C.configuracion.tipoFuente,fontSize:C.configuracion.tamanoFuente,isItalic:C.configuracion.esCursiva,isUnderlined:C.configuracion.esSubrayado})}catch(C){console.error("Error al cargar configuracin de formato:",C)}})()},[]);const j=async Q=>{const C=Number(Q.fontSize),z=Number.isFinite(C)&&C>0?C:14;v({fontFamily:Q.fontFamily||"Arial",fontSize:z,isItalic:!!Q.isItalic,isUnderlined:!!Q.isUnderlined})},A=["{facturaInfo}","{serie}","{folio}","{uuid}","{rfcEmisor}"];N.useEffect(()=>{E()},[e]);const E=()=>{const Q=`Estimado(a) cliente,

Se ha generado su factura electrnica.

Gracias por su preferencia.

Con los siguientes datos:
Serie de la factura: {serie}
Folio de la factura: {folio}
UUID de la factura: {uuid}
RFC del emisor: {rfcEmisor}

Atentamente,
Equipo de Facturacin Cibercom`,C=["Estimado(a) cliente,","","Se ha generado su factura electrnica.","","Gracias por su preferencia.","","Con los siguientes datos:","{facturaInfo}","Serie de la factura:","{serie}","Folio de la factura:","{folio}","UUID de la factura:","{uuid}","RFC del emisor:","{rfcEmisor}","","Atentamente,","Equipo de Facturacin Cibercom"].join(`
`);u(C),g(Q),f(e||"")},F=Q=>{const C=Q.target.value;f(C),a(C)},k=()=>{v(Q=>({...Q,isItalic:!Q.isItalic})),j({...p,isItalic:!p.isItalic})},P=()=>{v(Q=>({...Q,isUnderlined:!Q.isUnderlined})),j({...p,isUnderlined:!p.isUnderlined})},R=()=>({fontFamily:p.fontFamily,fontSize:`${p.fontSize}px`,fontStyle:p.isItalic?"italic":"normal",textDecoration:p.isUnderlined?"underline":"none"}),_=()=>c?c.split(`
`).map((C,z)=>{const S=C.trim();return S===""?n.jsx("div",{className:l?"h-2":"h-4"},`empty-${z}`):A.some(H=>S===H)?n.jsxs("div",{className:`flex items-center ${l?"my-0.5":"my-1"}`,children:[n.jsx("span",{className:`bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 ${l?"px-1.5 py-0.5 text-xs":"px-2 py-1"} rounded border border-yellow-300 dark:border-yellow-700 font-mono inline-block`,children:S}),n.jsx("span",{className:`ml-2 text-xs text-gray-500 dark:text-gray-400 ${l?"leading-tight":""}`,children:"(Variable dinmica)"})]},`var-${z}`):n.jsxs("div",{className:`flex items-center ${l?"my-0.5":"my-1"}`,children:[n.jsx("span",{className:`bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 ${l?"px-1.5 py-0.5 text-xs":"px-2 py-1"} rounded border border-blue-300 dark:border-blue-700 inline-block`,children:C}),n.jsx("span",{className:`ml-2 text-xs text-gray-500 dark:text-gray-400 ${l?"leading-tight":""}`,children:"(Texto protegido)"})]},`text-${z}`)}):n.jsx("div",{className:`text-gray-400 dark:text-gray-500 italic ${l?"text-xs":""}`,children:"No hay contenido protegido"});return n.jsxs("div",{className:`space-y-4 ${s}`,children:[n.jsxs("div",{className:`bg-blue-50 border border-blue-200 rounded-lg ${l?"p-2":"p-4"}`,children:[n.jsx("div",{className:`${l?"text-xs":"text-sm"} text-blue-600 font-medium mb-2`,children:"Contenido Protegido (No editable)"}),n.jsx("div",{className:`whitespace-pre-wrap text-gray-700 ${l?"text-xs":"text-sm"}`,children:_()})]}),o?null:n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm text-green-600 font-medium mb-2",children:"Mensaje Personalizable"}),n.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[n.jsx("select",{className:"border rounded px-2 py-1 text-sm",value:p.fontFamily,onChange:Q=>{v({...p,fontFamily:Q.target.value}),j({...p,fontFamily:Q.target.value})},children:w.map(Q=>n.jsx("option",{value:Q.value,children:Q.label},Q.value))}),n.jsx("select",{className:"border rounded px-2 py-1 text-sm",value:p.fontSize,onChange:Q=>{const C=Number(Q.target.value);v({...p,fontSize:C}),j({...p,fontSize:C})},children:b.map(Q=>n.jsx("option",{value:Q,children:Q},Q))}),n.jsx("button",{type:"button",className:`border rounded px-2 py-1 text-sm ${p.isItalic?"font-bold bg-gray-200":""}`,onClick:k,title:"Cursiva",children:n.jsx("span",{style:{fontStyle:"italic"},children:"I"})}),n.jsx("button",{type:"button",className:`border rounded px-2 py-1 text-sm ${p.isUnderlined?"font-bold bg-gray-200":""}`,onClick:P,title:"Subrayado",children:n.jsx("span",{style:{textDecoration:"underline"},children:"U"})})]}),n.jsx("textarea",{ref:y,value:d,onChange:F,placeholder:t,rows:r,required:i,className:"w-full h-32 p-3 border border-green-300 rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",style:{backgroundColor:"#f0fdf4",...R()}})]})]})},MU=({onLogoChange:e,initialLogo:a})=>{const[t,r]=N.useState(a||null),[s,i]=N.useState(null),o=async u=>{try{const d=u.toLowerCase();if(d.startsWith("data:image/png;base64,")||d.startsWith("data:image/svg+xml;base64,"))return u;const f=new Image;f.src=u,await new Promise((y,j)=>{f.onload=()=>y(),f.onerror=()=>j(new Error("No se pudo cargar la imagen para convertir a PNG"))});const m=600;let{width:x,height:h}=f;const g=Math.min(1,m/Math.max(x,h));x=Math.max(1,Math.round(x*g)),h=Math.max(1,Math.round(h*g));const p=document.createElement("canvas");p.width=x,p.height=h;const v=p.getContext("2d");if(!v)throw new Error("Canvas no disponible para conversin");v.drawImage(f,0,0,x,h);const w=p.toDataURL("image/png");if(Math.ceil(w.length*3/4)>1024*1024)throw new Error("La imagen convertida a PNG supera 1MB. Usa una imagen ms pequea.");return w}catch(d){return console.warn("Fallo convirtiendo a PNG, se usar el original:",d),u}},l=async u=>{var m;const d=(m=u.target.files)==null?void 0:m[0];if(i(null),!d)return;if(!d.type.match("image.*")){i("Por favor selecciona una imagen vlida");return}if(d.size>1024*1024){i("La imagen debe ser menor a 1MB");return}const f=new FileReader;f.onload=async x=>{var g;const h=(g=x.target)==null?void 0:g.result;try{const p=await o(h);r(p),e(p)}catch(p){i((p==null?void 0:p.message)||"Error al procesar la imagen")}},f.readAsDataURL(d)},c=()=>{r(null),e("")};return n.jsxs(ve,{className:"mb-4",children:[n.jsx("h3",{className:"text-lg font-medium mb-2",children:"Logo para correos electrnicos"}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Este logo aparecer en los correos electrnicos enviados con las facturas."}),t&&n.jsxs("div",{className:"mb-4",children:[n.jsx("div",{className:"border p-4 rounded-md bg-blue-50 flex justify-center mb-2",children:n.jsx("img",{src:t,alt:"Logo para correos",className:"max-h-24 max-w-full object-contain"})}),n.jsx(fe,{onClick:c,variant:"secondary",className:"text-sm",children:"Eliminar logo"})]}),n.jsxs("div",{className:"mt-2",children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:t?"Cambiar logo":"Subir logo"}),n.jsx("input",{type:"file",accept:"image/*",onChange:l,className:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none"}),s&&n.jsx("p",{className:"text-red-500 text-sm mt-1",children:s}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"PNG, JPG o SVG (mx. 1MB)"})]})]})},UU=()=>{const[e,a]=N.useState({asunto:"",mensaje:"",mensajePersonalizado:"",esPersonalizado:!1}),[t,r]=N.useState({asunto:"",mensaje:"",mensajePersonalizado:"",esPersonalizado:!1}),[s,i]=N.useState({id:void 0,tipoFuente:"Arial",tamanoFuente:14,esCursiva:!1,esSubrayado:!1,colorTexto:"#000000"}),[o,l]=N.useState({id:void 0,tipoFuente:"Arial",tamanoFuente:14,esCursiva:!1,esSubrayado:!1,colorTexto:"#000000"}),[c,u]=N.useState(!1),[d,f]=N.useState(!0),[m,x]=N.useState(null),[h,g]=N.useState(Lt.obtenerLogo());N.useEffect(()=>{p()},[]);const p=async()=>{try{f(!0);const P=await Jr.obtenerConfiguracionMensaje();if(P.exitoso&&P.configuracion){const _=await Jr.obtenerMensajePredeterminado(),Q={asunto:P.configuracion.asunto||"Factura Electrnica",mensaje:P.configuracion.mensaje||_.mensaje||`Estimado cliente,

Se ha generado su factura electrnica.

{mensajePersonalizado}

Datos de la factura
Serie: {serie}
Folio: {folio}
UUID: {uuid}
RFC Receptor: {rfcEmisor}

Gracias por su preferencia.

Atentamente,
Equipo de Facturacin Cibercom`,mensajePersonalizado:P.configuracion.mensajePersonalizado||"",esPersonalizado:P.configuracion.esPersonalizado||!1};a(Q),r(Q)}const R=await W0.obtenerConfiguracionActiva();if(R.exitoso&&R.configuracion){const _=R.configuracion,Q={id:_.id,tipoFuente:_.tipoFuente,tamanoFuente:_.tamanoFuente,esCursiva:_.esCursiva,esSubrayado:_.esSubrayado,colorTexto:_.colorTexto};i(Q),l(Q)}}catch(P){console.error("Error al cargar configuraciones:",P),x({tipo:"error",texto:"Error al cargar las configuraciones"})}finally{f(!1)}};N.useEffect(()=>{(async()=>{const R=await Lt.obtenerLogoActivoBackend();if(R&&R.trim()!=="")g(R),Lt.guardarLogo(R);else{const _=Lt.obtenerLogo();g(_)}})()},[]);const v=()=>{const P=(e.mensajePersonalizado||"").trim();let R=(e.mensaje||"").trim();return P?R=R.replace("{mensajePersonalizado}",P):R=R.replace("{mensajePersonalizado}",""),R=R.replace("{serie}","A"),R=R.replace("{folio}","1"),R=R.replace("{uuid}","E75C5FA6-F107-4EA5-A665-4FE383CE30BE"),R=R.replace("{rfcEmisor}","DEF987654G12"),R=R.replace("{facturaInfo}","Serie: A, Folio: 1"),R},w=async P=>{if(g(P),P&&P.trim()!==""){Lt.guardarLogo(P);try{await Lt.guardarLogoBackend(P)}catch(R){console.warn("No se pudo persistir logo en backend en cambio inmediato:",R)}}else{Lt.eliminarLogo();try{await Lt.guardarLogoBackend("")}catch{}}},b=async()=>{u(!0),x(null);try{const P=(e.mensajePersonalizado||"").trim(),R=await Jr.guardarConfiguracionMensaje({asunto:e.asunto,mensaje:P,esPersonalizado:P.length>0,formatoCorreo:{...s}});try{await Lt.guardarLogoBackend(h||"")}catch(_){console.warn("No se pudo persistir logo en backend al guardar configuracin:",_)}if(R.exitoso)r({...e,mensajePersonalizado:P,esPersonalizado:P.length>0}),l({...s}),x({tipo:"success",texto:"Configuraciones guardadas correctamente"}),setTimeout(()=>x(null),3e3);else{let _=R.mensaje||"Error al guardar la configuracin del mensaje";x({tipo:"error",texto:_})}}catch(P){console.error("Error al guardar configuraciones:",P),x({tipo:"error",texto:"Error al guardar las configuraciones"})}finally{u(!1)}},y=async()=>{try{const P=await Jr.restaurarMensajePredeterminado();if(P.exitoso&&P.configuracion){const R={asunto:P.configuracion.asunto||"Factura Electrnica - {facturaInfo}",mensaje:P.configuracion.mensaje||"",mensajePersonalizado:"Tenga un buen da",esPersonalizado:!0};a(R),x({tipo:"success",texto:"Mensaje predeterminado restaurado"}),setTimeout(()=>x(null),3e3)}}catch(P){console.error("Error al restaurar mensaje predeterminado:",P),x({tipo:"error",texto:"Error al restaurar el mensaje predeterminado"})}},j=()=>{a({...t}),i({...o}),x(null)},A=()=>e.asunto!==t.asunto||e.mensaje!==t.mensaje||e.mensajePersonalizado!==t.mensajePersonalizado||e.esPersonalizado!==t.esPersonalizado||s.tipoFuente!==o.tipoFuente||s.tamanoFuente!==o.tamanoFuente||s.esCursiva!==o.esCursiva||s.esSubrayado!==o.esSubrayado||s.colorTexto!==o.colorTexto;if(d)return n.jsxs("div",{className:"animate-fadeIn p-6",children:[n.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-gray-200 mb-6",children:"Configuracin de Mensajes de Correo"}),n.jsxs("div",{className:"flex items-center justify-center p-8",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),n.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"Cargando configuracin..."})]})]});const E="mt-4 p-3 rounded-md text-sm ",F=(m==null?void 0:m.tipo)==="success"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",k=E+F;return n.jsxs("div",{className:"animate-fadeIn p-6",children:[n.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-gray-200 mb-6",children:"Configuracin de Mensajes de Correo"}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-6",children:[n.jsx(MU,{onLogoChange:w,initialLogo:h}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Configurar Mensaje de Facturacin"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mensaje Principal (Datos de Factura - Protegido)"}),n.jsx(IU,{value:e.mensaje,onChange:P=>a({...e,mensaje:P,esPersonalizado:!0}),placeholder:"Contenido del mensaje que se enviar con las facturas",rows:6,required:!0,isProtected:!0,compact:!0})]}),n.jsxs("div",{className:"space-y-2 mt-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mensaje Personalizado (Opcional)"}),n.jsx("textarea",{value:e.mensajePersonalizado||"",onChange:P=>a({...e,mensajePersonalizado:P.target.value,esPersonalizado:!0}),placeholder:"Aada un mensaje personalizado (ej. Feliz Navidad, Felices Fiestas, etc.)",rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Tipo de fuente"}),n.jsxs("select",{value:s.tipoFuente,onChange:P=>{const R={...s,tipoFuente:P.target.value};i(R)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[n.jsx("option",{value:"Arial",children:"Arial"}),n.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),n.jsx("option",{value:"Courier New",children:"Courier New"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Tamao de fuente (px)"}),n.jsx("input",{type:"number",min:8,max:48,step:1,value:s.tamanoFuente,onChange:P=>{const R=Number(P.target.value),_=Number.isFinite(R)&&R>0?R:14,Q={...s,tamanoFuente:_};i(Q)},className:"w-24 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),n.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Entre 8 y 48 px. Si se deja vaco o invlido, se usar 14 px por defecto."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Estilo de texto"}),n.jsxs("div",{className:"flex space-x-4",children:[n.jsxs("label",{className:"inline-flex items-center",children:[n.jsx("input",{type:"checkbox",checked:s.esCursiva,onChange:P=>{const R={...s,esCursiva:P.target.checked};i(R)},className:"form-checkbox h-4 w-4 text-blue-600 transition duration-150 ease-in-out"}),n.jsx("span",{className:"ml-2 text-sm italic",children:"Cursiva"})]}),n.jsxs("label",{className:"inline-flex items-center",children:[n.jsx("input",{type:"checkbox",checked:s.esSubrayado,onChange:P=>{const R={...s,esSubrayado:P.target.checked};i(R)},className:"form-checkbox h-4 w-4 text-blue-600 transition duration-150 ease-in-out"}),n.jsx("span",{className:"ml-2 text-sm underline",children:"Subrayado"})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Color de texto"}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("input",{type:"color",value:s.colorTexto||"#000000",onChange:P=>{const R={...s,colorTexto:P.target.value};i(R)},className:"w-16 h-10 p-1 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700"}),n.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.colorTexto})]})]}),n.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[n.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${e.esPersonalizado?"bg-blue-500":"bg-green-500"}`}),n.jsx("span",{children:e.esPersonalizado?"Mensaje personalizado":"Mensaje predeterminado del sistema"})]})]}),n.jsxs("div",{className:"mt-6 space-y-3",children:[n.jsxs("div",{className:"flex space-x-3",children:[n.jsx(fe,{type:"button",variant:"primary",onClick:b,disabled:c||!A(),className:"flex-1",children:c?"Guardando...":"Guardar Configuracin"}),A()&&n.jsx(fe,{type:"button",variant:"secondary",onClick:j,className:"flex-1",children:"Cancelar"})]}),n.jsx(fe,{type:"button",variant:"outline",onClick:y,className:"w-full",children:"Restaurar Mensaje Predeterminado"})]})]})]}),n.jsx("div",{className:"space-y-6",children:n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Vista Previa del Mensaje"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Vista previa del mensaje final:"}),n.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-sm whitespace-pre-wrap min-h-[200px]",style:{fontFamily:s.tipoFuente,fontSize:`${s.tamanoFuente}px`,fontStyle:s.esCursiva?"italic":"normal",textDecoration:s.esSubrayado?"underline":"none",fontWeight:"normal",color:s.colorTexto},children:v()||"Sin mensaje configurado"})]}),n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n.jsx("p",{className:"font-medium mb-2",children:"Variables disponibles:"}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{children:[n.jsx("code",{className:"bg-gray-200 dark:bg-gray-600 px-1 rounded",children:"{facturaInfo}"})," - Serie y folio de la factura"]}),n.jsxs("div",{children:[n.jsx("code",{className:"bg-gray-200 dark:bg-gray-600 px-1 rounded",children:"{serie}"})," - Serie de la factura"]}),n.jsxs("div",{children:[n.jsx("code",{className:"bg-gray-200 dark:bg-gray-600 px-1 rounded",children:"{folio}"})," - Folio de la factura"]}),n.jsxs("div",{children:[n.jsx("code",{className:"bg-gray-200 dark:bg-gray-600 px-1 rounded",children:"{uuid}"})," - UUID de la factura"]}),n.jsxs("div",{children:[n.jsx("code",{className:"bg-gray-200 dark:bg-gray-600 px-1 rounded",children:"{rfcEmisor}"})," - RFC del emisor"]})]})]})]})]})})]}),m&&n.jsx("div",{className:k,children:m.texto})]})},LU={Boletas:"Tickets",Tickets:"Tickets"},BU=()=>{var Q;const{customColors:e}=N.useContext(Kt),[a,t]=N.useState([]),[r,s]=N.useState([]),[i,o]=N.useState([]),[l,c]=N.useState(null),[u,d]=N.useState(!1),[f,m]=N.useState(null),[x,h]=N.useState(!1),[g,p]=N.useState(!1),[v,w]=N.useState(null);N.useEffect(()=>{b()},[]);const b=async()=>{try{h(!0),w(null);const C=await fetch(Re("/menu-config/perfiles"));if(!C.ok){let S="Error al cargar perfiles";try{const D=await C.json();S=D.message||D.error||S}catch{S=`Error ${C.status}: ${C.statusText}`}throw new Error(S)}const z=await C.json();if(!Array.isArray(z))throw new Error("El servidor devolvi un formato de datos invlido");t(z),z.length>0?(c(z[0].idPerfil),y(z[0].idPerfil)):w({tipo:"error",texto:"No se encontraron perfiles disponibles"})}catch(C){console.error("Error al cargar perfiles:",C);const z=C instanceof Error?C.message:"Error al cargar los perfiles. Verifique que el servidor est ejecutndose.";w({tipo:"error",texto:z})}finally{h(!1)}},y=async C=>{try{h(!0);const z=await fetch(Re(`/menu-config/perfil/${C}`));if(!z.ok){let B="Error al cargar pestaas";try{const X=await z.json();B=X.message||X.error||B}catch{B=`Error ${z.status}: ${z.statusText}`}throw new Error(B)}const S=await z.json(),D=Array.isArray(S)?S.filter(B=>!B.menuPath):[];console.log("Pestaas principales:",D),s(D);const H=await fetch(Re(`/menu-config/pantallas/${C}`));if(!H.ok){let B="Error al cargar pantallas";try{const X=await H.json();B=X.message||X.error||B}catch{B=`Error ${H.status}: ${H.statusText}`}throw new Error(B)}const U=await H.json();console.log("Pantallas especficas:",U),o(Array.isArray(U)?U:[])}catch(z){console.error("Error al cargar configuraciones:",z);const S=z instanceof Error?z.message:"Error al cargar las configuraciones";w({tipo:"error",texto:S})}finally{h(!1)}},j=C=>{c(C),y(C)},A=async(C,z)=>{try{p(!0),w(null);const S=await fetch(Re(`/menu-config/visibilidad/${C}`),{method:"PUT",headers:{"Content-Type":"application/json","X-Usuario":"admin"},body:JSON.stringify({isVisible:z})});if(!S.ok){let H="Error al actualizar visibilidad";try{const U=await S.json();H=U.message||U.error||H}catch{H=`Error ${S.status}: ${S.statusText}`}throw new Error(H)}const D=await S.json();D.success?(s(H=>H.map(U=>U.idConfig===C?{...U,isVisible:z}:U)),l&&await y(l),w({tipo:"success",texto:"Visibilidad actualizada correctamente"}),setTimeout(()=>{w(null)},3e3)):w({tipo:"error",texto:D.message||"Error al actualizar visibilidad"})}catch(S){console.error("Error al actualizar visibilidad:",S);const D=S instanceof Error?S.message:"Error al actualizar la visibilidad";w({tipo:"error",texto:D})}finally{p(!1)}},E=async(C,z)=>{if(!g)try{p(!0),w(null);const S=!!z,H=JSON.stringify({isVisible:S}),U=await fetch(Re(`/menu-config/pantalla-visibilidad/${C}`),{method:"PUT",headers:{"Content-Type":"application/json","X-Usuario":"admin"},body:H});if(!U.ok){let X="Error al actualizar visibilidad de pantalla";try{const T=await U.json();X=T.message||T.error||X,console.error("Error del backend:",T)}catch{X=`Error ${U.status}: ${U.statusText}`,console.error("Error al parsear respuesta de error:",X)}throw new Error(X)}const B=await U.json();B.success?(o(X=>X.map(L=>L.idConfig===C?{...L,isVisible:S}:L)),window.dispatchEvent(new CustomEvent("menuConfigUpdated")),localStorage.setItem("menuConfigUpdated",Date.now().toString()),w({tipo:"success",texto:`Visibilidad actualizada: ${S?"Visible":"Oculto"}`}),setTimeout(()=>{w(null)},3e3),l&&setTimeout(()=>{y(l).catch(X=>{console.error("Error al recargar configuraciones:",X)})},500)):(console.error(`FALLO - ID_CONFIG: ${C}, mensaje: ${B.message}`),w({tipo:"error",texto:B.message||"Error al actualizar visibilidad de pantalla"}))}catch(S){console.error("EXCEPCIN al actualizar visibilidad:",S);const D=S instanceof Error?S.message:"Error al actualizar la visibilidad de la pantalla";w({tipo:"error",texto:D})}finally{p(!1)}},F=C=>{if(C>0){const z=[...r],S=z[C];z[C]=z[C-1],z[C-1]=S,z.forEach((D,H)=>{D.orden=H+1}),s(z)}},k=C=>{if(C<r.length-1){const z=[...r],S=z[C];z[C]=z[C+1],z[C+1]=S,z.forEach((D,H)=>{D.orden=H+1}),s(z)}},P=C=>{m(C),d(!0)},R=()=>{d(!1),m(null)},_=C=>{const S={Facturacin:["Artculos","Intereses","Carta Factura","Global","Monederos","Cancelacin Masiva","Nminas"],Consultas:["Facturas","Boletas","Tickets"],Administracin:["Empleados","Tiendas","Perodos Perfil","Perodos Plataforma","Secciones"],"Reportes Facturacin Fiscal":["Boletas No Auditadas","Reporte Ingreso-Facturacin","Integracin Factura Global","Integracin Clientes","Facturacin clientes posterior a Global","Integracin Sustitucin CFDI","Control de emisin de REP","Reportes REPgcp","Control de cambios","Conciliacin","REPs Sustituidos (Fiscal)","Reporte de Consulta Monederos","Reporte de Ventas Mquina Corporativas Serely Polu","Rgimen de Facturacin No Misma Boleta","Doble Facturacin Pendiente por Defencia","Sustitucin en Proceso","Cancelacin Sustitucin de Facturacin","Saldo a Favor de Clientes","Orden de Mdulos y Facturacin","Consulta de Usuarios","Consulta Tiendas de Total de Facturas Diarias","Validacin por Importe Intereses","Conciliacin Cambio de Sistema de Facturacin","Control de Complementos de Pago (REP) Generados por Ventas Corporativas","Reporte por Factura de Mercanca de Monederos","Ventas Corporativas vs SAT","Captura Libre Complemento de Pago (REP)","Conciliacin Sistema de Facturacin de Boletas vs SAT","Reporte de Trazabilidad de Boletas Canceladas","Estatus Actualizar SAT de CFDI por Peticin"],"Registro CFDI":["Registro de Constancias"],Monitor:["Grficas","Bitcora","Disponibilidad","Logs","Permisos","Decodificador"],Configuracin:["Configuracin de Correo","Configuracin de Empresa","Configuracin de Temas","Configuracin de Mens"]}[C]||[];return i.filter(D=>S.includes(D.menuLabel))};return n.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Configuracin de Mens"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Configure qu mens son visibles para cada perfil de usuario"})]}),v&&n.jsxs("div",{className:`mb-6 p-4 rounded-lg flex items-center justify-between ${v.tipo==="success"?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-green-800 dark:text-green-200":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200"}`,children:[n.jsxs("div",{className:"flex-1",children:[v.texto,v.tipo==="error"&&v.texto.includes("perfiles")&&n.jsx("p",{className:"text-sm mt-2 opacity-90",children:"Verifique que el servidor backend est ejecutndose en http://174.136.25.157:8080"})]}),v.tipo==="error"&&v.texto.includes("perfiles")&&n.jsx("button",{onClick:()=>b(),disabled:x,className:"ml-4 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:x?n.jsxs(n.Fragment,{children:[n.jsx(Km,{className:"animate-spin inline mr-2"}),"Cargando..."]}):"Reintentar"})]}),n.jsx(ve,{title:"Seleccionar Perfil",className:"mb-8",children:n.jsx("div",{className:"space-y-4",children:n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Perfil de Usuario"}),n.jsxs("select",{value:l||"",onChange:C=>j(Number(C.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:x,children:[n.jsx("option",{value:"",children:"Seleccionar perfil..."}),a.map(C=>n.jsx("option",{value:C.idPerfil,children:C.nombrePerfil},C.idPerfil))]})]})})}),l&&n.jsx(ve,{title:`Configuracin de Mens - ${(Q=a.find(C=>C.idPerfil===l))==null?void 0:Q.nombrePerfil}`,children:x?n.jsxs("div",{className:"flex items-center justify-center py-8",children:[n.jsx(Km,{className:"animate-spin h-8 w-8 text-blue-500"}),n.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"Cargando configuraciones..."})]}):n.jsxs("div",{className:"space-y-4",children:[r.map((C,z)=>{const S=_(C.menuLabel);return n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"flex flex-col space-y-1",children:[n.jsx("button",{onClick:()=>F(z),disabled:z===0||g,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(a1,{className:"h-4 w-4 rotate-90"})}),n.jsx("button",{onClick:()=>k(z),disabled:z===r.length-1||g,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(a1,{className:"h-4 w-4 -rotate-90"})})]}),n.jsx("button",{onClick:()=>P(C.menuLabel),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",disabled:S.length===0,title:"Configurar pantallas",children:n.jsx(Qg,{className:`h-4 w-4 ${S.length>0?"":"opacity-50"}`})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:C.menuLabel}),C.menuPath&&n.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Ruta: ",C.menuPath]}),n.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Orden: ",C.orden," | Pantallas: ",S.length]})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:C.isVisible?"Visible":"Oculto"}),n.jsx("button",{onClick:()=>A(C.idConfig,!C.isVisible),disabled:g,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${C.isVisible?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"} ${g?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:C.isVisible?e.primary:void 0},children:n.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${C.isVisible?"translate-x-6":"translate-x-1"}`})})]})]},C.idConfig)}),r.length===0&&n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No hay configuraciones disponibles para este perfil."})]})}),n.jsx(ve,{title:"Informacin",className:"mt-8",children:n.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[n.jsxs("p",{children:[" ",n.jsx("strong",{children:"Pestaas:"})," Controla la visibilidad de las pestaas principales en el sidebar"]}),n.jsxs("p",{children:[" ",n.jsx("strong",{children:"Pantallas:"})," Controla qu pantallas especficas estn disponibles dentro de cada pestaa"]}),n.jsxs("p",{children:[" ",n.jsx("strong",{children:"Visible:"})," El elemento ser mostrado para este perfil"]}),n.jsxs("p",{children:[" ",n.jsx("strong",{children:"Oculto:"})," El elemento no ser visible para este perfil"]}),n.jsxs("p",{children:[" ",n.jsx("strong",{children:"Orden:"})," Use los botones de flecha para cambiar el orden de los mens"]}),n.jsxs("p",{children:[" ",n.jsx("strong",{children:"Configurar:"})," Haga clic en el engranaje para configurar las pantallas especficas"]}),n.jsxs("p",{children:[" ",n.jsx("strong",{children:"Nota:"})," Los cambios se aplican inmediatamente y afectan a todos los usuarios con ese perfil"]})]})}),u&&f&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{children:[n.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Configurar Pantallas - ",f]}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Gestiona la visibilidad de las pantallas especficas dentro de esta pestaa"})]}),n.jsx("button",{onClick:R,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:n.jsx(Aw,{className:"h-5 w-5"})})]}),n.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:(()=>{const C=_(f);return console.log(`Pantallas para ${f}:`,C),C.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[n.jsx(Qg,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"No hay pantallas configuradas para esta pestaa."}),n.jsxs("p",{className:"text-xs mt-2",children:["Pestaa: ",f]})]}):n.jsx("div",{className:"space-y-3",children:C.map(z=>n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("div",{className:"flex items-center space-x-2",children:z.isVisible?n.jsx(_w,{className:"h-4 w-4 text-green-500"}):n.jsx(qS,{className:"h-4 w-4 text-gray-400"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:LU[z.menuLabel]||z.menuLabel}),n.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Ruta: ",z.menuPath]})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:z.isVisible?"Visible":"Oculto"}),n.jsx("button",{onClick:()=>E(z.idConfig,!z.isVisible),disabled:g,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${z.isVisible?"bg-blue-600":"bg-gray-200 dark:bg-gray-600"} ${g?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:z.isVisible?e.primary:void 0},children:n.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${z.isVisible?"translate-x-5":"translate-x-1"}`})})]})]},z.idConfig))})})()}),n.jsx("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700",children:n.jsx("button",{onClick:R,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-50 dark:hover:bg-gray-500 transition-colors",children:"Cerrar"})})]})})]})})},iv={rfc:"",correoElectronico:"",razonSocial:"",nombre:"",paterno:"",materno:"",pais:qr[0].value,codigoPostal:"",estado:"",municipio:"",colonia:"",calle:"",numeroExterior:"",numeroInterior:"",noRegistroIdentidadTributaria:"",domicilioFiscal:"",regimenFiscal:gt[0].value,usoCfdi:yt[0].value,codigoFacturacion:"",tienda:Ia[0].value,fecha:new Date().toISOString().split("T")[0],terminal:"",boleta:"",medioPago:ss[0].value,formaPago:ws[0].value,iepsDesglosado:!1,declaraIeps:!1,telefono:"",uuid:"",modoDetalle:"manual",uuidCfdiRelacionado:"",tipoRelacion:""},zU=()=>{var va;const[e,a]=N.useState(iv),[t,r]=N.useState([]),[s,i]=N.useState(null),[o,l]=N.useState(null),[c,u]=N.useState(!1),[d,f]=N.useState([]),[m,x]=N.useState(!1),[h,g]=N.useState(!1),[p,v]=N.useState(null),[w,b]=N.useState(1),[y]=N.useState(5),[j,A]=N.useState({isOpen:!1,facturaUuid:"",facturaInfo:"",correoInicial:"",rfcReceptor:""}),{empresaInfo:E}=On(),[F,k]=N.useState(null),P=N.useRef(null),[R,_]=N.useState(!1),[Q,C]=N.useState([]),[z,S]=N.useState(!1),[D,H]=N.useState(!1),[U,B]=N.useState([]),X=Y=>Y.length===12,T=Y=>Y.length===13;N.useEffect(()=>{const Y=(e.rfc||"").trim().toUpperCase();let oe=null;Y&&Y.length>=12&&(X(Y)?oe="moral":T(Y)&&(oe="fisica")),oe!==P.current&&(P.current=oe,k(oe),oe==="moral"?a(ue=>({...ue,nombre:"",paterno:"",materno:""})):oe==="fisica"&&a(ue=>({...ue,razonSocial:""})))},[e.rfc]);const L=Y=>{if(!Y)return{codigoPostal:"",calle:"",numeroExterior:"",numeroInterior:"",colonia:"",municipio:"",estado:""};const oe={codigoPostal:"",calle:"",numeroExterior:"",numeroInterior:"",colonia:"",municipio:"",estado:""},ue=Y.match(/(?:C\.?P\.?\s*)?(\d{5})(?:\s|$|,)/i);ue&&(oe.codigoPostal=ue[1]);const ge=Y.split(",").map(Le=>Le.trim());if(ge.length>0){const Le=ge[0],ke=Le.match(/(\d+[A-Za-z]?|MZ\s*\d+|LT\s*\d+|EDIF\s*\w+)/i);if(ke){oe.numeroExterior=ke[1];const ka=Le.substring(0,ke.index).trim();oe.calle=ka}else oe.calle=Le;const He=Le.match(/Int\.\s*(\S+)/i);He&&(oe.numeroInterior=He[1])}let _e=!1;for(let Le=1;Le<ge.length&&!_e;Le++)if(ge[Le].match(/C\.?P\.?\s*\d{5}/i)){_e=!0,Le>1&&(oe.estado=ge[Le-1]),Le>2&&(oe.municipio=ge[Le-2]),Le>3&&(oe.colonia=ge[Le-3]);break}return!_e&&ge.length>=3&&(oe.colonia=ge[ge.length-3]||"",oe.municipio=ge[ge.length-2]||"",oe.estado=ge[ge.length-1]||""),oe},V=async Y=>{const oe=L(Y.domicilioFiscal);if(a(ue=>({...ue,rfc:Y.rfc,razonSocial:Y.razonSocial||ue.razonSocial,nombre:Y.nombre||ue.nombre,paterno:Y.paterno||ue.paterno,materno:Y.materno||ue.materno,correoElectronico:Y.correoElectronico||ue.correoElectronico,pais:Y.pais||ue.pais,domicilioFiscal:Y.domicilioFiscal||ue.domicilioFiscal,regimenFiscal:Y.regimenFiscal||ue.regimenFiscal,usoCfdi:Y.usoCfdi||ue.usoCfdi,codigoPostal:oe.codigoPostal||ue.codigoPostal,calle:oe.calle||ue.calle,numeroExterior:oe.numeroExterior||ue.numeroExterior,numeroInterior:oe.numeroInterior||ue.numeroInterior,colonia:oe.colonia||ue.colonia,municipio:oe.municipio||ue.municipio,estado:oe.estado||ue.estado})),oe.codigoPostal&&oe.codigoPostal.length===5&&(await me(oe.codigoPostal),!oe.estado||!oe.municipio)){const ue=await Ei.obtenerDatosCP(oe.codigoPostal);ue&&(a(ge=>({...ge,estado:ge.estado||ue.estado,municipio:ge.municipio||ue.municipio,colonia:ge.colonia||ue.colonias[0]||""})),C(ue.colonias||[]))}},O=()=>{_(!0)},de=async Y=>{try{const oe={rfc:Y.rfc,razon_social:Y.razonSocial,nombre:Y.nombre,paterno:Y.apellidoPaterno,materno:Y.apellidoMaterno,correo_electronico:Y.correoElectronico,telefono:Y.telefono,codigo_postal:Y.codigoPostal,estado:Y.estado,municipio:Y.municipio,colonia:Y.colonia,calle:Y.calle,numero_exterior:Y.numeroExterior,numero_interior:Y.numeroInterior,pais:Y.pais,regimen_fiscal:Y.regimenFiscal,uso_cfdi:Y.usoCfdi,registro_tributario:Y.esExtranjero?"EXT":null},ue=await fetch(Re("/catalogo-clientes"),{method:"POST",headers:Ca(),body:JSON.stringify(oe)}),ge=await ue.json();if(!ue.ok||ge.error)throw new Error(ge.error||"Error al guardar cliente");a(_e=>({..._e,rfc:Y.rfc,razonSocial:Y.razonSocial,nombre:Y.nombre||_e.nombre,paterno:Y.apellidoPaterno||_e.paterno,materno:Y.apellidoMaterno||_e.materno,correoElectronico:Y.correoElectronico,telefono:Y.telefono||_e.telefono,codigoPostal:Y.codigoPostal,estado:Y.estado,municipio:Y.municipio,colonia:Y.colonia,calle:Y.calle,numeroExterior:Y.numeroExterior,numeroInterior:Y.numeroInterior,pais:Y.pais,regimenFiscal:Y.regimenFiscal,usoCfdi:Y.usoCfdi,declaraIeps:Y.declaraIeps})),_(!1)}catch(oe){throw console.error("Error al guardar cliente:",oe),oe}},me=async Y=>{var oe;if(!Y||Y.length!==5){C([]),a(ue=>({...ue,estado:"",municipio:"",colonia:""}));return}S(!0);try{console.log("Buscando datos para cdigo postal:",Y);const ue=await Ei.obtenerDatosCP(Y);console.log("Datos recibidos del servicio:",ue),ue?(a(ge=>{const _e={...ge,estado:ue.estado||ge.estado||"",municipio:ue.municipio||ge.municipio||"",colonia:ge.colonia||""};return console.log("Actualizando formulario con:",{estado:_e.estado,municipio:_e.municipio}),_e}),C(ue.colonias||[]),console.log("Colonias cargadas:",((oe=ue.colonias)==null?void 0:oe.length)||0)):(console.warn("No se recibieron datos del cdigo postal"),C([]),a(ge=>({...ge,estado:"",municipio:"",colonia:""})))}catch(ue){console.error("Error al cargar cdigo postal:",ue),C([]),a(ge=>({...ge,estado:"",municipio:"",colonia:""}))}finally{S(!1)}},ae=Y=>{const oe=Y.target.value.replace(/\D/g,"").slice(0,5);a(ue=>({...ue,codigoPostal:oe})),oe.length===5?me(oe):(C([]),a(ue=>({...ue,estado:"",municipio:"",colonia:""})))},ce=Y=>{if(!Y)return"N/A";try{const oe=new Date(Y);if(isNaN(oe.getTime()))return"N/A";let ue="000";if(Y.includes(".")){const _e=Y.split(".")[1];_e&&_e.length>=3&&(ue=_e.substring(0,3))}else ue=oe.getMilliseconds().toString().padStart(3,"0");return`${oe.toLocaleString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}.${ue}`}catch(oe){return console.error("Error al formatear fecha:",oe),"N/A"}},W=N.useCallback(async()=>{u(!0);try{const oe=await(await fetch(Re("/factura/consultar-por-empresa"))).json();if(oe.exitoso&&oe.facturas){const ue=oe.facturas.map(ke=>({...ke,fechaFactura:ce(ke.fechaFactura||ke.fechaGeneracion||ke.fechaTimbrado||ke.fechaEmision),fechaGeneracion:ce(ke.fechaGeneracion),fechaTimbrado:ce(ke.fechaTimbrado),codigoFacturacion:ke.codigoFacturacion||`${ke.serie||""}${ke.folio||""}`.trim()||ke.uuid,total:typeof ke.total=="number"?ke.total:typeof ke.importe=="number"?ke.importe:0,estado:ke.estado||ke.estatusFacturacion||"DESCONOCIDO",rfc:ke.rfc||ke.rfcReceptor||ke.rfcEmisor||"",razonSocial:ke.razonSocial||ke.nombreCliente||"",fechaOriginal:ke.fechaFactura||ke.fechaGeneracion||ke.fechaTimbrado||ke.fechaEmision})),ge=ue.map(ke=>ke.uuid),_e=[...new Set(ge)];let Le=ue;ge.length!==_e.length&&(Le=ue.filter((ke,He,ka)=>He===ka.findIndex(Qe=>Qe.uuid===ke.uuid))),Le.sort((ke,He)=>{const ka=ke.fechaOriginal,Qe=He.fechaOriginal;if(!ka&&!Qe)return 0;if(!ka)return 1;if(!Qe)return-1;const sl=new Date(ka);return new Date(Qe).getTime()-sl.getTime()}),r(Le),g(!0),b(1)}else console.error("Error al cargar facturas:",oe.error),r([])}catch(Y){console.error("Error al cargar facturas:",Y),r([])}finally{u(!1)}},[]),le=Y=>{const{name:oe,value:ue,type:ge}=Y.target,_e=ge==="checkbox"?Y.target.checked:ue;a(Le=>({...Le,[oe]:_e}))},I=async Y=>{var oe,ue;if(Y.preventDefault(),e.modoDetalle==="manual"&&U.length===0){alert("Por favor agregue al menos un producto o servicio antes de generar la factura.");return}try{const _e=[e.calle,e.numeroExterior,e.numeroInterior,e.colonia,e.municipio,e.estado,e.codigoPostal,e.pais].filter(Boolean).join(", ")||e.domicilioFiscal,Le={rfc:e.rfc,correoElectronico:e.correoElectronico,razonSocial:e.razonSocial,nombre:e.nombre,paterno:e.paterno,materno:e.materno,pais:e.pais,noRegistroIdentidadTributaria:e.noRegistroIdentidadTributaria,domicilioFiscal:_e,regimenFiscal:e.regimenFiscal,usoCfdi:e.usoCfdi,codigoFacturacion:e.codigoFacturacion,tienda:e.tienda,fecha:e.fecha,terminal:e.terminal,boleta:e.boleta,medioPago:e.medioPago,formaPago:e.formaPago,iepsDesglosado:e.iepsDesglosado,guardarEnMongo:!1,uuidCfdiRelacionado:e.uuidCfdiRelacionado||null,tipoRelacion:e.tipoRelacion||null};e.modoDetalle==="manual"&&U.length>0&&(Le.conceptos=U.map(Qe=>({descripcion:Qe.descripcion,cantidad:Qe.cantidad,unidad:Qe.unidad,precioUnitario:Qe.valorUnitario,importe:Qe.importe,claveProdServ:Qe.claveProdServ,claveUnidad:Qe.claveUnidad||Qe.unidad,objetoImp:Qe.objetoImpuesto||"02",tasaIva:Qe.tasaIVA/100})));const ke=await fetch(Re("/factura/generar/frontend"),{method:"POST",headers:Ca(),body:JSON.stringify(Le)});if(!ke.ok){const Qe=await ke.text();throw new Error(`Error HTTP ${ke.status}: ${Qe}`)}const He=await ke.json(),ka=He.uuid||((oe=He.datos)==null?void 0:oe.folioFiscal)||((ue=He.datosFactura)==null?void 0:ue.uuid);He.exitoso?(alert(`${He.mensaje}
UUID: ${ka}
Factura guardada en base de datos`),a(Qe=>({...Qe,uuid:ka||Qe.uuid})),ka&&(i("4 - EN PROCESO DE EMISION"),ne(ka)),e.correoElectronico&&e.correoElectronico.trim()&&window.confirm("Desea enviar los archivos al correo del receptor?")&&await Me(ka),W()):alert(`${He.mensaje}
Errores: ${He.errores||He.error}`)}catch(ge){console.error("Error en el envo:",ge),alert(`Hubo un error al enviar el formulario: ${ge instanceof Error?ge.message:"Error desconocido"}`)}},q=async Y=>{try{const oe=await fetch(kr(`/pac/stamp/status/${encodeURIComponent(Y)}`));if(!oe.ok)return null;const ue=await oe.json().catch(()=>null),ge=String((ue==null?void 0:ue.status)||(ue==null?void 0:ue.codigo)||""),_e=String((ue==null?void 0:ue.descripcion)||(ue==null?void 0:ue.statusDescripcion)||"");return ge?{codigo:ge,descripcion:_e}:null}catch{return null}},ne=Y=>{o&&(window.clearInterval(o),l(null));const oe=window.setInterval(async()=>{const ue=await q(Y);ue&&(ue.codigo==="0"?(i("0 - EMITIDA"),window.clearInterval(oe),l(null)):ue.codigo==="4"?i("4 - EN PROCESO DE EMISION"):ue.codigo==="2"?(i("2 - CANCELADA EN SAT"),window.clearInterval(oe),l(null)):ue.codigo==="66"&&i("66 - POR TIMBRAR"))},3e3);l(oe)};N.useEffect(()=>()=>{o&&window.clearInterval(o)},[o]);const G=()=>{a(iv),alert("Formulario reiniciado")},ee=async()=>{var Y;try{x(!0);const oe=(Y=e.codigoFacturacion)==null?void 0:Y.trim();if(!oe){alert("Por favor ingrese un folio para buscar.");return}const ue=Number(oe);if(isNaN(ue)||ue<=0){alert("El folio debe ser un nmero vlido.");return}console.log("Buscando ticket con folio:",ue);const ge={folio:ue};console.log("Filtros enviados al backend:",ge);const _e=await ci.buscarTickets(ge);console.log("Resultados recibidos:",_e),f(_e),g(_e&&_e.length>1),!_e||_e.length===0?(alert(`No se encontraron tickets con el folio ${ue}. Verifica que el folio exista en la base de datos.`),v(null)):_e.length===1?(v(_e[0]),ie(_e[0])):v(null)}catch(oe){console.error("Error al consultar tickets:",oe);const ue=oe instanceof Error?oe.message:"Error desconocido";alert(`Error al consultar tickets: ${ue}. Revisa la consola para ms detalles.`)}finally{x(!1)}},ie=Y=>{a(oe=>({...oe,tienda:Y.codigoTienda??oe.tienda,fecha:Y.fecha??oe.fecha,terminal:Y.terminalId!=null?String(Y.terminalId):oe.terminal,boleta:Y.folio!=null?String(Y.folio):oe.boleta,medioPago:Y.formaPago??oe.medioPago,formaPago:oe.formaPago||"PUE"}))},we=async(Y,oe)=>{try{await ma.generarYDescargarXML(Y)}catch(ue){console.error("Error al descargar XML:",ue),alert("Error al descargar el XML. Intenta nuevamente.")}},je=async Y=>{try{await ma.generarYDescargarPDF(Y)}catch(oe){console.error("Error al descargar PDF:",oe),alert(`Error al descargar PDF: ${oe instanceof Error?oe.message:"Error desconocido"}`)}},Me=async Y=>{const oe=(e.correoElectronico||"").trim();if(!oe||!Pt.validarEmail(oe)){alert("Ingresa un correo electrnico vlido en el formulario.");return}let ue="",ge="";try{const ke=await ma.obtenerFacturaPorUUID(Y);ue=ke.serie||"",ge=ke.folio||""}catch{}const _e=`Factura ${ue||"A"}${ge||"1"} - ${(E==null?void 0:E.nombre)||"Empresa"}`,Le=`Estimado(a) cliente,

Se ha generado su factura electrnica.

Gracias por su preferencia.`;try{const ke=await Pt.enviarCorreoConPdfAdjunto({uuidFactura:Y,correoReceptor:oe,asunto:_e,mensaje:Le});ke.success?alert(`Correo enviado exitosamente a: ${oe}`):alert(`Error al enviar correo: ${ke.message||"Desconocido"}`)}catch(ke){console.error("Error al enviar correo:",ke),alert(`Error al enviar correo: ${ke instanceof Error?ke.message:"Error desconocido"}`)}},$e=async()=>{const Y=(e.uuid||"").trim();if(!Y){alert("Primero guarda o consulta una factura para obtener el UUID.");return}await we(Y,e.codigoFacturacion||"Factura")},Ie=async()=>{const Y=(e.uuid||"").trim();if(!Y){alert("Primero guarda o consulta una factura para obtener el UUID.");return}await je(Y)},We=async()=>{const Y=(e.uuid||"").trim();if(!Y){alert("Primero guarda o consulta una factura para obtener el UUID.");return}await Me(Y)},Ve=async()=>{try{if(!e.rfc||!e.rfc.trim()){alert("Por favor ingrese el RFC del receptor.");return}const oe=[e.calle,e.numeroExterior,e.numeroInterior,e.colonia,e.municipio,e.estado,e.codigoPostal,e.pais].filter(Boolean).join(", ")||e.domicilioFiscal,ue={rfc:e.rfc,correoElectronico:e.correoElectronico,razonSocial:e.razonSocial,nombre:e.nombre,paterno:e.paterno,materno:e.materno,pais:e.pais,noRegistroIdentidadTributaria:e.noRegistroIdentidadTributaria,domicilioFiscal:oe,regimenFiscal:e.regimenFiscal,usoCfdi:e.usoCfdi,codigoFacturacion:e.codigoFacturacion,tienda:e.tienda,fecha:e.fecha,terminal:e.terminal,boleta:e.boleta,medioPago:e.medioPago,formaPago:e.formaPago,iepsDesglosado:e.iepsDesglosado};e.modoDetalle==="manual"&&U.length>0&&(ue.conceptos=U.map(He=>({descripcion:He.descripcion,cantidad:He.cantidad,unidad:He.unidad,precioUnitario:He.valorUnitario,importe:He.importe,claveProdServ:He.claveProdServ,claveUnidad:He.claveUnidad||He.unidad,objetoImp:He.objetoImpuesto||"02",tasaIva:He.tasaIVA/100})));const ge=await fetch(Re("/factura/preview-pdf"),{method:"POST",headers:Ca(),body:JSON.stringify(ue)});if(!ge.ok){const He=await ge.text();throw new Error(`Error HTTP ${ge.status}: ${He}`)}const _e=await ge.blob(),Le=window.URL.createObjectURL(_e),ke=document.createElement("a");ke.href=Le,ke.target="_blank",ke.rel="noopener noreferrer",document.body.appendChild(ke),ke.click(),document.body.removeChild(ke),window.URL.revokeObjectURL(Le)}catch(Y){console.error("Error al generar vista previa:",Y),alert(`Error al generar vista previa: ${Y instanceof Error?Y.message:"Error desconocido"}`)}},Ze=()=>{A({isOpen:!1,facturaUuid:"",facturaInfo:"",correoInicial:"",rfcReceptor:""})};Math.ceil(t.length/y);const Fe=(w-1)*y,na=Fe+y;t.slice(Fe,na),console.log(` Paginacin - Total facturas: ${t.length}, Pgina actual: ${w}, Elementos por pgina: ${y}`);const oa=Y=>{B(oe=>[...oe,{...Y}])},$a=Y=>{B(oe=>oe.filter((ue,ge)=>ge!==Y))},Xe=()=>{const Y=U.reduce((ge,_e)=>ge+_e.importe,0),oe=U.reduce((ge,_e)=>_e.tasaIVA>0?ge+_e.importe*_e.tasaIVA/100:ge,0),ue=Y+oe;return{subtotal:Y,iva:oe,total:ue}};return n.jsxs("div",{className:"space-y-8",children:[n.jsxs("form",{onSubmit:I,className:"space-y-8",children:[e.uuid&&n.jsxs("div",{className:"p-2 rounded bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-100",children:["Estado de timbrado: ",s||"Desconocido"]}),n.jsx(ve,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"RFC *"}),n.jsx(Jc,{value:e.rfc,onChange:Y=>a(oe=>({...oe,rfc:Y})),onSelect:V,onNotFound:O,required:!0})]}),n.jsx("div",{className:"md:col-span-2 lg:col-span-3",children:n.jsx(ta,{name:"declaraIeps",label:"Declaro IEPS **",checked:e.declaraIeps,onChange:le})}),(F==="moral"||F===null)&&n.jsx(J,{name:"razonSocial",label:"Razn Social *",value:e.razonSocial,onChange:le,required:F==="moral"}),n.jsx(J,{name:"codigoPostal",label:"Cdigo Postal *",value:e.codigoPostal,onChange:ae,required:!0,maxLength:5}),z&&n.jsx("div",{className:"text-sm text-gray-500 flex items-center",children:"Cargando datos..."}),n.jsx(Se,{name:"pais",label:"Pas",value:e.pais,onChange:le,options:qr}),n.jsx(J,{name:"estado",label:"Estado",value:e.estado,onChange:le}),n.jsx(J,{name:"municipio",label:"Municipio/Delegacin",value:e.municipio,onChange:le}),n.jsx(Se,{name:"colonia",label:"Colonia",value:e.colonia,onChange:le,options:Q.map(Y=>({value:Y,label:Y})),disabled:Q.length===0}),n.jsx(J,{name:"calle",label:"Calle",value:e.calle,onChange:le}),n.jsx(J,{name:"numeroExterior",label:"Nmero exterior",value:e.numeroExterior,onChange:le,placeholder:"Ej: 123, MZ 5, LT 10"}),n.jsx(J,{name:"numeroInterior",label:"Nmero interior",value:e.numeroInterior,onChange:le,placeholder:"Ej: EDIF A, DEP 101"}),n.jsx(Se,{name:"regimenFiscal",label:"Rgimen Fiscal *",value:e.regimenFiscal,onChange:le,options:gt,required:!0}),n.jsx(Se,{name:"usoCfdi",label:"Uso CFDI *",value:e.usoCfdi,onChange:le,options:yt,required:!0}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 md:col-span-2 lg:col-span-3",children:"Los campos marcados con: * son obligatorios, **Aplica slo para vinos y licores."})]})}),n.jsx(ve,{title:"Datos de Contacto",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsx(J,{name:"nombre",label:"Nombre",value:e.nombre,onChange:le}),n.jsx(J,{name:"paterno",label:"Apellido Paterno",value:e.paterno,onChange:le}),n.jsx(J,{name:"materno",label:"Apellido Materno",value:e.materno,onChange:le}),n.jsx(J,{name:"correoElectronico",label:"Correo Electrnico *",type:"email",value:e.correoElectronico,onChange:le,required:!0}),n.jsx(J,{name:"telefono",label:"Telfono para WhatsApp",value:e.telefono,onChange:le})]})}),h&&d.length>1&&n.jsx(ve,{title:"Tickets encontrados",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tienda"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Terminal"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Folio"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subtotal"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IVA"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Forma Pago"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"RFC"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estatus"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID Factura"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(Y=>{var oe,ue,ge;return n.jsxs("tr",{className:"cursor-pointer hover:bg-gray-50",onClick:()=>{v(Y),ie(Y)},children:[n.jsx("td",{className:"px-4 py-2",children:Y.codigoTienda}),n.jsx("td",{className:"px-4 py-2",children:new Date(Y.fecha).toLocaleDateString()}),n.jsx("td",{className:"px-4 py-2",children:Y.terminalId??"-"}),n.jsx("td",{className:"px-4 py-2",children:Y.folio}),n.jsx("td",{className:"px-4 py-2",children:(oe=Y.subtotal)==null?void 0:oe.toFixed(2)}),n.jsx("td",{className:"px-4 py-2",children:(ue=Y.iva)==null?void 0:ue.toFixed(2)}),n.jsx("td",{className:"px-4 py-2",children:(ge=Y.total)==null?void 0:ge.toFixed(2)}),n.jsx("td",{className:"px-4 py-2",children:Y.formaPago??"-"}),n.jsx("td",{className:"px-4 py-2",children:Y.nombreCliente??"-"}),n.jsx("td",{className:"px-4 py-2",children:Y.rfcCliente??"-"}),n.jsx("td",{className:"px-4 py-2",children:Y.status===1?"Activo":"Cancelado"}),n.jsx("td",{className:"px-4 py-2",children:Y.idFactura??"-"})]},Y.idTicket)})})]})})}),n.jsxs(ve,{title:"Detalle de la Factura",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Modo de Captura"}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",name:"modoDetalle",value:"automatico",checked:e.modoDetalle==="automatico",onChange:()=>a(Y=>({...Y,modoDetalle:"automatico"})),className:"mr-2"}),"Automtico"]}),n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"radio",name:"modoDetalle",value:"manual",checked:e.modoDetalle==="manual",onChange:()=>a(Y=>({...Y,modoDetalle:"manual"})),className:"mr-2"}),"Manual"]})]})]}),e.modoDetalle==="automatico"?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_auto] gap-2 sm:gap-4",children:[n.jsx(J,{name:"codigoFacturacion",label:"Cdigo de Facturacin o Prefactura",value:e.codigoFacturacion,onChange:le,placeholder:"Ingrese cdigo de facturacin o prefactura"}),n.jsx("div",{className:"flex items-end",children:n.jsx(fe,{type:"button",onClick:ee,variant:"secondary",disabled:m,className:"w-full sm:w-auto whitespace-nowrap",children:m?"Buscando":"Buscar"})})]}),p&&n.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-md",children:n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Ticket encontrado: Tienda ",p.codigoTienda,", Folio ",p.folio,", Total: $",(va=p.total)==null?void 0:va.toFixed(2)]})}),n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Los botones de agregar y eliminar estn bloqueados en modo automtico."})]}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 sm:gap-4",children:[n.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white",children:"Productos y Servicios"}),n.jsx(fe,{type:"button",onClick:()=>H(!0),variant:"primary",className:"text-sm w-full sm:w-auto whitespace-nowrap",children:"+ Agregar Producto/Servicio"})]}),n.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[n.jsx("p",{children:"Catlogo de artculos: nombre, descripcin"}),n.jsx("p",{children:"Acceso al catlogo de Clave de Producto o Servicio (Ej: Catlogo del SAT)"})]}),U.length>0&&n.jsx("div",{className:"border-t pt-4 mt-4",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Clave"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Descripcin"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Unidad"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Cantidad"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Valor Unitario"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"IVA"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Importe"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Accin"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:U.map((Y,oe)=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:Y.claveProdServ}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-200",children:Y.descripcion}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:Y.unidad}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:Y.cantidad.toFixed(6)}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Y.valorUnitario)}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200",children:Y.tasaIVA>0?`${Y.tasaIVA}%`:"Exento"}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-semibold text-gray-900 dark:text-gray-100",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Y.importe)}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:n.jsx(fe,{type:"button",onClick:()=>$a(oe),variant:"secondary",className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white",children:"Eliminar"})})]},oe))}),n.jsxs("tfoot",{className:"bg-gray-50 dark:bg-gray-700 font-semibold",children:[n.jsxs("tr",{children:[n.jsx("td",{colSpan:6,className:"px-4 py-2 text-right text-sm text-gray-700 dark:text-gray-300",children:"Subtotal:"}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Xe().subtotal)}),n.jsx("td",{})]}),n.jsxs("tr",{children:[n.jsx("td",{colSpan:6,className:"px-4 py-2 text-right text-sm text-gray-700 dark:text-gray-300",children:"IVA:"}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Xe().iva)}),n.jsx("td",{})]}),n.jsxs("tr",{children:[n.jsx("td",{colSpan:6,className:"px-4 py-2 text-right text-sm text-gray-700 dark:text-gray-300",children:"Total:"}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-lg text-gray-900 dark:text-gray-100",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Xe().total)}),n.jsx("td",{})]})]})]})})}),U.length===0&&n.jsx("div",{className:"border-t pt-4 mt-4",children:n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:'No hay productos agregados. Haz clic en "Agregar Producto/Servicio" para comenzar.'})})]})]}),e.modoDetalle==="automatico"&&p&&n.jsx(ve,{title:"Informacin del Ticket",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tienda"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Terminal"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Folio"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subtotal"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IVA"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Forma Pago"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"RFC"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estatus"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID Factura"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.codigoTienda)??"-"}),n.jsx("td",{className:"px-4 py-2",children:p?new Date(p.fecha).toLocaleDateString():"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.terminalId)??"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.folio)??"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.subtotal)!=null?p.subtotal.toFixed(2):"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.iva)!=null?p.iva.toFixed(2):"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.total)!=null?p.total.toFixed(2):"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.formaPago)??"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.nombreCliente)??"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.rfcCliente)??"-"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.status)===1?"Activo":"Cancelado"}),n.jsx("td",{className:"px-4 py-2",children:(p==null?void 0:p.idFactura)??"-"})]})})]})})}),n.jsxs(ve,{title:"Forma de Pago",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsx(Se,{name:"medioPago",label:"Medio de pago",value:e.medioPago,onChange:le,options:ss}),n.jsx(Se,{name:"formaPago",label:"Forma de pago",value:e.formaPago,onChange:le,options:ws})]}),n.jsx("div",{className:"mt-4",children:n.jsx(ta,{name:"iepsDesglosado",label:"IEPS desglosado",checked:e.iepsDesglosado,onChange:le})})]}),n.jsx(ve,{title:"Relacin con CFDI (Sustitucin)",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Si esta factura sustituye a otra, captura el UUID del CFDI original y el tipo de relacin."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsx(J,{name:"uuidCfdiRelacionado",label:"UUID del CFDI a sustituir",value:e.uuidCfdiRelacionado,onChange:le,placeholder:"Ej: A055BE36-AA6D-5F3C-99FE-6A8AD176AD16"}),n.jsx(Se,{name:"tipoRelacion",label:"Tipo de relacin",value:e.tipoRelacion,onChange:le,options:Fh})]}),e.uuidCfdiRelacionado&&!e.tipoRelacion&&n.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded",children:"Si capturaste un UUID de CFDI relacionado, debes seleccionar el tipo de relacin."})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-4 mt-8",children:[n.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 w-full sm:w-auto",children:n.jsx(fe,{type:"button",onClick:G,variant:"neutral",className:"w-full sm:w-auto",children:"Cancelar"})}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 w-full sm:w-auto",children:[n.jsx(fe,{type:"button",onClick:$e,variant:"secondary",className:"w-full sm:w-auto whitespace-nowrap",children:"Descargar XML"}),n.jsx(fe,{type:"button",onClick:Ie,variant:"secondary",className:"w-full sm:w-auto whitespace-nowrap",children:"Descargar PDF"}),n.jsx(fe,{type:"button",onClick:We,variant:"secondary",className:"w-full sm:w-auto whitespace-nowrap",children:"Enviar por Correo"})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 w-full sm:w-auto",children:[n.jsx(fe,{type:"button",onClick:Ve,className:"w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded",children:"Vista Previa"}),n.jsx(fe,{type:"submit",variant:"primary",className:"w-full sm:w-auto",children:"Generar"})]})]})]}),!1,n.jsx(Ep,{isOpen:j.isOpen,onClose:Ze,facturaUuid:j.facturaUuid,facturaInfo:j.facturaInfo,correoInicial:j.correoInicial,rfcReceptor:j.rfcReceptor}),n.jsx(Du,{isOpen:R,onClose:()=>_(!1),onSave:de,rfcInicial:e.rfc}),n.jsx(wk,{isOpen:D,onClose:()=>H(!1),onSelect:oa})]})};var k2,N2,j2;const $U={rfcIniciales:"",rfcFecha:"",rfcHomoclave:"",correoElectronico:"",razonSocial:"",nombre:"",paterno:"",materno:"",pais:((k2=qr[0])==null?void 0:k2.value)||"",noRegistroIdentidadTributaria:"",domicilioFiscal:"",regimenFiscal:((N2=gt[0])==null?void 0:N2.value)||"",usoCfdi:((j2=yt[0])==null?void 0:j2.value)||"",descripcion:"",fechaInformacion:new Date().toISOString().split("T")[0].replace(/-/g,""),numeroSerie:"",precio:"",personaAutoriza:"",puesto:""},VU=()=>{const[e,a]=N.useState($U),t=i=>{const{name:o,value:l}=i.target;a(c=>({...c,[o]:l}))},r=()=>{alert(`Buscando RFC: ${e.rfcIniciales}${e.rfcFecha}${e.rfcHomoclave}`)},s=i=>{i.preventDefault(),console.log("Generar Carta Factura:",e),alert("Generando Carta Factura (simulado). Ver consola para datos.")};return n.jsxs("form",{onSubmit:s,className:"space-y-6",children:[n.jsx(Di,{formData:e,handleChange:t,onRfcSearchClick:r}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Informacin:"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2",children:[n.jsx(ys,{label:"Descripcin:",name:"descripcion",value:e.descripcion,onChange:t,rows:4,className:"md:col-span-2",required:!0}),n.jsx(J,{label:"Fecha:",name:"fechaInformacion",value:e.fechaInformacion,onChange:t,placeholder:"AAAAMMDD",maxLength:8,required:!0}),n.jsx(J,{label:"Nmero de Serie:",name:"numeroSerie",value:e.numeroSerie,onChange:t,required:!0}),n.jsx(J,{label:"Precio:",name:"precio",type:"number",value:e.precio,onChange:t,required:!0}),n.jsx(J,{label:"Persona que autoriza:",name:"personaAutoriza",value:e.personaAutoriza,onChange:t,required:!0}),n.jsx(J,{label:"Puesto:",name:"puesto",value:e.puesto,onChange:t,required:!0})]})]}),n.jsx("div",{className:"flex justify-end mt-6",children:n.jsx(fe,{type:"submit",variant:"primary",children:"GENERAR CARTA FACTURA"})})]})},HU=()=>{const{customColors:e}=N.useContext(Kt),[a,t]=N.useState({fechaInicio:"",fechaFin:"",tienda:"",usuario:""}),[r,s]=N.useState([{id:"1",nombre:"REPORTE DE CONSULTA MONEDEROS",fecha:"2023-10-15",usuario:"admin",tipo:"Monederos",formato:"PDF",tamao:"1.2 MB",estatus:"Disponible",descargas:5}]),[i,o]=N.useState(!1),l=(d,f)=>{t(m=>({...m,[d]:f}))},c=async()=>{o(!0),setTimeout(()=>{const d={id:Date.now().toString(),nombre:"REPORTE DE CONSULTA MONEDEROS",fecha:new Date().toISOString().split("T")[0],usuario:"admin",tipo:"Monederos",formato:"PDF",tamao:"1.2 MB",estatus:"Disponible",descargas:0};s(f=>[d,...f]),o(!1)},2e3)},u=d=>{console.log("Descargando reporte:",d)};return n.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Reporte de Consulta Monederos"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Genera y consulta reportes de monederos electrnicos"})]}),n.jsxs(ve,{title:"Filtros de Bsqueda",className:"mb-8",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(jn,{className:"inline mr-2"}),"Fecha Inicio"]}),n.jsx("input",{type:"date",value:a.fechaInicio,onChange:d=>l("fechaInicio",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(jn,{className:"inline mr-2"}),"Fecha Fin"]}),n.jsx("input",{type:"date",value:a.fechaFin,onChange:d=>l("fechaFin",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(ko,{className:"inline mr-2"}),"Tienda"]}),n.jsxs("select",{value:a.tienda,onChange:d=>l("tienda",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Todas las tiendas"}),n.jsx("option",{value:"S001",children:"Sucursal 1 (S001)"}),n.jsx("option",{value:"S002",children:"Sucursal 2 (S002)"}),n.jsx("option",{value:"S003",children:"Sucursal 3 (S003)"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(xi,{className:"inline mr-2"}),"Usuario"]}),n.jsx("input",{type:"text",value:a.usuario,onChange:d=>l("usuario",d.target.value),placeholder:"Nombre de usuario",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),n.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[n.jsxs("button",{onClick:()=>t({fechaInicio:"",fechaFin:"",tienda:"",usuario:""}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[n.jsx(Sh,{className:"inline mr-2"}),"Limpiar Filtros"]}),n.jsx("button",{onClick:c,disabled:i,className:"px-6 py-2 text-white rounded-md hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:e.primary},children:i?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Generando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Ch,{className:"inline mr-2"}),"Generar Reporte"]})})]})]}),n.jsx(ve,{title:"Reportes Generados",children:r.length===0?n.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[n.jsx(hu,{className:"mx-auto h-12 w-12 mb-4"}),n.jsx("p",{children:"No se encontraron reportes disponibles"})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nombre"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Fecha"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Usuario"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tipo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Formato"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tamao"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Estatus"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Descargas"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Accin"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:r.map(d=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:d.nombre}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.fecha}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.usuario}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.tipo}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.formato}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.tamao}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:d.estatus})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.descargas}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("button",{onClick:()=>u(d.id),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 flex items-center",children:[n.jsx(jh,{className:"mr-1"}),"Descargar"]})})]},d.id))})]})})})]})})},GU=()=>{const{customColors:e}=N.useContext(Kt),[a,t]=N.useState({fechaInicio:"",fechaFin:"",tienda:"",usuario:"",regimen:""}),[r,s]=N.useState([{id:"1",nombre:"RGIMEN DE FACTURACIN NO MISMA BOLETA",fecha:"2023-10-15",usuario:"admin",tipo:"Rgimen Fiscal",formato:"PDF",tamao:"1.8 MB",estatus:"Disponible",descargas:2}]),[i,o]=N.useState(!1),l=(d,f)=>{t(m=>({...m,[d]:f}))},c=async()=>{o(!0),setTimeout(()=>{const d={id:Date.now().toString(),nombre:"RGIMEN DE FACTURACIN NO MISMA BOLETA",fecha:new Date().toISOString().split("T")[0],usuario:"admin",tipo:"Rgimen Fiscal",formato:"PDF",tamao:"1.8 MB",estatus:"Disponible",descargas:0};s(f=>[d,...f]),o(!1)},2e3)},u=d=>{console.log("Descargando reporte:",d)};return n.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Rgimen de Facturacin No Misma Boleta"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Genera y consulta reportes de rgimen de facturacin con boletas diferentes"})]}),n.jsxs(ve,{title:"Filtros de Bsqueda",className:"mb-8",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(jn,{className:"inline mr-2"}),"Fecha Inicio"]}),n.jsx("input",{type:"date",value:a.fechaInicio,onChange:d=>l("fechaInicio",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(jn,{className:"inline mr-2"}),"Fecha Fin"]}),n.jsx("input",{type:"date",value:a.fechaFin,onChange:d=>l("fechaFin",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(ko,{className:"inline mr-2"}),"Tienda"]}),n.jsxs("select",{value:a.tienda,onChange:d=>l("tienda",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Todas las tiendas"}),n.jsx("option",{value:"S001",children:"Sucursal 1 (S001)"}),n.jsx("option",{value:"S002",children:"Sucursal 2 (S002)"}),n.jsx("option",{value:"S003",children:"Sucursal 3 (S003)"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(xi,{className:"inline mr-2"}),"Usuario"]}),n.jsx("input",{type:"text",value:a.usuario,onChange:d=>l("usuario",d.target.value),placeholder:"Nombre de usuario",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(Wm,{className:"inline mr-2"}),"Rgimen"]}),n.jsxs("select",{value:a.regimen,onChange:d=>l("regimen",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Todos los regmenes"}),n.jsx("option",{value:"601",children:"General de Ley Personas Morales"}),n.jsx("option",{value:"605",children:"Sueldos y Salarios"}),n.jsx("option",{value:"606",children:"Arrendamiento"}),n.jsx("option",{value:"612",children:"Personas Fsicas con Actividades Empresariales"})]})]})]}),n.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[n.jsxs("button",{onClick:()=>t({fechaInicio:"",fechaFin:"",tienda:"",usuario:"",regimen:""}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[n.jsx(Sh,{className:"inline mr-2"}),"Limpiar Filtros"]}),n.jsx("button",{onClick:c,disabled:i,className:"px-6 py-2 text-white rounded-md hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:e.primary},children:i?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Generando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Ch,{className:"inline mr-2"}),"Generar Reporte"]})})]})]}),n.jsx(ve,{title:"Reportes Generados",children:r.length===0?n.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[n.jsx(hu,{className:"mx-auto h-12 w-12 mb-4"}),n.jsx("p",{children:"No se encontraron reportes disponibles"})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nombre"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Fecha"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Usuario"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tipo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Formato"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tamao"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Estatus"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Descargas"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Accin"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:r.map(d=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:d.nombre}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.fecha}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.usuario}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.tipo}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.formato}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.tamao}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:d.estatus})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.descargas}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("button",{onClick:()=>u(d.id),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 flex items-center",children:[n.jsx(jh,{className:"mr-1"}),"Descargar"]})})]},d.id))})]})})})]})})},XU=()=>{const{customColors:e}=N.useContext(Kt),[a,t]=N.useState({fechaInicio:"",fechaFin:"",tienda:"",usuario:"",maquina:""}),[r,s]=N.useState([{id:"1",nombre:"REPORTE DE VENTAS MQUINA CORPORATIVAS SERELY POLU",fecha:"2023-10-15",usuario:"admin",tipo:"Ventas Corporativas",formato:"PDF",tamao:"2.1 MB",estatus:"Disponible",descargas:3}]),[i,o]=N.useState(!1),l=(d,f)=>{t(m=>({...m,[d]:f}))},c=async()=>{o(!0),setTimeout(()=>{const d={id:Date.now().toString(),nombre:"REPORTE DE VENTAS MQUINA CORPORATIVAS SERELY POLU",fecha:new Date().toISOString().split("T")[0],usuario:"admin",tipo:"Ventas Corporativas",formato:"PDF",tamao:"2.1 MB",estatus:"Disponible",descargas:0};s(f=>[d,...f]),o(!1)},2e3)},u=d=>{console.log("Descargando reporte:",d)};return n.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Reporte de Ventas Mquina Corporativas Serely Polu"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Genera y consulta reportes de ventas de mquinas corporativas"})]}),n.jsxs(ve,{title:"Filtros de Bsqueda",className:"mb-8",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(jn,{className:"inline mr-2"}),"Fecha Inicio"]}),n.jsx("input",{type:"date",value:a.fechaInicio,onChange:d=>l("fechaInicio",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(jn,{className:"inline mr-2"}),"Fecha Fin"]}),n.jsx("input",{type:"date",value:a.fechaFin,onChange:d=>l("fechaFin",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(ko,{className:"inline mr-2"}),"Tienda"]}),n.jsxs("select",{value:a.tienda,onChange:d=>l("tienda",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Todas las tiendas"}),n.jsx("option",{value:"S001",children:"Sucursal 1 (S001)"}),n.jsx("option",{value:"S002",children:"Sucursal 2 (S002)"}),n.jsx("option",{value:"S003",children:"Sucursal 3 (S003)"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(xi,{className:"inline mr-2"}),"Usuario"]}),n.jsx("input",{type:"text",value:a.usuario,onChange:d=>l("usuario",d.target.value),placeholder:"Nombre de usuario",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n.jsx(Wi,{className:"inline mr-2"}),"Mquina"]}),n.jsxs("select",{value:a.maquina,onChange:d=>l("maquina",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Todas las mquinas"}),n.jsx("option",{value:"MAQ001",children:"Mquina 001"}),n.jsx("option",{value:"MAQ002",children:"Mquina 002"}),n.jsx("option",{value:"MAQ003",children:"Mquina 003"})]})]})]}),n.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[n.jsxs("button",{onClick:()=>t({fechaInicio:"",fechaFin:"",tienda:"",usuario:"",maquina:""}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[n.jsx(Sh,{className:"inline mr-2"}),"Limpiar Filtros"]}),n.jsx("button",{onClick:c,disabled:i,className:"px-6 py-2 text-white rounded-md hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:e.primary},children:i?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Generando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Ch,{className:"inline mr-2"}),"Generar Reporte"]})})]})]}),n.jsx(ve,{title:"Reportes Generados",children:r.length===0?n.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[n.jsx(hu,{className:"mx-auto h-12 w-12 mb-4"}),n.jsx("p",{children:"No se encontraron reportes disponibles"})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nombre"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Fecha"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Usuario"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tipo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Formato"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tamao"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Estatus"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Descargas"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Accin"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:r.map(d=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:d.nombre}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.fecha}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.usuario}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.tipo}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.formato}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.tamao}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:d.estatus})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:d.descargas}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("button",{onClick:()=>u(d.id),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 flex items-center",children:[n.jsx(jh,{className:"mr-1"}),"Descargar"]})})]},d.id))})]})})})]})})};var S2,C2;const ov=(((C2=(S2=import.meta)==null?void 0:S2.env)==null?void 0:C2.VITE_CREDIT_NOTES_BASE_URL)||"http://174.136.25.157:8080/facturacion-backend-0.0.1-SNAPSHOT").replace(/\/+$/,""),lv=.16,cv="84111506",dv="00000",uv=/\b\d{5}\b/;var T2,F2,_2;const qU={rfc:"",correoElectronico:"",razonSocial:"",nombre:"",paterno:"",materno:"",pais:((T2=qr[0])==null?void 0:T2.value)||"",noRegistroIdentidadTributaria:"",domicilioFiscal:"",regimenFiscal:((F2=gt[0])==null?void 0:F2.value)||"",usoCfdi:((_2=yt[0])==null?void 0:_2.value)||"",referenciaFactura:"",motivo:"",serie:"NC",folio:"",metodoPago:"PUE",formaPago:"01"},YU=e=>{if(e)try{return btoa(unescape(encodeURIComponent(e)))}catch(a){console.warn("No se pudo convertir a Base64",a);return}},WU=()=>{const{empresaInfo:e}=On(),{customColors:a,logoUrl:t}=N.useContext(Kt),[r,s]=N.useState(qU),[i,o]=N.useState({descripcion:"DEVOLUCION_MERCANCIA",cantidad:1,unidad:"E48",precioUnitario:0}),[l,c]=N.useState(""),[u,d]=N.useState({}),[f,m]=N.useState(!1),[x,h]=N.useState(null),[g,p]=N.useState(!1),[v,w]=N.useState(null),b=N.useRef(null),[y,j]=N.useState(!1),A=q=>q.length===12,E=q=>q.length===13,F=q=>{if(!q)return{codigoPostal:"",calle:"",numeroExterior:"",numeroInterior:"",colonia:"",municipio:"",estado:""};const ne={codigoPostal:"",calle:"",numeroExterior:"",numeroInterior:"",colonia:"",municipio:"",estado:""},G=q.match(/(?:C\.?P\.?\s*)?(\d{5})(?:\s|$|,)/i);G&&(ne.codigoPostal=G[1]);const ee=q.split(",").map(we=>we.trim());if(ee.length>0){const we=ee[0],je=we.match(/(\d+[A-Za-z]?|MZ\s*\d+|LT\s*\d+|EDIF\s*\w+)/i);if(je){ne.numeroExterior=je[1];const $e=we.substring(0,je.index).trim();ne.calle=$e}else ne.calle=we;const Me=we.match(/Int\.\s*(\S+)/i);Me&&(ne.numeroInterior=Me[1])}let ie=!1;for(let we=1;we<ee.length&&!ie;we++)if(ee[we].match(/C\.?P\.?\s*\d{5}/i)){ie=!0,we>1&&(ne.estado=ee[we-1]),we>2&&(ne.municipio=ee[we-2]),we>3&&(ne.colonia=ee[we-3]);break}return!ie&&ee.length>=3&&(ne.colonia=ee[ee.length-3]||"",ne.municipio=ee[ee.length-2]||"",ne.estado=ee[ee.length-1]||""),ne},k=async q=>{const ne=F(q.domicilioFiscal),G=[ne.calle,ne.numeroExterior,ne.numeroInterior,ne.colonia,ne.municipio,ne.estado,ne.codigoPostal].filter(Boolean).join(", ")||q.domicilioFiscal;s(ee=>({...ee,rfc:q.rfc,razonSocial:q.razonSocial||ee.razonSocial,nombre:q.nombre||ee.nombre,paterno:q.paterno||ee.paterno,materno:q.materno||ee.materno,correoElectronico:q.correoElectronico||ee.correoElectronico,pais:q.pais||ee.pais,domicilioFiscal:G||ee.domicilioFiscal,regimenFiscal:q.regimenFiscal||ee.regimenFiscal,usoCfdi:q.usoCfdi||ee.usoCfdi}))},P=()=>{j(!0)},R=async q=>{try{const ne={rfc:q.rfc,razon_social:q.razonSocial,nombre:q.nombre,paterno:q.apellidoPaterno,materno:q.apellidoMaterno,correo_electronico:q.correoElectronico,telefono:q.telefono,codigo_postal:q.codigoPostal,estado:q.estado,municipio:q.municipio,colonia:q.colonia,calle:q.calle,numero_exterior:q.numeroExterior,numero_interior:q.numeroInterior,pais:q.pais,regimen_fiscal:q.regimenFiscal,uso_cfdi:q.usoCfdi,registro_tributario:q.esExtranjero?"EXT":null},G=await fetch(Re("/catalogo-clientes"),{method:"POST",headers:Ca(),body:JSON.stringify(ne)}),ee=await G.json();if(!G.ok||ee.error)throw new Error(ee.error||"Error al guardar cliente");const we=[q.calle,q.numeroExterior,q.numeroInterior,q.colonia,q.municipio,q.estado,q.codigoPostal,q.pais].filter(Boolean).join(", ");s(je=>({...je,rfc:q.rfc,razonSocial:q.razonSocial,nombre:q.nombre||je.nombre,paterno:q.apellidoPaterno||je.paterno,materno:q.apellidoMaterno||je.materno,correoElectronico:q.correoElectronico,pais:q.pais,domicilioFiscal:we,regimenFiscal:q.regimenFiscal,usoCfdi:q.usoCfdi})),j(!1)}catch(ne){throw console.error("Error al guardar cliente:",ne),ne}};N.useEffect(()=>{const q=(r.rfc||"").trim().toUpperCase();let ne=null;q&&q.length>=12&&(A(q)?ne="moral":E(q)&&(ne="fisica")),ne!==b.current&&(b.current=ne,w(ne),ne==="moral"?s(G=>({...G,nombre:"",paterno:"",materno:""})):ne==="fisica"&&s(G=>({...G,razonSocial:""})))},[r.rfc]);const _=q=>new Promise((ne,G)=>{const ee=new FileReader;ee.onloadend=()=>{const ie=ee.result;ne((ie||"").split(",")[1]||"")},ee.onerror=G,ee.readAsDataURL(q)}),Q=async q=>{},C=q=>{const{name:ne,value:G}=q.target;s(ee=>({...ee,[ne]:G})),h(null),d(ee=>{const ie={...ee};return ie[ne]&&delete ie[ne],ie})},z=q=>{const{name:ne,value:G}=q.target;ne==="descripcionLibre"?c(G):o(ee=>({...ee,[ne]:ne==="cantidad"||ne==="precioUnitario"?G===""?"":Number(G):G}))},S=()=>{var Ve,Ze,Fe,na,oa,$a,Xe;const q=(r.rfc||"").trim().toUpperCase(),ne=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,G=/^[A-Z&]{3,4}[0-9]{6}[A-Z0-9]{3}$/,ee={},ie=((Ve=r.correoElectronico)==null?void 0:Ve.trim())||"",we=((Ze=r.razonSocial)==null?void 0:Ze.trim())||"",je=((Fe=r.domicilioFiscal)==null?void 0:Fe.trim())||"",Me=((na=r.nombre)==null?void 0:na.trim())||"",$e=((oa=r.paterno)==null?void 0:oa.trim())||"",Ie=(($a=r.usoCfdi)==null?void 0:$a.trim())||"",We=((Xe=r.regimenFiscal)==null?void 0:Xe.trim())||"";return ne.test(ie)||(ee.correoElectronico="Email invlido"),G.test(q)||(ee.rfc="RFC invlido"),v!=="fisica"&&!we&&(ee.razonSocial="Campo requerido"),v==="fisica"&&(Me||(ee.nombre="Campo requerido"),$e||(ee.paterno="Campo requerido")),je?uv.test(je)||(ee.domicilioFiscal="Incluye un CP vlido (5 dgitos)"):ee.domicilioFiscal="Campo requerido",We||(ee.regimenFiscal="Campo requerido"),Ie||(ee.usoCfdi="Campo requerido"),d(ee),Object.keys(ee).length===0},D=()=>{const q=typeof i.cantidad=="number"?i.cantidad:0,ne=typeof i.precioUnitario=="number"?i.precioUnitario:0,G=q*ne,ee=+(G*.16).toFixed(2),ie=+(G+ee).toFixed(2);return{subtotal:G,iva:ee,total:ie}},H=()=>{var q;return i.descripcion==="OTRO"?l.trim():((q=fv.find(ne=>ne.value===i.descripcion))==null?void 0:q.label)||i.descripcion},U=q=>{if(!q)return"";const ne=q.match(uv);return ne?ne[0]:q.trim()},B=async()=>{if(!S())return h({tipo:"error",texto:"Completa los datos fiscales obligatorios"}),null;if(i.descripcion==="OTRO"&&!l.trim())return h({tipo:"error",texto:"Especifica la descripcin libre del concepto"}),null;const q=(r.rfc||"").trim().toUpperCase(),{subtotal:ne,iva:G,total:ee}=D(),ie=await Q(r.referenciaFactura),we=H(),je=typeof i.cantidad=="number"?i.cantidad:0,Me=typeof i.precioUnitario=="number"?i.precioUnitario:0;return{notaData:{uuid:(ie==null?void 0:ie.uuidNc)||"",serie:r.serie||(ie==null?void 0:ie.serie)||"NC",folio:r.folio||(ie==null?void 0:ie.folio)||new Date().getTime().toString().slice(-6),fechaEmision:new Date().toISOString(),rfcEmisor:e.rfc,nombreEmisor:e.nombre,rfcReceptor:q,nombreReceptor:r.razonSocial||`${r.nombre} ${r.paterno} ${r.materno}`.trim()||q,domicilioFiscalReceptor:r.domicilioFiscal.trim(),usoCfdi:r.usoCfdi,regimenFiscal:r.regimenFiscal,formaPago:r.formaPago,metodoPago:r.metodoPago,subtotal:ne,iva:G,ivaTasa:lv,importe:ee,conceptos:[{descripcion:we,cantidad:je,unidad:i.unidad,precioUnitario:Me,importe:ne,claveProdServ:cv}],referenciaFactura:r.referenciaFactura||void 0,motivo:r.motivo||void 0,lugarExpedicion:dv},rfcReceptor:q}},X=(q,ne,G)=>{const ee=new Blob([q],{type:"application/xml"}),ie=window.URL.createObjectURL(ee),we=document.createElement("a");we.href=ie,we.download=`NotaCredito_${ne}-${G}.xml`,document.body.appendChild(we),we.click(),window.URL.revokeObjectURL(ie),document.body.removeChild(we)},T=async()=>{let q={logoUrl:t,customColors:a};try{const ne=await ma.obtenerConfiguracionLogos();ne!=null&&ne.exitoso&&(q={logoUrl:ne.logoUrl,logoBase64:ne.logoBase64,customColors:ne.customColors})}catch{}return q},L=q=>{const ne=new Date(q.fechaEmision).toISOString().split(".")[0],G=q.conceptos[0],ee=U(q.domicilioFiscalReceptor),ie=q.iva>0,we=(q.ivaTasa??lv).toFixed(6),je=ie?"02":"01";return`<?xml version="1.0" encoding="UTF-8"?>
<cfdi:Comprobante xmlns:cfdi="http://www.sat.gob.mx/cfd/4" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.sat.gob.mx/cfd/4 http://www.sat.gob.mx/sitio_internet/cfd/4/cfdv40.xsd" Version="4.0" Serie="${q.serie}" Folio="${q.folio}" Fecha="${ne}" SubTotal="${q.subtotal.toFixed(2)}" Total="${q.importe.toFixed(2)}" Moneda="MXN" TipoDeComprobante="E" Exportacion="01" LugarExpedicion="${q.lugarExpedicion||dv}" FormaPago="${q.formaPago}" MetodoPago="${q.metodoPago}">
${q.referenciaFactura?`  <cfdi:CfdiRelacionados TipoRelacion="${q.motivo||"01"}">
    <cfdi:CfdiRelacionado UUID="${q.referenciaFactura.toUpperCase()}"/>
  </cfdi:CfdiRelacionados>
`:""}  <cfdi:Emisor Rfc="${q.rfcEmisor}" Nombre="${q.nombreEmisor}" RegimenFiscal="601"/>
  <cfdi:Receptor Rfc="${q.rfcReceptor}" Nombre="${q.nombreReceptor}" DomicilioFiscalReceptor="${ee}" RegimenFiscalReceptor="${q.regimenFiscal}" UsoCFDI="${q.usoCfdi}"/>
  <cfdi:Conceptos>
    <cfdi:Concepto ClaveProdServ="${G.claveProdServ}" Cantidad="${G.cantidad.toFixed(6).replace(/0+$/,"").replace(/\.$/,"")}" ClaveUnidad="${G.unidad||"E48"}" Descripcion="${G.descripcion}" ValorUnitario="${G.precioUnitario.toFixed(2)}" Importe="${G.importe.toFixed(2)}" ObjetoImp="${je}">
${ie?`      <cfdi:Impuestos>
        <cfdi:Traslados>
          <cfdi:Traslado Base="${q.subtotal.toFixed(2)}" Impuesto="002" TipoFactor="Tasa" TasaOCuota="${we}" Importe="${q.iva.toFixed(2)}"/>
        </cfdi:Traslados>
      </cfdi:Impuestos>
    </cfdi:Concepto>`:"    </cfdi:Concepto>"}
  </cfdi:Conceptos>
${ie?`  <cfdi:Impuestos TotalImpuestosTrasladados="${q.iva.toFixed(2)}">
    <cfdi:Traslados>
      <cfdi:Traslado Base="${q.subtotal.toFixed(2)}" Impuesto="002" TipoFactor="Tasa" TasaOCuota="${we}" Importe="${q.iva.toFixed(2)}"/>
    </cfdi:Traslados>
  </cfdi:Impuestos>
`:""}</cfdi:Comprobante>`},V=async(q,ne)=>{try{const G=L(q),ee=q.conceptos[0],ie={uuidFacturaOrig:q.referenciaFactura||void 0,serieFacturaOrig:void 0,folioFacturaOrig:void 0,uuidNc:q.uuid||void 0,serieNc:q.serie,folioNc:q.folio,fechaEmision:q.fechaEmision,usoCfdi:q.usoCfdi,regimenFiscal:q.regimenFiscal,motivo:q.motivo||void 0,concepto:(ee==null?void 0:ee.descripcion)||"Nota de crdito",cantidad:(ee==null?void 0:ee.cantidad)||1,unidad:(ee==null?void 0:ee.unidad)||"E48",precioUnitario:(ee==null?void 0:ee.precioUnitario)||0,subtotal:q.subtotal,ivaImporte:q.iva,ivaPorcentaje:q.ivaTasa,iepsImporte:0,iepsPorcentaje:void 0,total:q.importe,xmlContent:G,rfcEmisor:q.rfcEmisor,rfcReceptor:ne,formaPago:q.formaPago,metodoPago:q.metodoPago,nombreReceptor:q.nombreReceptor,domicilioFiscalReceptor:q.domicilioFiscalReceptor},we=await fetch(`${ov}/credit-notes/guardar`,{method:"POST",headers:Ca(),body:JSON.stringify(ie)}),je=await we.json();if(!we.ok||!(je!=null&&je.ok)){const We=(je==null?void 0:je.errors)||[],Ve=We.length?We.join(" | "):(je==null?void 0:je.message)||"No se pudo guardar la nota de crdito";throw new Error(Ve)}je!=null&&je.uuidNc&&(ie.uuidNc=je.uuidNc,q.uuid=je.uuidNc);const Me=await fetch(`${ov}/credit-notes/timbrar`,{method:"POST",headers:Ca(),body:JSON.stringify(ie)}),$e=await Me.json();if(!Me.ok||!($e!=null&&$e.ok)){const We=($e==null?void 0:$e.message)||"Guardado correcto, pero el PAC rechaz el timbrado";throw new Error(We)}const Ie={ok:!0,uuid:$e.uuid||ie.uuidNc,serie:$e.serie||q.serie,folio:$e.folio||q.folio,xmlTimbrado:$e.xmlTimbrado||G,message:$e.message};return q.uuid=Ie.uuid||q.uuid,q.serie=Ie.serie||q.serie,q.folio=Ie.folio||q.folio,Ie}catch(G){return console.warn("Fallo guardando NOTA_CREDITO:",G),{ok:!1,error:(G==null?void 0:G.message)||"Error al guardar la nota de crdito"}}},O=async(q,ne,G,ee=!0)=>{try{ee&&p(!0),G!=null&&G.uuid&&(q.uuid=G.uuid),G!=null&&G.serie&&(q.serie=G.serie),G!=null&&G.folio&&(q.folio=G.folio);const ie=await T(),we=me(q),je=await fetch(Re("/factura/generar-pdf"),{method:"POST",headers:Ca(),body:JSON.stringify({facturaData:we,logoConfig:ie})});if(!je.ok)throw new Error("Error al generar PDF en el servidor");const Me=await je.blob(),$e=await _(Me),Ie=await Jr.obtenerMensajeParaEnvio(),We=`${q.serie}-${q.folio}`;let Ve=(Ie==null?void 0:Ie.asunto)||"Nota de Crdito - {facturaInfo}";Ve=Jr.procesarMensaje(Ve,{facturaInfo:We,serie:q.serie,folio:q.folio,uuid:q.uuid||"",rfcEmisor:q.rfcEmisor,rfcReceptor:ne});const Ze={facturaInfo:We,serie:q.serie,folio:q.folio,uuid:q.uuid||"",rfcEmisor:q.rfcEmisor,rfcReceptor:ne},Fe=(Ie==null?void 0:Ie.mensajePersonalizado)||(Ie==null?void 0:Ie.mensaje)||`Se ha generado su nota de crdito.

Gracias por su preferencia.`,na=(G==null?void 0:G.xmlTimbrado)||L(q),oa=YU(na),$a=await Pt.enviarPdfDirecto({pdfBase64:$e,correoReceptor:r.correoElectronico,asunto:Ve,mensaje:Fe,nombreAdjunto:`NotaCredito_${q.serie}-${q.folio}.pdf`,templateVars:Ze,xmlBase64:oa,nombreAdjuntoXml:oa?`NotaCredito_${q.serie}-${q.folio}.xml`:void 0});return $a.success?(h({tipo:"success",texto:$a.message||"Correo enviado exitosamente"}),alert(`PDF de nota de crdito enviado exitosamente al correo: ${r.correoElectronico}`),!0):(h({tipo:"error",texto:$a.message||"Error al enviar el correo"}),!1)}catch(ie){return h({tipo:"error",texto:(ie==null?void 0:ie.message)||"Error al enviar el correo"}),!1}finally{ee&&p(!1)}},de=async()=>{h(null);const q=await B();if(!q)return;const{notaData:ne,rfcReceptor:G}=q;try{m(!0);const ee=await V(ne,G);ee.ok?(h({tipo:"success",texto:"Nota de crdito guardada y timbrada correctamente con Finkok demo"}),alert(`Factura emitida y timbrada exitosamente
UUID: ${ee.uuid||"SIN-UUID"}`),window.confirm("Desea enviar la factura al correo?")&&await O(ne,G,ee)):h({tipo:"error",texto:ee.error||"No se pudo guardar la nota de crdito"})}catch(ee){h({tipo:"error",texto:(ee==null?void 0:ee.message)||"Error al guardar la nota de crdito"})}finally{m(!1)}},me=q=>({uuid:q.uuid,serie:q.serie,folio:q.folio,fechaEmision:q.fechaEmision,rfcEmisor:q.rfcEmisor,nombreEmisor:q.nombreEmisor,rfcReceptor:q.rfcReceptor,nombreReceptor:q.nombreReceptor,subtotal:q.subtotal,iva:q.iva,total:q.importe,moneda:"MXN",metodoPago:q.metodoPago,formaPago:q.formaPago,usoCfdi:q.usoCfdi||q.usoCFDI,tipoComprobante:"E",lugarExpedicion:"12345",xmlTimbrado:L(q),cadenaOriginal:`||1.1|${q.uuid||"SIN-UUID"}|${q.fechaEmision}||`,selloDigital:"ABC123DEF456",certificado:"MIIE",folioFiscal:q.uuid||"",fechaTimbrado:q.fechaEmision,conceptos:q.conceptos.map(ne=>({claveProdServ:ne.claveProdServ||cv,noIdentificacion:"NC001",cantidad:ne.cantidad,claveUnidad:ne.unidad||"E48",unidad:ne.unidad,descripcion:ne.descripcion,valorUnitario:ne.precioUnitario,importe:ne.importe,descuento:0,impuestos:[{tipo:"Traslado",impuesto:"002",tipoFactor:"Tasa",tasaOCuota:.16,base:ne.importe,importe:+(ne.importe*.16).toFixed(2)}]}))}),ae=async()=>{h(null);const q=await B();if(!q)return;const{notaData:ne,rfcReceptor:G}=q;try{m(!0);const ee=await V(ne,G);if(!ee.ok){h({tipo:"error",texto:ee.error||"No se pudo timbrar la nota de crdito"});return}const ie=await T(),we=me(ne),je=await fetch(Re("/factura/generar-pdf"),{method:"POST",headers:Ca(),body:JSON.stringify({facturaData:we,logoConfig:ie})});if(!je.ok)throw new Error("Error al generar PDF en el servidor");const Me=await je.blob();tx.descargarPDF(Me,`NotaCredito_${ne.serie}-${ne.folio}.pdf`),X(ee.xmlTimbrado||L(ne),ne.serie,ne.folio),h({tipo:"success",texto:"PDF y XML descargados correctamente"})}catch(ee){h({tipo:"error",texto:(ee==null?void 0:ee.message)||"Error al descargar PDF/XML"})}finally{m(!1)}},ce=async()=>{h(null);const q=await B();if(!q)return;const{notaData:ne,rfcReceptor:G}=q;try{m(!0);const ee=await V(ne,G);if(!ee.ok){h({tipo:"error",texto:ee.error||"No se pudo timbrar la nota de crdito"});return}X(ee.xmlTimbrado||L(ne),ne.serie,ne.folio),h({tipo:"success",texto:"XML descargado correctamente"})}catch(ee){h({tipo:"error",texto:(ee==null?void 0:ee.message)||"Error al descargar XML"})}finally{m(!1)}},W=async()=>{h(null);const q=await B();if(!q)return;const{notaData:ne}=q;try{const G=await T(),ee=me(ne),ie=await fetch(Re("/factura/generar-pdf"),{method:"POST",headers:Ca(),body:JSON.stringify({facturaData:ee,logoConfig:G})});if(!ie.ok)throw new Error("Error al generar PDF en el servidor");const we=await ie.blob(),je=window.URL.createObjectURL(we),Me=document.createElement("a");Me.href=je,Me.target="_blank",Me.rel="noopener noreferrer",document.body.appendChild(Me),Me.click(),document.body.removeChild(Me),window.URL.revokeObjectURL(je)}catch(G){h({tipo:"error",texto:(G==null?void 0:G.message)||"Error al generar vista previa"})}},le=async()=>{h(null);const q=await B();if(!q)return;const{notaData:ne,rfcReceptor:G}=q;try{m(!0);const ee=await V(ne,G);if(!ee.ok){h({tipo:"error",texto:ee.error||"No se pudo timbrar la nota de crdito"});return}const ie=await T(),we=me(ne),je=await fetch(Re("/factura/generar-pdf"),{method:"POST",headers:Ca(),body:JSON.stringify({facturaData:we,logoConfig:ie})});if(!je.ok)throw new Error("Error al generar PDF en el servidor");const Me=await je.blob();tx.descargarPDF(Me,`NotaCredito_${ne.serie}-${ne.folio}.pdf`),h({tipo:"success",texto:"PDF descargado correctamente"})}catch(ee){h({tipo:"error",texto:(ee==null?void 0:ee.message)||"Error al descargar PDF"})}finally{m(!1)}},I=async()=>{h(null);const q=await B();if(!q)return;const{notaData:ne,rfcReceptor:G}=q;try{p(!0);const ee=await V(ne,G);if(!ee.ok){h({tipo:"error",texto:ee.error||"No se pudo timbrar la nota de crdito"});return}await O(ne,G,ee,!1)}catch(ee){h({tipo:"error",texto:(ee==null?void 0:ee.message)||"Error al enviar el correo"})}finally{p(!1)}};return n.jsxs("form",{onSubmit:q=>q.preventDefault(),className:"space-y-6",children:[n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Datos fiscales:"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"RFC *"}),n.jsx(Jc,{value:r.rfc,onChange:q=>s(ne=>({...ne,rfc:q})),onSelect:k,onNotFound:P,required:!0}),u.rfc&&n.jsx("p",{className:"text-red-600 text-xs mt-1",children:u.rfc})]})})]}),n.jsx(ve,{children:n.jsx(Di,{formData:{rfcIniciales:"",rfcFecha:"",rfcHomoclave:"",correoElectronico:r.correoElectronico,razonSocial:r.razonSocial,nombre:r.nombre,paterno:r.paterno,materno:r.materno,pais:r.pais,noRegistroIdentidadTributaria:r.noRegistroIdentidadTributaria,domicilioFiscal:r.domicilioFiscal,regimenFiscal:r.regimenFiscal,usoCfdi:r.usoCfdi},handleChange:C,isRFCRequired:!1,isRazonSocialRequired:!0,isDomicilioFiscalRequired:!0,isRegimenFiscalRequired:!0,isUsoCfdiRequired:!0,isCorreoElectronicoRequired:!0,fieldErrors:u,mostrarRazonSocial:v==="moral"||v===null,mostrarNombreCompleto:v==="fisica"||v===null,ocultarRFC:!0})}),n.jsx(Du,{isOpen:y,onClose:()=>j(!1),onSave:R,rfcInicial:r.rfc}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Detalles de la Nota de crdito"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2",children:[n.jsx(J,{label:"Referencia factura:",name:"referenciaFactura",value:r.referenciaFactura,onChange:C}),n.jsx(Se,{label:"Motivo de la nota de crdito:",name:"motivo",value:r.motivo,onChange:C,options:KU}),n.jsx(J,{label:"Serie:",name:"serie",value:r.serie,onChange:C}),n.jsx(J,{label:"Folio:",name:"folio",value:r.folio,onChange:C}),n.jsx(Se,{label:"Uso CFDI:",name:"usoCfdi",value:r.usoCfdi,onChange:C,options:yt}),n.jsx(Se,{label:"Rgimen Fiscal:",name:"regimenFiscal",value:r.regimenFiscal,onChange:C,options:gt})]})]}),n.jsxs(ve,{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Concepto"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2",children:[n.jsx(Se,{label:"Concepto / descripcin:",name:"descripcion",value:i.descripcion,onChange:z,options:fv}),i.descripcion==="OTRO"&&n.jsx(J,{label:"Descripcin libre:",name:"descripcionLibre",value:l,onChange:z}),n.jsx(J,{label:"Cantidad:",name:"cantidad",type:"number",value:i.cantidad,onChange:z}),n.jsx(J,{label:"Unidad:",name:"unidad",value:i.unidad,onChange:z}),n.jsx(J,{label:"Precio Unitario:",name:"precioUnitario",type:"number",value:i.precioUnitario,onChange:z})]}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Los importes se calcularn automticamente para el PDF de vista previa."})]}),n.jsxs("div",{className:"flex justify-end mt-4",children:[n.jsx(fe,{type:"button",variant:"secondary",onClick:W,disabled:f||g,children:"Vista Previa"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:de,disabled:f||g,children:"Guardar factura"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:I,disabled:f||g,children:"Enviar por correo"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:ce,disabled:f,children:"Descargar XML"}),n.jsx(fe,{type:"button",variant:"secondary",onClick:le,disabled:f,children:"Descargar PDF"}),n.jsx(fe,{type:"button",variant:"primary",onClick:ae,disabled:f,children:"Descargar PDF y XML"})]}),x&&n.jsxs("div",{className:x.tipo==="success"?"mt-4 rounded-md border border-green-200 bg-green-50 p-4 text-green-800":"mt-4 rounded-md border border-red-200 bg-red-50 p-4 text-red-800",children:[n.jsx("p",{className:"font-semibold mb-1",children:x.tipo==="success"?"Operacin exitosa":"Error en operacin"}),n.jsx("p",{className:"text-sm",children:x.texto})]})]})},KU=[{value:"01",label:"01  Devolucin de mercancas"},{value:"02",label:"02  Descuento sobre factura"},{value:"03",label:"03  Bonificacin"},{value:"04",label:"04  Disminucin en el valor de la operacin"},{value:"05",label:"05  Cancelacin por error en factura"}],fv=[{value:"DEVOLUCION_MERCANCIA",label:"Devolucin de mercancas"},{value:"DESCUENTO_ERROR_PRECIO",label:"Descuento aplicado por error en el precio unitario"},{value:"BONIFICACION",label:"Bonificacin"},{value:"DISMINUCION_VALOR",label:"Disminucin en el valor de la operacin"},{value:"CANCELACION_SERVICIO",label:"Cancelacin de servicio no realizado"},{value:"AJUSTE_IVA_INCORRECTO",label:"Ajuste por factura emitida con IVA incorrecto"},{value:"OTRO",label:"Otro (texto libre)"}],Kf={noUsuario:Jm.username,nombreEmpleado:"Usuario demo (Cibercom)",nombrePerfil:"Demo",idPerfil:1,estatusUsuario:"A",idDfi:1,idEstacionamiento:null,modificaUbicacion:null};function Jf(e,a){return e===Jm.username&&a===Jm.password}async function JU(e,a){var s;let t=null;try{const i=typeof window<"u"&&(((s=window.localStorage)==null?void 0:s.getItem("cibercom.debugLogin"))==="true"||new URLSearchParams(window.location.search).get("debug")==="1"),o={"Content-Type":"application/json"};i&&(o["X-Debug-Login"]="true"),t=await fetch(Re("/auth/login"),{method:"POST",headers:o,body:JSON.stringify({usuario:e,password:a})})}catch{if(Jf(e,a))return{success:!0,message:"Modo demo (sin conexin al servidor)",usuario:Kf};throw new Error("No se pudo conectar con el servidor de autenticacin.")}let r=null;try{r=await t.json()}catch{if(!t.ok){if(t.status>=500&&Jf(e,a))return{success:!0,message:"Modo demo (servidor no disponible)",usuario:Kf};throw new Error("Respuesta invlida del servidor de autenticacin.")}}if(!t.ok){if(t.status>=500&&Jf(e,a))return{success:!0,message:"Modo demo (servidor con errores)",usuario:Kf};const i=(r==null?void 0:r.message)||(t.status===401?"Usuario o contrasea incorrectos.":`Error de autenticacin (${t.status}).`);throw new Error(i)}if(!(r!=null&&r.success))throw new Error((r==null?void 0:r.message)||"Usuario o contrasea incorrectos.");return r}const ZU={theme:"light",setTheme:()=>{},toggleTheme:()=>{},customColors:_0,setCustomColors:()=>{},logoUrl:Th(),setLogoUrl:()=>{}},Kt=N.createContext(ZU),mv="Cibercom Facturacin",Vi="cibercom.authenticated",kk="cibercom.theme",Nk="cibercom.customColors",kx="logoUrl",jk="cibercom.activePath",Nx="cibercom.user",Hi="cibercom.token",zn="cibercom.sessionTimestamp",xv=30*1e3,Zc=e=>{const a=[];return e.forEach(t=>{t.path&&a.push(t),t.children&&t.children.length>0&&a.push(...Zc(t.children))}),a},QU=({label:e})=>n.jsxs("div",{className:"p-6 text-center text-gray-600 dark:text-gray-300",children:[n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Seccin en construccin"}),n.jsxs("p",{children:["La seccin ",n.jsx("strong",{children:e})," an no cuenta con una implementacin completa."]})]}),hv=(e,a)=>{const t=a.trim().toLowerCase();return Zc(e).find(r=>{var s;return((s=r.path)==null?void 0:s.toLowerCase())===t||r.label.trim().toLowerCase()===t})},eL=()=>{try{const e=localStorage.getItem(Nk);if(e){const a=JSON.parse(e);if(a&&typeof a.primary=="string"&&typeof a.primaryDark=="string"&&typeof a.secondary=="string"&&typeof a.secondaryDark=="string"&&typeof a.accent=="string"&&typeof a.accentDark=="string")return a}}catch(e){console.warn("No se pudo leer customColors desde localStorage:",e)}return _0},aL=()=>{const e=localStorage.getItem(kx);return e&&e.trim().length>0?e:Th()},tL=()=>localStorage.getItem(kk)==="dark"?"dark":"light",rL=()=>{const e=typeof window<"u"?window.location.hash.slice(1).trim():"";if(e){const t=Zc(Xn).find(r=>r.path&&(r.path===e||r.path===e.toLowerCase()));if(t!=null&&t.path)return t.path}return localStorage.getItem(jk)||"dashboard"},sL=()=>{try{const e=localStorage.getItem(Nx);return e?JSON.parse(e):null}catch{return null}},nL=e=>{const a=document.documentElement;a.style.setProperty("--color-primary",e.primary),a.style.setProperty("--color-primary-dark",e.primaryDark),a.style.setProperty("--color-secondary",e.secondary),a.style.setProperty("--color-secondary-dark",e.secondaryDark),a.style.setProperty("--color-accent",e.accent),a.style.setProperty("--color-accent-dark",e.accentDark)},iL=e=>{const a=document.documentElement;e==="dark"?a.classList.add("dark"):a.classList.remove("dark")},oL=(e,a)=>{const t=Zc(e).find(r=>r.path===a);return(t==null?void 0:t.label)??"Dashboard"},lL=()=>{const[e,a]=N.useState(()=>tL()),[t,r]=N.useState(()=>eL()),[s,i]=N.useState(()=>aL()),[o,l]=N.useState(()=>{const _=localStorage.getItem(Vi)==="true";if(_){const Q=localStorage.getItem(zn);if(Q){const C=parseInt(Q,10);if(Date.now()-C>=xv)return localStorage.removeItem(Vi),localStorage.removeItem(Hi),localStorage.removeItem(zn),!1}else return localStorage.removeItem(Vi),localStorage.removeItem(Hi),!1}return _}),[c,u]=N.useState(!1),[d,f]=N.useState(()=>rL()),[m,x]=N.useState(()=>sL()),h=N.useMemo(()=>Zc(Xn),[]);N.useEffect(()=>{iL(e),localStorage.setItem(kk,e)},[e]),N.useEffect(()=>{nL(t),localStorage.setItem(Nk,JSON.stringify(t))},[t]),N.useEffect(()=>{s?localStorage.setItem(kx,s):localStorage.removeItem(kx)},[s]),N.useEffect(()=>{if(m){localStorage.setItem(Nx,JSON.stringify(m));const _=m.nombreEmpleado||m.noUsuario||xd.name;try{localStorage.setItem("nombreEmpleado",_)}catch{}try{const Q=m.idDfi!=null&&m.idDfi!==void 0?m.idDfi:m.idPerfil!=null&&m.idPerfil!==void 0?m.idPerfil:null;Q||console.warn("Usuario no tiene ID_DFI ni ID_PERFIL. NO_USUARIO:",m.noUsuario),localStorage.setItem("perfil",JSON.stringify({nombrePerfil:m.nombrePerfil||"Sin perfil",idPerfil:m.idPerfil,idDfi:m.idDfi,idEstacionamiento:m.idEstacionamiento,noUsuario:m.noUsuario,idUsuario:Q})),Q!=null?localStorage.setItem("session.idUsuario",String(Q)):console.error("No se pudo determinar el ID del usuario")}catch(Q){console.error("Error al guardar perfil del usuario:",Q)}try{const Q=m.noUsuario||_;localStorage.setItem("username",Q),localStorage.getItem("session.idUsuario")||localStorage.setItem("session.idUsuario",Q)}catch{}}else localStorage.removeItem(Nx),localStorage.removeItem("nombreEmpleado"),localStorage.removeItem("perfil"),localStorage.removeItem("username")},[m]),N.useEffect(()=>{localStorage.setItem(jk,d)},[d]),N.useEffect(()=>{if(typeof window>"u")return;const _=d?`#${d}`:"";window.location.hash!==_&&window.history.replaceState(null,"",`${window.location.pathname}${window.location.search}${_}`)},[d]),N.useEffect(()=>{const _=()=>{const Q=window.location.hash.slice(1).trim();if(!Q)return;const C=h.find(z=>z.path&&z.path===Q);C!=null&&C.path&&C.path!==d&&f(C.path)};return window.addEventListener("hashchange",_),()=>window.removeEventListener("hashchange",_)},[d,h]);const g=N.useCallback(()=>{a(_=>_==="dark"?"light":"dark")},[]),p=N.useCallback(()=>{l(!1),x(null),localStorage.removeItem(Vi),localStorage.removeItem(Hi),localStorage.removeItem(zn),localStorage.removeItem("perfil"),localStorage.removeItem("nombreEmpleado"),localStorage.removeItem("username"),u(!1)},[]),v=N.useCallback(async(_,Q)=>{try{const C=await JU(_,Q);l(!0),localStorage.setItem(Vi,"true"),localStorage.setItem(zn,Date.now().toString()),C.token?localStorage.setItem(Hi,C.token):localStorage.removeItem(Hi),C.usuario?x({...C.usuario,idPerfil:C.usuario.idPerfil!==null?C.usuario.idPerfil:null,idDfi:C.usuario.idDfi!==null?C.usuario.idDfi:null,idEstacionamiento:C.usuario.idEstacionamiento!==null?C.usuario.idEstacionamiento:null,modificaUbicacion:C.usuario.modificaUbicacion??null}):x(null)}catch(C){throw l(!1),localStorage.removeItem(Vi),localStorage.removeItem(Hi),localStorage.removeItem(zn),C instanceof Error?C:new Error("No se pudo iniciar sesin.")}},[]),w=N.useCallback(()=>{if(!o)return!1;const _=localStorage.getItem(zn);if(!_)return p(),!0;const Q=parseInt(_,10);return Date.now()-Q>=xv?(p(),!0):!1},[o,p]),b=N.useCallback(()=>{o&&localStorage.setItem(zn,Date.now().toString())},[o]);N.useEffect(()=>{if(!o)return;w();const _=setInterval(()=>{w()},3e4);return()=>{clearInterval(_)}},[o,w]),N.useEffect(()=>{if(!o)return;const _=["mousedown","mousemove","keypress","scroll","touchstart","click"],Q=()=>{b()};let C=null;const z=()=>{C||(C=setTimeout(()=>{Q(),C=null},1e3))};return _.forEach(S=>{window.addEventListener(S,z,{passive:!0})}),()=>{_.forEach(S=>{window.removeEventListener(S,z)}),C&&clearTimeout(C)}},[o,b]);const y=N.useCallback(()=>{u(_=>!_)},[]),j=N.useCallback((_,Q,C)=>{if(C)f(C);else{const z=hv(Xn,_);z!=null&&z.path&&f(z.path)}u(!1)},[]),A=N.useCallback(_=>{const Q=hv(Xn,_);Q!=null&&Q.path?f(Q.path):_&&f(_)},[]),E=N.useMemo(()=>({theme:e,setTheme:a,toggleTheme:g,customColors:t,setCustomColors:r,logoUrl:s,setLogoUrl:i}),[t,s,e,g]),F=N.useMemo(()=>oL(Xn,d),[d]),k=N.useMemo(()=>m?{name:m.nombreEmpleado||m.noUsuario||xd.name,storeId:m.idEstacionamiento!==null&&m.idEstacionamiento!==void 0?String(m.idEstacionamiento):xd.storeId}:xd,[m]),P=()=>{var _;switch(d){case"dashboard":return n.jsx(TC,{setActivePage:A});case"facturacion-articulos":return n.jsx(zU,{});case"facturacion-intereses":return n.jsx(H9,{});case"facturacion-carta-porte":return n.jsx(C9,{});case"facturacion-complemento-pagos":return n.jsx(K9,{});case"facturacion-retencion-pagos":return n.jsx(iM,{});case"facturacion-captura":return n.jsx(k9,{});case"facturacion-global":return n.jsx(OC,{});case"facturacion-cancelacion":return n.jsx(f9,{});case"facturacion-motos":return n.jsx(R9,{});case"facturacion-monederos":return n.jsx(F9,{});case"facturacion-nominas":return n.jsx(U9,{});case"facturacion-carta-factura":return n.jsx(VU,{});case"consultas-facturas":return n.jsx(cM,{});case"consultas-sku":return n.jsx(uM,{});case"consultas-tickets":return n.jsx(mM,{});case"consultas-reportes":return n.jsx(xM,{setActivePage:A});case"consultas-reps-sustituidos":return n.jsx(pM,{});case"refactura":return n.jsx(gM,{});case"facturas-sustituidas":return n.jsx(yM,{});case"facturas-por-usuario":return n.jsx(vM,{});case"admin-empleados":return n.jsx(wM,{});case"admin-tiendas":return n.jsx(EM,{});case"admin-periodos-perfil":return n.jsx(NM,{});case"admin-periodos-plataforma":return n.jsx(SM,{});case"admin-kioscos":return n.jsx(TM,{});case"admin-excepciones":return n.jsx(_M,{});case"admin-secciones":return n.jsx(RM,{});case"reportes-boletas-no-auditadas":return n.jsx(PM,{});case"reportes-ingreso-facturacion":return n.jsx(IM,{});case"reportes-integracion-factura-global":return n.jsx(UM,{});case"reportes-integracion-clientes":return n.jsx(BM,{});case"reportes-facturacion-clientes-global":return n.jsx($M,{});case"reportes-integracion-sustitucion-cfdi":return n.jsx(HM,{});case"reportes-control-emision-rep":return n.jsx(XM,{});case"reportes-repgcp":return n.jsx(YM,{});case"reportes-control-cambios":return n.jsx(WM,{});case"reportes-conciliacion":return n.jsx(KM,{});case"reportes-fiscales-reps-sustituidos":return n.jsx(ZM,{});case"monitor-graficas":return n.jsx(tU,{});case"monitor-bitacora":return n.jsx(rU,{});case"monitor-disponibilidad":return n.jsx(nU,{});case"monitor-logs":return n.jsx(xU,{});case"monitor-decodificador":return n.jsx(hU,{});case"monitor-permisos":return n.jsx(pU,{});case"monitor-conexiones":return n.jsx(gU,{});case"test-pdf":return n.jsx(yU,{});case"test-itext-pdf":return n.jsx(FU,{});case"registro-cfdi":return n.jsx(_U,{});case"catalogos-productos-servicios":return n.jsx(AU,{});case"catalogos-clientes":return n.jsx(RU,{});case"configuracion-temas":return n.jsx(DU,{});case"configuracion-empresa":return n.jsx(OU,{});case"configuracion-correo":return n.jsx(UU,{});case"configuracion-menus":return n.jsx(BU,{});case"reportes-consulta-monederos":return n.jsx(HU,{});case"reportes-regimen-facturacion-no-misma-boleta":return n.jsx(GU,{});case"reportes-ventas-maquina-corporativas":return n.jsx(XU,{});case"notas-credito":return n.jsx(WU,{});default:{const Q=((_=h.find(C=>C.path===d))==null?void 0:_.label)||d;return n.jsx(QU,{label:Q})}}},R=n.jsx("button",{type:"button",onClick:g,className:"px-2 sm:px-3 py-1 rounded-md border border-gray-300 dark:border-gray-600 text-xs sm:text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex-shrink-0","aria-label":"Cambiar tema",children:e==="dark"?"Oscuro":"Claro"});return n.jsx(Kt.Provider,{value:E,children:n.jsx(yC,{children:o?n.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300 overflow-hidden",children:[n.jsx(xC,{navItems:Xn,isOpen:c,toggleSidebar:y,onNavItemClick:j,logoUrl:s,appName:mv}),n.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden min-w-0",children:[n.jsx(vC,{user:k,toggleSidebar:y,onLogout:p,isSidebarOpen:c,isAuthenticated:o,ThemeToggleButton:R}),n.jsx(bC,{pageTitle:F,children:P()})]})]}):n.jsx(wC,{onLogin:v,logoUrl:s,appName:mv})})})},Sk=document.getElementById("root");if(!Sk)throw new Error("Could not find root element to mount to");const cL=PS.createRoot(Sk);cL.render(n.jsx(or.StrictMode,{children:n.jsx(lL,{})}));export{No as _,A2 as a,dL as c,uL as g};
