-- =====================================================
-- SCRIPT DE INSTALACIÓN COMPLETA DEL SISTEMA DE FACTURACIÓN
-- =====================================================
-- Este script contiene todo lo necesario para instalar y configurar
-- el sistema de facturación desde cero.
-- 
-- Fecha: Octubre 2025
-- Versión: 1.0
-- =====================================================

-- =====================================================
-- 1. CREAR TABLA DE PERFILES
-- =====================================================
CREATE TABLE PERFIL (
    ID_PERFIL NUMBER(10) PRIMARY KEY,
    NOMBRE_PERFIL VARCHAR2(100) NOT NULL,
    FECHA_ALTA DATE DEFAULT SYSDATE,
    FECHA_MOD DATE DEFAULT SYSDATE,
    USUARIO_MOD VARCHAR2(50) DEFAULT 'SYSTEM'
);

-- Insertar perfiles del sistema
INSERT INTO PERFIL (ID_PERFIL, NOMBRE_PERFIL) VALUES (1, 'Operador de Credito');
INSERT INTO PERFIL (ID_PERFIL, NOMBRE_PERFIL) VALUES (2, 'Jefe de Credito');
INSERT INTO PERFIL (ID_PERFIL, NOMBRE_PERFIL) VALUES (3, 'Administrador');

-- =====================================================
-- 2. CREAR TABLA DE USUARIOS
-- =====================================================
CREATE TABLE USUARIOS (
    NO_USUARIO VARCHAR2(50) PRIMARY KEY,
    NOMBRE_EMPLEADO VARCHAR2(200) NOT NULL,
    PASSWORD VARCHAR2(100) NOT NULL,
    ESTATUS_USUARIO VARCHAR2(20) DEFAULT 'ACTIVO',
    ID_PERFIL NUMBER(10) NOT NULL,
    FECHA_ALTA DATE DEFAULT SYSDATE,
    FECHA_MOD DATE DEFAULT SYSDATE,
    USUARIO_MOD VARCHAR2(50) DEFAULT 'SYSTEM',
    ID_DFI NUMBER(10) DEFAULT 1,
    ID_ESTACIONAMIENTO NUMBER(10) DEFAULT 1,
    MODIFICA_UBICACION CHAR(1) DEFAULT 'S',
    CONSTRAINT FK_USUARIOS_PERFIL FOREIGN KEY (ID_PERFIL) REFERENCES PERFIL(ID_PERFIL)
);

-- Insertar usuarios del sistema
INSERT INTO USUARIOS (
    NO_USUARIO, NOMBRE_EMPLEADO, PASSWORD, ESTATUS_USUARIO, ID_PERFIL,
    FECHA_ALTA, FECHA_MOD, USUARIO_MOD, ID_DFI, ID_ESTACIONAMIENTO, MODIFICA_UBICACION
) VALUES (
    'admin', 'Administrador Sistema', 'admin123', 'ACTIVO', 3,
    SYSDATE, SYSDATE, 'SYSTEM', 1, 1, 'S'
);

INSERT INTO USUARIOS (
    NO_USUARIO, NOMBRE_EMPLEADO, PASSWORD, ESTATUS_USUARIO, ID_PERFIL,
    FECHA_ALTA, FECHA_MOD, USUARIO_MOD, ID_DFI, ID_ESTACIONAMIENTO, MODIFICA_UBICACION
) VALUES (
    'operador', 'Operador de Crédito', 'operador123', 'ACTIVO', 1,
    SYSDATE, SYSDATE, 'SYSTEM', 1, 1, 'S'
);

INSERT INTO USUARIOS (
    NO_USUARIO, NOMBRE_EMPLEADO, PASSWORD, ESTATUS_USUARIO, ID_PERFIL,
    FECHA_ALTA, FECHA_MOD, USUARIO_MOD, ID_DFI, ID_ESTACIONAMIENTO, MODIFICA_UBICACION
) VALUES (
    'jefe', 'Jefe de Crédito', 'jefe123', 'ACTIVO', 2,
    SYSDATE, SYSDATE, 'SYSTEM', 1, 1, 'S'
);

-- =====================================================
-- 3. CREAR TABLA DE CONFIGURACIÓN DE MENÚS
-- =====================================================
CREATE TABLE MENU_CONFIG (
    ID_CONFIG NUMBER(10) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_PERFIL NUMBER(10) NOT NULL,
    MENU_LABEL VARCHAR2(200) NOT NULL,
    MENU_PATH VARCHAR2(200),
    IS_VISIBLE NUMBER(1) DEFAULT 1,
    ORDEN NUMBER(10) DEFAULT 1,
    FECHA_CREACION DATE DEFAULT SYSDATE,
    FECHA_MODIFICACION DATE DEFAULT SYSDATE,
    USUARIO_CREACION VARCHAR2(50) DEFAULT 'SYSTEM',
    USUARIO_MODIFICACION VARCHAR2(50) DEFAULT 'SYSTEM',
    CONSTRAINT FK_MENU_CONFIG_PERFIL FOREIGN KEY (ID_PERFIL) REFERENCES PERFIL(ID_PERFIL)
);

-- =====================================================
-- 4. INSERTAR CONFIGURACIÓN COMPLETA DE MENÚS
-- =====================================================

-- Dashboard para todos los perfiles
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Dashboard', 'dashboard', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Dashboard', 'dashboard', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Dashboard', 'dashboard', 1, 1, 'SYSTEM');

-- Pestañas principales para todos los perfiles
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Facturación', NULL, 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Consultas', NULL, 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Reportes Facturación Fiscal', NULL, 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Registro CFDI', NULL, 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Monitor', NULL, 1, 6, 'SYSTEM');

INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Facturación', NULL, 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Consultas', NULL, 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Administración', NULL, 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Reportes Facturación Fiscal', NULL, 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Registro CFDI', NULL, 1, 6, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Monitor', NULL, 1, 7, 'SYSTEM');

INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Facturación', NULL, 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Consultas', NULL, 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Administración', NULL, 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Reportes Facturación Fiscal', NULL, 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Registro CFDI', NULL, 1, 6, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Monitor', NULL, 1, 7, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Configuración', NULL, 1, 8, 'SYSTEM');

-- =====================================================
-- 5. INSERTAR PANTALLAS DE FACTURACIÓN
-- =====================================================
-- Operador de Crédito
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Artículos', 'facturacion-articulos', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Intereses', 'facturacion-intereses', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Carta Factura', 'facturacion-carta', 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Captura Libre', 'facturacion-captura', 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Factura Global', 'facturacion-global', 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Cancelación Masiva', 'facturacion-cancelacion', 1, 6, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Monederos', 'facturacion-monederos', 1, 7, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Nóminas', 'facturacion-nominas', 1, 8, 'SYSTEM');

-- Jefe de Crédito
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Artículos', 'facturacion-articulos', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Intereses', 'facturacion-intereses', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Carta Factura', 'facturacion-carta', 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Captura Libre', 'facturacion-captura', 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Factura Global', 'facturacion-global', 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Cancelación Masiva', 'facturacion-cancelacion', 1, 6, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Monederos', 'facturacion-monederos', 1, 7, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Nóminas', 'facturacion-nominas', 1, 8, 'SYSTEM');

-- Administrador
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Artículos', 'facturacion-articulos', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Intereses', 'facturacion-intereses', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Carta Factura', 'facturacion-carta', 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Captura Libre', 'facturacion-captura', 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Factura Global', 'facturacion-global', 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Cancelación Masiva', 'facturacion-cancelacion', 1, 6, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Monederos', 'facturacion-monederos', 1, 7, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Nóminas', 'facturacion-nominas', 1, 8, 'SYSTEM');

-- =====================================================
-- 6. INSERTAR PANTALLAS DE CONSULTAS
-- =====================================================
-- Operador de Crédito
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Facturas', 'consultas-facturas', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'SKU', 'consultas-sku', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Boletas', 'consultas-boletas', 1, 3, 'SYSTEM');

-- Jefe de Crédito
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Facturas', 'consultas-facturas', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'SKU', 'consultas-sku', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Boletas', 'consultas-boletas', 1, 3, 'SYSTEM');

-- Administrador
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Facturas', 'consultas-facturas', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'SKU', 'consultas-sku', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Boletas', 'consultas-boletas', 1, 3, 'SYSTEM');

-- =====================================================
-- 7. INSERTAR PANTALLAS DE ADMINISTRACIÓN (Solo Jefe y Admin)
-- =====================================================
-- Jefe de Crédito
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Empleados', 'admin-empleados', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Tiendas', 'admin-tiendas', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Períodos Perfil', 'admin-periodos-perfil', 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Períodos Plataforma', 'admin-periodos-plataforma', 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Kioscos', 'admin-kioscos', 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Excepciones', 'admin-excepciones', 1, 6, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Secciones', 'admin-secciones', 1, 7, 'SYSTEM');

-- Administrador
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Empleados', 'admin-empleados', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Tiendas', 'admin-tiendas', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Períodos Perfil', 'admin-periodos-perfil', 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Períodos Plataforma', 'admin-periodos-plataforma', 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Kioscos', 'admin-kioscos', 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Excepciones', 'admin-excepciones', 1, 6, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Secciones', 'admin-secciones', 1, 7, 'SYSTEM');

-- =====================================================
-- 8. INSERTAR TODAS LAS PANTALLAS DE REPORTES FACTURACIÓN FISCAL
-- =====================================================

-- Función auxiliar para insertar reportes para un perfil
DECLARE
    v_perfil_id NUMBER;
    v_orden NUMBER := 1;
BEGIN
    -- Para cada perfil (1, 2, 3)
    FOR v_perfil_id IN 1..3 LOOP
        v_orden := 1;
        
        -- 11 pantallas originales
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Boletas No Auditadas', 'reportes-boletas-no-auditadas', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Reporte Ingreso-Facturación', 'reportes-ingreso-facturacion', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Integración Factura Global', 'reportes-integracion-factura-global', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Integración Clientes', 'reportes-integracion-clientes', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Facturación clientes posterior a Global', 'reportes-facturacion-clientes-global', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Integración Sustitución CFDI', 'reportes-integracion-sustitucion-cfdi', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Control de emisión de REP', 'reportes-control-emision-rep', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Reportes REPgcp', 'reportes-repgcp', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Control de cambios', 'reportes-control-cambios', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Conciliación', 'reportes-conciliacion', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'REPs Sustituidos (Fiscal)', 'reportes-fiscales-reps-sustituidos', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        
        -- 19 pantallas nuevas
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Reporte de Consulta Monederos', 'reportes-consulta-monederos', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Reporte de Ventas Máquina Corporativas Serely Polu', 'reportes-ventas-maquina-corporativas', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Régimen de Facturación No Misma Boleta', 'reportes-regimen-facturacion-no-misma-boleta', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Doble Facturación Pendiente por Defencia', 'reportes-doble-facturacion-pendiente', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Sustitución en Proceso', 'reportes-sustitucion-en-proceso', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Cancelación Sustitución de Facturación', 'reportes-cancelacion-sustitucion-facturacion', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Saldo a Favor de Clientes', 'reportes-saldo-favor-clientes', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Orden de Módulos y Facturación', 'reportes-orden-modulos-facturacion', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Consulta de Usuarios', 'reportes-consulta-usuarios', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Consulta Tiendas de Total de Facturas Diarias', 'reportes-consulta-tiendas-facturas-diarias', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Validación por Importe Intereses', 'reportes-validacion-importe-intereses', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Conciliación Cambio de Sistema de Facturación', 'reportes-conciliacion-cambio-sistema', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Control de Complementos de Pago (REP) Generados por Ventas Corporativas', 'reportes-control-complementos-pago-rep', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Reporte por Factura de Mercancía de Monederos', 'reportes-factura-mercancia-monederos', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Ventas Corporativas vs SAT', 'reportes-ventas-corporativas-vs-sat', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Captura Libre Complemento de Pago (REP)', 'reportes-captura-libre-complemento-pago', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Conciliación Sistema de Facturación de Boletas vs SAT', 'reportes-conciliacion-boletas-vs-sat', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Reporte de Trazabilidad de Boletas Canceladas', 'reportes-trazabilidad-boletas-canceladas', 1, v_orden, 'SYSTEM');
        v_orden := v_orden + 1;
        INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (v_perfil_id, 'Estatus Actualizar SAT de CFDI por Petición', 'reportes-estatus-actualizar-sat-cfdi', 1, v_orden, 'SYSTEM');
    END LOOP;
END;
/

-- =====================================================
-- 9. INSERTAR PANTALLAS DE REGISTRO CFDI
-- =====================================================
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Registro de Constancias', 'registro-cfdi', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Registro de Constancias', 'registro-cfdi', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Registro de Constancias', 'registro-cfdi', 1, 1, 'SYSTEM');

-- =====================================================
-- 10. INSERTAR PANTALLAS DE MONITOR
-- =====================================================
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Gráficas', 'monitor-graficas', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Bitácora', 'monitor-bitacora', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Disponibilidad', 'monitor-disponibilidad', 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Logs', 'monitor-logs', 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Permisos', 'monitor-permisos', 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (1, 'Decodificador', 'monitor-decodificador', 1, 6, 'SYSTEM');

INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Gráficas', 'monitor-graficas', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Bitácora', 'monitor-bitacora', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Disponibilidad', 'monitor-disponibilidad', 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Logs', 'monitor-logs', 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Permisos', 'monitor-permisos', 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (2, 'Decodificador', 'monitor-decodificador', 1, 6, 'SYSTEM');

INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Gráficas', 'monitor-graficas', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Bitácora', 'monitor-bitacora', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Disponibilidad', 'monitor-disponibilidad', 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Logs', 'monitor-logs', 1, 4, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Permisos', 'monitor-permisos', 1, 5, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Decodificador', 'monitor-decodificador', 1, 6, 'SYSTEM');

-- =====================================================
-- 11. INSERTAR PANTALLAS DE CONFIGURACIÓN (Solo Administrador)
-- =====================================================
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Configuración de Correo', 'configuracion-correo', 1, 1, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Configuración de Empresa', 'configuracion-empresa', 1, 2, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Configuración de Temas', 'configuracion-temas', 1, 3, 'SYSTEM');
INSERT INTO MENU_CONFIG (ID_PERFIL, MENU_LABEL, MENU_PATH, IS_VISIBLE, ORDEN, USUARIO_CREACION) VALUES (3, 'Configuración de Menús', 'configuracion-menus', 1, 4, 'SYSTEM');

-- =====================================================
-- 12. CREAR ÍNDICES PARA OPTIMIZACIÓN
-- =====================================================
CREATE INDEX IDX_MENU_CONFIG_PERFIL ON MENU_CONFIG(ID_PERFIL);
CREATE INDEX IDX_MENU_CONFIG_VISIBLE ON MENU_CONFIG(IS_VISIBLE);
CREATE INDEX IDX_MENU_CONFIG_PATH ON MENU_CONFIG(MENU_PATH);

-- =====================================================
-- 13. VERIFICACIÓN FINAL
-- =====================================================
-- Mostrar resumen de la instalación
SELECT 
    'PERFILES CREADOS' as TIPO,
    COUNT(*) as TOTAL
FROM PERFIL
UNION ALL
SELECT 
    'USUARIOS CREADOS' as TIPO,
    COUNT(*) as TOTAL
FROM USUARIOS
UNION ALL
SELECT 
    'CONFIGURACIONES DE MENÚ' as TIPO,
    COUNT(*) as TOTAL
FROM MENU_CONFIG;

-- Mostrar configuración por perfil
SELECT 
    p.NOMBRE_PERFIL,
    COUNT(mc.ID_CONFIG) as TOTAL_PANTALLAS,
    SUM(CASE WHEN mc.IS_VISIBLE = 1 THEN 1 ELSE 0 END) as PANTALLAS_VISIBLES
FROM PERFIL p
LEFT JOIN MENU_CONFIG mc ON p.ID_PERFIL = mc.ID_PERFIL
GROUP BY p.ID_PERFIL, p.NOMBRE_PERFIL
ORDER BY p.ID_PERFIL;

COMMIT;

-- =====================================================
-- INSTALACIÓN COMPLETADA
-- =====================================================
-- El sistema está listo para usar con:
-- - 3 perfiles de usuario (Operador, Jefe, Administrador)
-- - 3 usuarios de prueba (operador/operador123, jefe/jefe123, admin/admin123)
-- - Configuración completa de menús dinámicos
-- - 30 pantallas de reportes fiscales (11 originales + 19 nuevas)
-- - Sistema de visibilidad configurable por administrador
-- =====================================================
