# üîß Soluci√≥n - Problema de Perfiles en Configuraci√≥n de Men√∫s

## üö® Problema Identificado

Despu√©s de crear los usuarios, el apartado de configuraci√≥n no carga los perfiles para la visibilidad de pesta√±as. Esto puede deberse a:

1. **Tabla MENU_CONFIG vac√≠a** - No hay configuraci√≥n de men√∫s para los perfiles
2. **Perfiles sin configuraci√≥n** - Los perfiles nuevos no tienen configuraci√≥n asociada
3. **Problema en la consulta** - El servicio no encuentra los perfiles

## üîç Diagn√≥stico

### **Paso 1: Verificar Estado Actual**
```sql
@database_diagnose_menu_problem.sql
```

Este script te mostrar√°:
- ‚úÖ **Perfiles existentes** en la tabla PERFIL
- ‚úÖ **Si existe tabla MENU_CONFIG**
- ‚úÖ **Contenido de MENU_CONFIG** (si existe)
- ‚úÖ **Usuarios y sus perfiles asignados**
- ‚úÖ **Prueba de consulta del servicio**

### **Paso 2: Verificar Configuraci√≥n Completa**
```sql
@database_check_menu_config.sql
```

Este script te mostrar√°:
- ‚úÖ **Configuraci√≥n de men√∫s existente**
- ‚úÖ **Perfiles sin configuraci√≥n**
- ‚úÖ **Configuraciones sin perfil v√°lido**
- ‚úÖ **Conteo de configuraciones por perfil**

## üõ†Ô∏è Soluci√≥n

### **Opci√≥n 1: Si la tabla MENU_CONFIG est√° vac√≠a**
```sql
@database_fix_menu_config.sql
```

Este script:
- ‚úÖ **Crea configuraci√≥n b√°sica** para todos los perfiles
- ‚úÖ **Crea secuencia SEQ_MENU_CONFIG** si no existe
- ‚úÖ **Asocia perfiles con configuraci√≥n de men√∫s**
- ‚úÖ **Verifica el resultado final**

### **Opci√≥n 2: Si solo faltan algunos perfiles**
Ejecuta solo las partes necesarias del script de correcci√≥n.

## üîç Posibles Causas

### **Causa 1: Tabla MENU_CONFIG Vac√≠a**
- La tabla existe pero no tiene datos
- Los perfiles no tienen configuraci√≥n asociada

### **Causa 2: Perfiles Nuevos Sin Configuraci√≥n**
- Los perfiles creados (ID: 99, 3, 2, 1) no tienen configuraci√≥n
- Solo los perfiles originales ten√≠an configuraci√≥n

### **Causa 3: Problema en el Servicio**
- El servicio `MenuConfigService.obtenerPerfiles()` no encuentra perfiles
- Problema en la consulta SQL

## üöÄ Pasos para Solucionar

### **Paso 1: Diagnosticar**
```sql
@database_diagnose_menu_problem.sql
```

### **Paso 2: Verificar Configuraci√≥n**
```sql
@database_check_menu_config.sql
```

### **Paso 3: Corregir si es Necesario**
```sql
@database_fix_menu_config.sql
```

### **Paso 4: Reiniciar Backend**
Despu√©s de ejecutar los scripts, reinicia el servidor backend.

### **Paso 5: Probar Configuraci√≥n**
Accede a la secci√≥n de configuraci√≥n y verifica que los perfiles aparezcan.

## üîç Verificaci√≥n Post-Fix

### **Verificar que los Perfiles Aparecen**
```sql
SELECT 
    ID_PERFIL, 
    NOMBRE_PERFIL 
FROM PERFIL 
ORDER BY NOMBRE_PERFIL;
```

**Deber√≠a mostrar todos los perfiles**: Super Administrador, Administrador, Jefe de Cr√©dito, Operador de Cr√©dito

### **Verificar Configuraci√≥n de Men√∫s**
```sql
SELECT 
    mc.ID_PERFIL,
    p.NOMBRE_PERFIL,
    COUNT(*) AS TOTAL_CONFIGURACIONES
FROM MENU_CONFIG mc
LEFT JOIN PERFIL p ON mc.ID_PERFIL = p.ID_PERFIL
GROUP BY mc.ID_PERFIL, p.NOMBRE_PERFIL
ORDER BY mc.ID_PERFIL;
```

**Todos los perfiles deber√≠an tener al menos 1 configuraci√≥n**

## ‚ö†Ô∏è Importante

- ‚úÖ **Las configuraciones existentes se preservan** - No se modifican
- ‚úÖ **Solo se agregan configuraciones faltantes** - Para perfiles nuevos
- ‚úÖ **El sistema de men√∫s seguir√° funcionando** - Con las configuraciones existentes
- ‚úÖ **Los perfiles aparecer√°n en configuraci√≥n** - Despu√©s de la correcci√≥n

## üîß Si A√∫n No Funciona

### **Verificar Logs del Backend**
```bash
grep -i "menu\|perfil\|config" logs/server.log
```

### **Probar Endpoint Directamente**
```bash
curl http://localhost:8080/api/menu-config/perfiles
```

### **Verificar Frontend**
Revisar la consola del navegador para errores en la carga de perfiles.

---

**Ejecuta primero `@database_diagnose_menu_problem.sql` para identificar el problema espec√≠fico, luego `@database_fix_menu_config.sql` para corregirlo.**
